=== IMPORTANT: ISOLATE THIS PAPER ===
You are summarizing ONLY the paper below. Do NOT reference or use content from any other papers.
Do NOT mix information from different papers. Only use information from THIS specific paper.

Paper Title: Free Energy Principle for the Noise Smoothness Estimation of Linear Systems with Colored Noise
Citation Key: meera2022free
Authors: Ajith Anil Meera, Martijn Wisse

REMEMBER: Extract quotes, claims, and findings ONLY from the paper text provided below.

Year: 2022

Key Terms: principle, systems, energy, smoothness, noise, state, colored, called, linear, brain

=== FULL PAPER TEXT ===

Free Energy Principle for the Noise Smoothness Estimation of
Linear Systems with Colored Noise
Ajith Anil Meera and Martijn Wisse
Abstract—Thefreeenergyprinciple(FEP)fromneuroscience II. RELATEDWORK
provides a framework called active inference for the joint
This section highlights the interdisciplinary nature of FEP
estimation and control of state space systems, subjected to
colored noise. However, the active inference community has with related works in neuroscience and robotics literature.
been challenged with the critical task of manually tuning
A. Neuroscience the noise smoothness parameter. To solve this problem, we
introduce a novel online noise smoothness estimator based on FEP posits that all biological systems resist their natural
theideaoffreeenergyprinciple.Wemathematicallyshowthat
tendency to disorder by minimizing their free energy [6],
ourestimatorcanconvergetothefreeenergyoptimumduring
where free energy is an information theoretic measure that
smoothness estimation. Using this formulation, we introduce a
joint state and noise smoothness observer design called DEMs. boundssensorysurprisal.FEPemergesasaunifiedtheoryof
Throughrigoroussimulations,weshowthatDEMsoutperforms the brain by providing a mathematical formalism for brain
state-of-the-artstateobserverswithleaststateestimationerror. functions[9],unifyingactionandperception[10],explaining
Finally,weprovideaproofofconceptforDEMsbyapplyingit
Freudian ideas [11], and connecting memory and attention
onarealliferoboticsproblem-stateestimationofaquadrotor
[9].TheworkclosesttoourproposedideaistheGeneralized
hovering in wind, demonstrating its practical use.
filtering [12] that uses FEP for noise smoothness estimation
during the inversion of dynamic models of the brain (fMRI
I. INTRODUCTION
data) [13]. We extend this idea into robotics to design an
Therisingdemandforautonomousdronedeliverysystems online state and noise smoothness observer for applications
has increased the need for accurate state observers that are like quadrotor flights with wind as colored noise.
robust against uncertain events like strong wind currents.
B. Robotics and control
These unmodelled wind currents induce colored noise to the
system, hindering the safe operation of drones. We take a In control systems literature, numerous approaches are
step in this direction by using the ideas from computational used to deal with colored noise during state estimation
neurosciencetointroduceanovelstateandnoisesmoothness [1]. SA models the colored process noise as an auto-
observer design for linear systems with colored noise. regressive(AR)noise andaugmentsthestate spaceequation
The classical linear estimators like Kalman Filter (KF) totransformitintoanequivalentsysteminfluencedbywhite
assumes the noises to be white. This assumption is often noise [3]. SMIKF [2] extends KF for coloured noise by
violated in practice, resulting in a sub-optimal estimation incorporating the temporal correlations of the AR noise into
[1]. Many adaptations on KF have been introduced to over- the prior covariance calculation of KF. MD [4] approach
come this challenge, including Second Moment Information deals with handling colored measurement noise. However,
Kalman filter (SMIKF) [2], State Augmentation (SA) [3], the white noise assumption is prevalent in robotics for the
Measurement Differencing (MD) [4] etc. Dynamic Expec- state estimation of a quadrotor [14], which might not be
tation Maximization (DEM) [5], based on Free Energy effective in outdoor windy conditions [8]. Our work fills
Principle (FEP) [6] from neuroscience has recently been this research gap by providing an online noise smoothness
used to design state and input observers [7] that has shown estimator.
to outperform the classical methods both in simulation and The brain inspired nature of FEP has already inspired the
in real robot experiments [8]. However, DEM requires the development of intelligent agents [15] – body perception of
prior knowledge of the noise smoothness parameter for the humanoidrobots[16],estimationandcontrolofmanipulator
accuratestateestimation.Tosolvethisproblem,weintroduce robot [17], system identification of a quadrotor [18], SLAM
anovelonlinenoisesmoothnessestimatorbasedonFEP,for [19], PID controller [20], KF [8], [21] etc. These active
linear systems with colored noise. The core contributions of inference applications can employ our noise estimator for
the paper include: better estimation and control of robots during colored noise.
1) introduction of an online smoothness estimator for the
III. PROBLEMSTATEMENT
state estimation of linear systems under colored noise,
Consider the linear plant dynamics given in Equation 1
2) extensiveevaluationoftheestimatorinsimulationand
where A, B and C are constant system matrices, x∈Rn is
its validation on a real robot (quadrotor flight) data.
thehiddenstate,v∈Rr istheinputandy∈Rm istheoutput.
BothauthorsarewiththeDepartmentofCognitiveRoboticsatTUDelft,
x˙ =Ax+Bv+w, y=Cx+z. (1)
TheNetherlands.Correspondingauthor:ajitham1994@gmail.com
2202
rpA
4
]YS.ssee[
1v69710.4022:viXra
Here w∈Rn and z∈Rm represent the process and measure- derivatives take a specific structure [5]. The smoothness
mentnoisewithnoiseprecision(inversecovariance)Πw and matrix defining this relation for p=6 is calculated as [7]:
Πz respectively. Variables of the plant are denoted in bold-  35 0 35s2 0 7s4 0 1s6 
face, while its estimates are denoted in non-boldface. The 16 8 4 6
 0 35s2 0 7s4 0 s6 0 
noisesinthispaperaregeneratedthroughtheconvolutionof   35s2 4 0 77s4 0 19s6 0 s8  
white noise with a Gaussian filter of kernel width s.  8 4 2 
S= 0 7s4 0 8s6 0 4s8 0 , (4)
The problem considered in this paper is the state (x)  3 
 7s4 0 19s6 0 17s8 0 2s10
and noise smoothness (s) observer design (DEMs) for the  4 2 3 3 
 0 s6 0 4s8 0 4 s10 0 
linearsystemgiveninEquation1,subjectedtocolorednoise. 3 15
1s6 0 s8 0 2s10 0 4 s12
We show that our observer outperforms state-of-the-art state 6 3 45
observers,bothinsimulation(SectionVIII)andonrealrobot where s is the kernel width of the Gaussian filter. Since
data (Section IX). s<1 second for practical cases (sensors have high sampling
rate), the first elements in S matrix are higher than the
IV. NOISECOLORMODELLING last ones, implying a higher correlation between the first
noisederivatives(moresmooth)thanthelastderivatives(less
The two key concepts behind the success of DEM in
smooth). The combined (generalized) noise precision matrix
handling the colored noise are i) the use of generalized co-
can be written using the S matrix as:
ordinates and ii) the noise precision modelling. This section
aims to elaborate on these theoretical concepts. (cid:20) S⊗Πz 0 (cid:21)
Π˜ = . (5)
0 S⊗Πw
A. Generalized coordinates
With the key concepts in place, the next section derives the
Generalized coordinates is a vector representation of the free energy formulations that are necessary for the observer
trajectoryofatimevaryingquantity(x,v,y)usingacollection design in Section VI.
of its higher order derivatives. For example, the state vector
in generalized coordinates is written using a tilde operator V. FREEENERGYOPTIMIZATION
as x˜=[x x(cid:48) x(cid:48)(cid:48) ....]T, where the dash operator represents the FEP uses Bayesian Inference to estimate the posterior
derivatives. The key advantage is the capability to track the probability p(ϑ/y)= p(ϑ,y/ (cid:82) p(ϑ,y)dϑ, where ϑ is the
trajectory of states, unlike the classical estimators that track componenttobeestimated(ϑ={x˜,s}),andyisthemeasure-
only the point estimates. This provides additional data for ment [22]. The presence of an intractable integral motivates
DEMduringestimation,resultinginitssuperiorperformance the use of a variational density q(ϑ), called the recognition
duringstateestimationundercolorednoise.Sincethenoises density that approximates the posterior as q(ϑ)≈ p(ϑ/y).
are colored, the higher derivatives of the system model can ThisapproximationisachievedbyminimizingtheKullback-
be written as [5]: Leibler (KL) divergence of the distributions given by
KL(q(ϑ)||p(ϑ/y))=(cid:104)lnq(ϑ)(cid:105) −(cid:104)lnp(ϑ/y)(cid:105) , where
x(cid:48)=Ax+Bv+w y=Cx+z q(ϑ) q(ϑ)
(cid:104).(cid:105) represents the expectation over q(ϑ). Upon simplifi-
q(ϑ)
x(cid:48)(cid:48)=Ax(cid:48)+Bv(cid:48)+w(cid:48) y(cid:48)=Cx(cid:48)+z(cid:48) (2) cation using p(ϑ/y)=p(ϑ,y)/p(y), it reduces to [6]:
... ...
lnp(y)=F+KL(q(ϑ)||p(ϑ|y)), (6)
which can be compactly written as:
whereF=(cid:104)lnp(ϑ,y)(cid:105) −(cid:104)lnq(ϑ)(cid:105) isthefreeenergy.
q(ϑ) q(ϑ)
x˙˜=Dxx˜=A˜x˜+B˜v˜+w˜ y˜=C˜x˜+z˜ (3) Since lnp(y) is independent of ϑ, minimization of the KL
divergence involves the maximization of free energy. This is
(cid:34)01 (cid:35) the fundamental idea behind using free energy as the proxy
where Dx= 01 . . ⊗I n×n . for brain’s inference through the minimization of its sensory
01
0 (p+1)×(p+1) surprisal [6].
Here, Dx represents the shift matrix, which performs the We use this idea from free energy principle for the
derivative operation on the generalized state vector. p and joint observer design for x˜ and s through two fundamental
d represent the embedding order for the hidden states and assumptions about q(ϑ)=q(x˜,s): i) Mean field assumption
the inputs respectively, indicating the number of derivatives [5] that facilitates a conditional independence between the
used. The generalized system matrices are given by A˜ = subdensities, q(ϑ)=q(x˜)q(s), and ii) Laplace assumption
I p+1 ⊗A, B˜ =I p+1 ⊗B, C˜ =I p+1 ⊗C, where I denotes [23] that facilitates the use of Gaussian distributions with
the identity matrix and ⊗ the Kronecker tensor product. mean µ and variance Σ over these subdensities, q(x˜) =
N (x˜: µx˜,Σx˜) and q(s)=N (s: µs,Σs). We refer to [24]
B. Noise precision modelling
for an elaborate read on similar simplifications. Under these
The second key concept is the modelling of generalized assumptions, F reduces to the sum of precision weighted
noise precision (inverse covariance) matrix Π˜. Since the prediction errors and the information entropy as:
noises are assumed to be Gaussian convoluted white noise, 1 1 1 1
the covariance matrix embedding the relation between noise F =− ε˜TΠ˜ε˜+ ln|Π˜|− εsTΠsεs+ ln|Πs|, (7)
2 2 2 2
where ε˜ is the combined prediction error for outputs and Since Π˜ (cid:31) 0, from definition ε˜TΠ˜ε˜ > 0, and since
states, and εs is the prediction error for s, given by: (ε˜TΠ˜ ε˜)| >0, we can conclude that (ε˜TΠ˜ ε˜)| >0,
s s=so ss s=so
(cid:20) y˜−C˜x˜ (cid:21) even though Π˜ s (cid:7) 0 and Π˜ ss (cid:7) 0 (refer Appendix B for
ε˜ = Dx˜−A˜x˜−B˜v˜ , and εs=s−ηs. (8) numerical analysis). From Equation 14, (ε˜TΠ˜ ss ε˜)| s=so >
0 =⇒ F | <0, completing the proof for the existence
ss s=so
Here ηs and Πs are the prior smoothness and its prior of a unique maximum of free energy at s=s o .
precision(confidence).Forthiswork,westarttheestimation
VI. OBSERVERDESIGN
fromalowpriorηs≈0withaverylowconfidence(Πs=1).
Therefore, Equation 7 reduces to: This section aims to introduce a novel observer design
(DEMs) for the joint state and noise smoothness estimation
1 1 1
F =− ε˜TΠ˜ε˜+ ln|Π˜|− s2. (9) ofalinearsystemwithcolorednoise.Weformulatethenoise
2 2 2
smoothness estimator from the previous section (gradient
The last term in Equation 9 is the novel term that we have ascend on F), using the Newton-Gauss update scheme:
introduced for optimizing smoothness, and doesn’t appear
s(t+dt)=s(t)+ds,
in FEP literature. Using this, we propose an online noise
(15)
smoothness estimation algorithm which estimates s through ds=(eFss|tdt−1)(F |)−1F|,
ss t s t
the gradient ascend (maximization) of F, where ∂F| =0
∂s s=so wheres(t)isthesmoothnessattimet,anddsisthesmooth-
and
∂2F|
<0, with s being the smoothness value that
∂s2 s=so o ness increment for a time increment of dt. We combine
maximizes F. The free energy gradients necessary for this
this observer design with the standard DEM observer design
scheme are obtained by differentiating Equation 9:
for state estimation [7], where the update equation in the
∂F 1 ∂Π˜ 1∂ln|Π˜| continuous time is given by:
=− ε˜T ε˜+ −s
∂ ∂ 2F s =− 2 1 ε˜T ∂ ∂ 2 s Π˜ ε˜+ 2 1∂ ∂ 2l s n|Π˜| −1, (10) x˙˜=A 1 x˜+B 1 (cid:20) y v ˜ ˜ (cid:21) (16)
∂s2 2 ∂s2 2 ∂s2
whereA =[Dx−kxC˜TΠ˜zC˜−kx(Dx−A˜)TΠ˜w(Dx−A˜)],B =
where the gradients of ln|Π˜| can be computed as (refer kx(cid:2) C˜TΠ˜z 1 (Dx−A˜)TΠ˜wB˜(cid:3) ,andkx isthelearningratewh 1 ich
Appendix A) :
issetto1throughoutthispaper.SinceEquation16isalinear
∂ln|Π˜| 1 ∂2ln|Π˜| 1 differentialequation,anexactalgebraicdiscretizationcanbe
=42(n+m) , =−42(n+m) . (11) performed for the observer as:
∂s s ∂s2 s2
(cid:20) (cid:21)
The usage of a gradient ascent scheme on the free energy x˜(t+dt)=eA1dtx˜(t)+A−1(eA1dt−I)B y˜(t) (17)
curve for the estimation of s is motivated by the proof for 1 1 v˜(t)
the existence of a unique maximum for F under practical
Equations 15 and 17 together complete our observer design.
bounds as follows.
Note that A and B are nonlinear functions of s because of
1 1
Proposition V.1. The free energy F defined by Equation 9 thepresenceofΠ˜w andΠ˜z init.Therefore,theupdateequa-
has a unique maximum with respect to noise smoothness s, tions of state and noise smoothness observers are coupled.
under the practical range of noise smoothness (0<s<1) Sincethisheavilycomplicatesthestabilityproofofthejoint
and sampling time (dt<s). estimator, we leave it for future research.
Proof. Considerallthesmoothnessvaluesofswithzerofree VII. WORKINGEXAMPLE
energy gradients (∂F| =0). Substituting Equation 11 in
∂s s=so This section aims to provide a working example in sim-
10andusing ∂ ∂ F s | s=so =0yieldstheconditionsatisfiedbyall ulation to show the capabilities of our observer design. We
maximum and minimum points: use simulation data at different s levels to show that DEMs
1 21(n+m) can accurately estimate x˜ and s.
(ε˜TΠ˜ ε˜)| = −s (12)
2
s s=so
s o
o
A. Simulation settings
where we use the shorthand Π˜ = ∂Π˜ . Since 0<s<1, we (cid:20) 0.0484 0.7535 (cid:21)
s ∂s A random system with A= , B=
have from Equation 12 that: −0.7617 −0.2187
 
0.2265 −0.4786
(ε˜TΠ˜ s ε˜)| s=so >0. (13) (cid:20) 0.3604 (cid:21)
, and C =


0.4066 −0.2641
 was used to
0.0776  0.3871 0.3817 
Theprooffortheexistenceofauniquemaximumiscomplete
if we prove that
∂2F|
<0, for all s satisfying Equation
−0.1630 −0.9290
∂s2 s=so o generate the synthetic data for a total time of T = 32s
13. The curvature of F at s=s is calculated from Equation
o with increments dt = 0.1s, and a Gaussian bump input
10 using Equation 11 as: v = e−0.25(t−12)2 . The colored noise was generated using
1(cid:16) 1 (cid:17) Πw =e6I and Πz =e6I . This simulation setting will be
F | =− (ε˜TΠ˜ ε˜)| +42(n+m) +1 (14) 2 4
ss s=so 2 ss s=so s2 used throughout the paper, unless mentioned otherwise. We
o
Fig. 1: The maximization of F successfully estimates s for 8
simulationswithdifferents .Thecoloredsolidlinesrepresentthe
real
onlineestimationofs,whereasthedottedlinesrepresents .The
real Fig.3:Thesumofsquarederror(SSE)instateestimationofDEM
estimation starts from ηs=0.001 at timet=0 for all simulations
deteriorateswhenthenoisesmoothnesssusedisdifferentfromthe
and converges close to s with a bias, within a few samples.
real real noise smoothness s . The solid and dotted lines denote the
real
SSE of DEM and KF for different simulated s. The SSE for DEM
takes a minimum when s≈s . For lower s (0.1 for example),
real
generate eight such time series data using different levels of KF outperforms DEM if s is not close to s , emphasizing the
real
noise smoothness s, ranging from 0.1 to 0.8 and use it for importance of an online noise smoothness observer.
the analysis in this section.
Through rigorous simulations, we show that our observer
provides competitive performance during high colored noise
cases.
A. Embedding order of states
In this section, we use rigorous simulations to show that
our observer design can enable state estimation under a
wide range of noises – at different embedding orders and
smoothness levels. We manipulate on the dimension and
component values of the S matrix in Equation 4 through
different p and s values, under the same simulation setup
described in Section VII-A with dt =0.05s. The size of S
Fig. 2: Free energy vs s plot for 8 different simulations (with 8
matrix increases with increasing p, whereas the components
different real s values) from Figure 1 at t=5s. All 8 free energy
inside it increases with increasing s. Figure 4 shows the
curvesshowaclearmaximumaroundtherealsvalues.Thisshows
the effectiveness of our noise smoothness observer. resultsofstateestimationusing150experiments(5randomly
generated noises each for five s values and six p values).
Theestimationerrordecreaseswithincreasing pfordifferent
B. Test example
noise smoothness values, highlighting the importance of us-
Figure 1 shows the results of our noise smoothness es- ing higher order generalized coordination during estimation.
timator for all eight simulations. All simulations start with Thisshowstheapplicabilityofourobserverforawiderange
thepriorηs=0.001andquicklystabilisesaroundthecorrect
of noise smoothness, embedding orders and noises.
smoothnessvalue(s indashedblack),showingthesuccess
real
of our estimator for a range of noise smoothness values.
Figure 2 shows the free energy vs s curve at t =5s for all
eight simulations. The clear peaks of the free energy curve
around the correct noise smoothness value (s ) shows that
real
free energy could be used as the objective function for noise
estimation for the operational ranges of s. The importance
of estimating the correct s is shown in Figure 3, where the
minimum state estimation error is achieved when s is
real
known. Therefore, Figure 3, 1 and 2, together demonstrates
the validity of our observer design in simulation. In the next
section, we will benchmark our observer against the state-
of-the-art observers. Fig. 4: The error in state estimation decreases as the embedding
order of states p increases, for a range of noise smoothness s.
VIII. BENCHMARKING
This shows that our smoothness estimation aids an accurate state
This section aims to benchmark the performance of estimation till an embedding order of p=4 for a wide range of s.
our smoothness estimator for a state estimation problem.
B. Benchmark state observer that models the relation between the PWM values and the
thrust generated by the quadcopter rotors. φ was recorded
In this section, we benchmark our observer against other
using the Optitrack system, and was used for the state
state-of-the-art observers like KF, SA and SMIKF, to show
estimationforatimesequenceofT =15swithdt=0.0083s.
its competitiveness. 50 time series data (10 each for 5
The influence of wind dynamics on the quadrotor states
smoothness values with dt =0.05s) were generated using
(φ and φ˙) is unmodelled in Equation 18. Therefore, the
the simulation setup in Section VII-A and the SSE in state
wind dynamics induces strong colored noise (w) in the
estimation was computed for KF, SA, SMIFK and DEMs.
data [18]. The higher process noise (Πw=e4), and a lower
The SMIKF and SA implementation accommodated an AR
measurement noise (Πz =e10) were used to represent high
model of order 1 and 6 respectively for the noise modelling,
unmodelledwindnoiseandlowOptitracknoiserespectively.
whereas the DEM implementation used an embedding order
Theembeddingorderof p=2andd=2wereusedtocapture
of p=6 for states and d =2 for inputs. Figure 5 shows
the noise color.
the results, clearly indicating the superior performance of
DEMs with minimum error in state estimation for higher
s. DEMs outperforms other observers for a wide range of
s values. However, for low noise color (s=0.1), SA and
SMIKFoutperformsDEMs.Inallcases,DEMsoutperforms
KF in the presence of colored noise.
Fig. 6: DEMs outperforms other benchmarks in state estimation
on the quadrotor flight data where it hovers under the influence of
wind, introducing colored noise into the system. DEMs (in red) is
closer to the ground truth Optitrack measurement (ideal in blue),
when compared to other benchmarks. KF, SA and SMIKF shows
coinciding estimation plots.
Fig. 5: DEMs outperform KF, SA and SMIKF with minimal
estimation error during state estimation under high colored noise
(s > 0.1). When noises are near white (s close to dt), DEMs
outperforms KF, but SA and SMIKF performs better. Solutions of
SA is unstable for higher s.
IX. PROOFOFCONCEPT-QUADROTORFLIGHT
This section aims to provide a proof of concept for our
observer design by employing it for the state estimation of
a real quadrotor flying under wind conditions. We use the
experimental design from [8] to obtain the quadrotor flight
data. The experiment consist of a quadrotor hovering at a Fig.7:Thefreeenergyvssplotfordifferenttimeinstancesduring
the quadrotor flight (data from Figure 6). The curves show a clear
fixed location, under the strong influence of wind generated
maximum, similar to the simulation results from Figure 2. This
by a blower. The linearized quadrotor model relating the
provides an experimental validation for using the gradient ascend
input motor signals to the output roll angle (φ) of the over free energy for smoothness estimation.
quadcopter, without accounting for the wind dynamics is
given by [8]:
Figure 6 shows the superior state estimation capabilities
of DEMs. DEMs (in red) is closer to the ground truth (in
(cid:20) φ φ ˙ ¨ (cid:21) = (cid:20) 0 0 1 0 (cid:21)(cid:20) φ φ˙ (cid:21) + (cid:20) c 0 Bφ − 0 cBφ − 0 cBφ c 0 Bφ (cid:21)(cid:34) p p p w w w m m m 1 2 3 (cid:35) , b S l A ue h ) a w ve he c n oi c n o c m id p in ar g ed sta to te o e th st e i r m b a e ti n o c n hm cu a r r v k e s s . . K F F ig , u S r M e I 7 K s F ho a w nd s
Ixx Ixx Ixx Ixx pwm4
the free energy vs s curve at different time instances t of
(cid:20) (cid:21)
y= (cid:2) 1 0 (cid:3) φ , the quadrotor flight, showing a clear maximum, similar to
φ˙
the simulation results in Figure 2, validating the practical
(18)
application of our estimator.
where pwm is the Pulse Width Modulation signal provided
i
to the ith motor by the controller for stable hovering, I = X. CONCLUSION
xx
3.4·10−3kgm2 is the quadcopter’s moment of inertia around A novel observer (DEMs) for the joint state and noise
thex-axis,andc =1.274·10−3Nmisthethrustcoefficient smoothness estimation of linear systems with colored noise
Bφ
was introduced. Through rigorous simulations, DEMs was [19] O. C¸atal, T. Verbelen, T. Van de Maele, B. Dhoedt, and A. Safron,
shown to outperform the benchmarks like KF, SMIKF and “Robotnavigationashierarchicalactiveinference,”NeuralNetworks,
vol.142,pp.192–204,2021.
SA in state estimation under colored noise with minimum
[20] M. Baltieri and C. L. Buckley, “Pid control as a process of active
estimationerror.Theobserverwasfacevalidatedbyapplying inference with linear generative models,” Entropy, vol. 21, no. 3, p.
itonapracticalroboticsapplication-thestateestimationofa 257,2019.
[21] M. Baltieri and T. Isomura, “Kalman filters as the steady-state so-
quadrotor hovering in unmodelled wind conditions, to show
lution of gradient descent on variational free energy,” arXiv preprint
that DEMs is a competitive observer. The main limitation arXiv:2111.10530,2021.
of this work is the absence of a stability proof for the joint [22] C. L. Buckley, C. S. Kim, S. McGregor, and A. K. Seth, “The free
energy principle for action and perception: A mathematical review,”
state andnoise smoothness observer,which can bethe focus
JournalofMathematicalPsychology,vol.81,pp.55–79,2017.
of future research. The estimator could be extended to solve [23] K.Friston,J.Mattout,N.Trujillo-Barreto,J.Ashburner,andW.Penny,
the general active inference problem for the estimation and “Variationalfreeenergyandthelaplaceapproximation,”Neuroimage,
vol.34,no.1,pp.220–234,2007.
control of nonlinear systems with colored noise.
[24] A.AnilMeeraandM.Wisse,“Dynamicexpectationmaximizational-
gorithmforestimationoflinearsystemswithcolorednoise,”Entropy,
ACKNOWLEDGMENT vol.23,no.10,p.1306,2021.
We would like to thank Peyman Mohajerin Esfahani for APPENDIX
his valuable insights on joint observer design. A. Gradients of ln|Π˜|
REFERENCES The log determinant of generalized precision can be calculated using
Equations4and5as:
[1] J. L. Crassidis and J. L. Junkins, Optimal estimation of dynamic
systems. ChapmanandHall/CRC,2004.
ln|Π˜|=ln|S⊗Πz|+ln|S⊗Πw|
[2] Z.Zhou,J.Wu,Y.Li,C.Fu,andH.Fourati,“Criticalissuesonkalman =ln(|S|m|Πz|(p+1))+ln(|S|n|Πw|(p+1)) (19)
filter with colored and correlated system noises,” Asian Journal of
=(p+1)(ln|Πz|+ln|Πw|)+(n+m)ln|S|.
Control,vol.19,no.6,pp.1905–1919,2017.
[3] A.BrysonandD.Johansen,“Linearfilteringfortime-varyingsystems Thederivativeofln|Π˜|withrespecttosbecomes:
usingmeasurementscontainingcolorednoise,”IEEETransactionson
AutomaticControl,vol.10,no.1,pp.4–10,1965. ∂ln|Π˜| ∂ln|S| ∂2ln|Π˜| ∂2ln|S|
=(n+m) , =(n+m) . (20)
[4] A. Bryson Jr and L. Henrikson, “Estimation using sampled data ∂s ∂s ∂s2 ∂s2
containing sequentially correlated noise.” Journal of Spacecraft and
Rockets,vol.5,no.6,pp.662–665,1968. FromEquation4,|S|= 512s42,resultingin ∂ln|S|=42 and ∂2ln|S|=−42.
6075 ∂s s ∂s2 s2
[5] K. J. Friston, N. Trujillo-Barreto, and J. Daunizeau, “Dem: a varia- ThissimplifiesEquation20to:
tionaltreatmentofdynamicsystems,”Neuroimage,vol.41,no.3,pp.
∂ln|Π˜| 1 ∂2ln|Π˜| 1
849–885,2008. =42(n+m) , =−42(n+m) . (21)
[6] K.Friston,“Thefree-energyprinciple:aunifiedbraintheory?”Nature ∂s s ∂s2 s2
reviewsneuroscience,vol.11,no.2,pp.127–138,2010. B. Numerical analysis on the nature of ε˜TΠ˜ε˜
[7] A. A. Meera and M. Wisse, “Free energy principle based state and
Werecordedthefirsttwogradientsofthepolynomialε˜TΠ˜ε˜ withrespect
inputobserverdesignforlinearsystemswithcolorednoise,”in2020
to s for 20,000 combinations of randomly sampled ε˜ and s such that
AmericanControlConference(ACC). IEEE,2020,pp.5052–5058.
|ε˜|<1 and s∈(0,1]. From the results shown in Figure 8, the data points
[8] F.Bos,A.A.Meera,D.Benders,andM.Wisse,“Freeenergyprinciple
predominantly lie on the first quadrant, suggesting that the function has
forstateandinputestimationofaquadcopterflyinginwind,”arXiv
positive gradients, which is a sign of monotonically increasing function.
preprintarXiv:2109.12052,2021.
Theabsenceofanypointsonthefourthquadrantmotivatestheconclusion:
[9] K. Friston, “The free-energy principle: a rough guide to the brain?”
Trendsincognitivesciences,vol.13,no.7,pp.293–301,2009.
if ε˜TΠ˜ sε˜>0 then ε˜TΠ˜ ssε˜>0. The results remain the same for different
normlengthsofε˜.
[10] K. J. Friston, J. Daunizeau, J. Kilner, and S. J. Kiebel, “Action and
behavior:afree-energyformulation,”Biologicalcybernetics,vol.102,
no.3,pp.227–260,2010.
[11] R. L. Carhart-Harris and K. J. Friston, “The default-mode, ego-
functions and free-energy: a neurobiological account of freudian
ideas,”Brain,vol.133,no.4,pp.1265–1283,2010.
[12] K. Friston, K. Stephan, B. Li, and J. Daunizeau, “Generalised filter-
ing,”MathematicalProblemsinEngineering,vol.2010,2010.
[13] B.Li,J.Daunizeau,K.E.Stephan,W.Penny,D.Hu,andK.Friston,
“Generalised filtering and stochastic dcm for fmri,” neuroimage,
vol.58,no.2,pp.442–457,2011.
[14] J.-J. Xiong and E.-H. Zheng, “Optimal kalman filter for state esti-
mation of a quadrotor uav,” Optik, vol. 126, no. 21, pp. 2862–2868,
2015.
[15] P.Lanillos,C.Meo,C.Pezzato,A.A.Meera,M.Baioumy,W.Ohata,
A. Tschantz, B. Millidge, M. Wisse, C. L. Buckley et al., “Active
inference in robotics and artificial agents: Survey and challenges,”
arXivpreprintarXiv:2112.01871,2021.
[16] G. Oliver, P. Lanillos, and G. Cheng, “Active inference body
perception and action for humanoid robots,” arXiv preprint
arXiv:1906.03022,2019.
[17] M. Baioumy, P. Duckworth, B. Lacerda, and N. Hawes, “Active
inference for integrated state-estimation, control, and learning,” in Fig. 8: The plot demonstrating that the function ε˜TΠ˜ε˜ is mostly
2021 IEEE International Conference on Robotics and Automation monotonically increasing with respect to s in the domain (0,1] for
[18]
(
A
IC
.A
R
.
A
M
).
ee
I
r
E
a
E
an
E
d
,
M
20
.
2
W
1,
is
p
s
p
e
.
,
4
“A
66
b
5
r
–
a
4
in
67
in
1
s
.
piredlearningalgorithmforthe
|ε˜|<1. Moreover, when ε˜TΠ˜ sε˜ >0, ε˜TΠ˜ ssε˜ <0, since there are
nodatapointsonthefourthquadrantasshowninthezoomedplot.
perceptionofaquadrotorinwind,”arXivpreprintarXiv:2109.11971,
2021.

=== INSTRUCTIONS ===

0. PROFESSIONAL TONE REQUIREMENTS:
   - Begin directly with the paper title or content - NO conversational openings
   - Do NOT use phrases like: 'Okay, here's...', 'Here's a summary...',
     'Let me summarize...', 'I'll extract...', or similar conversational language
   - Start immediately with substantive content in formal academic tone
   - Example BAD: 'Okay, here's a summary of the paper...'
   - Example GOOD: 'This paper investigates [topic]...'

1. Start with exact title: "Free Energy Principle for the Noise Smoothness Estimation of Linear Systems with Colored Noise"

2. EXTRACT QUOTES:
   - Extract 10-15 direct quotes from the paper that support key claims
   - QUOTE EXTRACTION AND FORMATTING:
     * Extract quotes VERBATIM from the paper text - do NOT modify or "correct" them
     * Extract quotes exactly as they appear in the source text
     * Preserve all aspects of the quote exactly as written, including spacing
     * Use proper quotation marks: "quote text" (double quotes)
     * CRITICAL: Only extract quotes that actually appear in the paper text
     * Do NOT generate, invent, or "fix" quotes - extract them exactly as written
   - QUOTE FORMATTING STANDARD:
     * Attribution format: 'The authors state: "quote text"' OR 'According to the paper: "quote text"'
     * Vary attribution phrases to avoid repetition (use: 'The authors state', 'They note',
       'The paper argues', 'According to the research', 'The study demonstrates')
     * Include section context when available: 'In the Introduction, the authors state: "quote text"'
     * Ensure proper spacing around quotes and punctuation
   - Search the full paper text to find relevant quotes
   - Each quote must be verbatim from the paper text (with spacing normalized)

3. IDENTIFY CLAIMS:
   - Identify the main claims and arguments made by the authors
   - State each claim clearly and support it with quotes from the paper
   - Distinguish between primary claims and supporting arguments

4. SUMMARIZE KEY FINDINGS:
   - Summarize the key findings with specific numbers, metrics, and results
   - Include quantitative data: percentages, statistics, measurements
   - Extract numerical results from the results section
   - Present findings with supporting evidence from the paper

5. DESCRIBE METHODS:
   - Describe the methodology, experimental setup, and approach used
   - Include details about: algorithms, procedures, experimental design
   - Explain how the research was conducted
   - Extract specific methodological details from the methods section

6. PRESENT RESULTS:
   - Present the results with quantitative data and statistical significance
   - Include specific numbers, tables, figures mentioned in the paper
   - Extract results from the results section with exact values
   - Support results with quotes or data from the paper

7. NO REPETITION - CRITICAL REQUIREMENT (ENHANCED):
   - CRITICAL: Before writing EACH sentence, check: 'Have I already said this exact idea?'
   - If you've already stated an idea, DO NOT repeat it - move to the next unique point
   - Each sentence must be COMPLETELY UNIQUE - no duplicate ideas, even with different words
   - Each claim appears EXACTLY ONCE - if you've stated it, move to the next unique point
   - Each paragraph must be COMPLETELY UNIQUE - no duplicate paragraphs
   - Do NOT repeat the same sentence, even with slight variations or word changes
   - Do NOT repeat paragraphs or sections - each section must have unique content
   - Each claim should appear only ONCE in the entire summary
   - Vary attribution phrases: use 'The authors state', 'They note', 'The paper argues',
     'According to the research', 'The study demonstrates' - do NOT repeat the same phrase
   - If you find yourself writing similar content, STOP immediately and write something completely different
   - Before each sentence, ask: 'Have I already said this?' If yes, write something new
   - Vary your language: use synonyms, different sentence structures, different perspectives
   - REPETITION CHECKLIST: After writing each sentence, verify it's not a duplicate of any previous sentence

   EXAMPLES OF WHAT NOT TO DO:
   ❌ BAD: 'The authors state: "X". The authors state: "Y". The authors state: "Z".'
   ✅ GOOD: 'The authors state: "X". They further note: "Y". The paper argues: "Z".'

   ❌ BAD: Repeating the same claim 3+ times with slight variations
   ✅ GOOD: State each claim once, then move to the next unique point

8. STRUCTURE:
   - Use markdown headers: ### Overview, ### Methodology, ### Results, ### Discussion
   - Target length: 1000-1500 words
   - Ensure all requested elements (quotes, claims, findings, methods, results) are included
