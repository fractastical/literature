=== IMPORTANT: ISOLATE THIS PAPER ===
You are summarizing ONLY the paper below. Do NOT reference or use content from any other papers.
Do NOT mix information from different papers. Only use information from THIS specific paper.

Paper Title: Active inference as a unified model of collision avoidance behavior in human drivers
Citation Key: schumann2025active
Authors: Julian F. Schumann, Johan Engström, Leif Johnson

REMEMBER: Extract quotes, claims, and findings ONLY from the paper text provided below.

Year: 2025

Abstract: Collisionavoidance–involvingarapidthreatdetectionandquickexecutionoftheappropriateevasive
maneuver–isacriticalaspectofdriving.However,existingmodelsofhumancollisionavoidancebehav-
ior are fragmented, focusing on specific scenarios or only describing certain aspects of the avoidance
behavior,suchasresponsetimes.Thispaperaddressesthesegapsbyproposinganovelcomputational
cognitivemodelofhumancollisionavoidancebehaviorbasedonactiveinference.Activeinferencepro-
vides a unified approach to modeling hum...

Key Terms: tudelft, human, avoidance, unified, behavior, inference, active, collision, model, waymo

=== FULL PAPER TEXT ===

5202
nuJ
11
]OR.sc[
4v51220.6052:viXra
Active inference as a unified model of collision avoidance
behavior in human drivers
Julian F. Schumann1, Johan Engstro¨m2*, Leif Johnson2, Matthew O’Kelly2,
Joao Messias2, Jens Kober1, Arkady Zgonnikov1
1Department of Cognitive Robotics, Delft University of Technology, Netherlands.
2Waymo LLC, Mountain View, CA, USA.
Contributing authors: j.f.schumann@tudelft.nl; jengstrom@waymo.com; leif@waymo.com;
mokelly@waymo.com; messiasj@waymo.com; j.kober@tudelft.nl; a.zgonnikov@tudelft.nl;
Abstract
Collisionavoidance–involvingarapidthreatdetectionandquickexecutionoftheappropriateevasive
maneuver–isacriticalaspectofdriving.However,existingmodelsofhumancollisionavoidancebehav-
ior are fragmented, focusing on specific scenarios or only describing certain aspects of the avoidance
behavior,suchasresponsetimes.Thispaperaddressesthesegapsbyproposinganovelcomputational
cognitivemodelofhumancollisionavoidancebehaviorbasedonactiveinference.Activeinferencepro-
vides a unified approach to modeling human behavior: the minimization of free energy. Building on
prioractiveinferencework,ourmodelincorporatesestablishedcognitivemechanismssuchasevidence
accumulation to simulate human responses in two distinct collision avoidance scenarios: front-to-rear
lead vehicle braking and lateral incursion by an oncoming vehicle. We demonstrate that our model
explains a wide range of previous empirical findings on human collision avoidance behavior. Specif-
ically, the model closely reproduces both aggregate results from meta-analyses previously reported
in the literature and detailed, scenario-specific effects observed in a recent driving simulator study,
including response timing, maneuver selection, and execution. Our results highlight the potential of
active inference as a unified framework for understanding and modeling human behavior in complex
real-life driving tasks.
Collision avoidance is a critical skill for human avoid collisions in traffic can provide insights into
drivers. It involves the rapid detection of threats high-stakes, split-second decision making which
(such as a vehicle ahead suddenly braking) and has substantial implications for traffic safety.
deciding on an appropriate evasive maneuver (for Behavior models play a key role both in
instance, braking or swerving). These maneuvers understanding the mechanisms of human colli-
are complex, requiring not only precise execution sion avoidance and in improving traffic safety.
but also continuous adjustments as the situation These models are applied in diverse contexts,
evolves. Furthermore, drivers need to account for suchascollisionriskestimation[1],understanding
the uncertainty in the future behavior of other effectsofdriverdistraction[2],modelingtake-over
road users: for example, will an oncoming vehicle behavior [3], representing human agents in simu-
encroaching into my lane continue across or move lated test environments [4], and providing behav-
back to its own lane? Understanding how humans ioral benchmarks for autonomous vehicles [5, 6].
1
Expected
Free 11 iiii
Energy
High
I
t
Low iliac.io ii Ffii i. i fi iiii iiii iiii
iiii iii.EE I
iiii
ii
EIDFEEfiiff
ie
Fig. 1:Anillustrationofthekeyprinciplesofouractiveinferencemodelintheopposite-directionlateral
incursion scenario. Upper left panel: The modeled agent (at the bottom, facing forward) is continuously
generating beliefs (represented by the arrows) about how the current driving situation will play out and
what future observations it will make as a consequence of its own actions and the actions of the other
vehicle.In”normal”,non-conflictsituations,thesituationtypicallyplaysoutasexpected.Theagentthus
initially believes with high certainty that both itself and the oncoming vehicle will remain in their lanes
and pass each other safely. This yields low expected free energy (EFE; green arrows) since the agent’s
expected (and thus preferred) observations (e.g., making progress, avoid collisions) are aligned with the
actualobservations.Upperrightpanel:Whentheoncomingvehiclesuddenlyencroachesintothedriver’s
lane, the EFE increases rapidly (as indicated by the red arrows) because this new situation is likely to
result in an observed collision in the future, which is strongly disfavored by the agent. In this situation,
the agent’s belief about the oncoming vehicle’s future trajectory also becomes more uncertain, because
the other vehicle can no longer be trusted to follow established traffic norms. The agent thus needs to
imagine a better future with lower EFE – in this case, a scenario where it avoids collision by swerving
left (lower left panel) and take action to make that better future come true (lower right panel).
Besides immediate practical applications, mod- based on the explicit modeling of cognitive mech-
eling human collision avoidance behavior is an anisms underlying response timing and evasive
interesting subject of study in its own right. maneuvering. However, they are typically frag-
Being a highly complex and dynamic task with mented, focusing either on specific scenario types
extremely high stakes, collision avoidance pro- (e.g., front-to-rear conflicts [10–12] or merg-
vides a unique testbed for theories and models ing [13]), specific explanatory factors (such as
of cognition previously not validated in the real off-road glances [1, 14] or cognitive load [2]), or
world [7–9]. only reproduce certain aspects of human behav-
Mostexistingcomputationalmodelsofhuman ior (such as response times [3, 6, 10, 11, 15] or
collision avoidance are mechanistic, that is, are
2
theextentofsteering[16]).Altogether,thesemod- such as looming perception [34, 35] and evidence
els cover a wide range of scenarios and diverse accumulation [36–39]. We evaluated our model
aspects of collision avoidance behavior. Yet, each against a range of previously reported empiri-
one of these mechanistic models on its own is cal findings in two paradigmatic collision avoid-
highlyspecific:theyarenotdesignedtogeneralize ance scenarios: the front-to-rear scenario, where
to multiple scenarios or describe multiple aspects a driver needs to respond to a suddenly braking
of human behavior. vehicle in front, and the opposite-direction lat-
Recently, machine learning models based on eralincursionscenario,whereanoncomingvehicle
large datasets of human driving have demon- suddenlycutsacrossthedriver’spath.Testingthe
strated the ability to generalize across a wide model in two markedly different scenarios allowed
range of traffic scenarios [4, 17–21]. Because such us to investigate the potential of active inference
modelstypicallygeneratefullmotiontrajectories, as a unified framework for generalizable modeling
they also have the potential to represent multi- of human collision avoidance behavior.
pleaspectsofcollisionavoidancebehaviorandnot
just a single metric of interest. However, a key Results
challenge is that safety-critical behavior such as
collision avoidance is often under-represented in In this work, we use active inference as an overar-
the datasets used for training [22], which makes ching framework to guide the modeling. The key
it hard to achieve representative human-like colli- premiseofactiveinferenceisthatallbehaviorand
sion avoidance behavior solely based on learning cognition can be understood based on the single
from data [23]. principleofminimizingfreeenergy.Anagentmini-
Thus, there is currently a lack of models that mizingfreeenergycanbeconceptuallyunderstood
can capture the key aspects of human collision as the agent sensing, and acting upon, the world
avoidance behavior (response selection, timing, insuchawayastominimizeitssurpriseovertime.
andexecution)allatthesametimeandacrossdif- Intheactiveinferenceframework,thisamountsto
ferent scenarios. This limits both practical appli- seekingoutobservationsthatareexpected (unsur-
cations (due to the need to develop a new model prising) and preferred given the type of creature
for every new scenario) and fundamental under- the agent is, reflecting its adaptation to its par-
standing of cognitive mechanisms underlying the ticular environment or niche (e.g., a fish expects
behavior of humans in safety-critical situations in and prefers the sensation of being immersed in
traffic(duetothelackofaunifiedexplanationfor water).Agentscapableofplanningintothefuture
multiple aspects of behavior). and modeling the consequences of their actions
To address this gap, here we present a uni- (suchashumancardrivers),selectplansthatmin-
fied collision avoidance model based on active imize the expected surprise, or more generally the
inference. Originating in computational neuro- expected free energy (EFE) [24].
science, active inference is a versatile general Our model implements these principles in the
framework for understanding and modeling sen- collisionavoidancecontext(Figure1).Specifically,
tient behavior in living systems [24–26] that has the modeled agent repeatedly evaluates possible
beenpreviouslyusedtomodelhumanbehaviorin futures under its current policy (i.e., a sequence
diversecontexts[27–31],includingthemodelingof of planned actions) – including interactions with
human driver behavior such as car following [32], other road users – in terms of their EFE. The
responses to driving automation failures [15], and driver then selects policies that minimize EFE by
managinguncertaintyaroundocclusionsandnon- realizing observations that align with the driver’s
driving-related tasks [33]. Building on the model preferences such as avoiding collisions (yielding
of Engstr¨om et al. [33], here we propose an active pragmatic value)whileobtainingnewinformation
inference-based model to capture a spectrum to reduce uncertainty about the environment’s
of human behaviors in collision avoidance. Our future (yielding epistemic value) [24, 33].
model incorporates several well-known cognitive Fundamentally, agents cannot have perfect
mechanisms to represent the dynamics of human knowledge of the mechanisms underlying the
decision making in response to sudden stimuli, surrounding world (the generative process), but
3
a Observe to update belief b Predict other norm-compliant agent
a
I tiitii iiiiittI
ii iiitf
iffiIIi I i.IT itI iisi
_s
f Update world state c Accumulate surprise E
in favor of full re-plan
e.i Selection (policy extension) d.i Sampling (policy extension) E<1
F
I IIII F F iFii ii.if FFiiF i i i i i I II I . . I I E E i O0
i I
n
E
e.ii Selection (full policy) d.ii Sampling (full policy)
E≥1 t
F Ii .iitI iiiiiIIIi Femi
ÉÉ
FiIIo iss o
Fig. 2: Main functional components of our active inference collision avoidance model.At each time step,
the ego agent observes the world state, updates its belief about the world (a), and makes probabilistic
predictionsabouttheactionsoftheotheragent(wherefuturetrajectoriesthatadheretotrafficnormsare
prioritized) (b). At every time step, the agent accumulates evidence (as measured by surprise associated
with the current state of the world) on the unsuitability of the current policy (c). If the accumulated
evidence reaches a threshold, the agent re-plans the entire policy, selecting the one that minimizes the
expected free energy (EFE) (d.ii and e.ii). Otherwise, it continues using its current policy in an extend
form – i.e., only sampling and then selecting the policy’s last time step (d.i and e.i). The first action in
the new or extended policy is then applied to the environment (f).
instead rely on an internal, not necessarily veridi- the readily available perceptual information [35]:
cal, representation of their beliefs about the envi- the object’s visual angle φ subtended at the
ronment, the generative model [24]. Importantly, driver’sretina,anditsderivative,theangularrate
an (ego) agent’s generative model is probabilistic, φ˙, commonly referred to as looming [34, 40? ].
with the uncertainty about the state of the world The model then infers back the kinematic state
being represented by a set of sample particles. from those observations, where – with increasing
Our model implements these general principles distances – equal variations in φ lead to increas-
in a time-discrete, sequential process (Figure 2) inglylargervariationsintheinferreddistanceand
which incorporates a number of key perceptual, therefore increasing uncertainty about the kine-
cognitive, and motor mechanisms. matic state of the other agent. Additionally, the
Looming-based perception. First, the agent’s perception accuracy is limited: it cannot
agent observes the world and updates its belief perceive looming with absolute values below a
(Figure2a),combiningtheseobservationswiththe threshold φ˙ [41, 42]. Due to this threshold, the
0
expectations derived from the generative model agent is unable to detect small relative veloci-
propagating its previous belief forward in time. tiesatlongdistances;ourmodelthusincorporates
Themodelassumesthattheagentcannotdirectly this looming threshold as one possible mechanism
perceive kinematic states of surrounding objects behind delays in recognizing events like abrupt
(e.g., positions and velocities), but instead uses braking of the other vehicle.
4
Behavior prediction via norm- own policy, evaluating its current suitability by
conditioned particle filter. After perceiving calculating the residual information [47] of the
the environment, the ego agent predicts the other pragmatic value, which can be seen as a mea-
vehicle’sbehavior(Figure2b).Forthis,ourmodel sureofsurprise.Thissurprisesignal–the(scaled)
uses a sample-based approach [33, 43] (i.e., based negative pragmatic value associated with the cur-
on a particle filter). Specifically, the samples rently selected policy – essentially indicates how
representing the agent’s updated belief about the unsuitable the current policy is given the model’s
other vehicle are propagated forward by the gen- preferred observations and how the situation is
erative model (in our case using a bicycle model expected to develop. The model assumes that the
with additive Gaussian noise). In this way, the driver continuously accumulates this surprise sig-
model generates multiple distinct kinematically nal as evidence in favor of full policy re-plan
plausible future trajectories of the other vehicle, (Figure2c).Oneachtimestep,iftheaccumulated
including the ones that could potentially lead to evidence has not reached a predefined threshold,
a collision. This enables the model to anticipate the agent considers it sufficient to continue with
rare, long-tail behaviors of the other vehicle and the current policy, and extends this policy one
respond to them appropriately during collision time step into the future (Figure 2d.i and e.i).
avoidance, but yields overly pessimistic predic- However, if enough evidence in favor of current
tions in non-conflict situations. For instance, policy being unsuitable is accumulated, a set of
widely dispersed predictions could lead the agent completely new policies is sampled and a new full
to anticipate vehicles encroaching into its lane, policy is selected (Figure 2d.ii and e.ii). The first
incentivizing unnecessary evasive actions. By action from either the extended or the new full
contrast, human drivers typically assume that policy is then applied to update the environment
other vehicles follow traffic rules [44, 45] and for the next time step (Figure 2f).
other societal norms for driving [46]. To capture Constrained policy sampling. When
this, our model assumes that the ego agent uses proposingnewcandidatepolicies,eitherforexten-
a norm-conditioned particle filter for behavior sion(Figure2d.i)orfullre-plan(Figure2d.ii),the
prediction, by assigning each possible predicted model uses the cross-entropy method [48]. With
trajectory a weight based on its adherence to this method, candidate actions are iteratively
traffic norms. This allows the model to priori- resampled, increasingly focusing on the most
tize norm-compliant behaviors when predicting promising areas of the action space. To represent
the actions of the other vehicle. In this way, the humans’ bounded capacity for planning under
model’s belief about the future trajectory of the time pressure [13, 49–52], we limit the number of
other vehicle is initially constrained by the social evaluated policies in this process. Importantly,
norm that other vehicles typically remain within the sampled acceleration values are constrained
their lane unless explicitly indicating otherwise. to reflect that humans operate the gas and brake
However, when another vehicle unexpectedly pedals with one foot. These constraints include
initiates a conflict (for example an incursion limiting applied jerks (as humans cannot press
towards the ego vehicle’s lane), the model will or release pedals instantaneously) and enforcing
eventually take predicted norm-violating trajec- a constant holding time of 0.2s at acceleration
tories seriously. The reason for this is that the a ≲ 0ms−2 during transitions in both direc-
0
weights assigned to each predicted particle in the tions between acceleration and deceleration (as
set are divided by their sum (i.e., sum to 1 across humans cannot move their foot between pedals
all predictions). Thus, in cases where the over- instantaneously).
whelming majority of the predicted trajectories Policy selection via expected free energy
violate the norms, the model still considers these minimization. Among the sampled candidate
trajectories rather than disregarding all of them policies, the model aims to find the policy that
as non-norm-compliant. minimizes expected free energy (EFE) – the
Re-planning full policy based on accu- cornerstone of the active inference framework
mulating surprise. In the next step, based on (Figure2e.iande.ii).Inourmodel,thepragmatic
the set of previously predicted possible trajecto-
ries of the other vehicle, the agent considers its
5
value part of the EFE is maximized by 1) main- the vehicles. After a short time of driving at con-
taining a desired longitudinal velocity, 2) staying stant speed, the other vehicle starts braking with
within the current lane (avoiding unnecessary or a high constant deceleration until coming to a
unsafe lane changes) and on the road, 3) min- stop. Depending on the initial kinematics of the
imizing control inputs (avoid harsh braking or vehicles, the ego agent can avoid collision either
steering),4)preventingcollisionsoratleastreduc- solelybybraking(Figure3a)orcombinedbraking
ingtheirseverity(measuredbytherelativeimpact and swerving (Figure 3b). The model sometimes
velocity), and 5) avoiding situations where colli- avoided a collision by swerving only (i.e., with-
sions may become inevitable (such as following a outbraking).However,sinceexistingresultsinthe
vehicle too closely without sufficient stopping dis- literature on front-to-rear scenarios typically only
tance, assuming realistic reaction times). Finally, report on braking response performance, we only
maximizing the epistemic value encourages 6) compared our models brake response times (i.e.,
policies resulting in a large variety of reliable for the analysis of those, steering only responses
observations[33].However,inthepresentcollision are not considered).
avoidance setting, behavior is mainly expected to At lower speeds and larger time gaps, the
be driven by pragmatic, rather than epistemic, model typically avoids collisions by braking only.
value since there is not much the driver can do to In a representative simulation (Figure 3a), after
reduce uncertainty, especially given that we here theleadingagentstartedbrakingatt=0.8s(first
assume that the other vehicle is non-reactive to dashed line), it took the model 0.6s to perceive
the ego agent’s actions. this (see the ego agent’s belief in the acceleration
plot).Atthatpoint(t=1.4s,seconddashedline),
Model evaluation themodelrecognizedtheimminentconflictresult-
ing from this change in perceived behavior of the
We evaluated the model against human data in
othervehicle,ascanbeseenbytherapiddecrease
two scenarios. In the front-to-rear scenario, we
(increaseinnegativevalue)inthecollisionpartof
compared the model to the results of a meta-
thepragmaticvalue.Thisleadstoacorresponding
analysis of brake response times [53] in experi-
increase in the rate of accumulation of the evi-
mental driving simulator and field studies (e.g.,
denceforare-plan(i.e.,surprise).However,itstill
Brookhuis et al. [54] and Lee et al. [55]), and
took further 0.6s until the accumulated evidence
an analysis of deceleration magnitudes based on
E reached the threshold, delaying the first notice-
two naturalistic driving datasets captured across
able agent reaction to t = 2s (third dashed line),
US and Africa reported in [14]. In the opposite-
where the agent started to execute a new pol-
directionlateralincursion scenario,themodelwas
icy – emergency braking. This policy was selected
comparedtohumandatafromadrivingsimulator
because it allowed the agent to drastically reduce
study conducted in UK [56] which was conducted
itsEFEviareachingfuturestateswithhighprag-
in parallel to the present work. Thus, by contrast
matic value, in particular thanks to low collision
to the model evaluation for the front-to-rear sce-
probability. This policy was preferred over the
nario, which was based on aggregated data, we
alternative policy of braking and steering into the
werehereabletorunourmodelonnearlyidentical
adjacent lane because the pragmatic value associ-
scenariosforwhichthehumandatawascollected,
ated with lane changing was more negative than
allowing for more detailed comparisons. Impor-
that associated with lower velocity, as the desired
tantly,thesamemodelparametervalueswereused
(corresponding to the initial) velocity is compar-
for both scenarios.
atively low. However, even under this policy, at
t = 2s, the acceleration has still not changed,
Front-to-rear scenario
due to the pedal constraints. Consequently, the
In the front-to-rear scenario, the ego vehicle trails first deceleration of the model can be observed at
the other vehicle which is driving in the same t=2.2s,resultinginatotalresponsetimeof1.4s.
lane; both vehicles have the same initial velocity Smaller time gaps and higher initial veloci-
which was systematically varied in our simula- tiescanmake itkinematicallyimpossibletoavoid
tions together with the initial time gap between collision by braking only. In such situations, the
model typically opts to steer and brake at the
6
a Example - Brake only b Example - Brake & Steer
Xego
f
t=2.0s t=1.4s
Egovehicle Othervehicle Ego’sbeliefaboutOther
Lateralpos Velocity Controleffort Collision
eulav
.garP
garpGλ
1
10.0
−
−
0 2 4
1
0
Timet[s]
yticoleV
.leccA
elgnareetS
]1
−sm[
v
]2
−sm[a
]dar[
δ
EecnedivE
52
51
0
5
0
5-
50.0
0
50.0-
0 2 4
Timet[s]
0 1 2 3 4
1
5.0
0
Timegap[s]
)ylnoekarB(P
c
0 1 2 3 4
3
2
1
0
Timegap[s]
]s[emitesnopseR
d
0.0 0.5 1.0 1.5
0
2-
4-
6-
8-
InvTTC[s− 1]
]2
−sm[anim
e Data
ylnoekarB reetS&ekarB noisilloC
25
10
]s/m[
ogev
Fig. 3: Evaluation of the model in the front-to-rear scenario. a) In a scenario where initial pre-conflict
kinematics are such that collision can be avoided by braking (initial vehicle velocities v = 15ms−1, a
0
bumper-to-bumpertimegapof1.5s),themodeltypicallyproducesbraking-onlybehavior.Thesub-panels
visualize the top-down view of the scenario, the time dynamics of both vehicles’ velocity v, acceleration
a, steering angle δ and (for the ego vehicle) the components of the pragmatic value G (scaled with
prag
the evidence accumulation gain λ) that underlie the accumulated evidence towards a full policy re-plan.
b) In a scenario where braking on its own might not be sufficient to avoid collision (v = 25ms−1, 1s
0
time gap), the model selects a policy that involves both braking and steering towards the opposite lane
(see the model’s selected policies in the topmost plots). c) The likelihood of the ego vehicle deciding to
brakeandstaybehindtheleadingothervehicle(withoutanysteering)asafunctionoftimegap,withthe
four lines representing four different velocities (ranging from 10ms−1 to 25ms−1; the lines representing
20 m/s and 25 m/s are overlapping at zero brake only probability). This data include those samples
where the agent is only steering. d) The relationship between the time gap and the brake response time
of the ego agent in 280 model simulations (see Supplementary Materials 1.3.1). Regression line based
on a meta-analysis of human brake response times [53] is shown for reference. e) The relationship of
the inverse time-to-collision (TTC) at brake onset (defined as
max{0,vego−vOV}
) and the lowest observed
∆x
7
deceleration.Regressionlinebasedonthehumandecelerationmagnitudedata[14]isshownforreference.
Video replays of the example simulations are available in the supplementary information.
same time (for instance, Figure 3b). Here, due thefewrelatedstudiesthatexist,butthesedonot
to the smaller initial distance, the model’s per- providesufficientlydetailedanalysesforrigorously
ception delay was noticeably shorter (being only evaluating our model’s evasive maneuvering deci-
about0.2s,withthemodeledagentperceivingthe sions.Thesestudiesgenerallysuggestthatevasive
brakingatt=1s,thefirstdashedline).However, maneuver decisions, similar to response timing,
due to the more challenging initial kinematics, it depend on the scenario kinematics (see [56] for a
wasmoredifficultforthemodeltoavoidcollision, review). Avoiding collisions is generally kinemat-
despitetheshorterperceptiondelay.Inparticular, ically more feasible by braking at lower speeds
themodelswitchedbetweendifferentpoliciesfour and by steering at higher speeds [57] and human
times. Initially, the model recognized the need to drivers tend to swerve into an adjacent lane if
slightly brake and steer around the other vehicle: a kinematically viable escape path exists [58–
already at the time of the first re-plan (t = 1.4s, 60]. In line with these general observations, our
second dashed line) the collision component of model prefers braking at lower velocities and
EFEwassubstantiallyreducedbythechosenpol- favors combined swerving-and-braking or swerv-
icy.Thispolicywasmostlysufficientinimproving ing only responses at higher velocities, regardless
the collision component of the pragmatic value, of the time gap (Figure 3c). At medium veloc-
but as visible in the top panel (planned trajec- ities (15ms−1) the model behavior is sensitive
tory X(cid:102)ego ), the agent intends to stay in between to the gap between the vehicles: the longer the
lanes for an extended period. This led to two time gap, the higher the probability of a brake-
further re-plans (t = 3.2s and t = 3.8s, third only maneuver. This pattern reflects a trade-off
and fourth dashed lines respectively) to adjust between the components of the pragmatic values
the trajectory. However, even having passed the associated with collisions, control effort (harsh-
other vehicle already, the model is not completely nessofbrakingandsteering),andlateralposition.
successful, with a noticeable lateral position com- This dependence of swerving choice on time gap
ponent remaining in the pragmatic value. As the at intermediate speeds has, to our knowledge, not
optimalsolutionofdrivinginthecenterofthecur- been empirically tested and represents an inter-
rent lane on a free road should have maximized esting quantitative prediction from our model.
the pragmatic value, this remaining lateral error In more urgent scenarios (short time gaps), the
is likely the result of the cross-entropy method model prefers swerving due to the low prag-
notidentifyingtheoptimalpolicy.Thisrepresents matic value of harsh braking. Conversely, in less
a bounded planning capacity which, as discussed urgentscenarios(largertimegaps),themodelopts
above, is also present in humans [13, 49–52] and for braking since moderate braking avoids colli-
thus an intended feature of our model. sion without incurring the significant reduction of
By systematically varying the initial kinemat- pragmaticvalueduetoleavingthelane(whilethe
icsofthevehicles,weassessedthemodelbehavior deviationfromthedesiredvelocityisstilltolerable
across a spectrum of front-to-rear scenarios. Due at those medium speeds).
to the stochasticity of the model (foremost in Regarding brake response times, empirical
behaviorpredictionandpolicysampling),foreach studies have consistently found a strong depen-
ofthe28setsofinitialconditionsweranthesimu- dence on scenario kinematics [2, 3, 6, 14, 53, 61,
lationofthefront-to-rearscenario10times.Based 62]. Specifically, more kinematically urgent sce-
onthesesimulations,weanalyzedthemodel’scho- narios (e.g., with a small initial time gap and/or
sen evasive maneuver, response time, and deceler- hardleadvehiclebraking)leadtoshorterresponse
ation magnitude and compared it to human data times while less urgent scenarios lead to longer
reported in the driver behavior literature. response times, with approximately linear rela-
Figure3cshowstheprobabilitythatthemodel tionship between measures of urgency (e.g., the
will brake only (without steering) for different initial time gap) and mean response time [6, 53].
velocities and time gaps. Existing studies on how Our model produced behavior that is remark-
human evasive maneuver choice depends on sce- ably consistent with these findings (Figure 3d).
nario kinematics in front-to-rear scenarios are Interestingly, compared to the evasive maneuver
limited. Thus, we compared our model results to decisions, velocities do not seem to significantly
influence brake response times, nor does the final
8
chosen behavior. Furthermore, model response incursion only partially entering the participant’s
times remain consistent (approx. 1s) over the lane, making it possible to find an escape path
range of short time gaps (0.5s to 1.5s). This last by steering slightly toward the shoulder (the orig-
result could be a consequence of the evidence inal study used left-hand traffic, so we are here
accumulation mechanism requiring certain min- avoiding directional terms to prevent confusion).
imum time to trigger a re-plan even at a very Were-implementedareversed(i.e.,right-hand
highrateofincomingevidence.Relatedly,thelack traffic)versionsofthesescenariosinoursimulator
of fast enough responses at short time gaps is a setup (see Supplementary Materials Figure A1),
likely explanation for the collisions observed in enabling a direct comparison between human and
the model (only at the shortest time gap of 0.5s). model behavior in an nearly identical scenar-
However, because the data reported in the liter- ios. An example of our model implemented in
ature does not cover such short time gaps, this the steep scenario is shown in (Figure 4a) and
model prediction remains to be tested in future (Figure4b)showsanexampleofthemediumsce-
studies. nario (Figure 4b). When looking at the example
While response selection and its timing are simulations (Figure 4a and b), we can observe
comprehensively characterized by the choice of again that the model needs multiple re-plans
evasive maneuver and response times, response before deciding on the final avoidance maneuver.
execution is a dynamic process and can be char- Comparedtothefront-to-rearscenario,wherethis
acterized by a variety of metrics. Here we focus is likely caused by the model’s bounded planning
on deceleration magnitude, which has been previ- capacity, here this is due to the high uncertainty
ously shown to depend on the kinematics of the whenpredictingthepositionsoftheothervehicles,
front-to-rearscenario:humandriversbrakeharder which can be seen in the depictions on the top.
in more kinematically urgent scenarios [14]. Our In Figure 4a (steep incursion), a first re-planning
model captured this phenomenon: the magnitude is triggered at 4.2s (first dashed line) but this
of its braking increased with the inverse time-to- doesnotsignificantlyreducethenegativecollision
collisionatbrakeonset(Figure3e).Thisbehavior component of the pragmatic value. Additionally,
of the model can be explained by the pragmatic the model neither initiates large steering maneu-
valuetrade-offbetweenavoidingacollisiononthe vers nor significant accelerations/decelerations.
one hand and avoiding the effort of hard braking Together, this suggests that the high uncertainty
and losing velocity on the other hand. In other about the other vehicle’s behavior prevents the
words, the model aimed to not brake harder than agentfromfindinganevasivepolicythatisbetter
necessary to avoid collision. (has lower EFE) than the current policy, instead
delaying the decision. The reason for this is that
Opposite-direction lateral incursion due to the wide spread in the belief about possi-
scenario ble future trajectories that the oncoming vehicle
maytake,thereisyetnoevasivepolicywithlower
For evaluating model behavior in the opposite-
EFE than the current non-evasive policy. With
direction lateral incursion scenario, we used
thecollisionriskunresolvedafterthefirstre-plan,
human data from a driving simulator study at
surprise quickly accumulates toward a second re-
the University of Leeds, UK, reported by John-
plan at 4.6s (second dashed line). By this time,
son et al. [56]. In this study, vehicles initially
theagentsarecloser,allowinglessspaceforuncer-
approached each other in opposite lanes when the
tainty to grow and enabling the model to identify
computer controlled vehicle unexpectedly steered
a steering policy that mitigates the collision risk
toward the participant’s lane along a predefined
(after the second re-plan, the collision component
path. The study implemented three kinematic
ofthepragmaticvaluenolongersignificantlycon-
variants differing in incursion ”steepness”: (1) a
tributestosurpriseaccumulation).Thedecisionto
steep incursioncrossinginfrontoftheparticipant
swervetowardtheleftisaresultofboththeother
at a sharp angle and allowing a relatively easy
vehiclehavingcrossedsufficientlyovertotheright
escape by steering toward the opposite lane; (2)
side to leave a gap for swerving, and the model’s
a medium incursion at a shallower angle, head-
stronger preference for moving into the opposite
ing directly toward the participant; (3) a shallow
9
a Example - Steep incursion b Example - Medium incursion
Xego
f
t=4.6s t=5.0s
Egovehicle Othervehicle Ego’sbeliefaboutOther
Lateralpos Velocity Controleffort Collision
eulav
.garP
garpGλ
1
10.0
−
−
0 2 4
1
0
Timet[s]
yticoleV
.leccA
elgnareetS
]1
−sm[
v
]2
−sm[a
]dar[
δ
EecnedivE
02
01
0
5
0
5-
50.0
0
50.0-
0 2 4
Timet[s]
Steep Medium Shallow
1
5.0
0
Incursiontype
ytilibaborP
c
Steep Medium Shallow
5
4
3
2
1
0
Incursiontype
]s[emitesnopseR
d
Steerleft
Collision
Steerright
ledoM ataD
Steering
Braking
Fig. 4: Evaluation of the model in the opposite-direction lateral incursion scenario. a) A steep,
unprompted incursion by the other vehicle leads to the model swerving towards the opposite lane. The
sub-panels visualize the dynamics of both vehicles’ velocity v, acceleration a, steering angle δ and (for
the ego vehicle) the components of the pragmatic value G (scaled with the evidence accumulation
prag
gainλ)thatunderlietheaccumulatedevidencetowardsafullpolicyre-plan.b)Inresponsetoamedium
incursion by the other vehicle, where the model crashed at t=5.8s. c) The likelihood of the ego vehicle
successfully avoiding the other vehicle by steering left (toward the opposite lane) or right (toward the
shoulder), or failing to avoid a collision. d) Brake and steer response times. In panels C and D, human
behavior and response times measured in a driving simulator study [56] are shown for reference. Video
replays of the example simulations are available in the supplementary information.
10
lane over leaving the road to the right (similar to response times (which were extracted using the
Figure 1). However, it can be seen in Figure 4a same method; see the Methods section). A key
that this trajectory is not optimal. Namely, as finding of Johnson et al. [56] was that the partici-
can be seen in the top plot, the planed trajectory pants’ evasive maneuvering patterns and collision
X(cid:102)ego chosenduringthesecondre-planatt=4.6s outcomes were strongly determined by the differ-
(second dashed line) stays in the oncoming lane, ent scenario kinematics in the the three incursion
resulting in a low value for the lateral position scenarios.Inthesteepscenario,mostparticipants
component of the pragmatic value. Consequently, avoided collisions by steering toward the opposite
slight course corrections will likely be performed lane, while in the shallow scenario, participants
later (but this would occur outside the current typically steered toward the shoulder, passing the
simulation window). other vehicle on the ”inside”. However, in the
Figure 4b shows an example of the medium mediumscenario,themajorityofparticipantscol-
incursion scenario where the model is unable to lidedwiththeoncomingvehicle.Sincetheurgency
avoid a collision. Again, likely due to uncertainty (i.e., time to collision at the initial steering of
abouttheothervehicle’sbehavior,thefirstre-plan the oncoming vehicle) was constant across sce-
at t = 4.0s (first dashed line) mainly results in a narios, the high crash rate in the medium case
sharpdecelerationandminorsteeringtowardsthe was attributed to greater uncertainty about the
right (i.e., towards the shoulder). While steering othervehicle’sfuturepath,leavingnoclearescape
towards the right might seem suboptimal given route.
the other agent’s current path, it aligns with the As shown in Figure 4c, our model repro-
influence of the norm-conditioned particle filter, duced these results, reliably avoiding collisions in
which – by weighing those particles returning to the steep and shallow scenarios through steer-
theothervehicle’soriginallanehigherintheEFE ing respectively left (toward the center) or right
calculation – biases the model toward believing (toward the shoulder). Interestingly, the model
the otheragentwill return toits original lane (for also reproduce the human propensity for collision
moredetailsonthis,seethefollowingsection).At (although at slightly lower rate) in the medium
the second re-plan (t=4.6s, second dashed line), scenario. Johnson et al. [56] suggested that, con-
the model abandons the steering to the right and ceptually,akeyreasonwhyhumandriverstended
steersslightlytotheleftbutmainlyjustcontinues to collide in the medium incursion scenario is
braking. However, this only marginally improves the high perceived uncertainty about the oncom-
the collision components of the pragmatic value, ing vehicle’s future behavior which prevents the
leaving the imminentcollision risk unresolved. By driver from finding a sufficiently certain escape
the third re-plan at 5s (third dashed line), the path.Asdescribedabove,thecurrentmodeloffers
agent continues braking, trying to minimize the a detailed computational account for the possi-
impact severity, as by this point, the vehicles, ble mechanisms underlying this phenomenon: the
which are as seen in the top panel still on a direct wide spread (uncertainty) in the behavior pre-
collision course with nearly no offset, got so close dictions about the oncoming vehicle, as well as
that a collision becomes nearly unavoidable. Con- a bias towards expecting that it will return to
sequently,eventhefourthre-plan(t=5.4s,fourth its own lane due to the norm-conditioning of the
dashed line) fails to find a satisfactory trajectory, beliefs, prevents the model to find an evasive pol-
with the fifth re-plan coinciding with the collision icyintimetoavoidcollision(seeFigure4babove).
at t=5.8s (fifth dashed line). Anadditionalfactorbehindtheobservedcollision
As described above, we compared our model rateswaslikelyalsothemodel’sboundedplanning
to the human data collected in the driving sim- capacity.Increasingthemodel’splanningcapacity
ulator study by Johnson et al. [56]. We closely – by increasing the number of evaluated policies
replicatedthescenariosofthatstudyinoursimu- inthecrossentropymethodtenfold–resultedina
lations(seeSupplementaryMaterials1.3.2),which significantdropinthemodel’scollisionrate(from
allowed direct comparisons between the model 65%to50%inthemediumincursionscenario,and
and the data with respect to the chosen avoid- from 20% to 0% in the shallow incursion).
ance behavior and both braking and swerving Furthermore, Johnson et al. [56] found that
braking and steering response times – measured
11
from initiation of the incursion to the first reac- escapepaths,sotheagentcontinuesbraking,com-
tion – were generally long, ranging around 3.5 to ingtoacompletestop.Atthepointintimewhere
4 seconds. While braking response times did not the certainty about the other agent is low enough
vary noticeably with incursion severity, steering for safely choosing either left or right, the agent
response did decrease consistently from the steep can physically no longer avoid a collision (as it
towards the shallow scenario. Our model gener- can not move laterally when stopped). An exam-
ally reproduced the range of response times, with ple simulation of this scenario can be found in
closely matched median values (Figure 4d), but the supplementary material. The fact that colli-
did not capture the variation in steering response sions happened mostly in the shallow incursion
times. One possible explanation may lie in the scenariosislikelybecauseinthemediumandsteep
many participants avoiding collision in the steep incursion scenarios, early braking leaves enough
scenario primarily by braking before making a spaceinfrontoftheegoagentfortheothervehicle
final steering adjustment, delaying their recorded to move across, which is not the case in the shal-
steering response. In contrast, the model relied lowincursion.Inthisscenario,collisionwouldstill
more on steering for collision avoidance, requir- occur if the ego agent stayed in its starting lat-
ing an earlier response. The underlying reason for eral position, which makes braking an insufficient
these behavioral differences between the model avoidance mechanism. Based on those observa-
and human drivers are still unclear but may have tions, the inclusion of evidence accumulation is
todowithvaryingindividualpreferencesforbrak- criticalforaccountingforempiricaldataonhuman
ingversusswerving.Furtherworkisneededtosee responsetimesinbothscenarios,aswellasevasive
if these individual differences can be reproduced maneuverselectionintheshallowlateralincursion
bythemodelbyvaryingitsvelocity-,lanechange- scenario.
and lateral control effort preferences. Removing added noise in behavior pre-
diction. The model that uses deterministic pre-
Evaluating individual model dictionsabouttheothervehicleproducedresponse
mechanisms times in the front-to-rear scenario that are only
slightlylongerthanforboththefullmodelandthe
Comparison to the empirical data human data (Figure 5c), especially given shorter
(Figures 3 and 4) revealed that our model cap- time-gaps. By contrast, in the opposite direction
turedthekeyaspectsofhumancollisionavoidance lateral incursion scenario, it exhibited substan-
performance in the two collision avoidance sce- tially shorter response times. The reason for this
narios. To better understand which of the model apparent discrepancy is that in the front-to-rear
mechanisms are essential for capturing the empir- scenario, prediction noise results in ego agent’s
icalobservations,weevaluatedtheperformanceof believing that the other vehicle may brake more
six simpler models which systematically excluded aggressively,promptingthemodeltoreactearlier.
the key mechanisms one-by-one (Figure 5). In the lateral incursion scenario, however, remov-
Removing evidence accumulation. With- ing the prediction noise decreases ego agent’s
out evidence accumulation, the model fully re- uncertainty about the other vehicle, leading to
plans its policy at every time step. Consequently, earlier steering responses which, given how these
it starts reacting to changes in the other vehicle’s particular scenarios unfolded, turned out be a
behavior immediately after detecting them. This moreeffectiveavoidancestrategy,asevidencedby
resulted in a drastic reduction in response times the absence of collisions in this case. However, it
across all scenarios ( Figure 5b). Additionally, should be noted that this strategy was only more
the model without evidence accumulation pre- effective after the fact (i.e., with hindsight of how
dominantly failed to avoid collisions in the shal- the scenario played out). In another counterfac-
low incursion scenario, contrasting sharply with tual scenario, where the oncoming vehicle turns
human data and the full model. This was mostly backintoitsownlane,earlyswervingcouldinstead
caused by the model initiating braking very early. result in collision (see [56] for further discussion
Given the uncertainty about the other vehicle, of this important point).
neither steering left nor steering right allows safe Prediction noise affected not only response
times but also the model’s choice of evasive
12
aFullmodel
)ylnoekarB(P
1
5.0
0
bnoevidence cnoprediction dnopedal enolooming f nolooming gnonorm-con.
accumulation noise constraints perception threshold particlefilter
0 1 2 3 4
]s[
TRt∆
3
2
1
0
0 1 2 3 40 1 2 3 40 1 2 3 40 1 2 3 40 1 2 3 40 1 2 3 4
Timegap[s]
0 0.5 1
]2
−sm[anim
0
2-
4-
6-
8-
0 0.5 1 0 0.5 1 0 0.5 1 0 0.5 1 0 0.5 1 0 0.5 1
InvTTC[s− 1]
ytilibaborP
]s[
TRt∆
1
5.0
05
4
3
2
1
0
peetS muideM wollahS peetS muideM wollahS peetS muideM wollahS peetS muideM wollahS
Incursiontype
peetS muideM wollahS peetS muideM wollahS peetS muideM wollahS
Fig. 5: Evaluation of variants of the model without some of its key mechanisms in the front-to-rear
scenario(topthreerows,seeFigure3forthelegend)andthelateralincursionscenario(bottomtworows,
see Figure 4 for the legend). In the second and third rows, dashed gray lines depict regressions to model
simulation results.
maneuverinthelateralincursionscenario.Inpar- the importance of enabling the model to account
ticular, the model with deterministic predictions for uncertainty in its predictions to represent the
predominantly opted to avoid the other vehicle key collision mechanism in the medium incursion
by steering left regardless of the incursion pro- scenario, as discussed in relation to Figure 4b.
file. This allowed the model to avoid collisions Removing pedal constraints. The model
in all simulations, but is not consistent with the notconstrainedbypedalswitchingdelaysresulted
human data. Overall, these findings underscore in approximately 0.2s faster brake response times
that behavior prediction noise is crucial for accu- inboththefront-to-rearandlateralincursionsce-
ratelyreproducinghumanbehaviorparticularlyin narios compared to the full model (Figure 5d).
the lateral incursion scenario, and also confirms This matches the delay of 0.2s implemented for
13
the switch from acceleration to deceleration. This threshold, in addition to the strong theoretical
delay could potentially be accounted for with- support.
out pedal constraints by slightly decreasing the Removingthenorm-conditionedparticle
gain factor in the evidence accumulation mech- filter.Inthemodelwithoutthenorm-conditioned
anism. This approach would, however, also lead particle filter, the changes to the overall behav-
to increased steering response times in the lateral ior in the front-to-rear scenario are very minor
incursion scenario, which both in the full model compared to the full model (Figure 5g). How-
andthisablationwerealreadyslightlyslowerthan ever, in the lateral incursion scenario this change
the human data. Thus, we deemed these con- has a major impact on the collision outcome in
straints essential for describing human response the medium incursion scenario, where the model
times in the front-to-rear scenario. now avoids collision in all runs, similar to the
Removing looming perception. We ana- modelvariantwithoutpredictionnoise.Whenthe
lyzed a version of the model which directly norm-conditioning is removed, the model treats
perceived kinematic variables without relying on all predicted trajectories as equally likely instead
looming(Figure5e)aswellasonewhichperceived of initially focusing on those where the oncoming
looming but did not have a looming perception vehicle returns to its own lane. This assumption,
threshold (Figure 5f). In the front-to-rear sce- together with the reduced pragmatic value asso-
nario, both these models differed from the full ciated with lane changes, leads the full model
model and the human data in that they pro- to initially steer towards the right, costing valu-
duced faster brake response times at longer time able time and creating situations where steering
gaps. For the model without the looming thresh- to the left is no longer a viable solution, and col-
old, this is due to the fact that greater time lisions become unavoidable. By contrast, in the
gaps (and therefore greater distances) require a model without norm conditioning, potential colli-
larger velocity difference to surpass the looming sionsalongsteeperincursiontrajectoriesaretaken
detection threshold, which delays responses, as more seriously earlier, making an initial steering
it needs more time to accumulate. Furthermore, to the right less likely. Instead, the model with-
these results being very similar to the model that out norm conditioning more frequently evades to
did not perceive looming at all (Figure 5e) indi- theleftimmediatelyinsuchmediumincursionsce-
cates that in this scenario, the looming threshold narios, resulting in the observed lack of collisions.
was a key factor behind the ability of the model This aligns with the hypothesized role of norm
to capture human response times. Additionally, conditioningincrashes,asdiscussedinconnection
while not specifically analyzed here, this effect is with Figure 4b.
expected to be exacerbated in high speed freeway While these difference already highlight the
scenarios where (given the higher speed) the fol- importance of the norm-conditioned particle fil-
lowingdistancesforagiventimegapincrease,fur- ter, it has the strongest impact in benign (non-
ther emphasizing the importance that the model conflict) scenarios. In such scenarios, the model
accounts for this phenomenon. In the opposite withthesimplekinematics-basedbehaviorpredic-
direction lateral incursion scenario, removing the tionmechanismisunrealisticallyconservativedue
looming threshold (or looming entirely) did not to having to plan for all kinematically possible
have any major effect, as the high relative veloc- futures of the other vehicle — a problem that is
ities overcome the looming threshold very early, avoided by the model with norm-conditioned par-
and perception accuracy of longitudinal positions ticlefilter(seeSupplementaryMaterials1.4foran
is far less relevant in that scenario. example).
In summary, models without either looming Overall, all six simpler versions of the model
perception or looming threshold resulted in qual- exhibit qualitative differences compared to the
itative differences between the model and human full model, and none capture the human data
data on brake response times in the front-to-rear across both scenarios as comprehensively as the
scenarioandcollisionratesinthelateralincursion full model. This provides evidence that all of the
scenario. This highlights the importance of both analyzed model mechanisms are all important for
looming-basedperceptionandloomingperception capturing human collision avoidance behavior.
14
Additionally, we ran a model ablation where their expected free energy, pursuing the policy
we ignored the epistemic value when selecting with the lowest EFE, and allowing for further re-
policies, which however did not result in any planning if the chosen policy turns out to not
meaningful differences. yield the preferred (and hence expected) out-
comes (e.g., due to limited planning accuracy or
Discussion unexpected changes in how the scenario unfolds).
This, in effect, implements a constraint satisfac-
Building on previous work [33], we here presented tionmechanismwheredifferentmodelpreferences
an active inference-based framework for model- aretradedagainsteachotherinfindingthepolicy
ing human collision avoidance behavior based on withthehighestoverallcombinedpragmaticvalue
first principles. To our knowledge, this is the and epistemic value. We observed several exam-
first published computational model that offers ples of this (Figures 3 and 5) where, for example,
a detailed account of human collision avoidance themodelgenerallypreferstobrakeatlowspeeds
behavior across multiple conflict scenarios. Our (sincethelossrelatedtothepreferredspeedisnot
model reproduces many key results in the rich ashighasthecostofchanginglane)andswerveat
literature on collision avoidance in front-to-rear higher speeds (where the cost of braking in terms
scenarios,inparticularthedependenceofresponse of speed loss are higher). This yields detailed pre-
times and braking magnitude on scenario kine- dictionsofhumanbehaviorsindifferentkinematic
matics. The model also generated several detailed situationsthatcouldbefurthertestedempirically.
predictions on how evasive maneuver decisions Anotherimportantnovelaspectofourmodelis
(braking vs. swerving) vary with scenario kine- its ability to dynamically account for uncertainty
maticswhichcanbetestedinfutureexperiments. about the future behavior of other agents. This is
Furthermore, we compared the model directly particularlyimportantinsituationslikethelateral
to human behavior in an opposite-direction lat- incursion scenario where the driver cannot deter-
eral incursion scenario with varying kinematics mine a priori if the other vehicle will continue
obtained in a driving simulator study [56]. This crossingtheegovehicle’slaneorifitwillturnback
analysis demonstrated that the model can repro- to its original lane, resulting in a wide range of
duce human evasive maneuver decisions, collision potential future trajectories of the other vehicle.
outcomes,aswellasresponsetimesinthedifferent However, the uncertainty may be reduced as the
incursion scenarios. scenario unfolds, opening up new available escape
Akeynovelfeatureofourmodelisitsabilityto paths,orescapeaffordances [56],aswasthecasein
flexibly represent closed-loop collision avoidance the current steep and shallow incursion scenarios.
through dynamic replanning of policies, includ- Insuchcases,atooearlyevasiveresponsemaybe
ing braking, steering, and accelerating actions, premature (and non-optimal) and does not prop-
in a way that is qualitatively and quantitatively erlyreflecthumanbehavior.Wesawanexampleof
similar to human collision avoidance behavior. thisinFigure5c,wherethemodelwithoutpredic-
In contrast, existing publicly available collision tionnoiserespondedmuchfasterthanhumansand
avoidance models either implement a ”one-shot”, the full model, thus avoiding collision in all cases.
often predetermined, open-loop evasive maneu- However, such overconfident evasive maneuvering
ver [1, 5, 63] or limited aspects of closed-loop behavior would be detrimental in the alternative
control,suchasintermittentbrakingbutnosteer- scenario where the other vehicle is turning back
ing[11,64].Somecommerciallyavailablemodels– into its original lane. By representing the uncer-
the Stochastic Cognitive Model (BMW; [65, 66]), tainty about the other vehicle’s future positions
thedriveBOTmodel(cogniBIT;[67,68])–report- using a vehicle dynamics (bicycle) model and a
edly implement human-like closed-loop behavior noisy particle filter, our model is able to handle
incollisionavoidancescenarios.However,thelack such situations and successfully reproduce human
of available information on the detailed working behavior.
principles of these models precludes a meaningful It should be noted that in the collision avoid-
comparison with the current model. ance scenarios simulated in the present study,
Our model achieves closed-loop behavior by there is little opportunity for the driver to reduce
continuously evaluating evasive policies based on the uncertainty about the oncoming vehicle’s
15
future trajectory through epistemic actions. In evidence (e.g., looming [? ]), our model rather
other words, there is little the driver can do to accumulates surprise. Similar ideas have been
obtainfurtherinformationthatcouldhelppredict explored in existing models [6, 47, 64], based on
whattheothervehiclewilldo.However,asfurther thenotionthatatrafficconflictbydefinitionisan
discussed below, in the real world communicative extremelyrare(andhencesurprising)eventwhich
acts such as honking, flashing headlights or ini- always takes place against a ”default” expecta-
tially moving to the right in the lane could serve tion of how the situation would normally play
to reduce uncertainty about the oncoming vehi- out (Figure 1). This is also the key idea behind
cle driver’s intent, but since the oncoming agent the NIEON (Non-Impaired driver with their Eyes
was here assumed to be non-reactive such aspects ON the conflict) response time model which con-
were not addressed in the current work (this is a ceptualizes the onset of the stimulus that human
topic for future development of the model). Thus, drivers respond to in a traffic conflict as the onset
as expected, disabling the epistemic value com- of surprise (i.e., the violation of the initial default
ponent of EFE did not significantly change the expectation) [6]. The current model generalizes
current simulation results. this idea in several novel ways. First, instead
While active inference models can be imple- of triggering a predefined action such as brak-
mented computationally in many different ways, ing when the surprising evidence has reached the
following [33], we used a stochastic receding- threshold, the evidence accumulation here trig-
horizon control architecture as the basis for the gers the re-planning of a new policy, using the
implementation.Thissharessimilaritieswithprior EFE-based policy selection mechanism discussed
work in robotics, particularly decision-theoretic above. Second, the surprise signal that is being
approachesthatexplicitlyaccountforuncertainty accumulated is not just the difference between a
in actuation and sensing by propagating belief predicted and actual signal but rather the nega-
states into the future, often using particle-based tive pragmatic value of the current policy, that is,
representations, and then selecting actions that how ”bad” the currently selected default policy
optimize expected outcomes based on this pro- is relative to the agent’s preferred observations.
jected belief evolution [69–71]. However, our work This provides a straightforward solution to the
diverges from these engineering models in two known problem of how to determine whether a
crucial aspects. First, since our goal is to repre- given surprise signal is relevant to the agent [47].
sent human driver behavior rather than designing While we here model evidence accumulation
a robotics controller, the modeling focuses on explicitly, it can in principle be seen as an
capturing key aspects of human driving, such implicit feature of active inference [75]. How-
as response timing and evasive maneuver deci- ever, in practice, it is challenging to accurately
sionmaking,ratherthanoptimizingperformance. represent human response dynamics implicitly in
Second, our modeled agent minimizes EFE (as a simplified model like ours and, in order to
prescribed by the active inference framework), enable a straightforward tuning of the model’s
while traditional state-based reward functions response performance to human data, we chose
often employed in the control literature lack such thecurrentexplicitmodelingofevidenceaccumu-
a neuro-biologically plausible objective. lation. As demonstrated by our simulation results
Our model incorporates an explicit mecha- (Figure 5b), the inclusion of this mechanism is
nism for evidence accumulation to account for essential to account for realistic response times in
human response timing, based on existing mod- our model.
els [6, 72? –74]. Evidence accumulation models The current model is based on the gen-
naturally account for the situation-dependency of eral model predictive control architecture origi-
response timing in traffic situations: the faster a nally developed for the model of routine driving
traffic conflict escalates, the faster the human’s described in [33] which, in turn, is based on
response to it [6, 14]. Compared to existing evi- the standard discrete-time active inference EFE
denceaccumulationmodels,ourmodelintroduces model for planning agents formulated as a par-
some key novel aspects. In particular, by contrast tiallyobservableMarkovdecisionprocess[24].The
to traditional models that accumulate perceptual original routine driving model in [33] focused pri-
marily on the role of epistemic value in resolving
16
uncertainty when driving around visual occlu- states with a high degree of certainty, thus look-
sions and during visual time sharing (drawing ing as if it is minimizing free energy over time.
from the rat-in-a-T-maze example in [24]). How- By the same token, we endowed our model with
ever, that model was not aimed at describing a (highly simplified) set of preferred states that
time-critical behaviors. For instance, in collision aremeaningfulandrelevanttoahumancardriver
avoidance scenarios its responses to sudden stim- (avoid danger of collision, stay on the road, keep
uli would be overly fast, similar to the ver- upprogress,avoidtooharshbraking/steering)and
sion of our model without evidence accumulation defined the model such that it acts (selects and
(Figure 5b). Extending the original model [33] executes policies) in a way that maximizes the
with not only evidence accumulation, but also chance of observing these preferred states.
other mechanisms such as looming-based per- Related to this, our model also offers a novel
ception and norm-conditioned predictions was operationalization of the classical notion of affor-
essential for capturing human collision avoidance dance,traditionallybroadlydefinedbyGibson[35]
behavior (Figure 5). Otherwise, the model we as what the environment ”offers the animal, what
reportedhereretainsthekeyfeaturesoftheorigi- it provides or furnishes, either for good or ill” (p.
nal routine driving model needed for dealing with 127). Thus, when our model identifies candidate
uncertainty resolution through epistemic action, evasive policies associated with low EFE, these
thus offering a powerful and general computa- can be understood as affordances in the sense of
tional framework for modeling driving behavior, opportunitiesforactionsthatareworthpursuing.
also beyond collision avoidance. As in [33], we The active inference framework offers a further
employed engineering tools like the cross-entropy distinction between pragmatic affordances yield-
method and particle filters with discrete and con- ing unsurprising, familiar and preferred observa-
tinuous variables. However, while relying on such tions and epistemic affordances yielding informa-
established methods, our model does not reduce tionthatcanresolveuncertaintyaboutpragmatic
to a combination of them; instead, these meth- affordances[33,81,82](see [56])forafurtherdis-
ods serve as means for implementing specific cussionaboutthisexpandednotionofaffordances
cognitive mechanisms within our active inference anditsrelationtotheclassicalaffordanceconcept
framework. in ecological psychology).
Our framework is grounded not only in active Thankstoitsgenerality,activeinference-based
inference and the free energy principle [26], models have been developed for virtually every
but also enactivist approaches to cognitive sci- facet of biologically-based cognition and behav-
ence [76, 77]. Active inference and enactivist cog- ior, in organisms ranging from single cells [78],
nitive science share the the foundational notion plants [83], individual animals and humans [84]
that behavior in biological agents results from to social and cultural phenomena [85], which pro-
a self-organizing process geared towards sustain- vides a great source of concepts and ideas for
ing the agent’s integrity (existence) over time. modeling different aspects of human road user
This emphasizes a strong continuity between life behavior. Thus, importantly, we see active infer-
and mind [77–79] and offers a natural solution ence not just as a computational approach to
to the problem how the certain aspects of the model development, but as a general theoretical
environment become meaningful and relevant to framework for understanding road user behavior
an agent [80]. Such an existential imperative can that can guide modeling at a conceptual level
be described as the organism striving to main- and generate novel hypotheses for experimental
tain itself in a sparse attractive set of preferred studies. At the same time, the great majority
agent-environmentstates,wheretheattractiveset of existing active inference models use relatively
depends on the specific organism in question. simple toy scenarios, thereby limiting its appli-
Thus, to survive over time, a fish needs to remain cability to real-world human behavior [9]. By
inwaterwiththerightchemicalbalanceandtem- operationalizing active inference in the context of
perature range, obtain food, avoid being eaten a dynamically rich task, that is, collision avoid-
by certain predators etc. This implies that these ance and evaluating it against human data from
particular states are meaningful and relevant to both simulated and real-world driving, this study
the fish which then acts in order to observe these
17
pushes the boundaries of active inference appli- agentshiddenbehindoccludingobjectsorappear-
cations toward the modeling of complex human ing outside the driver’s field of view (see also Wei
naturalistic behaviors. et al. [89]).
While, as discussed above, our model repre- Finally, while the current policy sampling
sentsasignificantadvancementinhumancollision and kinematic-based particle filter approach was
avoidance modeling, it has several limitations demonstrated to work well in the current scenar-
that can be addressed in future work. First, in ios, this could be a limiting factor in scaling the
this work we essentially hand-tuned the model model to a wider range of scenarios, especially
parameterstofitthehumandatafromthetwocol- when modeling pre-conflict scenarios with more
lisionavoidancescenarios.Whereasthishighlights complex road infrastructures and road user inter-
the model’s generalizability and interpretability, actions. To overcome this potential limitation,
hand-tuning model parameters is impractical at machine-learning-based generative models from
scale. Future research should explore system- existing data-driven models [17, 21, 90–94] could
aticparameteroptimizationmethods,forexample be leveraged to generate possible futures in the
using the approach suggested by Wei et al. [86]. current model that are evaluated by EFE, either
Second, the current model assumes that other stand-alone or in combination with the current
agents are non-reactive, an assumption that in kinematicrollouts,thuspotentiallyenhancingthe
general case does not hold. Thus, future work generalizability of the model.
incorporating reactive agents and investigating Overall, our work contributes to the recent
the role of communication in agent interactions body of research [33, 86] with new evidence that
drivenbyepistemicvaluecouldextendthemodel’s active inference can serve as a general frame-
applicability, enabling simulations of interactions workforcomputationalroadusermodeling.Along
between multiple active inference agents. More- withtheemergingreal-worldapplicationsofactive
over, the current model (as well as the original inference in robotics [95] and artificial intelli-
model in [33]) only reasons at a shallow ”unso- gence [96], this work can aid the development
phisticated” level about how actions bring about of simulated agents used for real-world applica-
futureobservationswithvaryingdegreesofuncer- tions in advanced driver assistance systems and
tainty. Further work could explore the possibili- autonomous vehicle evaluation.
ties of incorporating sophisticated inference [87],
which enables ”deeper” levels of recursive reason- Methods
ing about how future observations would lead to
updated beliefs and corresponding new actions. Model principles
This may be particularly relevant when modeling
Our model follows the architecture of the original
interactions between road users.
modelinitiallyformulatedbyEngstr¨ometal.[33],
Third, the model currently only accounts for
and combines some of the original elements of
perceptual limitations in terms of visual looming,
thatmodelwithmultiplenewmechanisms.Inpar-
which, strictly speaking, only applies to objects
ticular, our model retains the representation of
located along a straight path of travel relative to
probabilistic beliefs using sets of samples and the
thegazedirectionoftheobserver(inourcase,this
correspondingly sample-based estimation of the
means objects located straight ahead of the ego
expected free energy (see equation (6)) as well as
vehicle).Thus,torepresentothertypesofpercep-
the cross entropy method used for policy selec-
tual limitations, alternative perceptual variables
tion. In addition to these mechanisms, we intro-
would need to be explored such as, for example
ducedloomingperception,evidenceaccumulation,
bearing angle as a specification of perpendicular
the norm-conditioned particle filter, and the con-
collision course [88].
straints on acceleration profiles (see Figure 5 for
Fourth,whilemechanismsfordealingwithpar-
the analysis of the impact of these new mecha-
tialobservabilityduringocclusionsandvisualtime
nisms on model behavior). We also modified the
sharing were explored in [33], further work is
Bayesian belief update (equation (2)) and the
needed to develop more comprehensive solutions
calculation of the epistemic value (equation (7)).
for representing and reasoning about multiple
18
Inouractiveinferencemodel,theenvironment get the expected states S (approximating
A,t
is represented by the generative process, with a q (s ) = exp
(cid:0)E
lnp(s |s ,a )
(cid:1)
), with
A t q(st−1) t t−1 t−1
stateoftheworldη ∈E whichispartiallyobserv- s ∼ p(s′|s ,a ) being randomly sam-
A,t,n t−1,n t−1
able by the agent. The agent can influence the pled. Then, a kernel density estimate [97, 98]
environment with its actions a∈A (according to based on S is used to approximate q (s ) as
A,t A t
thestatetransitionprobabilityp(η′|η,a)),result- a Gaussian Mixture Model (GMM). Assuming
(cid:98)
ing in observations o ∈ O, whose dependence on that p(o |s ) is Gaussian as well, q(s ) can also
t t t
theworldstateisdescribedinp(o|η)(thepisused be represented as a GMM; this allows straightfor-
(cid:98) (cid:98)
to show these function be part of the generative ward sampling of S . Compared to the approach
t
process). in the original model [33] of weighting samples
The agent has an internal model of the world, s ∈ S with p(o |s ) and then resam-
A,t,n A,t t A,t,n
the generative model, with the corresponding par- pling based thereon, this approach allowed us
tially observable state s ∈ S, and the corre- to represent large shifts in beliefs outside the
sponding state transition function p(s′|s,a) and extreme values of the initial set S .
0
observation probability p(o|s). As the generative The agent’s visual perception in our model is
model isanabstractionoftherealworlddescribed basedonlooming(SupplementaryMaterials1.2.2)
by the generative process, η and s do not nec- – the optical information immediately available
essarily have to represent the same state spaces to humans about the relative motion of objects
(E ̸= S). The agent is uncertain about the state straight ahead in the direction of travel [35].
of the generative model, represented by the prob- Specifically, the relative position and motion of
ability density function q(s) (referred to as the objects along the forward path of the agent is
agent’sbeliefaboutthestates).Following[33],in perceived in terms of the visual angle φ sub-
our model the agent represents its belief distribu- tendedbytheobjectattheretinaoftheobserver,
tions q(s) in a non-parametric way as a set of N and its derivative, the angular rate φ˙ (loom-
samples S ={s ,...,s } (i.e., a particle filter). ing) [34, 40]. Due to the nonlinear relationship
1 N
The agent then tries to minimize its free between the observer’s distance to the observed
energy,bothinthebeliefq(s)itforms(variational vehicle (in Figure 2a referred to as ∆x) and φ
free energy)andtheactionsaitchooses(expected (with increasing distances, equal variations δ∆x
free energy). The action and policy selection is leadtoincreasinglysmallerδφ),perceptionerrors
based on the existence of a preference prior p(o) for φ and φ˙ will lead, respectively, to increasing
depicting preferred observations. inference errors and therefore uncertainty about
thepositionandspeedoftheleadingothervehicle
Perception at increasing distances. We represent this aspect
in the model by setting the noise in p(o|s) to be
At time t, the agent perceives the world state η ,
t constant across φ and its derivatives.
resulting in the observation o :
t Atacertaindistance,φ˙ isnolongerperceptible
tothehumaneye,whichimpliesaminimalthresh-
o ∼p(o′|η ) (1)
t (cid:98) t old for looming detection [41, 42]. To account for
this, the model incorporates a detection thresh-
With this observation, the agent updates its old
old on φ˙ (i.e., for small |φ˙|, the means of the
beliefq(s )toq(s ).Theactiveinferenceframe-
t−1 t observation probabilities p(o|s) for velocities and
work postulates that this update is based on the
acceleration were set to the values correspond-
minimization of the variational free energy [24],
ing to φ˙ = 0). This means that changes in the
but in our case we use standard Bayesian updat-
other vehicle’s velocity cannot be perceived by a
ing:
human driver beyond a certain distance, resulting
for example in a delayed recognition if the lead
q(s )∝p(o |s )E p(s |s ,a ). (2)
t t t q(st−1) t t−1 t−1 vehicle suddenly brakes.
Here, the particle filter first advances the
individual samples in S (representing
t−1
q(s )) using the transition function to
t−1
19
Behavior prediction the belief that, for example, any oncoming vehi-
cle may encroach into their lane at any time.
After observing the current state of the world,
This leads to overly reactive behaviors. Human
the agent applies the state transition function
drivers, by contrast, typically avoid such pes-
p(s′|s,a) starting from its current belief q(s )
t simisticpredictionsbyassumingthatotherdrivers
in order to generate a predicted belief about
will adhere to road rules and other established
the future states of the situation q (s |π ,q(s ))
(cid:101)s τ t t traffic norms [44, 45]; for example, they typically
(with τ ∈ {t + 1,...,t + H}, an arbitrary
assume that oncoming vehicles will stay in their
policy π containing the ego agents sequence
laneunlessthereisevidencetothecontrary.With-
of planned actions, and prediction horizon H)
out such an assumption driving on roads with
of agents in the scene, as well as the corre-
multiple adjacent lanes would not be possible.
sponding belief over possible future observations
To address this issue, we introduced the nor-
q (o |π ,q(s )) = E p(o |s ). During
(cid:101)o τ t t qs(sτ|πt,q(st)) τ τ mative probability density function, p : O →
thispredictionprocess,theagentaddsnoisetothe n
(0,1], reflecting expectations about adherence to
controlinputsofthe(cid:101)otheragentstorepresentthe
traffic norms, by assigning lower probability val-
possibility that they might change their behavior.
uestofutureobservationsthatviolateestablished
Practically, the agent advances the
norms (such as leaving the lane). Thereby, we
belief q (s |π ,q(s )) (represented by
(cid:101)s τ t t implement an assumption into the model that
S(cid:101)τ = {s
τ,1
,...,s
τ,N
}) to the next time-step
other road users will behave according to such
by using the state transition function (in our
norms. While beliefs about traffic norms could
case based on a bicycle model [99], see Supple-
also be implemented directly in the state transi-
mentary Materials 1.2.1) on each of the sample
tionfunctionp(s′|s,a),weherechosethissimpler
states s ∼ p(s |s ,a , and applies
τ,n τ τ−1,n τ−1 approach which was deemed sufficient for present
additive noise (similarly to forming the expected
purposes. This possibility can be explored in
belief q (s) in the belief update). The belief
A future work.
q (o |π ,q(s )) is then represented by the set
(cid:101)o τ t t Specifically, we normalize the probability den-
O(cid:101)τ ={o τ,1 ,...,o τ,N }, where o τ,n ∼p(o τ |s τ,n ). sities p
n
(o
τ
) across the N particles in O(cid:101)τ that
It could be noted that this belief propagation representq (o |π ,q(s )).Thisensuresthatwhen
(cid:101)o τ t t
scheme is unsophisticated in the technical sense
normative behavior is no longer observed (i.e.,
that it does not condition the beliefs about future
all values of p
n
(o
τ
) for o
τ
∈ O(cid:101)τ are similarly
states on corresponding counterfactual observa-
low), norm violations are still treated as likely
tions. While it would theoretically be possible to
events requiring an appropriate response. Specif-
use a form of sophisticated inference [87] that
ically, as there are no norm-compliant particles
accounts for such conditioning, we here used the
to dominate onto the EFE calculation, the norm-
unsophisticatedapproachforsimplicity,similarto
violating particles will now all be considered with
the original model [33] and most existing active
similar importance. This approach – which we
inference models.
call norm-conditioned particle filter – helps align-
A key advantage of this kinematics-based
ing the model’s predictions with realistic driving
behavior prediction approach (compared to
scenarios while allowing for the anticipation of
machine learning-based data-driven approaches)
norm violations when necessary. As traffic norms
is that in a collision avoidance scenario it allows
are typically scenario-specific, we defined them
the model to account for kinematically possible
individually per scenario (Supplementary Materi-
but low-probability “extreme” (long-tail) behav-
als 1.3.1 and 1.3.2).
iors of other agent once the conflict has been
initiated, something which is hard to learn based
Policy sampling
on data. However, on the flip side, this could
yield too pessimistic behavior predictions prior Basedonthepredictedbehavioroftheothervehi-
to the conflict. For example, if the noise in the cle, the agent selects its policy π. Here, policies
particle filter is high, leading to a high disper- are defined as sequences of H future actions; fol-
sion of the particles, the model operates based on lowing the bicycle model, the actions are defined
in terms of acceleration a and steering rate ω.
long
20
These actions are selected using the cross-entropy g ):
epist
method [33, 48], which iteratively resamples sets
ofM candidatepoliciesK times,wheretheresam- t+H
(cid:88)
pling focuses around the subset of the βM best G(π t ,q(s t ))= −g pragm (q (cid:101)o (o τ |π t ,q(s t )))
samples from the previous iteration. Specifically, τ=t+1
the agent takes the mean and variance of this −g (q (s |π ,q(s ))).
epist (cid:101)s τ t t
promisingsubset(ignoringpotentialcorrelations), (3)
and then samples a new set with size M from the The pragmatic values g is defined as
pragm
corresponding normal distribution. In contrast to
the original model [33] that randomly picked the g pragm (q (cid:101)o (o))=E qo(o)pn(o) lnp(o), (4)
finalsamplingoutputfromthelastiteration’sset,
here we specifically choose the best sample. while we use the Shannon(cid:101)entropy H to calculate
To better represent human behavior, the the epistemic value [24]
modelincorporatesapedalconstrainttofilterout
unrealistic changes in acceleration (Supplemen- g epist (q (cid:101)s (s))=E qo(o) D KL [q (cid:101) (s|o)|q (cid:101)s (s)]
tary Materials 1.2.3). As human drivers generally =H(E p(o|s))−E H(p(o|s)).
control acceleration by operating the brake and (cid:101)
qs(s) qs(s)
(5)
gas pedal with a single foot and cannot move the ThefirstterminEqu(cid:101)ation(5)iskno(cid:101)wnasthepos-
foot between pedals instantaneously, the model teriorpredictiveentropy andrepresentstheextent
imposes a constant holding time interval of 0.2s to which a policy is expected to yield a variety
at a 0 ≲0ms−2, such that if the model transitions ofdifferentobservations.Thesecondterm,known
from a current acceleration a long >a 0 to a target as expected ambiguity represents the diversity of
acceleration a long,f < a 0 , it must first decelerate observations expected for a given state, that is,
to a 0 , maintain that value for 0.2s, and then pro- the extent to which the observations of that state
ceed to a long,f . The same applies for acceleration are unreliable (e.g., due to reduced visibility).
changes in the other direction. In our particle-based representation, we rep-
resent q
(cid:101)s
(s) with the set S(cid:101) of N particles and
Policy roll-out and evaluation q
(cid:101)o
(o) = E
qs(s)
p(o|s) with the set O(cid:101), resulting in
the approximations
To evaluate a policy π, the agent first uses the
(cid:101)
bicycle model to roll out its possible future states (cid:80)
p (o)lnp(o)
based on π. In the general case, the possible (cid:16) (cid:17) n
o∈O
future states of the agent and the other vehicle g˜ pragm O(cid:101) = (cid:80) p (o) (6)
n
are coupled, hence the agent rolls out its poli- (cid:101)
o∈O
ciesjointlywiththepredictedfuturesoftheother
vehicle. For the reason of simplicity, however, our and (cid:101)
model assumes that in p(s′|s,a) the other vehicle
 
is unresponsive to the actions of the ego vehicle, (cid:16) (cid:17) 1 (cid:88) 1 (cid:88)
allowing us to separate behavior prediction and g˜ epist S(cid:101),O(cid:101) = − ln p(o|s)
N N
policy roll-out. o∈O s∈S
Activeinferencethenrestsonthefundamental 1 (cid:88)
− (cid:101)H(p(o|s))(cid:101),
assumption that an agent prefers policies which N
minimizeitsexpectedfreeenergy (EFE)Goverthe s∈S
(7)
prediction horizon of H time steps (i.e., the best
under the assumption(cid:101) that the entropy
policy is the one with the lowest EFE). This EFE
H(p(o|s)) : S → R can be calculated analyt-
combines the desire of the agent to, on the one
ically. The original model [33] had calculated
hand, observe itself in states that it prefers (max-
imize pragmatic value g ) and, on the other
g
epist
by using KDE methods based on O(cid:101) to
pragm approximate q (o) = E p(o|s), compared to
hand, seek information that may reduce uncer-
us using 1 (cid:80)
(cid:101)o
p(o|s). W
q
e
s(
o
s)
pted for this different
tainty about the world (maximize epistemic value N
s∈S (cid:101)
approach, as the original estimation would result
(cid:101)
21
in an over-approximation of q (o), given that we Here,wefollowEngstr¨ometal.[6]inaccumulating
(cid:101)o
evaluate the KDE exclusively at the center of surprise ϵ≥0,definedastheresidualinformation
each kernel. Consequently, we use the following of the pragmatic value [47]:
approximation G˜ for the EFE:
t+H
(cid:88)
t+H ϵ =Hmaxlnp(o)− g (q (o |π ,q(s ))) .
(cid:88) (cid:16) (cid:17) t pragm (cid:101)o τ t t
G˜(π t ,q(s t ))= −g˜ pragm O(cid:101)τ o τ=t+1
τ=t+1 (8) (11)
(cid:16) (cid:17) Under this definition, the surprise is the differ-
−g˜
epist
S(cid:101)τ ,O(cid:101)τ .
encebetweenthehighestpragmaticvaluepossible
and the actual pragmatic value of a policy. For
When evaluating the pragmatic value, we
instance, if a policy would result in the most
assume that the preference (i.e. the distribution
preferred observation, the agent would not accu-
of desired observations) p(o) accounts for four
mulate any additional evidence. However, if a
aspects of the agent’s objective: a) to maintain
policy would lead to an undesired (i.e., a priori
its desired longitudinal velocity, b) to minimize
unlikely)observation,muchevidenceforare-plan
the magnitude of control inputs, c) to remain
would be gained.
on the road and within its current lane (e.g.,
If the accumulated evidence is below the
avoiding lane markers or opposite lanes), d) pre-
threshold of 1, the model then follows the
vent collisions, and e) avoiding hazardous situ-
extended policy. Otherwise, it generates a com-
ations. Each of these aspects is represented by
pletely new policy, applying the above policy
an individual preference function (Supplementary
selection mechanism to every action in the policy.
Materials 1.2.4), which are multiplied together:
Finally, after the policy is determined, its first
action a is used to update the state of the actual
p(o)=N(v |µ ,σ )N(a |0,σ )N(ω |0,σ ) t
ego v v long,ego a ego ω world. This is done using the state transition
p lat (y ego )p coll (o)p safe (o). function of the generative process:
(9)
For p safe (o), the model specifically seeks to η t+1 ∼p (cid:98) (η′|η t ,a t ) (12)
avoid states where, under the assumption that
the other vehicle begins braking suddenly with a Model parameters
deceleration of a , the ego vehicle would fail
OV,min
to avoid a collision despite initiating maximum Each of the key model mechanisms has a num-
braking after a response time of 1s. ber of parameters associated with it (see Table 1
for an overview of the 26 most essential param-
Surprise-based re-planning eters). For 12 of them, the exact values have
been directly adopted from the literature, in par-
Our model assumes that on every time step, the
ticular the original model [33]. Another thirteen
agent performs planning incrementally, unless it
model parameters were treated as free parame-
observes a surprising event, in which case it re-
ters, and were manually tuned to qualitatively
plans the full policy. Practically, on every time
match the empirical observations. It was not the
steptheagenttakesthepolicychosenintheprevi-
purpose of this study to obtain the closest possi-
ous time step, disregards its first action (as it was
ble fit to human data so no exhaustive parameter
alreadyexecuted)andassumesthattheremaining
optimization was performed.
actions constitute all but the last actions of the
newpolicy.Theabovepolicyselectionmechanism
Metrics
isthenusedtogeneratethelastactionofthenew
policy. Front-to-rear scenario
Inparallelwithincrementalpolicyupdates,on
Inthisscenario,weusedthevehicletrajectoryand
everytimesteptheagentaccumulatesevidencein
driver input data to extract brake response times
favorofafullre-plan,usingtheaccumulationrate
and deceleration magnitudes. To that end, we fol-
λ:
lowed Markkula et al. [14], extracting response
E =E +λϵ . (10)
t t−1 t
22
Table 1: An overview of the most essential parameters used in the full model. For tuned parameters,
we normally only tested three to four different parameters, with the drift rate λ being the noticeable
exception.
Parameter Description Source
State transition function p(s′|s,a)
∆t=0.2s Time step size Model of routine driving [33]
4.2m×1.72m Vehicle size Matching [56]
w =3.65m Lane width Matching [56]
σ =3ms−2 Noise applied to other vehicle’s accelera- Tuned parameter
a,0
tion during belief update
σ =0.4575ms−2 Noise applied to other vehicle’s steering Tuned parameter
ω,0
rate during belief update
σ =0.6ms−2 Noise applied to other vehicle’s accelera- Tuned parameter
a
tion during behavior prediction
σ =0.0915ms−2 Noise applied to other vehicle’s steering Tuned parameter
ω
rate during behavior prediction
Observation probability p(o|s)
φ˙ =0.00215s−1 Looming threshold Taken from [42]
0
Preference function p(o)
µ =v Mean of preference distribution of agent’s Model of routine driving [33]
v 0
velocity v
σ =0.5ms−1 Standard deviation of preference distribu- Tuned parameter
v
tion of agent’s velocity v
σ =0.1ms−2 Standard deviation of preference distribu- Tuned parameter
a
tion of agent’s acceleration a
σ =0.02s−1 Standard deviation of preference distribu- Tuned parameter
ω
tion of agent’s steering rate ω
g =−15000 Pragmatic value for leaving the road Tuned parameter
LL
g =−1000 Pragmatic value for driving on a lane Tuned parameter
LC
boundary or in opposing lanes
g =−10000 Pragmatic value after collision with rela- Tuned parameter
C
tive velocity of 10ms−1
Policy selection
H =30 Prediction horizon Model of routine driving [33]
N =75 Number of particles Model of routine driving [33]
K =10 Number of iterations of policy sampling Model of routine driving [33]
M =100 Tuned parameter
β =0.1 βM samples with lowest EFE are used as Model of routine driving [33]
base for next iteration
N
(cid:0) 0,5ms−2(cid:1)
Distribution to sample accelerations a in Model of routine driving [33]
τ
first iteration from (mean) and Tuned parame-
ter (std)
N
(cid:0) 0,0.1s−1(cid:1)
Distributiontosamplesteeringratesω in Model of routine driving [33]
τ
first iteration from (mean) and Tuned parame-
ter (std)
a =−0.1ms−2 Acceleration applied when no pedal is Logical consideration
0
pressed
λ=10−5.9 Evidence accumulation drift rate Tuned parameter
23
times by fitting a piecewise-linear function to the
recorded velocity data; the brake response time
was then determined as the time instant when
the first constant line switches to one with falling
velocity. The slope of this line was used as the
estimated deceleration magnitude.
Lateral incursion scenario
In this scenario, we extracted brake and steer-
ing response times following Johnson et al. [56],
by interpolating along the acceleration a and
long
steering angle δ data to find the time at which
−1ms−2 and 0.0077rad (i.e., a steering wheel
angle of 5◦) are exceeded, to extract brake and
steering response times respectively.
Conflict of Interest
JE, MO’K, LJ and JM were employed by
Waymo LLC and conducted the research without
any external funding from third-parties. Tech-
niques discussed in this paper may be described
in U.S. Patent Application Nos. 18/614,428
and 63/657,623. Delft University of Technology
received funding from Waymo LLC for parts of
the research carried out by JFS, but JFS received
no direct financial benefit for his contributions to
the paper.
Acknowledgments
We thank Daphne Cornelisse for creating
figures 1 and 2, as well as Martijn Wisse, Todd
Hester, and Trent Victor for providing helpful
feedback on the manuscript.
Author contributions
Julian F. Schumann: Methodology, Soft-
ware, Validation, Formal analysis, Investigation,
Writing - Original Draft, Visualization. Johan
Engstr¨om: Conceptualization, Validation, Writ-
ing-OriginalDraft,Supervision,Projectadminis-
tration, Funding acquisition. Leif Johnson: For-
mal analysis, Writing - Review & Editing, Visu-
alization. Matthew O’Kelly: Writing - Review
& Editing. Joao Messias: Writing - Review &
Editing. Jens Kober: Writing - Review & Edit-
ing,Supervision.ArkadyZgonnikov:Resources,
24
Writing - Review & Editing, Supervision, Project
administration, Funding acquisition.
25
1 Supplementary Material
1.1 Active Inference Framework
Tomodelthebehaviorofhumandriversindifferentscenarios,wecombineActiveInferenceandEvidence
Accumulation. For sake of either notation, we use the shorthand of b = {b |i ∈ {1,...,B}}. Addi-
1:B i
tionally, while the predicted beliefs about states q (s ) and observations q (o ) for τ >t depend on the
(cid:101)s τ (cid:101)o τ
current belief q(s ) and the chosen policy π (sequence of planned actions), so that the correct notation
t t
would be q (s |π ,q(s )) and q (o |π ,q(s )) respectively, we will use the shorthand expressions q (s )
(cid:101)s τ t t (cid:101)o τ t t (cid:101)s τ
and q (o ) to improve readability.
(cid:101)o τ
1.1.1 Generative process and Generative model
Thebasicconceptofactiveinferenceistheideathatahumanagentdoesnotknowtheactualmechanism
underlying their surrounding world (called generative process), but instead relies on an internal model
(the so called generative model) approximating the true world. These describe how the true state of the
world(η ),astateoftheagents’beliefabouttheworld(s )),theagent’sactions(a ),andtheobservations
t t t
of the true world o at a time t interact with each other. Here, the generative process consists out of two
t
parts:
• Thetruetransitionprobabilityp(η |η ,a ).Itdescribeshowacertainactionattimetinfluencesthe
(cid:98) t+1 t t
future world state.
• The true observation probability p(o |η ). It describes how likely it is that a certain observation can
(cid:98) t t
be perceived given the current state of the world.
Meanwhile, the generative model consists out of two parts as well.
• The internal state transition probability p(s |s ,a ,θ ), which might be parameterized by θ .
t+1 t t s s
• The internal observation probability p(o |s ,θ ), which might be parameterized by θ .
t t o o
Thesecondmainideaofactiveinferenceisthatanagentisuncertainaboutitsbeliefabouttheworld
s , meaning that instead of a single values, we instead assume that the agent holds a probabilistic belief,
t
denoted by q(s ). In general, the agent could also have some uncertainty regarding the generative model
t
itself (i.e., there is a probabilistic belief q(θ) about the general model’s parameters θ = {θ ,θ }), but
o s
we will not include this assumption in favor of a computationally more efficient model. We represent
stochastic beliefs q(s ) by N =75 equally likely representative samples S =s .
t t t,1:N
Given a world with the previous state η , an belief S , and a chosen action a , we can update
t−1 t−1 t−1
those in the following way:
1. Werandomlysampleourfutureworldstateη usingthetransitionprobabilityofthegenerativeprocess:
t
η ∼p(η′|η ,a ) (A13)
t (cid:98) t−1 t−1
2. We generate the observations o that the agent makes. Under the assumption that the uncertainties
t
in the generative process are negligible compared to the uncertainties in the generative model, we use
the expected value:
o =E o′ (A14)
t p(o′|ηt)
3. We lastly have to update the internal belief of the agent. Here, using variational inference, we get:
(cid:98)
q(s )∝p(o |s ,θ )E p(s |s ,a ,θ )
t t t o q(st−1) t t−1 t−1 s
(A15)
∝p(o |s ,θ )q (s )
t t o A t
To apply this to our sample based belief representation, we first generate the updated samples
S = s that represent q (s ) and follow from the internal state transition probability
A,t A,t,1:N A t
26
p(s |s ,a ,θ ), with s ∼ p(s′|s ,a ,θ ). One can then get an explicit approximation
t t−1 t−1 s A,t,n t−1,n t−1 s
for q (s ) using a Kernel Density Estimate (KDE) based on S , which can be expressed as
A t A,t
N
1 (cid:88)
q (s )≈ N (s |s ,Σ ) . (A16)
A t t A,t,n A,t
N
n=1
At this point, with q and p(o|s) both known, one could generate the updated belief samples S with
A t
a form of the Metropolis Hastings algorithm, which is however computationally inefficient.
Instead, a faster update is possible, as long as there exists a bijective mapping L under which
p(o|s) can be expressed as a normal distribution:
p(o |s ,θ )=N (L(o )|µ(L(o ))+L(As +b),Σ(L(o )))|detJ (o )|
t t o t t t t L t
(A17)
=N (L(As +b)|L(o )−µ(L(o )),Σ(L(o )))|detJ (o )|
t t t t L t
Then, instead doing our update over s directly, we can instead do it over s =L(As +b). Namely,
L,t t
we can use a KDE to instead calculate q (s ), where with s =L(As +b) we get
L,A L,t L,A,t,n A,t,n
N
1 (cid:88)
q (s )≈ N (s |s ,Σ ) . (A18)
L,A L,t L,t L,A,t,n L,A,t
N
n=1
Substituting (A18) and (A17) then allows us to express q (s ) as a Gaussian multi mixture model,
L L,t
from which sampling S is trivial:
L,t
q(s )∝p(o |s ,θ )q (s )
t t t o A t
⇐⇒ q (s )∝N (s |L(o )−µ(L(o )),Σ(L(o )))q (s )
L L,t L,t t t t L,A L,t
N
(cid:88)
∝ ∼ N (s L,t |L(o t )−µ(L(o t )),Σ(L(o t )))N (s L,t |s L,A,t,n ,Σ L,A,t ) (A19)
n=1
N
(cid:88)
∝ ∼ w t,n N (s L,t |µ t,n ,Σ t )
n=1
with µ =L(o )−µ(L(o ))
o t t
(cid:16) (cid:17)−1
Σ = Σ−1 +Σ(L(o ))−1
t L,A,t t
(cid:16) (cid:17)
µ =Σ Σ−1 s +Σ(L(o ))−1µ (A20)
t,n t L,A,t L,A,t,n t o
(cid:18) (cid:19)
1
w ∝exp − (s −µ ) T (Σ +Σ(L(o ))) −1 (s −µ ) .
t,n L,A,t,n o L,A,t t L,A,t,n o
2
After sampling s from the GMM, we can get our final sample S = s with s =
L,t,1:N t t,1:N t,n
A−1(cid:0) L−1(s )−b (cid:1) .
L,t,n
If A is not full rank, we will have to simply assume that the distribution q(s ) orthogonally to the
t
image of A will be identical to the one in q (s ). However, it must be noted that in our simulations
A t
A will be the identity matrix.
In the update of our model, we use a time step size of ∆t=0.2s
27
1.1.2 Expected Free Energy
After the agent updates its internal belief q(s), it then has to generate a new policy π = a
t t:(t+H−1)
(with a = [π ] ) over a prediction horizon of H time steps (we use H = 30 in our implementation). In
t t 1
general active inference, it is postulated that such a plan is selected based on the minimization of the
expected free energy G, here defined using the preference function p(o):
t+H
(cid:88)
G(π |q(s ))= g(π ,q(s ),τ)
t t t t
τ=t+1
(A21)
t+H
= (cid:88) −E lnp(o )− (cid:0) H(q (o ))−E H(p(o |s ,θ )) (cid:1)
qo(oτ)pn(oτ) τ (cid:101)o τ qs(sτ) τ τ o
τ=t+1 (cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
P
(cid:101)
ragmaticvaluegpragm Epistem
(cid:101)
icvaluegepist
Here,thenormativeprobabilityp isusedtoimplementsomenorm-conditionedbeliefaboutthelikelihood
n
of observations (i.e., while some observation o
τ
might be kinematically equally likely to others in O(cid:101)τ ,
it might be perceived as less likely because it violates some norms, such as driving on the wrong side
of the road). We call this use of p an norm-conditioned particle filter. It must be noted that it could
n
be argued that such beliefs are better implemented directly in the state transition function, this would
requireamuchmoredetailedbalancingofp ,complicatingthefittingofthemodel.Therefore,forreasons
n
ofsimplicity,wechosethecurrentapproach.Meanwhile,q (s )andq (o )correspondtothebeliefsthat
(cid:101)s τ (cid:101)o τ
the agents predicts for internal states and observations when following a certain policy, with
q (s )=E p(s |s ,a ,θ )
(cid:101)s τ qs(sτ−1) τ τ−1 τ−1 s
(A22)
q (o )=E p(o |s ,θ )
(cid:101)o τ q (cid:101)s(sτ) τ τ o
We use again our sample based approach fo (cid:101) r belief representation, with S(cid:101)τ = s
τ,1:N
representing q
(cid:101)s
(s
t
)
(with s
τ,n
∼p(s′|s
τ−1,n
,a
τ−1
,θ
s
)) and O(cid:101)τ =o
τ,1:N
approximating q
(cid:101)o
(o
τ
) (where o
τ,n
∼p(o′|s
τ,n
,θ
o
)).
For the initial step of τ =t+1, we can assume that S(cid:101)t =S
t
. Based on this, one can then calculate the
expected free energy g at one timestep with
(cid:80)
p (o )lnp(o )
n τ τ
g(π
t
,q(s
t
),τ)≈−
oτ∈Oτ
(cid:80) p (o )
n τ
(cid:101)
oτ∈Oτ (A23)
 
(cid:101) 1 (cid:88)
−H(q
(cid:101)o
(o
τ
))− H(p(o′|s
τ
,θ
o
)) ,
N
sτ∈Sτ
where we use the approximation (cid:101)
H(q (o ))=H
(cid:0)E
p(o |s ,θ )
(cid:1)
(cid:101)o τ qs(sτ) τ τ o
 
1 (cid:101)(cid:88) 1 (cid:88) (A24)
=− ln p(o
τ
|s
τ
,θ
o
)
N N
oτ∈Oτ sτ∈Sτ
(cid:101) (cid:101)
To maximize G, we use the Cross Entropy Method (CEM) for model predictive control, which is an
iterative method over k ∈1,...,K with K =20:
28
1. We define a distribution p (π ) = N(π |µ ,diag(σ2 )) over the policy space, from which
π,k t t π,t,k−1 π,t,k−1
we sample the M = 100 policies π from p (π ) and calculate the respective expected free
t,k,1:M π,k t
energy (after adjusting for pedals with f ) G =G(f (π ),q(s )) (see (A23)).
real t,k,m real t,k,m t
2. We select the β =0.1∈[0,1] percent samples π with the lowest expected free energy.
t,k,1:M
3. We update our distribution, where µ and σ are the mean and standard deviation of the
π,t,k π,t,k
aforementioned βM selected best plans.
For the first iteration, we choose µ = 0, while we choose as standard deviations in σ value of
π,t,0 π,t,0
5ms−2 for accelerations a and 0.1s−1 for steering rates ω. The final policy is then selected as
(cid:32) (cid:33)
π =f argmin G(f (π ),q(s )) . (A25)
t real real t,K,m t
m∈{1,...,M}
Here, f is used to prevent unrealistically control inputs.
real
1.1.3 Evidence Accumulation
Commonly, the policy π is re-chosen at every timestep. However, research has shown that humans tend
t
to make decisions (such a changing preselected policies) only if there is enough evidence supporting such
a decision, in a process called evidence accumulation. Here, we implement this concept by having the
agent accumulate evidence E towards the need for selecting a new policy. The agent then updates its
t
policy in the following way:
1. We our previous policy π , resulting in π , with [π ] = [π ] , and only optimize the last
t−1 (cid:101)t (cid:101)t 1:H−1 t−1 2:H
needed time step [π ] with the method described in 1.1.2.
(cid:101)t H
2. We calculate the evidence for choosing a new plan based on the normalized, negative pragmatic value
(i.e., the surprise), with
t+H
(cid:88)
ϵ =ϵ(π |q(s ))=Hmax lnp(o′) − E lnp(o ,a ). (A26)
t (cid:101)t t
o′
qo(oτ) τ τ−1
τ=t+1
(cid:101)
WethenupdateouraccumulatedsurprisewithE =E +λϵ ,whereweuseadriftrateofλ=10−5.9.
t t−1 t
3. If we see that E ≥1, then we optimize the full policy π using the method described in 1.1.2, and set
t t
E =0. Otherwise, we use the continued policy π as our current policy π
t (cid:101)t t
1.2 Specific Models
While the previous section described our general framework for using active inference, this section will
detail the exact generative process and generative model we used in our scenarios.
1.2.1 State transition probability
When implementing the model, we use for the state transition function of both the generative process
and the generative model a common bicycle model B. In this, model each vehicle can be defined by
three parameters, its width d, its front length l and its rear length l . Additionally, the kinematic
f r
state of each agent then consists of its position markers x and y, its longitudinal speed v, its current
headingangleθ andsteeringangleδ (x={x,y,v,θ,δ}).Eachagentisthencontrolledbytheacceleration
a ∈ [−a ,a ] and steering rate ω ∈ [−ω ,ω ] with a = 8ms−2 and ω = 1.22s−1
long max max max max max max
29
(u={a ,ω}). One then can get the differential equation x˙ =B(x,u):
long
x˙ =vcos(θ+β)
y˙ =vsin(θ+β)
v˙ =k a
tire long
v
θ˙ = tan(k δ)cos(β)
tire
l +l
f r (A27)
(cid:40)
0 sgn(ω)sgn(δ) >1
δ˙ = ktire
ω Otherwise
(cid:18) (cid:19)
l
r
with β =arctan tan(k δ)
tire
l +l
f r
Here, we use k
tire
and δ(cid:98)to represent the limitations imposed by the tire friction:
a
max
k tire = (cid:40) (cid:114) (cid:41) (A28)
(cid:16) (cid:17)2
max a , along]2+ v2 δ
max [ lf+lr
Ineachscenario,wherewemodeltheegoagentininteractionwiththeotheragentsV ={V ,V ,...},
1 2
we then can generally find the control actions a = u and η = o = s = {x ,u |ν ∈ {ego}∪V}. We
ego ν ν
assume that the generative process is deterministic, which allows us to get the following, where f (x,u)
B
describes the usage of Heun’s methods to propagate the state forward according to equation (A27):
p(η′|η,a)=δ (cid:0) x′ −f (x ,a) (cid:1) δ (cid:0) u′ −a (cid:1)
(cid:98) ego B ego ego
(cid:89) δ(x′ −f (x ,u ))δ(u′ −u ) (A29)
ν B ν ν ν ν,preset
ν∈V
Here, the next control inputs u are predefined to allow the other vehicle to follow a prescribed
ν,preset
trajectory, which depends on the scenario (see 1.3.1 and 1.3.2). Meanwhile, some uncertainty is involved
in the generative model:
p(s′|s,a,θ )=δ (cid:0) x′ −f (x ,a) (cid:1) δ (cid:0) u′ −a (cid:1)
s ego B ego ego
(cid:89) δ(x′ −f (x ,u ))N (cid:0) u′|u ,diag(σ2) (cid:1) (A30)
ν B ν ν ν ν u
ν∈V
In our model, we assume σ =σ =[3ms−2,0.4575s−1] when updating our belief (see (A15)) and
u u,0
σ =0.2f
(cid:0)E
p (o)
(cid:1)
σ (A31)
u v qo(o) n u,0
when predicting future states during model evalua(cid:101)tion (see (A22)). Here, p is the weighting used in
n
equation (A23), with
1
f (p)= :[0,1]→[1,10] (A32)
v 2max{min{p,0.505},0.01}−0.01
being used to give the agent less certainty in its belief about the future state of the other vehicle if its
current state violates traffic norms.
30
1.2.2 Observation probability
For the generative process, we assume that observations are exact.
p(o′|η)=δ(o′−η) (A33)
(cid:98)
For the generative model meanwhile, we use a observation probability that follows the style laid out
in equation (A17). Here, we implement the looming based perception using the bijective mapping
{x ,φ}=L(x ,x ,u |a)withφ={φ,φ˙,φ¨,y ,θ ,δ ,ω },whereloomingangleφ,looming
ego ego OV OV OV OV OV OV
φ˙, and looming rate φ¨ are calculated as:
(cid:18) (cid:19)
d
φ≈2arctan
2(x −x )
OV ego
d(v cos(θ )−v )
φ˙ ≈− OV OV ego
(x −x )2+ 1d2 (A34)
OV ego 4
(cid:32) (cid:33)
d 2(x −x )(v cos(θ )−v ) 2
φ¨≈ a −a cos(θ )+ OV ego OV OV ego .
(x −x )2+ 1d2 long,ego OV OV (x −x )2+ 1d2
OV ego 4 OV ego 4
Itmustbenotedthatthismappingisaroughone-dimensionalestimateassumingthatθ ≈0.However,
ego
looming based perception update is the only used if the other agent is roughly in front of it, as it
unreasonable to assume that the ego vehicle would perceive the other vehicle directly with their eyes if
it is not in front of them. So technically, we find that:
if in the actual world state η where
(cid:40)
{x ,φ} x −x >l +l
L(o|a)=L(x ,x ,u |a)= ego OV ego r f (A35)
ego OV OV
x ,x ,u Otherwise
ego OV OV
As our state and observation states s and o overlap, in Equation (A17), we use A = I and b = 0. we
also have to implement the looming threshold, for which we use the function µ(o ). Given a looming
L
threshold of φ˙ =0.00215s−1, we can define here:
0
(cid:40)
µ (o ) (x −x >l +l )∧(|φ˙|≤φ˙ )
µ(o )= loom L OV ego r f 0 (A36)
L
0 Otherwise
with
 T
0

0
0
0
0
0

µ (o )= . (A37)
loom L φ˙

φ¨−
(xOV−xe
d
go)2+1
4
d2
a
ego

 0
0
0

0
31
(cid:16) (cid:17)
Meanwhile, we also have to define the function Σ(o )=diag σ(o ) 2 , where
L L
σ(o )={σ ,σ (o )} (A38)
L ego OV L
with
σ = (cid:8) 0.0002m,0.000001m,0.0002ms−1,0.000001,0.000001 (cid:9) (A39)
ego
and
  T






0
0
0
0
.
.
0
.
0
0
.
0
0
0
0
0
.
0
0
.
0
0
.
0
.
0
0
0
0
0
0
0
0
0
.
0
0
.
0
0
0
0
0
0
0
2
0
2
0
0
0
0
2
0
0
1
m
2
0
s
1
0
2
m
2
−
2
s
1
m
s
s
−
m
s
1
−
−
−
1
2
1
2





T
x OV −x ego <l r +l f
σ OV (o L )= 0.00002m (x OV −x ego >l r +l f )∧(|φ˙|>φ˙ 0 ) (A40)







0
0
0
.
0
0
.
0
0
.
.
0
0
0
0
.
.
0
0
0
0
0
0
0
0
.
0
0
.
.
0
0
0
4
0
.
0
0
2
0
0
4
0
3
2
0
0
0
0
0
3
s
0
2
2
0
s
s
−
2
2
s
−
−
2
1
m
−
1
1
1
2




T
(x OV −x ego >l r +l f )∧(|φ˙|≤φ˙ 0 )
1.2.3 Control limits
We also want to limit the acceleration and deceleration patterns not achievable by actual human input.
Tothisend,weusef (equation(A25)),whichinourcasewillusetwofunctions,f andf .f
real pedal jerk pedal
preventsunrealisticallyfastswitchingbetweengasandbrakepedals,bysettingforanaccelerationa :
long,τ
(cid:40)
a (a −a )(a −a )<0
0 long,τ−1 0 long,τ 0
f (a )= (A41)
pedal long,τ
a otherwise
τ
Itmustbenotedthatinourcurrentmodelweassumethattheaccelerationobservedwhenreleasingboth
pedalsisa =−0.1ms−2,toapproximatethefactthatwithneutralpedals,windandrollresistanceswill
0
lead to some decelerations.
Meanwhile, f tries to implement realistic speeds at which the pedals can be pressed and released,
jerk
by limiting the jerks applied:
f (a )=min{a +j ∆t,max{a ,a +j ∆t}} (A42)
jerk long,τ long,τ−1 min long,τ long,τ−1 max
32
For the jerk limits, we use:
(cid:40)
−5ms−3 (a −a )<0∧(a −a )>0
long,τ−1 long,τ−2 long,τ long,τ−1
j =
min −30ms−3 otherwise

0ms−3 (a −a )>0∧(a −a )<0 (A43)
(cid:40) long,τ−1 long,τ−2 long,τ long,τ−1
j max = 5ms−3 a long,τ ≥0

15ms−3 a <0
otherwise
long,τ
Both those functions are applied recursively, with
(cid:0) (cid:0) (cid:0) (cid:1)(cid:1)(cid:1)
[f (π)] =f f f [f (π)] (A44)
real τ pedal jerk pedal real τ−1
1.2.4 Preference function
We use the following preference function p when minimizing the expected free energy G (see (A23)):
p(o)= N(v |v ,σ )N(a |0,σ )N(ω |0,σ )p (y )p (o)p (o) (A45)
ego 0 v long,ego a ego ω lat ego coll safe
Here,
(cid:18) (cid:19)
w−d
p (y )=T y (y ) | ,g ,g (A46)
lat ego rel ego LC LL
2
with the triangular function T:
(cid:40) (cid:16) (cid:17)
exp |x|p |x|≤x
T(x|x
0
,p
1
,p
2
)∝ x0 1 0 (A47)
exp(p ) otherwise
2
We also need to define the collision preference p :
coll
p (o )=min{p (o ),f (o )} (A48)
coll τ coll τ−1 coll τ
This minimum is here so that all timesteps following upon a collision are still punished, as the model
itself has no collision mechanics, allowing vehicles to phase through each other. We than get the collision
preference at a single timestep f , where we have collision condition C(o) = |y −y | ≤ 1.15d∧
coll OV ego
|x −x |≤1.15(l +l ):
OV ego f r
 (cid:16) (cid:16) (cid:17)(cid:17)
 exp g C 0.2+0.8 vego−vOV 10 c m os s ( − θe 1 go−θOV) C(o)
(cid:40)
f coll (o)= 1 x OV −x ego ≤l r +l f . (A49)

N
(cid:16)
φ˙|0.2s−1,σ
(cid:17)
Otherwise
Otherwise
φ τ−1
Here, the mean for the normal distribution over τ−1 = φ˙ is taken from Markkula et al. [14]. In the
φ
collision cases (C(o)), we adjust the collision cost based on the collision speed, as it is likely that human
agents prefere to collide with lower impact velocities, if a collision cannot be avoided.
Lastly, we define p , where we mainly consider the feasibility of braking when in a car following
safe
scenario:
(cid:40) (cid:16) (cid:16) (cid:17)(cid:17)
exp 1g 0.2+0.8 vego−vOVcos(θego−θOV) C (o)∧a <−a
p (o )= 2 C 10ms−1 brake ego,req max (A50)
safe τ
1 Otherwise
33
Here, the condition C for being in a car following scenario is defined as:
brake
C (o)=(|y −y |≤1.15d)∧(x −x ≥(l +l ))∧(sgn(v )sgn(v cos(θ ))≥0) (A51)
brake OV ego OV ego f r ego OV OV
Meanwhile, a is the required deceleration applied after a reation time of t needed to avoid a
ego,req react
collision if the other vehicle suddenly started to accelerate towards/brake in front of the ego vehicle with
a =min{a ,a }.
OV,test long,OV OV,min
1 max{v ,0}2
a =− ego,react
ego,req 2max{d −1.15(l +l ),0}
ego,react f r
v =v +min{a ,0}t (A52)
ego,react ego long,ego react
(cid:18) 1 v2 (cid:19) (cid:18) 1 (cid:19)
d = x − OV − x +v t + min{a ,0}t2
ego,react OV 2a ego ego react 2 long,ego react
OV,test
The preference function can then be parameterized by the eight parameters σ = 0.5ms−1, σ =
v a
0.1ms−2, σ = 0.02s−1, σ = 0.125s−1, g = −1000, g = −5000, g = −10000, t = 1s.
ω τ−1 LC LL C react
Meanwhile, depending on the simulation, we choose a so that the given initial distance and speed
OV,min
would result in stable car following, with lower bound of a = −a = −8ms−2. Specifically, we
min max
simulateaone-lanefront-to-rearscenariowithaleadingothervehicleatconstantvelocityv formultiple
0
valuesofa .Foreachsimulation,wethenextractthesteady-statefollowingdistancethattheagent
OV,min
choseforfollowing,andthecorrespondingtimegap.Whenthengivenavelocityv anddesiredfollowing
0
distance or desired time gap, we use linear interpolation to extract the corresponding value of a
OV,min
from the given data points.
While our framework is aimed to be as generalizable as possible, there are still some changes in
between our two models. Namely, when calculating the y from equation (A52), we have to represent
rel
that in the front-to-rear scenario both lanes go in one direction, while in the lateral incursion scenario,
the left lane is designed for oncoming traffic.
1.3 Specific scenarios
1.3.1 Front-to-rear scenario
The first scenario, which models the response of a driver to the leading other vehicle suddenly braking,
contains two vehicles (V ={ego,OV}).
Initial state
In this scenario, there are 12 initial condition, with x = {0m,0m,v ,0,0} and x =
ego,0 0 OV,0
{v ∆t + l + l ,0m,v ,0,0}, with ∆t ∈ {0.5s,1.0s,1.5s,2.0s,2.5s,3.0s,3.5s} and v ∈
0 tgp,0 f r 0 tgp,0 0
{10ms−1,15ms−1,25ms−1,35ms−1}. Meanwhile, we assume a lane width w =3.65m, and vehicle sizes
of d=1.72m, l =2.1m, and l =2.1m.
f r
Other vehicles behavior
Inthisscenario,wesetu sothattheothervehiclewilldrivestraightonforexactly5s,afterwhich
OV,preset
it will start to decelerate, applying a jerk of −10ms−3 until reaching an acceleration value of −6ms−2.
It will keep this acceleration until it comes to a standstill.
34
a Steep
Markkula et al.
3.5 Simulated
3.0
2.5
2.0
0 1 2 3
]m[
ni
y
rat
b Medium c Shallow
Markkula et al. Markkula et al.
Simulated Simulated
0 1 2 3 0 1 2 3
t in [s] t in [s] t in [s]
Fig. A1: The different maneuvers by the other vehicle. The orange line represents the trajectory used
in our simulation, while the blue line corresponds to the original experiment [56]. t = 0 corresponds to
the start of the maneuver, while the horizontal velocity stays constant. Afterwards, the model continues
along a straight line with constant velocity.
.
Lateral preference
Here, we calculate the lateral relative position y from equation (A52) as:
rel

 y ego y ego ≤ w− 2 d
y rel (y ego )= w− 2 d w− 2 d <y ego ≤ w+ 2 d (A53)
y −w w+d <y
ego 2 ego
Norm conditioning
We define the normative probability p (o) (see (A23)) in the following way, that punishes moving into
n
the left lane (p=0.02) or leaving the road (p=0.01) :

 1 −w− 2 d ≤y OV ≤ w− 2 d
p n (o)= 0.02 w− 2 d ≤y OV < 3w 2 −d (A54)
0.01
Otherwise
Given the usage of p (o) as a weighing function, it is excusable to not normalize it here.
n
1.3.2 Lateral incursion scenario
The second scenario also only contains out of two vehicles (V ={ego,OV}).
Initial state
In this scenario, there is a single initial condition, with x = {0m,0m,v ,0,0} and x =
ego,0 0 OV,0
{300m,0m,v ,π,0}(theinitialvelocitiesv =17.88ms−1 correspondto40mph).Lanewidthandvehicle
0 0
size are identical to the front-to-rear scenario (see 1.3.1)
Other vehicle’s behavior
The other vehicle’s path is preprogrammed in a manner that it start turning to the left when the time
to collision ((x −x )/(v +v )) falls below 5.15s. This turn will last for 3.3s, at which point the
OV ego OV ego
othervehicle’sfrontleftcornershouldstartcrossingthecentrallanemarker,afterwhichtheothervehicle
will follow a straight path. Following [56], we run this scenario in 3 different variants, where after 5.15s
seconds, we perceive y = −0.4w (Steep incursion), y = 0m (Medium incursion), or y = 0.45w
OV OV OV
(Shallow incursion) (see Figure A1).
35
5 10 15 20
1
0
1-
2-
Velocityvego [ms− 1]
]m[
ogeynoitisoplaretaL
a b
Startingcondition
FullModel
Modelwithnonormconditioning
]1
−sm[
ogevyticoleV
02
51
01
5
0 2 4 6
1
0
1-
2-
Timet[s]
]m[
ogeynoitisoplaretaL
Fig. A2: Results in the 20 repetitions of the non-incursion scenario, for both the model with norm
conditioned particle filter (blue) and without (red). a) Change of longitudinal velocity v and lateral
ego
positiony ofsimulatedagentsovertime.b)Thekinematicstateoftheegovehicleatthepointintime
ego
when passing the oncoming other vehicle.
Lateral preference
Here, we calculate the lateral relative position y from equation (A52) as:
rel

 y ego y ego ≤ w− 2 d
y rel (y ego )= w− 2 d w− 2 d <y ego ≤ 3w 2 −d (A55)
y −w 3w−d <y
ego 2 ego
Norm conditioning
We define the normative probability p (o) (see (A23)) in the following way, that punishes moving into
n
the opposite lane (p=0.02), and punishes leaving the road even more (p=0.01) :

 1 w+ 2 d ≤y OV ≤ 3w 2 −d
p n (o)= 0.02 −w− 2 d ≤y OV < w+ 2 d (A56)
0.01
Otherwise
Given the usage of p (o) as a weighing function, it is excusable to not normalize it here.
n
1.4 Benign scenario
This is a variation of the lateral incursion scenario, where the other vehicle just drives along its lane
withoutanychangeindirectionorspeed.Specifically,westartthevehiclesataninitialdistanceof150m,
both driving with 15ms−1. Those simulations are repeated 20 times for both the full proposed model as
well as the one without the norm conditioned particle filter. As seen in Figure A2, the full model – with
one very jumpy exception – does not deviate from its desired state in response to the other agent. This
is much different in the model without norm conditioning, where the vehicles either move to the right,
36
or brake, or do both. With such behavior not very realistic in everyday driving scenarios, those results
highlighttheneedforthenorm-conditionedparticlefilter.Ofcourse,itmustbenotedthatsimilarresults
without the norm-conditioned particle filter could be achieved by simply removing the prediction noise,
but it was shown in the main text that that is essential for realistic collision avoidance behavior.
37
References
[1] J. B¨argman, V. Lisovskaja, T. Victor, C. Flannagan, M. Dozza, How does glance behavior influence
crash and injury risk? A ‘what-if’ counterfactual simulation using crashes and near-crashes from
SHRP2. Transportation Research Part F: Traffic Psychology and Behaviour 35, 152–169 (2015).
https://doi.org/10.1016/j.trf.2015.10.011. URL https://www.sciencedirect.com/science/article/pii/
S136984781500162X
[2] J. Engstr¨om, G. Markkula, Q. Xue, N. Merat, Simulating the effect of cognitive load on brak-
ing responses in lead vehicle braking scenarios. IET Intelligent Transport Systems 12(6), 427–433
(2018). https://doi.org/10.1049/iet-its.2017.0233. URLhttps://onlinelibrary.wiley.com/doi/abs/10.
1049/iet-its.2017.0233. eprint: https://onlinelibrary.wiley.com/doi/pdf/10.1049/iet-its.2017.0233
[3] G. Bianchi Piccinini, E. Lehtonen, F. Forcolin, J. Engstr¨om, D. Albers, G. Markkula, J. Lodin,
J. Sandin, How Do Drivers Respond to Silent Automation Failures? Driving Simulator Study
and Comparison of Computational Driver Braking Models. Human Factors: The Journal of
the Human Factors and Ergonomics Society 62(7), 1212–1229 (2020). https://doi.org/10.1177/
0018720819875347. URL http://journals.sagepub.com/doi/10.1177/0018720819875347
[4] N. Montali, J. Lambert, P. Mougin, A. Kuefler, N. Rhinehart, M. Li, C. Gulino, T. Emrich,
Z. Yang, S. Whiteson, B. White, D. Anguelov, The Waymo Open Sim Agents Challenge. Advances
in Neural Information Processing Systems 36, 59151–59171 (2023). URL https://proceedings.
neurips.cc/paper files/paper/2023/hash/b96ce67b2f2d45e4ab315e13a6b5b9c5-Abstract-Datasets
and Benchmarks.html
[5] P.Olleja,G.Markkula,J.B¨argman. ValidationofhumanbenchmarkmodelsforAutomatedDriving
System approval: How competent and careful are they really? (2024). https://doi.org/10.48550/
arXiv.2406.09493. URL http://arxiv.org/abs/2406.09493. ArXiv:2406.09493
[6] J. Engstr¨om, S.Y. Liu, A. Dinparastdjadid, C. Simoiu, Modeling road user response timing in nat-
uralistic traffic conflicts: A surprise-based framework. Accident Analysis & Prevention 198, 107460
(2024). https://doi.org/10.1016/j.aap.2024.107460. URL https://www.sciencedirect.com/science/
article/pii/S0001457524000058
[7] P.J.Matusz,S.Dikker,A.G.Huth,C.Perrodin,AreWeReadyforReal-worldNeuroscience? Journal
ofCognitiveNeuroscience31(3),327–338(2019). https://doi.org/10.1162/jocn e 01276. URLhttps:
//doi.org/10.1162/jocn e 01276
[8] S.G. Shamay-Tsoory, A. Mendelsohn, Real-Life Neuroscience: An Ecological Approach to Brain
and Behavior Research. Perspectives on Psychological Science 14(5), 841–859 (2019). https://doi.
org/10.1177/1745691619856350. URLhttps://doi.org/10.1177/1745691619856350. Publisher:SAGE
Publications Inc
[9] W. Carvalho, A. Lampinen. Naturalistic Computational Cognitive Science: Towards generalizable
modelsandtheoriesthatcapturethefullrangeofnaturalbehavior(2025). https://doi.org/10.48550/
arXiv.2502.20349. URL http://arxiv.org/abs/2502.20349. ArXiv:2502.20349 [q-bio]
[10] Q. Xue, G. Markkula, X. Yan, N. Merat, Using perceptual cues for brake response to a lead vehicle:
Comparing threshold and accumulator models of visual looming. Accident Analysis & Prevention
118, 114–124 (2018). https://doi.org/10.1016/j.aap.2018.06.006. URL https://linkinghub.elsevier.
com/retrieve/pii/S0001457518302239
38
[11] M. Sv¨ard, G. Markkula, J. B¨argman, T. Victor, Computational modeling of driver pre-crash brake
response, with and without off-road glances: Parameterization using real-world crashes and near-
crashes. Accident Analysis & Prevention 163, 106433 (2021). https://doi.org/10.1016/j.aap.2021.
106433. URL https://www.sciencedirect.com/science/article/pii/S0001457521004644
[12] C. Guo, X. Wang, L. Su, Y. Wang, Safety distance model for longitudinal collision avoid-
ance of logistics vehicles considering slope and road adhesion coefficient. Proceedings of the
Institution of Mechanical Engineers (2021). URL https://journals.sagepub.com/doi/full/10.1177/
0954407020959744
[13] O. Siebinga, A. Zgonnikov, D.A. Abbink, A model of dyadic merging interactions explains human
drivers’ behavior from control inputs to decisions. PNAS Nexus 3(10), pgae420 (2024). https:
//doi.org/10.1093/pnasnexus/pgae420. URL https://doi.org/10.1093/pnasnexus/pgae420
[14] G. Markkula, J. Engstr¨om, J. Lodin, J. B¨argman, T. Victor, A farewell to brake reaction times?
Kinematics-dependent brake response in naturalistic rear-end emergencies. Accident Analysis &
Prevention 95, 209–226 (2016). https://doi.org/10.1016/j.aap.2016.07.007. URL https://www.
sciencedirect.com/science/article/pii/S0001457516302366
[15] R. Wei, A.D. McDonald, A. Garcia, H. Alambeigi, Modeling Driver Responses to Automation Fail-
ures With Active Inference. IEEE Transactions on Intelligent Transportation Systems 23(10),
18064–18075 (2022). https://doi.org/10.1109/TITS.2022.3155381. URL https://ieeexplore.ieee.org/
abstract/document/9733256. Conference Name: IEEE Transactions on Intelligent Transportation
Systems
[16] T. Li, J. Kovaceva, M. Dozza, Modeling collision avoidance maneuvers for micromobility vehicles.
Journal of Safety Research 87, 232–243 (2023). https://doi.org/10.1016/j.jsr.2023.09.019. URL
https://www.sciencedirect.com/science/article/pii/S0022437523001500
[17] Y.Yuan,X.Weng,Y.Ou,K.M.Kitani,AgentFormer:Agent-AwareTransformersforSocio-Temporal
Multi-Agent Forecasting, in IEEE/CVF International Conference on Computer Vision (2021), pp.
9813–9823
[18] S. Suo, S. Regalado, S. Casas, R. Urtasun, Trafficsim: Learning to simulate realistic multi-agent
behaviors,inProceedingsoftheIEEE/CVFConferenceonComputerVisionandPatternRecognition
(2021), pp. 10400–10409
[19] T. Gu, G. Chen, J. Li, C. Lin, Y. Rao, J. Zhou, J. Lu, Stochastic Trajectory Prediction via Motion
IndeterminacyDiffusion,inProceedingsoftheIEEE/CVFConferenceonComputerVisionandPat-
ternRecognition (2022),pp.17113–17122.URLhttps://openaccess.thecvf.com/content/CVPR2022/
html/Gu Stochastic Trajectory Prediction via Motion Indeterminacy Diffusion CVPR 2022 paper.
html
[20] M. Igl, D. Kim, A. Kuefler, P. Mougin, P. Shah, K. Shiarlis, D. Anguelov, M. Palatucci, B. White,
S.Whiteson,Symphony: Learning realistic and diverse agents for autonomous driving simulation,in
2022 International Conference on Robotics and Automation (ICRA) (IEEE, 2022), pp. 2445–2451
[21] A.M´esz´aros,J.F.Schumann,J.Alonso-Mora,A.Zgonnikov,J.Kober,TrajFlow: Learning Distribu-
tionsoverTrajectoriesforHumanBehaviorPrediction,in2024IEEEIntelligentVehiclesSymposium
(IV) (Jeju, 2024)
39
[22] B. Ivanovic, G. Song, I. Gilitschenski, M. Pavone, trajdata: A Unified Interface to Mul-
tiple Human Trajectory Datasets. Advances in Neural Information Processing Systems
36, 27582–27593 (2023). URL https://proceedings.neurips.cc/paper files/paper/2023/hash/
57bb67dbe17bfb660c8c63d089ea05b9-Abstract-Datasets and Benchmarks.html
[23] J.F. Schumann, J. Kober, A. Zgonnikov, Benchmarking Behavior Prediction Models in Gap Accep-
tanceScenarios. IEEETransactionsonIntelligentVehicles8(3),2580–2591(2023). https://doi.org/
10.1109/TIV.2023.3244280
[24] K. Friston, T. FitzGerald, F. Rigoli, P. Schwartenbeck, G. Pezzulo, Active Inference: A Process
Theory. Neural Computation 29(1), 1–49 (2017). https://doi.org/10.1162/NECO a 00912. URL
https://doi.org/10.1162/NECO a 00912
[25] L. Da Costa, T. Parr, N. Sajid, S. Veselic, V. Neacsu, K. Friston, Active inference on discrete state-
spaces: a synthesis. Journal of Mathematical Psychology 99, 102447 (2020). https://doi.org/10.
1016/j.jmp.2020.102447. URL http://arxiv.org/abs/2001.07203. ArXiv:2001.07203 [q-bio]
[26] T. Parr, G. Pezzulo, K.J. Friston, Active Inference: The Free Energy Principle in Mind, Brain, and
Behavior (MIT Press, 2022). Google-Books-ID: UrZNEAAAQBAJ
[27] R. Smith, P. Badcock, K.J. Friston, Recent advances in the application of predictive coding and
active inference models within clinical neuroscience. Psychiatry and Clinical Neurosciences 75(1),
3–13 (2021). https://doi.org/10.1111/pcn.13138. URL https://onlinelibrary.wiley.com/doi/abs/10.
1111/pcn.13138. eprint: https://onlinelibrary.wiley.com/doi/pdf/10.1111/pcn.13138
[28] J. Vasil, P.B. Badcock, A. Constant, K. Friston, M.J.D. Ramstead, A World Unto Itself: Human
Communication as Active Inference. Frontiers in Psychology 11 (2020). https://doi.org/10.3389/
fpsyg.2020.00417. URL https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.
2020.00417/full. Publisher: Frontiers
[29] H. Bottemanne, K.J. Friston, An active inference account of protective behaviours during the
COVID-19 pandemic. Cognitive, Affective, & Behavioral Neuroscience 21(6), 1117–1129 (2021).
https://doi.org/10.3758/s13415-021-00947-0. URL https://doi.org/10.3758/s13415-021-00947-0
[30] D.J.Harris,T.Arthur,D.P.Broadbent,M.R.Wilson,S.J.Vine,O.R.Runswick,AnActiveInference
Account of Skilled Anticipation in Sport: Using Computational Models to Formalise Theory and
Generate New Hypotheses. Sports Medicine 52(9), 2023–2038 (2022). https://doi.org/10.1007/
s40279-022-01689-w. URL https://doi.org/10.1007/s40279-022-01689-w
[31] F.Novicky´,A.A.Meera,F.Zeldenrust,P.Lanillos. Precisionnotprediction:Body-ownershipillusion
as a consequence of online precision adaptation under Bayesian inference (2024). https://doi.org/
10.1101/2024.09.04.611162. URL http://biorxiv.org/lookup/doi/10.1101/2024.09.04.611162
[32] R. Wei, A. Garcia, A. McDonald, G. Markkula, J. Engstr¨om, I. Supeene, M. O’Kelly, World Model
Learning from Demonstrations with Active Inference: Application to Driving Behavior, in Active
Inference, ed. by C.L. Buckley, D. Cialfi, P. Lanillos, M. Ramstead, N. Sajid, H. Shimazaki, T. Ver-
belen (Springer Nature Switzerland, Cham, 2023), Communications in Computer and Information
Science, pp. 130–142. https://doi.org/10.1007/978-3-031-28719-0 9
[33] J. Engstr¨om, R. Wei, A.D. McDonald, A. Garcia, Matthew O’Kelly, L. Johnson, Resolving uncer-
tainty on the fly: modeling adaptive driving behavior as active inference. Frontiers in Neurorobotics
18 (2024). https://doi.org/10.3389/fnbot.2024.1341750. URL https://www.frontiersin.org/articles/
40
10.3389/fnbot.2024.1341750. Publisher: Frontiers
[34] D.N. Lee, A theory of visual control of braking based on information about time-to-collision.
Perception 5(4), 437–459 (1976). https://doi.org/10.1068/p050437
[35] J.J. Gibson, The Ecological Approach to Visual Perception: Classic Edition (Psychology Press, New
York, 2014). https://doi.org/10.4324/9781315740218
[36] R.D. Luce, Response times: Their role in inferring elementary mental organization (Oxford
University Press on Demand, 1986). Issue: 8
[37] J.I. Gold, M.N. Shadlen, The neural basis of decision making. Annu. Rev. Neurosci. 30(1), 535–574
(2007)
[38] R. Ratcliff, H.P. Van Dongen, Diffusion model for one-choice reaction-time tasks and the cognitive
effects of sleep deprivation. Proceedings of the National Academy of Sciences 108(27), 11285–11290
(2011)
[39] G.Markkula,Modeling driver control behavior in both routine and near-accident driving,inProceed-
ings of the human factors and ergonomics society annual meeting, vol. 58 (SAGE Publications Sage
CA: Los Angeles, CA, 2014), pp. 879–883
[40] J. Pekkanen, O. Lappi, P. Rinkkala, S. Tuhkanen, R. Frantsi, H. Summala, A computational model
fordriver’scognitivestate,visualperceptionandintermittentattentioninadistractedcarfollowing
task. Royal Society Open Science 5(9), 180194 (2018). https://doi.org/10.1098/rsos.180194. URL
https://royalsocietypublishing.org/doi/full/10.1098/rsos.180194. Publisher: Royal Society
[41] E.R. Hoffmann, Estimation of Time to Vehicle Arrival—Effects of Age on Use of Available Visual
Information. Perception 23(8), 947–955 (1994). https://doi.org/10.1068/p230947. URL https:
//doi.org/10.1068/p230947. Publisher: SAGE Publications Ltd STM
[42] D. Lamble, M. Laakso, H. Summala, Detection thresholds in car following situations and peripheral
vision:implicationsforpositioningofvisuallydemandingin-cardisplays. Ergonomics42(6),807–815
(1999). https://doi.org/10.1080/001401399185306. URL https://doi.org/10.1080/001401399185306.
Publisher: Taylor & Francis eprint: https://doi.org/10.1080/001401399185306
[43] K.P. Murphy, Machine learning: a probabilistic perspective (MIT press, 2012)
[44] H. Laurent, M. Sangnier, C. Treibich, Traffic safety and norms of compliance with rules: An
exploratory study. Economics Bulletin 41(4), 2464–2483 (2021). URL http://www.scopus.com/
inward/record.url?scp=85125263034&partnerID=8YFLogxK
[45] S. Abbas, S. Fatima, A. Sharif, S.M. Adnan, Drivers’ knowledge, attitude and practices towards
traffic rules and regulations. Journal of Road Safety 35(3), 24–31 (2024)
[46] C. Tennant, C. Neels, G. Parkhurst, P. Jones, S. Mirza, J. Stilgoe, Code, culture, and concrete:
Self-driving vehicles and the rules of the road. Frontiers in Sustainable Cities 3, 710478 (2021)
[47] A. Dinparastdjadid, I. Supeene, J. Engstrom. Measuring Surprise in the Wild (2023). https://doi.
org/10.48550/arXiv.2305.07733. URL http://arxiv.org/abs/2305.07733. ArXiv:2305.07733 [cs]
[48] P.T. de Boer, D.P. Kroese, S. Mannor, R.Y. Rubinstein, A Tutorial on the Cross-Entropy Method.
Annals of Operations Research 134(1), 19–67 (2005). https://doi.org/10.1007/s10479-005-5724-z.
41
URL https://doi.org/10.1007/s10479-005-5724-z
[49] H.A. Simon, A behavioral model of rational choice. The quarterly journal of economics pp. 99–118
(1955)
[50] H. Summala, in Modelling Driver Behaviour in Automotive Environments: Critical Issues in
Driver Interactions with Intelligent Transport Systems, ed. by P.C. Cacciabue (Springer, London,
2007), pp. 189–207. https://doi.org/10.1007/978-1-84628-618-6 11. URL https://doi.org/10.1007/
978-1-84628-618-6 11
[51] H. Oh, J.M. Beck, P. Zhu, M.A. Sommer, S. Ferrari, T. Egner, Satisficing in split-second decision
makingischaracterizedbystrategiccuediscounting. JournalofExperimentalPsychology:Learning,
Memory, and Cognition 42(12), 1937–1956 (2016). https://doi.org/10.1037/xlm0000284. Place: US
Publisher: American Psychological Association
[52] F. Callaway, B. van Opheusden, S. Gul, P. Das, P.M. Krueger, T.L. Griffiths, F. Lieder, Rational
use of cognitive resources in human planning. Nature Human Behaviour 6(8), 1112–1125 (2022).
https://doi.org/10.1038/s41562-022-01332-8
[53] J. Engstroem, Scenario criticality determines the effect of working memory load on brake response
time,inProceedings of the European Conference on Human Centred Design for Intelligent Transport
Systems (2010), pp. 25–36. URL https://trid.trb.org/View/1150568
[54] K.A.Brookhuis,G.deVries,D.deWaard,Theeffectsofmobiletelephoningondrivingperformance.
Accident Analysis & Prevention 23(4), 309–316 (1991). https://doi.org/10.1016/0001-4575(91)
90008-S. URL https://www.sciencedirect.com/science/article/pii/000145759190008S
[55] J.D. Lee, B. Caven, S. Haake, T.L. Brown, Speech-based interaction with in-vehicle computers: the
effect of speech-based e-mail on drivers’ attention to the roadway. Human Factors 43(4), 631–640
(2001). https://doi.org/10.1518/001872001775870340
[56] L. Johnson, J. Engstr¨om, A. Srinivasan, I. O¨zturk, G. Markkula, Looking for an out: Affordances,
uncertainty and collision avoidance behavior of human drivers (2025). URL https://arxiv.org/abs/
2505.14842
[57] M. Br¨annstr¨om, E. Coelingh, J. Sj¨oberg, Decision-making on when to brake and when to steer to
avoid a collision. International Journal of Vehicle Safety 7(1), 87–106 (2014). https://doi.org/
10.1504/IJVS.2014.058243. URL https://www.inderscienceonline.com/doi/full/10.1504/IJVS.2014.
058243. Publisher: Inderscience Publishers
[58] V. Venkatraman, J.D. Lee, C.W. Schwarz, Steer or Brake?: Modeling Drivers’ Collision-Avoidance
BehaviorbyUsingPerceptualCues. TransportationResearchRecord2602(1),97–103(2016). https:
//doi.org/10.3141/2602-12. URL https://doi.org/10.3141/2602-12. Publisher: SAGE Publications
Inc
[59] M. Hu, Y. Liao, W. Wang, G. Li, B. Cheng, F. Chen, Decision Tree-Based Maneuver Prediction for
DriverRear-EndRisk-AvoidanceBehaviorsinCut-InScenarios.JournalofAdvancedTransportation
2017, e7170358 (2017). https://doi.org/10.1155/2017/7170358. URL https://www.hindawi.com/
journals/jat/2017/7170358/. Publisher: Hindawi
[60] A.Sarkar,J.S.Hickman,A.D.McDonald,W.Huang,T.Vogelpohl,G.Markkula,Steeringorbraking
avoidanceresponseinSHRP2rear-endcrashesandnear-crashes:Adecisiontreeapproach. Accident
Analysis & Prevention 154, 106055 (2021). https://doi.org/10.1016/j.aap.2021.106055. URL https:
42
//www.sciencedirect.com/science/article/pii/S0001457521000865
[61] M.L. Aust, J. Engstr¨om, M. Vistr¨om, Effects of forward collision warning and repeated event expo-
sure on emergency braking. Transportation Research Part F: Traffic Psychology and Behaviour
18, 34–46 (2013). https://doi.org/10.1016/j.trf.2012.12.010. URL https://www.sciencedirect.com/
science/article/pii/S1369847813000065
[62] A.D. McDonald, H. Alambeigi, J. Engstr¨om, G. Markkula, T. Vogelpohl, J. Dunne, N. Yuma,
Toward Computational Simulations of Behavior During Automated Driving Takeovers: A Review
of the Empirical and Modeling Literatures. Human Factors 61(4), 642–688 (2019). https://doi.
org/10.1177/0018720819829572. URLhttps://doi.org/10.1177/0018720819829572. Publisher:SAGE
Publications Inc
[63] K.D. Kusano, H.C. Gabler, Safety Benefits of Forward Collision Warning, Brake Assist, and
Autonomous Braking Systems in Rear-End Collisions. IEEE Transactions on Intelligent Trans-
portation Systems 13(4), 1546–1555 (2012). https://doi.org/10.1109/TITS.2012.2191542. URL
https://ieeexplore.ieee.org/abstract/document/6180219. Conference Name: IEEE Transactions on
Intelligent Transportation Systems
[64] M. Sv¨ard, G. Markkula, J. Engstr¨om, F. Granum, J. B¨argman, A quantitative driver model of
pre-crash brake onset and control, in Proceedings of the Human Factors and Ergonomics Society
Annual Meeting, vol. 61 (2017), pp. 339–343. https://doi.org/10.1177/1541931213601565. URL
https://cir.nii.ac.jp/crid/1360294647862811264. Publisher: SAGE Publications
[65] A.Fries,F.Fahrenkrog,K.Donauer,M.Mai,F.Raisch,Driver behavior model for the safety assess-
ment of automated driving, in 2022 IEEE Intelligent Vehicles Symposium (IV) (IEEE, 2022), pp.
1669–1674
[66] A.Fries,L.Lemberg,F.Fahrenkrog,M.Mai,A.Das,Modelingdriverbehaviorincriticaltrafficsce-
nariosforthesafetyassessmentofautomateddriving. TrafficInjuryPrevention24(sup1),S105–S110
(2023). https://doi.org/10.1080/15389588.2023.2211187. URL https://doi.org/10.1080/15389588.
2023.2211187. Publisher: Taylor & Francis eprint: https://doi.org/10.1080/15389588.2023.2211187
[67] L.F.A. de Oliveira, L. Schories, L. Brostek, M. Meywerk, Simulation-Based Evaluation of a Generic
Autonomous Emergency Braking System Using a Cognitive Pedestrian Behavior Model, in 27th
International Technical Conference on the Enhanced Safety of Vehicles (ESV) (2023). URL https:
//trid.trb.org/View/2211669. Number: 23-0217
[68] C. R¨ossert, J. Drever, L. Brostek. Cognitive behavior model replicates road user response timing
in naturalistic rear-end traffic conflicts (2024). https://doi.org/10.31219/osf.io/su5kt. URL https:
//osf.io/su5kt
[69] C. Hubmann, M. Becker, D. Althoff, D. Lenz, C. Stiller, Decision making for autonomous driving
considering interaction and uncertain prediction of surrounding vehicles, in 2017 IEEE intelligent
vehicles symposium (IV) (IEEE, 2017), pp. 1671–1678
[70] S.Brechtel,T.Gindele,R.Dillmann,Probabilisticdecision-makingunderuncertaintyforautonomous
driving using continuous POMDPs, in 17th International IEEE Conference on Intelligent Trans-
portation Systems (ITSC) (2014), pp. 392–399. https://doi.org/10.1109/ITSC.2014.6957722
[71] M.Bouton, A.Cosgun, M.J.Kochenderfer, Belief state planning for autonomously navigating urban
intersections, in 2017 IEEE Intelligent Vehicles Symposium (IV) (IEEE, 2017), pp. 825–830
43
[72] J. Pekkanen, O.T. Giles, Y.M. Lee, R. Madigan, T. Daimon, N. Merat, G. Markkula, Variable-Drift
Diffusion Models of Pedestrian Road-Crossing Decisions. Computational Brain & Behavior 5(1),
60–80 (2022). https://doi.org/10.1007/s42113-021-00116-z
[73] A. Zgonnikov, D. Abbink, G. Markkula, Should I Stay or Should I Go? Cognitive Modeling of Left-
Turn Gap Acceptance Decisions in Human Drivers. Human Factors p. 00187208221144561 (2022).
https://doi.org/10.1177/00187208221144561. URL https://doi.org/10.1177/00187208221144561.
Publisher: SAGE Publications Inc
[74] J.F.Schumann,A.R.Srinivasan,J.Kober,G.Markkula,A.Zgonnikov,Using Models Based on Cog-
nitive Theory to Predict Human Behavior in Traffic: A Case Study,in2023 IEEE 26th International
Conference on Intelligent Transportation Systems (ITSC) (2023), pp. 5870–5875. https://doi.org/
10.1109/ITSC57777.2023.10421837. URL https://ieeexplore.ieee.org/abstract/document/10421837.
ISSN: 2153-0017
[75] T.H.B. FitzGerald, P. Schwartenbeck, M. Moutoussis, R.J. Dolan, K. Friston, Active Inference,
Evidence Accumulation, and the Urn Task. Neural Computation 27(2), 306–328 (2015). https:
//doi.org/10.1162/NECO a 00699. URL https://doi.org/10.1162/NECO a 00699
[76] F.J. Varela, E. Thompson, E. Rosch, The embodied mind, revised edition: Cognitive science and
human experience (MIT press, 2017)
[77] E. Thompson, Mind in life: Biology, phenomenology, and the sciences of mind (Harvard University
Press, 2010)
[78] K. Friston, Life as we know it. Journal of The Royal Society Interface 10(86), 20130475 (2013).
https://doi.org/10.1098/rsif.2013.0475. URL https://royalsocietypublishing.org/doi/full/10.1098/
rsif.2013.0475. Publisher: Royal Society
[79] E.D. Paolo, E. Thompson, R. Beer, Laying down a forking path: Tensions between enaction and
the free energy principle. Philosophy and the Mind Sciences 3 (2022). https://doi.org/10.33735/
phimisci.2022.9187. URLhttps://philosophymindscience.org/index.php/phimisci/article/view/9187
[80] J. Kiverstein, M.D. Kirchhoff, T. Froese, The Problem of Meaning: The Free Energy Princi-
ple and Artificial Agency. Frontiers in Neurorobotics 16 (2022). https://doi.org/10.3389/fnbot.
2022.844773.URLhttps://www.frontiersin.org/journals/neurorobotics/articles/10.3389/fnbot.2022.
844773/full. Publisher: Frontiers
[81] K. Friston, in Affordances in Everyday Life: A Multidisciplinary Collection of Essays, ed. by
Z.Djebbara(SpringerInternationalPublishing,Cham,2022),pp.211–219. https://doi.org/10.1007/
978-3-031-08629-8 20. URL https://doi.org/10.1007/978-3-031-08629-8 20
[82] M.J.D. Ramstead, in Affordances in Everyday Life: A Multidisciplinary Collection of Essays, ed.
by Z. Djebbara (Springer International Publishing, Cham, 2022), pp. 193–202. https://doi.org/10.
1007/978-3-031-08629-8 18. URL https://doi.org/10.1007/978-3-031-08629-8 18
[83] P. Calvo, K. Friston, Predicting green: really radical (plant) predictive processing. Journal of The
Royal Society Interface 14(131), 20170096 (2017). https://doi.org/10.1098/rsif.2017.0096. URL
https://royalsocietypublishing.org/doi/10.1098/rsif.2017.0096. Publisher: Royal Society
[84] T. Van de Maele, B. Dhoedt, T. Verbelen, G. Pezzulo, A hierarchical active inference model of
spatial alternation tasks and the hippocampal-prefrontal circuit. Nature Communications 15(1),
9892 (2024). https://doi.org/10.1038/s41467-024-54257-3. URL https://www.nature.com/articles/
44
s41467-024-54257-3. Publisher: Nature Publishing Group
[85] N. Kastel, C. Hesp, K.R. Ridderinkhof, K.J. Friston, Small steps for mankind: Modeling the emer-
gence of cumulative culture from joint active inference communication. Frontiers in Neurorobotics
16 (2023). https://doi.org/10.3389/fnbot.2022.944986. URL https://www.frontiersin.org/journals/
neurorobotics/articles/10.3389/fnbot.2022.944986/full. Publisher: Frontiers
[86] R.Wei,A.D.McDonald,A.Garcia,G.Markkula,J.Engstrom,M.O’Kelly.Anactiveinferencemodel
of car following: Advantages and applications (2023). https://doi.org/10.48550/arXiv.2303.15201.
URL http://arxiv.org/abs/2303.15201. ArXiv:2303.15201 [cs]
[87] K. Friston, L. Da Costa, D. Hafner, C. Hesp, T. Parr, Sophisticated inference. Neural Computation
33(3), 713–763 (2021)
[88] A. Chohan, G.J. Savelsbergh, P. Van Kampen, M. Wind, M.H. Verheul, Postural adjustments and
bearing angle use in interceptive actions. Experimental brain research 171, 47–55 (2006)
[89] R. Wei, J. Lee, S. Wakayama, A. Tschantz, C. Heins, C. Buckley, J. Carenbauer, H. Thiruvengada,
M. Albarracin, M.d. Prado, P. Horling, P. Winzell, R. Rajagopal. Navigation under uncertainty:
Trajectory prediction and occlusion reasoning with switching dynamical systems (2024). https:
//doi.org/10.48550/arXiv.2410.10653. URL http://arxiv.org/abs/2410.10653. ArXiv:2410.10653
[90] T. Salzmann, B. Ivanovic, P. Chakravarty, M. Pavone, Trajectron++: Dynamically-Feasible Trajec-
tory Forecasting with Heterogeneous Data, in Computer Vision – ECCV 2020 (Cham, 2020), pp.
683–700. https://doi.org/10.1007/978-3-030-58523-5 40
[91] K.Mangalam,Y.An,H.Girase,J.Malik,FromGoals,Waypoints&PathstoLongTermHumanTra-
jectory Forecasting, in Proceedings of the IEEE/CVF International Conference on Computer Vision
(2021),pp.15233–15242. URLhttps://openaccess.thecvf.com/content/ICCV2021/html/Mangalam
From Goals Waypoints Paths to Long Term Human Trajectory ICCV 2021 paper.html
[92] R. Girgis, F. Golemo, F. Codevilla, M. Weiss, J.A. D’Souza, S.E. Kahou, F. Heide,
C. Pal, LATENT VARIABLE SEQUENTIAL SET TRANSFORMERS FOR JOINT MULTI-
AGENT MOTION PREDICTION, in 10th International Conference on Learning Rep-
resentations, ICLR 2022 (2022). URL https://collaborate.princeton.edu/en/publications/
latent-variable-sequential-set-transformers-for-joint-multi-agent
[93] S. Shi, L. Jiang, D. Dai, B. Schiele, Motion Transformer with Global Intention Localiza-
tion and Local Movement Refinement. Advances in Neural Information Processing Sys-
tems 35, 6531–6543 (2022). URL https://proceedings.neurips.cc/paper files/paper/2022/hash/
2ab47c960bfee4f86dfc362f26ad066a-Abstract-Conference.html
[94] N. Nayakanti, R. Al-Rfou, A. Zhou, K. Goel, K.S. Refaat, B. Sapp, Wayformer: Motion Forecasting
via Simple & Efficient Attention Networks, in 2023 IEEE International Conference on Robotics and
Automation (ICRA) (2023), pp. 2980–2987. https://doi.org/10.1109/ICRA48891.2023.10160609.
URL https://ieeexplore.ieee.org/abstract/document/10160609
[95] P. Lanillos, C. Meo, C. Pezzato, A.A. Meera, M. Baioumy, W. Ohata, A. Tschantz, B. Millidge,
M. Wisse, C.L. Buckley, J. Tani. Active Inference in Robotics and Artificial Agents: Survey and
Challenges (2021). https://doi.org/10.48550/arXiv.2112.01871. URL http://arxiv.org/abs/2112.
01871. ArXiv:2112.01871 [cs]
45
[96] P.Mazzaglia,T.Verbelen,O.C¸atal,B.Dhoedt,TheFreeEnergyPrincipleforPerceptionandAction:
A Deep Learning Perspective. Entropy 24(2), 301 (2022). https://doi.org/10.3390/e24020301.
URL https://www.mdpi.com/1099-4300/24/2/301. Number: 2 Publisher: Multidisciplinary Digital
Publishing Institute
[97] M.P. Deisenroth, A.A. Faisal, C.S. Ong, Mathematics for Machine Learning (Cambridge University
Press, 2020). Google-Books-ID: pFjPDwAAQBAJ
[98] J. Fischer, O.S. Tas, Information Particle Filter Tree: An Online Algorithm for POMDPs with
Belief-Based Rewards on Continuous Domains, in Proceedings of the 37th International Conference
on Machine Learning (PMLR, 2020), pp. 3177–3187. URL https://proceedings.mlr.press/v119/
fischer20a.html. ISSN: 2640-3498
[99] P.Polack,F.Altch´e,B.d’Andr´eaNovel,A.deLaFortelle,Thekinematicbicyclemodel:Aconsistent
model for planning feasible trajectories for autonomous vehicles?, in 2017 IEEE Intelligent Vehicles
Symposium (IV) (2017), pp. 812–818. https://doi.org/10.1109/IVS.2017.7995816. URL https://
ieeexplore.ieee.org/abstract/document/7995816
46

=== INSTRUCTIONS ===

0. PROFESSIONAL TONE REQUIREMENTS:
   - Begin directly with the paper title or content - NO conversational openings
   - Do NOT use phrases like: 'Okay, here's...', 'Here's a summary...',
     'Let me summarize...', 'I'll extract...', or similar conversational language
   - Start immediately with substantive content in formal academic tone
   - Example BAD: 'Okay, here's a summary of the paper...'
   - Example GOOD: 'This paper investigates [topic]...'

1. Start with exact title: "Active inference as a unified model of collision avoidance behavior in human drivers"

2. EXTRACT QUOTES:
   - Extract 10-15 direct quotes from the paper that support key claims
   - QUOTE EXTRACTION AND FORMATTING:
     * Extract quotes VERBATIM from the paper text - do NOT modify or "correct" them
     * Extract quotes exactly as they appear in the source text
     * Preserve all aspects of the quote exactly as written, including spacing
     * Use proper quotation marks: "quote text" (double quotes)
     * CRITICAL: Only extract quotes that actually appear in the paper text
     * Do NOT generate, invent, or "fix" quotes - extract them exactly as written
   - QUOTE FORMATTING STANDARD:
     * Attribution format: 'The authors state: "quote text"' OR 'According to the paper: "quote text"'
     * Vary attribution phrases to avoid repetition (use: 'The authors state', 'They note',
       'The paper argues', 'According to the research', 'The study demonstrates')
     * Include section context when available: 'In the Introduction, the authors state: "quote text"'
     * Ensure proper spacing around quotes and punctuation
   - Search the full paper text to find relevant quotes
   - Each quote must be verbatim from the paper text (with spacing normalized)

3. IDENTIFY CLAIMS:
   - Identify the main claims and arguments made by the authors
   - State each claim clearly and support it with quotes from the paper
   - Distinguish between primary claims and supporting arguments

4. SUMMARIZE KEY FINDINGS:
   - Summarize the key findings with specific numbers, metrics, and results
   - Include quantitative data: percentages, statistics, measurements
   - Extract numerical results from the results section
   - Present findings with supporting evidence from the paper

5. DESCRIBE METHODS:
   - Describe the methodology, experimental setup, and approach used
   - Include details about: algorithms, procedures, experimental design
   - Explain how the research was conducted
   - Extract specific methodological details from the methods section

6. PRESENT RESULTS:
   - Present the results with quantitative data and statistical significance
   - Include specific numbers, tables, figures mentioned in the paper
   - Extract results from the results section with exact values
   - Support results with quotes or data from the paper

7. NO REPETITION - CRITICAL REQUIREMENT (ENHANCED):
   - CRITICAL: Before writing EACH sentence, check: 'Have I already said this exact idea?'
   - If you've already stated an idea, DO NOT repeat it - move to the next unique point
   - Each sentence must be COMPLETELY UNIQUE - no duplicate ideas, even with different words
   - Each claim appears EXACTLY ONCE - if you've stated it, move to the next unique point
   - Each paragraph must be COMPLETELY UNIQUE - no duplicate paragraphs
   - Do NOT repeat the same sentence, even with slight variations or word changes
   - Do NOT repeat paragraphs or sections - each section must have unique content
   - Each claim should appear only ONCE in the entire summary
   - Vary attribution phrases: use 'The authors state', 'They note', 'The paper argues',
     'According to the research', 'The study demonstrates' - do NOT repeat the same phrase
   - If you find yourself writing similar content, STOP immediately and write something completely different
   - Before each sentence, ask: 'Have I already said this?' If yes, write something new
   - Vary your language: use synonyms, different sentence structures, different perspectives
   - REPETITION CHECKLIST: After writing each sentence, verify it's not a duplicate of any previous sentence

   EXAMPLES OF WHAT NOT TO DO:
   ❌ BAD: 'The authors state: "X". The authors state: "Y". The authors state: "Z".'
   ✅ GOOD: 'The authors state: "X". They further note: "Y". The paper argues: "Z".'

   ❌ BAD: Repeating the same claim 3+ times with slight variations
   ✅ GOOD: State each claim once, then move to the next unique point

8. STRUCTURE:
   - Use markdown headers: ### Overview, ### Methodology, ### Results, ### Discussion
   - Target length: 1000-1500 words
   - Ensure all requested elements (quotes, claims, findings, methods, results) are included
