=== IMPORTANT: ISOLATE THIS PAPER ===
You are summarizing ONLY the paper below. Do NOT reference or use content from any other papers.
Do NOT mix information from different papers. Only use information from THIS specific paper.

Paper Title: Evaluation of "As-Intended" Vehicle Dynamics using the Active Inference Framework
Citation Key: kidera2025evaluation
Authors: Kazuharu Kidera, Takuma Miyaguchi, Hideyoshi Yanagisawa

REMEMBER: Extract quotes, claims, and findings ONLY from the paper text provided below.

Year: 2025

Key Terms: vehicle, energy, free, dynamics, performance, inference, framework, active, evaluation, intended

=== FULL PAPER TEXT ===

Evaluation of â€œAs-Intendedâ€ Vehicle Dynamics using the
Active Inference Framework
Kazuharu Kidera1[0009-0008-8969-6468], Takuma Miyaguchi2[0009-0006-6229-4317],
and Hideyoshi Yanagisawa2[0000-0002-0175-7537]
1 Honda R&D Co., Ltd., 4630 Shimotakanezawa, Haga-machi, Haga-gun, Tochigi 321-3393,
Japan
2 The University of Tokyo, 7-3-1 Hongo, Bunkyo-ku, Tokyo 113-8656, Japan
kazuharu_kidera@jp.honda
Abstract. We constructed a computational model of the driverâ€™s brain for steer-
ing tasks using the active inference framework, grounded in the free energy prin-
cipleâ€”a theory from computational neuroscience. This model enables quantita-
tive estimation of how accurately the brain learns vehicle dynamics and performs
appropriate steering, using a measure called variational free energy. Through
driving simulator experiments, we observed strong correlations between varia-
tional free energy and both expert driversâ€™ subjective â€œas-intendedâ€ scores and
general participantsâ€™ objective control performance. These results suggest that
variational free energy provides a promising quantitative metric for evaluating
whether a vehicle behaves â€œas-intended.â€
Keywords: Free energy principle, Active inference, Vehicle dynamics.
1 Introduction
1.1 Research Objective
In the development of vehicle dynamics performance, static design parameters are typ-
ically set based on accumulated experience and established engineering theories. Basic
performance is then validated using physically measurable or simulation-based dy-
namic indicators, such as steering response [1]. However, the final adjustment of these
parameters still relies heavily on subjective evaluations by expert driversâ€”assessments
that are often neither objective nor quantitative. A fundamental question remains: what
does it truly mean for a driver to operate a vehicle â€œas-intendedâ€? We address this issue
by applying the free energy principle [2] and active inference [3]â€”neuroscientific the-
oriesâ€”as a novel approach to understanding and evaluating â€œas-intendedâ€ control.
1.2 Free Energy Principle and Active Inference
The free energy principle is a theory that explains the brain's perception, learning, and
action in a unified manner. By interacting with the external environment through the
2 K. Kidera, T. Miyaguchi, and H. Yanagisawa
body, the brain constructs a model of the world known as the generative model. The
process of building this model corresponds to learning and action, while perception is
realized as Bayesian inference through the model. These processes are achieved by
minimizing a quantity called variational free energy (VFE), which represents the mod-
eling error [3].
Active inference builds on this principle by providing a theoretical framework for
planning actions to achieve goals while continuously updating the generative model
[3]. It can be implemented in a simulation environment. By modeling driver behavior
within this framework, the modeling error of vehicle dynamics in the driverâ€™s brain can
be quantified as VFE (see Fig. 1, modified from [3]).
Fig. 1. A conceptual illustration of how perception and action minimize VFE, a measure of the
discrepancy between the brainâ€™s generative model and the external world.
2 Methodology
2.1 Computational Model of the Brain in Steering Tasks
This study focuses on a steering task involving a car traveling at a constant speed of
100 km/h. Vehicle dynamics were simulated using CarSim, developed by Mechanical
Simulation Corporation, now part of Applied Intuition, Inc. [4]. The driving course, 10
meters wide, includes three cornersâ€”left, right, and leftâ€”and a straight section. The
objective is to follow the centerline as closely as possible. Fig. 2 shows both the layout
of this course and the configuration of the driving simulator used in the experiment for
this study. The CarSim model incorporates complex dynamics such as tire nonlinearity,
mechanical friction, and stroke velocity-dependent damping, capturing realistic char-
acteristics of vehicle behavior.
The first step involves constructing a self-learning driving behavior model using the
active inference framework. This enables the simulation of information processing that
occurs in the driverâ€™s brain. Since the vehicle dynamics are too complex to describe
analytically, we adopted a discrete-time active inference model, which avoids the need
for explicit motion and observation equations. In this framework, the generative model
is formulated as a partially observable Markov decision process (POMDP) based on
mean-field approximation, as illustrated in Fig. 3 [3, 5]. It represents how the hidden
state vectorâ€”representing the firing states of neuronal populationsâ€”evolves over time
as a probability distribution. The tensors and vectors used in this generative model are
summarized in Table 1.
Evaluating Vehicle Dynamics with Active Inference 3
Fig. 2. Top-down view of the driving course and simulator setup used to evaluate â€œas-intendedâ€
vehicle control.
Fig. 3. The active inference framework consisting of: 1. Observation, 2. inference of hidden
states, 3. evaluation of policies, 4. action selection, and 5. learning.
Table 1. Components of the generative model in the active inference framework.
Component Descriptions and Configurations
One-hot vectors representing specific observed values, with the following di-
mensions for each modality:
- modality[0]: Lateral deviation from the centerline at 15 m ahead (âˆ’10
to +10 m, 64 bins)
Observation
- modality[1]: Area error with respect to the centerline up to 15 m ahead
ğ‘œ
ğœ
(âˆ’160 to +160 mÂ², 64 bins)
- modality[2]: Steering angle (âˆ’120 to +120 deg, 49 bins)
- modality[3]: Steering torque feedback (âˆ’30 to +30 Nm, 64 bins)
- modality[4]: Vehicle yaw rate (âˆ’40 to +40 deg./s, 64 bins)
- modality[5]: Vehicle lateral acceleration (âˆ’1.6 to +1.6 G, 64 bins)
Categorical distribution with the following dimension:
Hidden state
ğ‘  ğœ - factor[0]: 36
Equation of Observation
Equation of
Motion
4. A ctions: External
Sam ple actions from probability distribution over policies. environm ent
(favoring those m ost likely to achieve the desired observation C or to gain useful inform
3. C alculate E xpected F ree E nergy (E F E ):
C alculate E FE for each policy.
1. Input:
O btain observations
and actions.
Observation
Observation
Observation time step
2. M inim ization of V ariational F ree E nergy (V F E ): Action Infer hidden state.
ation)
5. L earning:
D irichlet distributions are accum and B tensors. ulated in A
4 K. Kidera, T. Miyaguchi, and H. Yanagisawa
For each modality, the mapping from hidden states to observations has the fol-
lowing matrix dimensions:
- modality[0]: 64 Ã— 36
- modality[1]: 64 Ã— 36
Likelihood
- modality[2]: 49 Ã— 36
ğ´
- modality[3]: 64 Ã— 36
- modality[4]: 64 Ã— 36
- modality[5]: 64 Ã— 36
Each matrix is column-normalized and filled with uniform values.
The state transition tensor has the following dimension:
- factor[0]: 36 Ã— 36 Ã— 49
State transition
Here, 49 corresponds to the action (steering angle) dimension. Each matrix
ğµ
slice corresponding to an action is column-normalized and filled with uniform val-
ues.
Preferences are defined for the following three modalities (the others are set as
uniform categorical distributions):
- modality[0]: Normal distribution with a mean of 0 m and a standard
Preference deviation equivalent to 0.5 m
ğ¶ - modality[1]: Normal distribution with a mean of 0 mÂ² and a standard
deviation equivalent to 8 mÂ²
- modality[3]: Normal distribution with a mean of 0 Nm and a standard
deviation equivalent to 15 Nm
Categorical distribution with the following dimension:
Initial state - factor[0]: 36
ğ· Initialized with a sigmoid-shaped distribution to provide a better starting point
for learning than a random distribution.
In this study, we used the JAX version of pymdp [6], an open-source Python library for
active inference that supports large-scale tensor operations and parallel computing via
Googleâ€™s JAX [7]. We integrated pymdp, which implements the computational model
of the brain and runs on WSL (Windows Subsystem for Linux), with CarSim, which
represents the external environment and runs on MATLAB Simulink. Communication
from CarSim to pymdp over a local Ethernet connection corresponds to sensory nerve
signals, while communication in the opposite direction corresponds to motor nerve sig-
nals that control the steering angle. The cycle of the POMDP for the steering task was
set to 25 Hz as a representative frequency, since a single frequency had to be chosen.
Although this choice was initially based on assumptions about the timescale of motor
and sensory processing, its validity is examined through the experimental results in this
study. Interestingly, a study by a game developer suggests that the brain processes in-
formation during gameplay at 25â€“33.3 Hz [8].
Inference of hidden states, corresponding to the recognition process, was performed
by minimizing VFE using marginal message passing (MMP) over the past 32 time steps
of observations (approximately 1.3 seconds of sensory memory). MMP is regarded as
Evaluating Vehicle Dynamics with Active Inference 5
one of the most promising variational inference algorithms in active inference [9]. The
VFE of a policy ğœ‹ (i.e., a sequence of actions), denoted as ğ¹ , is defined as follows [3]:
ğœ‹
ğ¹ ğ· [ğ‘„(ğ‘ Ìƒ|ğœ‹)||ğ‘ƒ(ğ‘œÌƒ,ğ‘ Ìƒ|ğœ‹)](1)
ğœ‹ ğ¾ğ¿
In discrete-time active inference, the ğ¹ at time step ğœ is computed using MMP as [3]:
ğœ‹
1
ğ‘­ ğ’” âˆ™(ğ‘™ğ‘›ğ’” âˆ’ğ‘™ğ‘›ğ‘¨âˆ™ğ‘œ âˆ’ (ğ‘™ğ‘›(ğ‘© ğ’” )+ğ‘™ğ‘›(ğ‘©â€  ğ’” )))( )
ğœ‹ğœ ğœ‹ğœ ğœ‹ğœ ğœ ğœ‹ğœ ğœ‹ğœâˆ’1 ğœ‹ğœ+1 ğœ‹ğœ+1
In active inference, the expected free energy (EFE) is computed for each policy, a soft-
max function is applied to obtain a probability distribution over policies, and an ac-
tionâ€”steering angle in this caseâ€”is selected from this distribution [3]. EFE can be
expressed in various mathematical forms, but one formulation represents it as the sum
of an epistemic value term (exploration), a pragmatic value term (exploitation), and a
novelty term, as shown in Equation (3) [3].
ğº(ğœ‹) âˆ’ğ¸ [ğ· [ğ‘„(ğ‘ Ìƒ|Ï€,ğ‘œÌƒ)||ğ‘„(ğ‘ Ìƒ|ğœ‹ )]]
ğ‘„(ğ‘œÌƒ|ğœ‹) ğ¾ğ¿
âˆ’ğ¸ [ğ‘™ğ‘›ğ‘ƒ(ğ‘œÌƒ|ğ¶)]âˆ’ğ¸ [ğ· [ğ‘„(ğœƒ|ğ‘œÌƒ,ğ‘ Ìƒ)||ğ‘„(ğœƒ )]](3)
ğ‘„(ğ‘œÌƒ|ğœ‹) ğ‘„Ìƒ(ğ‘œÌƒ,ğ‘ Ìƒ|ğœ‹) ğ¾ğ¿
Learning in the generative model follows the update rules given in Equation (4) for the
A tensor, B tensor, and D vector [3].
ğ’‚ ğ‘+âˆ‘ğ‘œ âŠ—ğ’”
ğœ ğœ
ğœ
ğ’ƒ ğ‘ +âˆ‘ğ’” âŠ—ğ’”
ğœ‹ğœ ğœ‹ğœ ğœ‹ğœ ğœ‹ğœâˆ’1
ğœ
ğ’… ğ‘‘+ğ’” (4)
1
With the above task setting and generative model, simulation confirmed that autono-
mous learning of the steering task was possible. Starting from a state where both the A
and B tensors were flat, actions were generated through active inference, enabling the
generative model (i.e., the computational model of the brain) to learn, much like an
actual human would. During learning, steering behavior was initially random, and the
vehicle frequently went off course due to a lack of knowledge about driving operations
or vehicle dynamics. After several dozen trials, the generative model began to partially
follow the target trajectory (the centerline), and after approximately 50 to 150 trials, it
was able to complete the course while staying close to it. This progression reflects a
typical pattern in active inference: initial dominance of the novelty term in EFE, fol-
lowed by state exploration and eventual exploitation.
2.2 Hypothesis
During online learning, we found that VFE increases with greater deviation from the
centerline and decreases as the deviation decreases (see Fig. 4). Fig. 1 illustrates that
when VFE is low, the vehicleâ€™s behavior is predictable; when it is high, it becomes
unpredictable. This unpredictability reduces the accuracy of action selectionâ€”steering
6 K. Kidera, T. Miyaguchi, and H. Yanagisawa
in this task. Consequently, deviation from the centerline is closely linked to VFE. Since
the desired observations (C vector) are not used in computing VFE, this relationship is
a non-trivial finding demonstrated through simulation.
Hypothesis: Lower VFE reflects a higher degree of â€œas-intendedâ€ control in the
steering task.
Fig. 4. Time-series plot of lateral deviation from the centerline and VFE during online learning
of the steering task. Higher VFE is associated with greater deviation.
2.3 Verification of Hypothesis through Offline Learning
In this paper, we refer to autonomous learning using the active inference framework, as
described in Section 2.1, as online learning. Offline learning is also possible using ob-
servation and action data from a computer-controlled or human driver, without using
policy-based actions from EFE. As shown in Fig. 3 and Equation (4), the A, B, and D
parameters of the generative model can be learned by sequentially inputting observation
data, with the appropriate B matrix selected based on the actions.
We validated this offline approach using the course in Fig. 2 (excluding the initial
9-second straight section, added as a lead-in segment for the simulator), 12 CarSim
vehicle models, and the Simulink driver model, which controls steering based on ob-
servation modalities 0 and 1 (Table 1). Fig. 5 shows the time-averaged VFE in the final
trial after 15 learning iterations per vehicle. While the driver model follows the center-
line reasonably well across all vehicles, the average VFE shows clear and systematic
differences, reflecting each vehicleâ€™s specifications and dynamics. This supports the
hypothesis in Section 2.2.
Fig. 6 shows time-series data for the vehicles with the lowest and highest average
VFE. The course includes straight sections and corners with different radii. VFE rises
in transitional regions where the vehicle transitions between straight and curved seg-
ments, indicating non-steady-state motion. In the low-VFE vehicle, corrective steering
is minimal and observations transition smoothly. In contrast, the high-VFE vehicle
shows significant corrective steering and large fluctuations during the same transitions.
Evaluating Vehicle Dynamics with Active Inference 7
Fig. 5. Time-averaged VFE obtained through offline learning using the Simulink driver model
for 12 CarSim vehicle models. Vehicle parameters and dynamic characteristics generally consid-
ered favorable to handling are shown in deeper blue; unfavorable ones are shown in deeper red.
Fig. 6. Time-series plots of observations for each modality in Table 1. The right side displays the
VFE over time in the final trial and the progression of time-averaged VFE over 15 trials.
In the active inference framework, this can be interpreted as follows. The brain learns
both the frequency of co-occurrence between observations and hidden states at each
V ehicle m odel
D rive System
W eight [kg]
Y aw Inertia [kg m ^2]
W heelbase [m m ]
A verage of track w idths [m m ]
C enter of G ravity H eight[m m ]
Steering ratio
G ain [dB] Steeringâ€“Y aw R ate
R esponse @ 0.2H z Phase [deg.]
G ain [dB] Steeringâ€“Lateral A ccel.
R esponse @ 0.2H z Phase [deg.]
C ar Sim precom puted average V FE [nat]
5
de ] 4 t t u an pm [ 3 E o F ce V 2 rp e m g 1 a i r S e r v a 0 a C
A -C lass H atchback
FF
750
750
2350
1395
540
22.9
-6.16
-11.1
-32.6
-24.0
3.13
A-Class
Hatchback
B-C lass H atchback
FF
1110
1343.1
2600
1482.5
540
17.8
-7.98
-5.22
-34.3
-14.0
2.95
B-Class
Hatchback
B-C lass SportsC ar
FR
1020
1020
2330
1482.5
375
17.9
-6.88
-3.01
-33.1
-9.87
2.98
B-Class
SportsCar
C -C lass H atchback
FF
1270
1536.7
2910
1675
540
19.9
-10.1
-3.15
-36.3
-9.18
2.82
C-Class
Hatchback
D -C lass Sedan
FF
1370
2315.3
2866
1550
520
17.6
-8.26
-6.82
-34.9
-15.4
3.30
D-Class
Sedan
D -C lass M inivan
FF
1800
3528
3000
1640
700
21.04
-13.6
-2.96
-39.9
-11.4
3.96
D-Class
M inivan
D -C lass SU V
4W D
1430
2059.2
2660
1565
650
17
-12.0
0.015
-38.6
-12.1
4.24
D-Class
SUV
E-C lass Sedan
4W D
1650
3234
3050
1600
530
16.2
-11.5
-1.31
-37.8
-9.25
3.02
E-Class
Sedan
E-C lass SU V
4W D
1590
2687.1
2950
1575
720
19.7
-12.4
-2.25
-39.1
-12.7
3.40
E-Class
SUV
Exotic SportsC ar
4W D
1360
1065.2
2650
1625
375
15.6
-3.65
0.121
N /A
N /A
2.50
Exotic
SportsCar
F-C lass Sedan
4W D
1820
4095
3160
1605
590
19.2
-12.8
-1.82
-39.1
-7.03
2.62
F-Class
Sedan
Full Size SU V
4W D
2257
3524.9
3140
1737.5
781
18
-11.9
-3.03
-38.3
-14.1
3.81
Full Size
SUV
8 K. Kidera, T. Miyaguchi, and H. Yanagisawa
time step, and the transitions between hidden states over time, as described in Equation
(4). When these relationships become complexâ€”as in vehicles with high VFEâ€”the
modeling error of the generative model (i.e., VFE) tends to increase. In such cases,
achieving â€œas-intendedâ€ steering is expected to be extremely difficult for humans. The
following sections experimentally verify this hypothesis.
3 Experimental Verification
3.1 Experimental Conditions
To verify the hypothesis presented in Section 2.2, we conducted an experiment. It was
approved by the Life Ethics Committee of Honda R&D Co., Ltd. (Committee number:
100HM-041H) and the Ethics Review Committee of the Graduate School of Engineer-
ing, The University of Tokyo (Approval number: KE24-76).
Participants drove the course using CarSim on a simple simulator (see Fig. 2), with
the 12 vehicle models listed in Fig. 5. They were instructed to steer as close to the
centerline as possible. Vehicle speed was fixed at 100 km/h in CarSim, so throttle and
brake were not used. The course took 39 seconds to complete.
Each vehicle was driven five times on the course. The first two runs were excluded
due to unstable driving during familiarization and difficulty in obtaining stable offline
VFE. The remaining three trials were used for analysis. To ensure data reliability, 15
off-course trials were also excluded from the 300 total, in the case of the 60 general
participants described later.
All trial data from each participantâ€™s successive runs were used for continuous of-
fline learning, ensuring that the calculated VFE reflected their full experience. The A
tensor, B tensor, and D vector listed in Table 1 were initialized only once per participant
at the beginning, and continuous learning then followed Equation (4).
Before the experiment, all participants were given instructions originally provided
in Japanese and translated into English for this paper. They were told that the purpose
of the experiment was to evaluate whether the car behaves â€œas-intendedâ€ when the
driver has a specific intention. Driving along the centerline was used to provide a com-
mon intention among participants. However, precision was not defined, as participants
had varying levels of driving skill, making it unrealistic to demand uniform accuracy.
After each run, participants performed sensory evaluations by rating how "as-in-
tended" they felt the car behaved. Participants were asked the following questions:
â€¢ Please score how "as-intended" you felt the car was during the previous trial. The
degree of "as-intended" refers to the extent to which the car behaved as you intended.
â€¢ 0: Not at all "as-intended", 10: Completely "as-intended" (11-point Likert scale)
The evaluation focused on the perceived behavior of the car, not the participantsâ€™ driv-
ing skills. Participants included:
1. One professional expert driver with extensive experience in vehicle development.
2. Sixty general participants holding Japanese driver's licenses.
Evaluating Vehicle Dynamics with Active Inference 9
The expert driverâ€™s evaluations were considered reliable, whereas those by general par-
ticipants were potentially less so. Accordingly, the expert driver evaluated all 12 vehi-
cles in a random order specified by the experimenter. Each general participant drove
one vehicle randomly assigned by the experimenter, and only the evaluation for that
vehicle was used for analysis. Five participants were assigned to each vehicle model,
ensuring balanced driving experience across models.
3.2 Results of the Experiment by Expert Driver
Fig. 7 (left) shows the relationship between the expert driverâ€™s â€œas-intendedâ€ scores and
the average VFE obtained through offline learning using the CarSim Simulink driverâ€™s
data (hereafter, CarSim precomputed average VFE; see Fig. 5). A strong negative cor-
relation was found (r=-0.80, p<0.001), strongly supporting the hypothesis in Section
2.2. Fig. 7 (right) shows the same relationship using the expert driverâ€™s own driving
data, which also revealed a relatively strong negative correlation (r=-0.67, p<0.001),
further reinforcing the hypothesis.
Fig. 7. Relationship between â€œas-intendedâ€ scores and average VFE values. Left: VFE from
CarSim Simulink driver. Right: VFE from expert driverâ€™s own data.
The slightly weaker correlation in the expert driverâ€™s own data (r=-0.67), compared to
the CarSim data (r=-0.80), may partly reflect the influence of learning order: offline
learning for the expert driver was performed continuously across all vehicles, whereas
the CarSim data were learned independently for each vehicle. The stronger correlation
with the CarSim data suggests that the expert driverâ€™s â€œas-intendedâ€ scores were based
on an absolute internal standard, unaffected by the driving order.
As shown in Fig. 8 (left), the expert driver exhibited almost no variation in control
performanceâ€”measured as the time-averaged distance from the centerlineâ€”across dif-
ferent vehicle models, despite variations in the CarSim precomputed average VFE. The
expert driverâ€™s steering control was comparable to that of the Simulink driver, which
likely underlies the strong correlations in Fig. 7 (left) and suggests that control perfor-
mance does not determine the â€œas-intendedâ€ score.
Fig. 8 (middle) suggests that the expert driver may have based their â€œas-intendedâ€
scores on the amount of corrective steering required. Vehicles with higher CarSim pre-
computed average VFE required greater corrective steering, as quantified by the time-
averaged magnitude of steering angle components above a 1.27 Hz cutoff frequency,
]-[erocs
"dednetni-sa"
109876543210
2
C
2.5
arS im p
3
reco m p u ted
3.5
averag
R
e
Â² = 0.6342
4
V F E [n at]
4.5
]-[erocs
"dednetni-sa"
109876543210
4 6
averag e V F E fro
8m
d rivin g
R Â² = 0.4479
10
d ata [n at]
12
10 K. Kidera, T. Miyaguchi, and H. Yanagisawa
extracted using a washout filter. This measure showed a strong positive correlation with
VFE (r=0.88, p<0.001). Furthermore, as shown in Fig. 8 (right), this corrective steering
effort exhibited a strong negative correlation with the â€œas-intendedâ€ score (r =-0.79,
p<0.001). These results suggest that the expert driver, either consciously or uncon-
sciously, perceived task difficulty and adjusted their steering effort accordingly.
1.4
1.2
1
0.8
0.6 RÂ² = 0.0358
0.4
0.2
0
2 2.5 3 3.5 4 4.5
Fig. 8. Relationships between CarSim precomputed average VFE, control performance, correc-
tive steering, and â€œas-intendedâ€ score in the expert driver.
3.3 Results of the Experiment by 60 General Participants
Fig. 9 (left) shows the relationship between average VFE from offline learning of each
participantâ€™s driving data and their control performance, based on data from 60 general
participants. A strong positive correlation was found (r=0.78, p<0.001). Fig. 9 (right)
shows the relationship between the same VFE and the amount of corrective steering,
with a relatively strong correlation (r=0.65, p<0.001). These results strongly support
the hypothesis in Section 2.2.
Fig. 9. Relationship between average VFE from offline learning of participant driving data and
control performance (left) or corrective steering (right) in 60 general participants.
In contrast, Fig. 10 (left) shows the relationship between the CarSim precomputed av-
erage VFE and the â€œas-intendedâ€ scores given by general participants (r=-0.02,
p=0.746). Fig. 10 (right) shows the relationship between the same scores and the aver-
age VFE obtained through offline learning from each participantâ€™s driving data (r=-
0.28, p<0.002). Neither figure shows a clear correlation, unlike the results with the ex-
pert driver. In Fig. 10 (left), the horizontal axis represents different vehicle models, and
the â€œas-intendedâ€ scores varied widely among general participantsâ€”even for the same
]m[ecnamrofrep
lortnoc
6
5
4 RÂ² = 0.7777
3
2
1
0
2 2.5 3 3.5 4 4.5
CarSim precomputed averageVFE[nat]
].ged[gnireets
evitcerroc
6
5
4
3
2 RÂ² = 0.6253
1
0
0 2 4 6 8 10
CarSim precomputed averageVFE[nat]
].ged[gnireets
evitcerroc
"as-intended" score[-]
1.4 6
ec ]m n a [ m ro
frep
lortno
c
1 0
0
0
0
. .
.
.
.
6
2
2 8
4
1 RÂ² = 0.6146 ].g g e n d ir [ eets
evitcerro
c
5 4 3
2
1
RÂ² = 0.4168
0 0
4 6 8 10 12 4 6 8 10 12
averageVFE from driving data [nat] averageVFE from driving data [nat]
Evaluating Vehicle Dynamics with Active Inference 11
vehicle. This variation was observed not only across participants, but also within the
same participant across repeated trials.
Fig. 10. Relationships between â€œas-intendedâ€ scores and average VFE in 60 general participants.
Fig. 11 further illustrates this issue. Fig. 11 (left) shows the relationship between Car-
Sim precomputed average VFE and control performance among 60 general partici-
pants. The variation in control performance among participants is as large as or larger
than that due to vehicle model differences. The resulting weak correlation (r=0.18,
p<0.019) suggests that control performance is unlikely to be an indicator of the â€œas-
intendedâ€ score. Fig. 11 (middle) shows a moderate correlation between CarSim pre-
computed average VFE and corrective steering (r=0.49, p<0.001). However, Fig. 11
(right) shows that corrective steering is also not a strong determinant of the â€œas-in-
tendedâ€ score (r=-0.33, p<0.001). Unlike the expert driver, general participants showed
no clear basis for their â€œas-intendedâ€ evaluations, leading to widely varying scores.
Fig. 11. Relationships between CarSim precomputed average VFE, control performance, correc-
tive steering, and â€œas-intendedâ€ score in 60 general participants.
4 Discussion
Traditionally, â€œas-intendedâ€ controllability has been evaluated through subjective as-
sessments by expert drivers using simulators or real vehicles. We confirmed that, while
general participants showed variability in their evaluations, the expert driverâ€™s assess-
ments consistently aligned with objective indicators such as corrective steering. This is
analogous to wine tasting: trained sommeliers can evaluate reliably, whereas this is
difficult for general consumers. Accordingly, we provided an explicit intention (to fol-
low the centerline as closely as possible) and ensured objective evaluation of â€œas-
]-[erocs
"dednetni-sa"
109876543210
R
2
Â² = 0.0006
2.5
C arS im p
3
reco m p u ted
3.5
averag e V F E
4
[n at]
4.5
]-[erocs
"dednetni-sa"
109876543210
4 6
averag e V F E fro
8m
d rivin g d
R
10
ata [n at]
Â² = 0.0794
12
1.4
1.2
1 RÂ² = 0.0309
0.8
0.6
0.4
0.2
0
2 2.5 3 3.5 4 4.5
]m[ecnamrofrep
lortnoc
6
5
4
RÂ² = 0.2428
3
2
1
0
2 2.5 3 3.5 4 4.5
CarSim precomputed averageVFE[nat]
].ged[gnireets
evitcerroc
6
5
4
RÂ² = 0.1078
3
2
1
0
0 2 4 6 8 10
CarSim precomputed averageVFE[nat]
].ged[gnireets
evitcerroc
"as-intended" score[-]
12 K. Kidera, T. Miyaguchi, and H. Yanagisawa
intendedâ€ via control performance and corrective steering, even if general participants
could not consciously judge it.
In this study, we introduced a novel methodology. By defining a specific task (e.g.,
a steering task), constructing a computational model of the brain capable of online
learning within the active inference framework, and calculating VFE through offline
learning using existing data, we demonstrated that the resulting VFE values correlate
strongly with both reliable subjective â€œas-intendedâ€ scores and objective indicators
(e.g., control performance or corrective steering).
These findings support the hypothesis that lower VFE reflects a higher degree of
â€œas-intendedâ€ controllability. They also suggest that VFE values obtained through of-
fline learning using simulation data can quantify this controllability and potentially
serve as a proxy for expert driversâ€™ subjective â€œas-intendedâ€ scores.
Ideally, VFE values should be derived from online learning within the active infer-
ence framework. However, we found that the learning outcomes were sensitive to fac-
tors such as the random seed used in action selection based on EFE, as well as the D
vector. This sensitivity made it difficult to obtain stable and consistent VFE values for
vehicle evaluation. It remains unclear whether this limitation arises from the framework
itself or from the specific design of the generative model. Further studies are needed to
clarify this issue.
5 Conclusion
Based on the methodology introduced and experimentally validated in this study, we
conclude that, regardless of individual differences in driving skill or variations in vehi-
cle dynamics, the modeling error of vehicle dynamics learned in the driverâ€™s brainâ€”
represented by VFEâ€”plays a critical role in determining whether the driver can steer
the vehicle â€œas-intendedâ€ from an objective standpoint.
These findings strongly support the theoretical perspective underlying active infer-
ence, which holds that the brain learns by accumulating statistical regularities in sen-
sory inputs and acts through probabilistic inference. Furthermore, this study presents a
novel approach to the long-standing challenge of quantitatively evaluating and under-
standing "as-intended" control in vehicle dynamics.
Importantly, the offline learning approach proposed in this study is not limited to
simulation or simulator dataâ€”it can also be applied to real-world driving data. This
enables consistent and objective evaluation of â€œas-intendedâ€ controllability regardless
of the evaluator. Notably, the ability to perform such evaluations using only simulation
data offers a clear advantage in the early stages of vehicle dynamics design. Future
research will aim to extend this approach to real-world applications.
Acknowledgments. This study was initiated by Honda R&D Co., Ltd. in collaboration with The
University of Tokyo. We would like to thank all participants in the driving experiments. We
would also like to express our sincere appreciation to the pymdp development team for their
timely completion and release of the JAX version in response to our request, which significantly
contributed to the implementation of our simulation framework.
Evaluating Vehicle Dynamics with Active Inference 13
Disclosure of Interests. Kazuharu Kidera is employed by Honda R&D Co., Ltd. The other au-
thors declare no competing interests.
References
1. Tao, M., Sugimachi, T., Suda, Y., Shibata, K., Katou, D., Fukaya, T.: A study on vehicle
dynamics characteristics that realize â€œas-intendedâ€ driving. Trans. Soc. Automot. Eng. Jpn.
48(6), 1265â€“1271 (2017) (in Japanese). https://doi.org/10.11351/jsaeronbun.48.1265
2. Friston, K.: The free-energy principle: a unified brain theory? Nat. Rev. Neurosci. 11(2),
127â€“138 (2010). https://doi.org/10.1038/nrn2787
3. Parr, T., Pezzulo, G., Friston, K.J.: Active Inference: The Free Energy Principle in Mind,
Brain, and Behavior. MIT Press, Cambridge (2022). https://doi.org/10.7551/mit-
press/12441.001.0001
4. Applied Intuition: CarSim. https://www.appliedintuition.com/products/carsim, last accessed
2025/05/16
5. Smith, R., Friston, K.J., Whyte, C.J.: A step-by-step tutorial on active inference and its ap-
plication to empirical data. J. Math. Psychol. 107, 102632 (2022).
https://doi.org/10.1016/j.jmp.2021.102632
6. Heins, C., Millidge, B., Demekas, D., Klein, B., Friston, K., Couzin, I.D., et al.: pymdp: A
Python library for active inference in discrete state spaces. J. Open Source Softw. 7(73),
4098 (2022). https://doi.org/10.21105/joss.04098
7. Bradbury, J., Frostig, R., Hawkins, P., Johnson, M.J., Leary, C., Maclaurin, D., et al.: JAX:
composable transformations of Python+NumPy programs. https://github.com/google/jax,
last accessed 2025/05/16
8. CEDEC Digital Library: Brainwave frequency bands and information processing speed dur-
ing gameplay. https://cedil.cesa.or.jp/cedil_sessions/view/2146 (in Japanese), last accessed
2025/05/16
9. Parr, T., Markovic, D., Kiebel, S.J., Friston, K.J.: Neuronal message passing using Mean-
field, Bethe, and Marginal approximations. Sci. Rep. 9(1), 1889 (2019).
https://doi.org/10.1038/s41598-018-38246-3

=== INSTRUCTIONS ===

0. PROFESSIONAL TONE REQUIREMENTS:
   - Begin directly with the paper title or content - NO conversational openings
   - Do NOT use phrases like: 'Okay, here's...', 'Here's a summary...',
     'Let me summarize...', 'I'll extract...', or similar conversational language
   - Start immediately with substantive content in formal academic tone
   - Example BAD: 'Okay, here's a summary of the paper...'
   - Example GOOD: 'This paper investigates [topic]...'

1. Start with exact title: "Evaluation of "As-Intended" Vehicle Dynamics using the Active Inference Framework"

2. EXTRACT QUOTES:
   - Extract 10-15 direct quotes from the paper that support key claims
   - QUOTE EXTRACTION AND FORMATTING:
     * Extract quotes VERBATIM from the paper text - do NOT modify or "correct" them
     * Extract quotes exactly as they appear in the source text
     * Preserve all aspects of the quote exactly as written, including spacing
     * Use proper quotation marks: "quote text" (double quotes)
     * CRITICAL: Only extract quotes that actually appear in the paper text
     * Do NOT generate, invent, or "fix" quotes - extract them exactly as written
   - QUOTE FORMATTING STANDARD:
     * Attribution format: 'The authors state: "quote text"' OR 'According to the paper: "quote text"'
     * Vary attribution phrases to avoid repetition (use: 'The authors state', 'They note',
       'The paper argues', 'According to the research', 'The study demonstrates')
     * Include section context when available: 'In the Introduction, the authors state: "quote text"'
     * Ensure proper spacing around quotes and punctuation
   - Search the full paper text to find relevant quotes
   - Each quote must be verbatim from the paper text (with spacing normalized)

3. IDENTIFY CLAIMS:
   - Identify the main claims and arguments made by the authors
   - State each claim clearly and support it with quotes from the paper
   - Distinguish between primary claims and supporting arguments

4. SUMMARIZE KEY FINDINGS:
   - Summarize the key findings with specific numbers, metrics, and results
   - Include quantitative data: percentages, statistics, measurements
   - Extract numerical results from the results section
   - Present findings with supporting evidence from the paper

5. DESCRIBE METHODS:
   - Describe the methodology, experimental setup, and approach used
   - Include details about: algorithms, procedures, experimental design
   - Explain how the research was conducted
   - Extract specific methodological details from the methods section

6. PRESENT RESULTS:
   - Present the results with quantitative data and statistical significance
   - Include specific numbers, tables, figures mentioned in the paper
   - Extract results from the results section with exact values
   - Support results with quotes or data from the paper

7. NO REPETITION - CRITICAL REQUIREMENT (ENHANCED):
   - CRITICAL: Before writing EACH sentence, check: 'Have I already said this exact idea?'
   - If you've already stated an idea, DO NOT repeat it - move to the next unique point
   - Each sentence must be COMPLETELY UNIQUE - no duplicate ideas, even with different words
   - Each claim appears EXACTLY ONCE - if you've stated it, move to the next unique point
   - Each paragraph must be COMPLETELY UNIQUE - no duplicate paragraphs
   - Do NOT repeat the same sentence, even with slight variations or word changes
   - Do NOT repeat paragraphs or sections - each section must have unique content
   - Each claim should appear only ONCE in the entire summary
   - Vary attribution phrases: use 'The authors state', 'They note', 'The paper argues',
     'According to the research', 'The study demonstrates' - do NOT repeat the same phrase
   - If you find yourself writing similar content, STOP immediately and write something completely different
   - Before each sentence, ask: 'Have I already said this?' If yes, write something new
   - Vary your language: use synonyms, different sentence structures, different perspectives
   - REPETITION CHECKLIST: After writing each sentence, verify it's not a duplicate of any previous sentence

   EXAMPLES OF WHAT NOT TO DO:
   âŒ BAD: 'The authors state: "X". The authors state: "Y". The authors state: "Z".'
   âœ… GOOD: 'The authors state: "X". They further note: "Y". The paper argues: "Z".'

   âŒ BAD: Repeating the same claim 3+ times with slight variations
   âœ… GOOD: State each claim once, then move to the next unique point

8. STRUCTURE:
   - Use markdown headers: ### Overview, ### Methodology, ### Results, ### Discussion
   - Target length: 1000-1500 words
   - Ensure all requested elements (quotes, claims, findings, methods, results) are included
