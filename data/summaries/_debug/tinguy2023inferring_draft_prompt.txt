=== IMPORTANT: ISOLATE THIS PAPER ===
You are summarizing ONLY the paper below. Do NOT reference or use content from any other papers.
Do NOT mix information from different papers. Only use information from THIS specific paper.

Paper Title: Inferring Hierarchical Structure in Multi-Room Maze Environments
Citation Key: tinguy2023inferring
Authors: Daria de Tinguy, Toon Van de Maele, Tim Verbelen

REMEMBER: Extract quotes, claims, and findings ONLY from the paper text provided below.

Year: 2023

Abstract: Cognitive maps play a crucial role in facilitat-
ingflexiblebehaviourbyrepresentingspatialand
conceptualrelationshipswithinanenvironment.
Theabilitytolearnandinfertheunderlyingstruc-
ture of the environment is crucial for effective
exploration and navigation. This paper intro-
duces a hierarchical active inference model ad-
dressingthechallengeofinferringstructureinthe
worldfrompixel-basedobservations. Wepropose
a three-layer hierarchical model consisting of a
cognitivemap,anallocentric,andanego...

Key Terms: inferring, abstract, crucial, environments, structure, maze, hierarchical, model, room, multi

=== FULL PAPER TEXT ===

Inferring Hierarchical Structure
in Multi-Room Maze Environments
DariadeTinguy1 ToonVandeMaele1 TimVerbelen2 BartDhoedt1
Abstract
Cognitive maps play a crucial role in facilitat-
ingflexiblebehaviourbyrepresentingspatialand
conceptualrelationshipswithinanenvironment.
Theabilitytolearnandinfertheunderlyingstruc-
ture of the environment is crucial for effective
exploration and navigation. This paper intro-
duces a hierarchical active inference model ad-
dressingthechallengeofinferringstructureinthe
worldfrompixel-basedobservations. Wepropose
a three-layer hierarchical model consisting of a
cognitivemap,anallocentric,andanegocentric
worldmodel,combiningcuriosity-drivenexplo-
Figure1.Exampleofa3×3roomsmini-gridenvironmentand
rationwithgoal-orientedbehaviouratthediffer-
ourmodelnavigationinitduringanexplorationandgoal-reaching
entlevelsofreasoningfromcontexttoplaceto
task, where the starting position is the red triangle. Noise on
motion. Thisallowsforefficientexplorationand
thevisualisedpathwasaddedinpost-processingforobserving
goal-directedsearchinroom-structuredmini-grid superposedvisitsonasingletile.
environments.
Neacsu et al. (2022) presents a deep hierarchical model
basedonactiveinferenceandcastsstructurelearningasa
1.Introduction
Bayesianmodelreductionproblem. Stoianovetal.(2022)
Understanding and navigating through complex environ- introduces a hierarchical generative model learning and
ments is a fundamental capability for intelligent agents. recognisingmazestructuresbasedonspecificlocalisationin
Traditionalapproachesrelyonmetricalortopologicalmaps aglobalprefixedframe. Whileallthesegenerativemodels
toguideagentmovement. However,inorderforanagentto aimtocapturetheunderlyingstructureanddynamicsofthe
betrulyautonomous,itmustpossesstheabilitytolearnand world,thesearetypicallylimitedtosmallsimulationswith
adapttoitssurroundings. Inordertounderstandacomplex discretestateandobservationspaces.
andpossiblyaliasedworldandnavigateinit,bothspatial
Addressing this aspect, recent approaches like G-SLAM
hierarchy,i.e. capturingspatialstructuresandrelationships,
(Safronetal.,2021)andDreamer(Hafneretal.,2020)use
andtemporalhierarchyarerequiredtoplanlong-termnavi-
deepneuralnetworkstolearngenerativeworldmodelsfrom
gationschemes.
high-dimensionalobservationssuchaspixels. However,as
Severalapproacheshavebeenproposedtolearnthestructure thesecapturetheworldinaflatlatentstatespace,thesemod-
of the world in the context of navigation. George et al. elsstrugglewithlong-termplanning,especiallyinaliased
(2021) proposes a clone structured graph representation environments.
of the environment to disambiguate aliased observations.
This paper proposes a pixel-based hierarchical model ex-
*Equalcontribution 1DepartmentofInformationTechnology, hibitingbothspatialandtemporalhierarchies. Themodelis
University of Ghent, Ghent, Belgium 2Verses AI, Vancouver, gearedtowardslearningthestructureofmazemini-gridenvi-
Canada.Correspondenceto:DariadeTinguy<Daria.detinguyat ronments(Chevalier-Boisvertetal.,2018). Amazeconsists
ugent.be>.
ofinterconnected,visuallysimilarroomswithvariationsin
shape,size,andcolourasdepictedinFig1.Withinthemaze,
Proceedings of the 40th International Conference on Machine
Learning,Honolulu,Hawaii,USA.PMLR202,2023.Copyright thereisonewhitegoaltile,whichtheagentmustfind. Our
2023bytheauthor(s). modelconsistsofamortisedinferencemodelsatthelower
3202
nuJ
32
]IA.sc[
1v64531.6032:viXra
InferringHierarchicalStructureinMulti-RoomMazeEnvironments
Figure2.Theleftshowsthegraphicalmodelofthe3-layerhierarchicalActiveinferencemodelconsistingofa)thecognitivemap,b)the
allocentricmodel,andc)theegocentricmodel,eachoperatingatadifferenttimescale.Theorangecirclesrepresentlatentstatesthathave
tobeinferred,thebluecirclesdenoteobservableoutcomesandthewhitecirclesarerandomvariablestobeinferredbyplanning.Theright
partvisualisestherepresentationateachlayer.Thecognitivemapisrepresentedasd)atopologicalgraphcomposedofallthelocations
(l)andtheirconnections,inwhicheachlocationisstoredinadistinctnode. Theallocentricmodele)infersplacerepresentations(z)
byintegratingsequencesofobservations(s)andposes(p),fromwhichtheroomstructurecanbegenerated. Theegocentricmodelf)
imaginesfutureobservationsgiventhecurrentposition,state(s),andpossibleactions(a).Hereo)depictsanactualobservation(o)and
thepredictedobservationsofthepossibleactionslefti),forwardii),andrightiii).
levels, which are trained on pixel data, for representing withrespecttomodelparametersinlearningandwithre-
movementandposeinegocentricresp. allocentricreference specttoactioninplanning(Fristonetal.,2016;Kaplan&
frames,combinedwithagraph-structuredmodelatthetop Friston,2017).
tocapturethemazestructure.Themodelnavigationisbased
Weproposeahierarchicalgenerativemodelconsistingof
onaprincipledactiveinferenceapproach,whichbalances
three layers functioning at nested timescales (see Fig 2).
goal-directedbehaviourandepistemicforagingthroughin-
Fromtoptobottom: thecognitivemap,creatingacoherent
formationgain(Fristonetal.,2016).Moreover,theplanning
topologicalmap,theallocentricmodel,representingspace,
happensatdifferenttemporaltimescalesateachlevelinthe
andtheegocentricmodel,managingmotions. Thestructure
hierarchy,allowingforlong-termdecision-making.
oftheenvironmentisinferredovertimebyagglomerating
visualobservationsintorepresentationsofdistinctplaces
2.Method (e.g. rooms)athigherlevelsdiscoveringtheconnectivity
structureofthemazeasagraph.
Theactiveinferenceframework(Parretal.,2022)isbuilt
on the premise that intelligent agents minimise their sur- Thecognitivemap: Thetoplayerinthegenerativemodel,
prise. Anactiveinferenceagententailsaninternalgener- illustratedinFig2afunctionsatthecoarsesttimescale(T),
ativemodelaimingtobestexplainthecausesofexternal eachtickatthistimescalecorrespondstoadistinctlocation
observationandtheconsequencesofitsactionsthroughthe (l )integratingtheinitialpositions(pT)oftheplace(zT).
T 0
minimisationofsurpriseorpredictionerror,whichisalso Theselocationsaredepictedasnodesinatopologicalgraph,
knownasfreeenergy(FE).Agentsminimisethisquantity as shown in Fig 2d. Edges between nodes are added as
InferringHierarchicalStructureinMulti-RoomMazeEnvironments
theagentmovesfromonelocationtoanother,effectively highest level, navigate within the rooms at the mid-level,
learningthemazestructure. Inordertomaintainthespatial andexecuteactionsseamlesslyatthelowlevel.
structure between locations, the agent keeps track of its
ThecompletegenerativemodelisformalisedinAppendixB,
relativerotationandtranslationusingacontinuousattractor
for which we parameterise the likelihood, transition, and
network (CAN) as in (Milford et al., 2004). Hence the
approximateposteriormappingsoftheallocentricandego-
cognitivemapformsacomprehensiverepresentationofthe
centriclevelsusingdeepneuralnetworks. Thesearetrained
environment,enablingtheagenttonavigatebyformulating
on a dataset of pixel observations collected by sampling
believesoveritssurroundings.
randomactionsina3by3roomsmini-gridenvironmentas
The allocentric model: The middle layer, illustrated in depictedinFig1,withinoracrossroomsrespectively. For
Fig2b,playsacrucialroleinconstructingacoherentun- moredetailsonthemodelsandtrainingprocedurewealso
derstandingoftheenvironment,denotedasz . Thismodel refertoAppendixAand B.
T
functionsatafinertimescale(t),formingabeliefoverthe
place by integrating a sequence of observations (sT) and
t 3.Results
poses (pT) to generate this representation (Eslami et al.,
t
2018;VandeMaeleetal.,2021).Fig2eandFig3showcase 3.1.Explorationandgoal-orientedsearch
theresultingplacedefiningtheenvironmentgivenaccumu-
We evaluate to what extent the hierarchical active infer-
latedobservations. Astheagentmovesfromoneplaceto
encemodelenablesouragenttoefficientlyexploretheen-
another,oncethecurrentobservationsdonotalignwiththe
vironment,aswellastothenadopttheinferredmodelfor
previouslyformedpredictionabouttheplace,theallocentric
goal-directedplanning. Notethatouragentistrainedtask
modelresetsitsplacedescriptionandgathersnewevidence
agnostic,andgoal-directedbehaviourisinducedbysettinga
toconstructarepresentationofthenewlydiscoveredroom
preferredobservation(i.e.thewhitetile)astypicallydonein
(z ),advancingbyonetickonthecoarsertimescaleand
T+1
activeinference(Fristonetal.,2016). Whenthepreference
resettingthemid-leveltimescaletto0.
isomitted,theagentwillbepurelydrivenbyepistemicfor-
The egocentric model: The lowest layer, illustrated in aging,i.e. maximisinginformationgain,effectivelydriving
Fig2c,hasthefinesttimescale(τ). Toevolveintimethis exploration.
modelrequiresthepriorstate(st)andcurrentaction(at )
τ τ+1 Theexplorationtaskisconsideredsuccessfulwhenanagent
toinferthecurrentobservation(ot )(C¸ataletal.,2020).
τ+1 observes95%ofthevisibletilesinthemaze,whileforthe
Basedonitscurrentposition,themodelgeneratespossible
goal-reachingtask,theagentmuststeponthewhitetilefor
futuretrajectorieswhileconsideringtheconstraintsimposed
thetasktobeconsideredsuccessful.
by the environment, such as the inability to pass through
walls(achievedbydiscerningthecause-effectrelationship Wecompareourmethodwithfourotherexplorationmeth-
between actions and observations). Fig 2f illustrates the ods: C-BET(Parisietal.,2021),RandomNetworkDistil-
currentobservationinthemiddleo)andshowstheimagined lation(RND)(Burdaetal.,2018),Curiosity(Pathaketal.,
potentialobservationsiftheagentweretoturnlefti),right 2017),andCount(Bellemareetal.,2016)onboththeexplo-
iii),ormoveforwardii). rationandgoal-seekingtask. Allbaselinesaretrainedinthe
sameconditionsasouragentonthesame303by3rooms
Themodeloperateswithinahierarchicalactiveinference
environments.
scheme, planning at different time scales. The cognitive
mapplaysavitalroleinlong-termnavigationbyhandling Table1presentsthedifferenceinthemeannumberofsteps
placeconnectivity,allowingthemodeltoplanthelocations (numberofmovementsfromonetiletothenext)between
to visit (π) at a high level, the poses to visit within each eachmodelandthenumberofstepsneededbytheoracle,
place(π l )atamid-level, anddeterminingthebestaction anA-staralgorithmwithcompleteknowledgeoftheenvi-
policy(π p )atthelowlevelwhileconsideringobstaclessuch ronmentlayoutandagentposition. Theothermodelsare
as walls. To infer the best navigation strategy to reach a
desiredobjective,theagentemploysactiveinferenceand Table1.Themodel’s deviationfromthe meannumberofsteps
utilisestheconceptofExpectedFreeEnergy(EFE).EFEis (tilesphysicallycovered)providedbytheOracleisevaluatedin
ameasureoftheagent’sprojecteduncertaintyorsurprise twotaskswithin3×3roomsenvironments: fullexplorationof
about future states. By minimising EFE, the agent aims themazeandreachingthesinglewhitetileintheenvironment.
toreduceuncertaintyandmakeaccuratepredictionsabout
futureoutcomes, thusdetermininganoptimalpathtothe TASK OURS C-BET RND CURIOSITY COUNT
objective(Kaplan&Friston,2017). Thishierarchicalac-
EXPLO-
67 195 177 146 334
RATION
tiveinferenceprocess,coupledwiththeintegrationofEFE,
GOAL
allows the agent to effectively explore new rooms at the 34 105 109 121 150
REACH
InferringHierarchicalStructureinMulti-RoomMazeEnvironments
limitedtotheinformationtheycanobserveandmustinfer Finally,ourhierarchicalmodelalsoenablesaccuratepredic-
thelayoutandconnectivityofthemaze. Theseresultsindi- tionsoverlongtimescalescrossingdifferentrooms,whereas
catethatourmodeloutperformsthebaselinesbyrequiring recurrentstatespacemodelstypicallyfailwhentheagent
fewerstepsforbothexplorationandgoal-drivenbehaviour. needstopredictacrossroomboundaries. AppendixCFig7
Details about the other models’ training can be found in depictseachlayer’spredictionabilityoveralong-termimag-
AppendixA.Ourmodelreachesobjectivesfasterthanksto inedtrajectory.
itslong-termmemorycapturingthestructureofthemaze.
4.Discussion
3.2.Qualitativeresults
Ourhierarchicalactiveinferencemodeldemonstratesprofi-
Figure3illustratestheinferenceprocessofplacedescrip-
ciencyinlearningthemaze-likestructureofthemini-grid
tions. Withinapproximatelythreesteps,themainfeatures
environmentandestablishingconnectionsbetweenrooms
of the environment are captured and reasonably accurate
byleveragingthecognitivemap’sabilitytoretainspatial
basedontheaccumulatedobservations. Evenwhenencoun-
locations and their relative relationships. The allocentric
teringanewaisleforthefirsttimeatstep11,themodelis
model contributes to inferring and learning the structural
abletoadaptandgenerateawell-imaginedrepresentation.
layoutofroomsbasedonobservedpositions,whiletheego-
Eachobservationcorrespondstotheredagent’sclearfield
centricmodelfacilitatesinformeddecision-makingduring
ofview,asdepictedintheagentpositionrowofthefigure.
actions. In this work, we focused on comparing to other
Moreresultsareaddedinappendix. Forinstance,Appendix methodsthatencourageexplorationlikeC-BET(Parisietal.,
CFig4showstheagentconsistentlyachievingastableplace 2021),RandomNetworkDistillation(RND)(Burdaetal.,
descriptionwithinaroundthreeobservationsinroomsizes 2018),Curiosity(Pathaketal.,2017)orCount(Bellemare
thatwerepartofitstraining. Interestingly,theagentalso etal.,2016). However, furthertestingagainstothermod-
exhibitstheabilitytoaccuratelyreconstructlargerrooms, elsinmorediverseenvironments,includinglargerenviron-
eventhoughitdidnotencountersuchsizesduringtraining. mentsandbiggerroomsiscalledfor,asourmodelhasthe
Inparticular,stableplacedescriptionsfor8-tilewiderooms capacity to scale to new maze sizes without the need for
areattainedinapproximatelyfivesteps. Thisshowcasesthe re-training. In future work, we also intend to benchmark
agent’sallocentricmodelgeneralisationabilitiesbeyondthe againstmodel-basedRLmethods(Hafneretal.,2020),espe-
limitsofitstraining. ciallytheonesthatalsolearnhierarchicalstructureintheir
worldmodel(Mazzagliaetal.,2023).
Moreover,ourmodelisabletodisambiguatebetweenvisu-
allysimilarplacesthroughthecombinationofaccurateplace One limitation of the current system is that we explicitly
inferencebytheallocentricmodelandtheagentlocationin train the allocentric model on data collected within one
thecognitivemap. ThiscapabilityisevidentinAppendixC room, whichyieldsproperspacerepresentations. Tomit-
Fig6,wheretheroomsshareasimilarappearance(shape igate this, and generalise to arbitrary environments, we
orcolour). Despitethisvisualaliasing,theagentsuccess- could consider splitting the data by unsupervised cluster-
fullydistinguishesbetweenthem,andasinglegraphnode ing(Asanoetal.,2020),orbyusingthemodel’sprediction
iscreatedforeachroom,evenwhenenteringfromadiffer- errortochunkthedataintoseparatespaces(Verbelenetal.,
entdoorthantheinitialentrypoint. Thisdemonstratesthe 2022).
robustnessoftheagent’sperceptualandspatialreasoning
Whileournavigationexhibitsstrongexplorationandgoal-
abilitiesindisambiguatingsimilarenvironments.
reachingabilities,thereisstillroomforimprovement. For
instance,everytimetheagententersanewroom,itneeds
a few steps to relocate in the allocentric reference frame.
Adoptingamorepreciseprioronwheretheagentwillenter
theroom,giventhepreviousroom,wouldfurtherimprove
this. Wecouldalsolearnapriorovertopologicalmapstruc-
tures, which would better drive exploration as the agent
would expect to discover new rooms, encouraging more
informationgainatthehighestlevel,andallowingtheagent
toimagineshortcutsbeforehand(Tinguyetal.,2023). Addi-
tionally,whilethecurrentdesignispixel-basedandprovides
Figure3.Evolutionoftheplacerepresentationinaroomasnew atop-downviewoftheagent,applyingthismodeltoa3D
observationsareprovidedbythemovingagent(redtriangle).The first-personviewenvironment,suchastheMemorymaze
modelisabletocorrectlyreconstructthestructureoftheroomas
(Pasukonisetal.,2022),wouldbringusclosertoreal-world
observationsarecollected.
applications.
InferringHierarchicalStructureinMulti-RoomMazeEnvironments
Acknowledgment Hafner, D., Lillicrap, T. P., Norouzi, M., and Ba, J.
Mastering atari with discrete world models. CoRR,
ThisresearchreceivedfundingfromtheFlemishGovern-
abs/2010.02193,2020. URLhttps://arxiv.org/
mentunderthe“Onder-zoeksprogrammaArtificie¨leIntelli-
abs/2010.02193.
gentie(AI)Vlaanderen”programme.
Kaplan,R.andFriston,K.Planningandnavigationasactive
References inference. 122017. doi: 10.1101/230599.
Asano,Y.,Rupprecht,C.,andVedaldi,A. Self-labellingvia Mazzaglia, P., Verbelen, T., Dhoedt, B., Lacoste, A., and
simultaneousclusteringandrepresentationlearning. In Rajeswar,S.Choreographer:Learningandadaptingskills
InternationalConferenceonLearningRepresentations, inimagination. InTheEleventhInternationalConference
2020. URLhttps://openreview.net/forum? on Learning Representations, 2023. URL https://
id=Hyx-jyBFPr. openreview.net/forum?id=PhkWyijGi5b.
Bellemare, M., Srinivasan, S., Ostrovski, G., Schaul, Milford, M., Wyeth, G., and Prasser, D. Ratslam: a hip-
T., Saxton, D., and Munos, R. Unifying count-based pocampalmodelforsimultaneouslocalizationandmap-
exploration and intrinsic motivation. In Lee, D., ping. 1:403–408Vol.1,2004. doi:10.1109/ROBOT.2004.
Sugiyama, M., Luxburg, U., Guyon, I., and Garnett, 1307183.
R. (eds.), Advances in Neural Information Process-
Neacsu, V., Mirza, M. B., Adams, R. A., and Fris-
ing Systems, volume 29. Curran Associates, Inc.,
ton, K. J. Structure learning enhances concept for-
2016. URL https://proceedings.neurips.
mation in synthetic active inference agents. PLOS
cc/paper_files/paper/2016/file/
ONE, 17(11):1–34, 11 2022. doi: 10.1371/journal.
afda332245e2af431fb7b672a68b659d-Paper.
pone.0277199.URLhttps://doi.org/10.1371/
pdf.
journal.pone.0277199.
Burda, Y., Edwards, H., Storkey, A. J., and Klimov, O.
Parisi,S.,Dean,V.,Pathak,D.,andGupta,A. Interesting
Exploration by random network distillation. CoRR,
object,curiousagent: Learningtask-agnosticexploration.
abs/1810.12894, 2018. URL http://arxiv.org/
CoRR,abs/2111.13119,2021. URLhttps://arxiv.
abs/1810.12894.
org/abs/2111.13119.
Chevalier-Boisvert,M.,Willems,L.,andPal,S. Minimalis-
Parr, T., Pezzulo, G., and Friston, K. J. Active In-
ticgridworldenvironmentforopenaigym. https://
ference: The Free Energy Principle in Mind,
github.com/maximecb/gym-minigrid,2018.
Brain, and Behavior. The MIT Press, 2022.
ISBN 978-0-262-36997-8. doi: 10.7551/mitpress/
Eslami,S.M.A.,Rezende,D.J.,Besse,F.,Viola,F.,Mor-
12441.001.0001. URL https://direct.
cos,A.S.,Garnelo,M.,Ruderman,A.,Rusu,A.A.,Dani-
mit.edu/books/oa-monograph/5299/
helka,I.,Gregor,K.,Reichert,D.P.,Buesing,L.,Weber,
Active-InferenceThe-Free-Energy-Principle-in-Mind.
T.,Vinyals,O.,Rosenbaum,D.,Rabinowitz,N.,King,H.,
Hillier,C.,Botvinick,M.,Wierstra,D.,Kavukcuoglu,K.,
Pasukonis,J.,Lillicrap,T.,andHafner,D. Evaluatinglong-
andHassabis,D. Neuralscenerepresentationandrender-
termmemoryin3dmazes,2022.
ing. Science,360(6394):1204–1210,2018. doi: 10.1126/
science.aar6170. URL https://www.science. Pathak, D., Agrawal, P., Efros, A. A., and Darrell, T.
org/doi/abs/10.1126/science.aar6170. Curiosity-driven exploration by self-supervised predic-
tion. CoRR, abs/1705.05363, 2017. URL http://
Friston, K., FitzGerald, T., Rigoli, F., Schwarten-
arxiv.org/abs/1705.05363.
beck, P., Doherty, J. O., and Pezzulo, G. Ac-
tive inference and learning. Neuroscience & Biobe- Safron,A.,C¸atal,O.,andVerbelen,T. Generalizedsimul-
havioral Reviews, 68:862–879, 2016. ISSN 0149- taneouslocalizationandmapping(g-SLAM)asunifica-
7634. doi: https://doi.org/10.1016/j.neubiorev.2016.06. tionframeworkfornaturalandartificialintelligences: to-
022. URLhttps://www.sciencedirect.com/ wards reverse engineering the hippocampal/entorhinal
science/article/pii/S0149763416301336. system and principles of high-level cognition. Octo-
ber 2021. doi: 10.31234/osf.io/tdw82. URL https:
George, D., Rikhye, R., Gothoskar, N., Guntupalli, J. S.,
//doi.org/10.31234/osf.io/tdw82.
Dedieu, A., and La´zaro-Gredilla, M. Clone-structured
graphrepresentationsenableflexiblelearningandvicar- Stoianov,I.,Maisto,D.,andPezzulo,G. Thehippocampal
iousevaluationofcognitivemaps. NatureCommunica- formationasahierarchicalgenerativemodelsupporting
tions,12,042021. doi: 10.1038/s41467-021-22559-5. generative replay and continual learning. Progress in
InferringHierarchicalStructureinMulti-RoomMazeEnvironments
Neurobiology, 217:102329, 2022. ISSN 0301-0082.
doi: https://doi.org/10.1016/j.pneurobio.2022.102329.
URL https://www.sciencedirect.com/
science/article/pii/S0301008222001150.
Tinguy, D. d., Mazzaglia, P., Verbelen, T., and Dhoedt,
B. Home run: Finding your way home by imagining
trajectories. In Active Inference, pp. 210–221, Cham,
2023. Springer Nature Switzerland. ISBN 978-3-031-
28719-0.
VandeMaele,T.,Verbelen,T.,C¸atal,O.,DeBoom,C.,and
Dhoedt,B. Activevisionforrobotmanipulatorsusing
the free energy principle. Frontiers in Neurorobotics,
15, 2021. ISSN 1662-5218. doi: 10.3389/fnbot.2021.
642780. URLhttps://www.frontiersin.org/
articles/10.3389/fnbot.2021.642780.
Verbelen, T., de Tinguy, D., Mazzaglia, P., Catal, O.,
and Safron, A. Chunking space and time with in-
formation geometry. In NeurIPS 2022 Workshop on
Information-TheoreticPrinciplesinCognitiveSystems,
2022. URLhttps://openreview.net/forum?
id=Fq_HdQj6fOE.
C¸atal, O., Wauthier, S., De Boom, C., Verbelen, T., and
Dhoedt,B. Learninggenerativestatespacemodelsforac-
tiveinference. FrontiersinComputationalNeuroscience,
14, 2020. URL https://www.frontiersin.
org/article/10.3389/fncom.2020.574372.
InferringHierarchicalStructureinMulti-RoomMazeEnvironments
A.TrainingEnvironment
Inthispaperallmodelsweretrainedonamini-gridenvironment(Chevalier-Boisvertetal.,2018)consistingof3by3
squared rooms of 4 to 7 tiles wide connected by aisles of fixed length randomly placed, separated by a closed door in
themiddle. Eachroomisassignedacoloratrandomfromasetoffour: red,green,blue,andpurple. Inaddition,white
tilesmaybepresentatrandompositionsinthemap. Theagent’sperspectiveoftheenvironmentisrepresentedasatop
view, encompassing a window of 7 by 7 tiles. This window includes the tile on which the agent is currently located.
However,theagenthasnovisibilitybehinditself,anditcannotperceivethroughwallsorcloseddoors. Theobservation
interpretedbyourmodelisa3x56x56RGBpixelrendering,whileothermodelssuchasC-BET(Parisietal.,2021),Random
NetworkDistillation(RND)(Burdaetal.,2018),Curiosity(Pathaketal.,2017)andCount(Bellemareetal.,2016)utilizea
hot-encodedlistof7x7whereeachnumberrepresentsatiletype(wall,floor,goal...). Theagentmotioninthisenvironment
islimitedtothreeactions: goingonetileforwardorturn90degreeeitherleftorright.
Both the allocentric and egocentric models underwent independent training using a shared dataset consisting of 400
environments,with100environmentsperroomsize. Thegoalofthetrainingprocesswastoefficientlyacquireknowledge
aboutthecompositionofaroomandcomprehendthedynamicconstraintspresentintheenvironment,suchaswallsand
doors. The allocentric model was trained on random sequences of varying lengths within a single room, whereas the
egocentricmodelconsideredtheentirerandommotionspanning400stepswithintheenvironment. Throughoutthetraining
phase,thetrajectoriesfollowedbytheagentwereentirelyrandom.
Toensureafairandrigorouscomparison,allothermodelsincludedinthestudyweretrainedandtestedonanidentical
set of environments. These models used their respective policy networks to guide their trajectories, with the objective
of maximising performance according to their specific criteria, as specified in (Parisi et al., 2021). By training on the
sameenvironments,anydifferencesinperformancebetweenthemodelscanbeattributedtotheirdistinctapproachesand
architectures,allowingameaningfulcomparison.
B.OurModelDetails
B.1.Modeldescription
Resultswisewegainedinefficiencybykeepingtheallocentricandegocentricmodelsrunningandtrainingindependently
onthesamedata. Thusinpractice,wehavetheegocentricmodellearningitslatentstatethroughthejointprobabilityof
theagent’sobservations,actions,policies,beliefstatesanditscorrespondingapproximateposterior. Itiscomposedofthe
transitionmodelp toincorporateactioninitsreasoning,thelikelihoodmodelsp toconstructpixel-basedobservations,
θ ξ
andtheposteriormodelp toincorporatepasteventstofuturestate.
ϕ
T
pθ(st|st−1,aa1 )
T
pξ(otct|st)
(cid:89)(cid:122) (cid:125)(cid:124) (cid:123)(cid:89)(cid:122) (cid:125)(cid:124) (cid:123)
P(o˜,c˜,s˜,a˜)=P(s ) P(s |s ,a ) P(o ,c |s ) (1)
θ t t−1 t−1 t t t
t=1 t=1
In parallel, the allocentric model forms an internal belief about the world and updates its belief by interacting with it,
resultinginaplace(latentstatez)structureduponpositions(p)andcorrespondingobservations(o)(Eslamietal.,2018;
VandeMaeleetal.,2021). Thecorrespondingtrueposteriorofthisallocentricmodelis:
i
(cid:89)
P′(z,o˜,p˜)=P(z) P(o |p ,z)P(p ) (2)
k k k
k=1
Thecognitivemapintegratessuccessiveactionovertimestepstoobtaintheestimatedtranslationandrotationoftheagent
into a 3D grid using an Attractor Network (CAN) (Milford et al., 2004). When the current place being defined by the
allocentricmodeldifferssignificantlyfromanyother,anewexperiencecelliscreated.
B.2.ModelHyperparameters
InferringHierarchicalStructureinMulti-RoomMazeEnvironments
Layer Neurons/Filters Stride
PositionalEncoder Linear 9
Convolutional 16 1//(kernel:1)
Posterior Convolutional 32 2
Convolutional 64 2
Convolutional 128 2
Linear 2*32
Concatenation
Linear 256*4*4
Upsample
Convolutional 128 1
Likelihood
Upsample
Convolutional 64 1
Upsample
Convolutional 32 1
Upsample
Convolutional 3 1
Concatenation
Linear 2048
PositionalDecoder
Linear 512
Linear 128
Linear 64
Linear 9
Table2. allocentricmodelparameters
Layer Neurons/Filters Stride
Concatenation
Prior LSTM 256
Linear 2*32
Convolutional 8 2
Convolutional 16 2
Convolutional 32 2
Concatenation
Posterior
Linear 256
Linear 64
Linear 256
Linear 32*7*7
ImageLikelihood
Upsample
Convolutional 16 1
Upsample
Convolutional 8 1
Upsample
Convolutional 3 1
Linear 16
CollisionLikelihood Linear 8
Linear 1
Table3. egocentricmodelparameters
B.3.Navigationdetails
Duringnavigation, thecognitivemaptakesintoaccountthecontexttoavoidloopingbacktoalreadyvisitedplaces. If
thecurrentunderstandingoftheenvironmentmatchesapreviouslyencounteredplace,thecorrespondingviewcellgets
activated. However,toavoidambiguitiesduetotheagent’schangingposition,thesystemduplicatestheplaceifitisfar
fromthepreviousexperience,andadaptsittonewvisualstimuliwhilepreservingtheoriginalviewcell. Inthisway,the
problemofaliasesiseffectivelyresolved.
Moreover,toavoidbeingtrappedinalocalminimumwhilenavigatingthroughalargeenvironmentwithmultiplerooms,the
agentmayencounterasituationwhereitreturnstoaknownplacewithnoapparentlinkstounexploredareas. Insuchcases,
theagentisencouragedtovisittheleastexploredoroldestconnectedplacetopreventitfromstoppingexploration. Adecay
parameterassociatedwiththeview-cellisutilisedtoachievethis,causingtheactivityofthecurrentview-celltodecayover
timeasitissolicited,andallpastview-cellstodiminishgraduallyastheyarenolongerstimulated. Thisapproachensures
thattheagentcontinuestoexplorenewareasandavoidsgettingstuckinaparticularpartoftheenvironment.
InferringHierarchicalStructureinMulti-RoomMazeEnvironments
C.Supplementaryresults
Supplementarytestsshowedhowfastandaccuratelytheallocentricmodelpredictsobservationsfromun-visitedpositionsin
anewroom. Startingfromitsplacegenerationandnoobservationupto6observationsinseveralroomsofincreasingsize,
theagentisabletocometoageneraldescriptionoftheplaceinabout3steps,havinganMSEunder0.2(Fig. 4),whichis
visuallycloselookingasisdemonstratedinFig. 5. Theagentisalsoabletosolvebiggerenvironmentsitneverencountered
intrainingas8tileswideroomsgivenmoreobservations(inaverage5).
Figure4.Prediction error of unvisited positions over
min5testsper5environmentsbyroomsizestarting Figure5.Observationqueries,sampledpredictionoverunvisitedpo-
fromstep0wherethemodelshasnoobservation. sitionandmeanMSEover5samplesofpredictions
Weplacedanagentinanewenvironmentconsistingofinterconnectedroomswithsimilarappearances(intermsofcolor
and/orshape),arrangedina2x2pattern,asshowninFigure6A.Theagent’staskwastomoveclockwiseuntilitreturnedto
thestartingpoint,andthenmoveanti-clockwisethroughthepreviouslyvisitedrooms.
Whenevertheagentidentifiedanewlocation,itcreatedanewview-cellandexperienceIDtostoretheinformation,as
depictedinFigure6B.Ifthepredictionerrorincreasedaboveathresholdof0.5MSE,indicatingthatthepreviousplace
descriptiondidn’tmatchthecurrentobservation,theagentwouldrelyonthepreviouslyknownview-cells,basedontheir
probability,todescribethecurrentroom,asshowninFigure6C.Thebarsinthefigurerepresenttheamountofhypotheses
beingconsideredsimultaneouslytoexplaintheagent’sobservations. Wecanseethatuponenteringanewplace,theagent
startedinvestigatingaround600differenthypothesestodetermineitscurrentposition,withathirdoftheworsthypotheses
beingerasedateachstep. Astheagent’sbesthypothesisconvergedtoanunderstandingoftheplace,somenewhypotheses
werealsoconsidered. ThebluelineinFigure6C.representstheprobabilityofthebestnewhypothesiscomparedtothe
knownplaces’hypotheses. Theagentusuallyconvergedtoapreciseunderstandingofanewplacewithinfoursteps,whereas
ittookabouttwostepsinanalreadyknownroom,thankstotheprobabilityofthepreviousplaceoutweighinganynewplace
description,whichmatchedobservationsmoreprecisely.
Figure6D.depictstheimaginedroomsusedforhypothesiscreationwhenenteringanewroom,withalldoorentriesbeing
consideredtocreatenewhypotheses,whichwereimmediatelydiscardediftheydidnotmatchobservations. Theassociated
probabilityoftheview-cellwasproportionaltotheprecisionofthepredictions,andasingleview-cellcouldhaveseveral
hypotheses running at once. In the figure, only the best hypothesis was considered. The imagined rooms were almost
correctlyinferred,withexperience1havingalessprecisereconstruction,althoughitwasstillsufficienttorecognizeitwhen
enteringfromanewdoor.
InferringHierarchicalStructureinMulti-RoomMazeEnvironments
Figure6.Navigationsamplesoftheagentloopingclockwiseandanti-clockwise(thusenteringfromadifferentdoor)inanewenvironment
of2by2roomsover142steps.Theclockwisenavigationcorrespondstoafullynewexplorationgeneratingnewplaces(seeC.)whilethe
anti-clockwiseloopleadsthroughexploredplaces.A.)anewworldcomposedof4closelookingrooms(colouror/andshapes),B.)the
modelassociatedeachroomtoadifferentexperienceidcorrespondingtotheplaceC.)theprobabilityofanewplacebeingcreated(in
blue,themostprobableplaceamongallpossibilities)oranexistingplacebeingdeemedthemostprobabletoexplaintheenvironment.
Thegreybarsrepresenthowmanynewplacesareconsideredatonce,thenumberofsimultaneoushypothesisbeingconsideredcanbe
readontherightpartoftheplot. D.)theimaginedplacegeneratedforeachexperienceid. Wecanseethatexperience1isnotfully
accurate,yetitisenoughtodistinguishitfromtheotherroomsgivenrealobservationsofit.
Figure7.Animaginedtrajectorybyeachlevelofapathleadingtowardanalreadyvisitedroom.Theegocentricmodelhasashort-term
memorythereforeitforgetsinformationastimepasses,ascanbeobservedstartingstep2,thefrontaisleisalreadymissingaftertheagent
turnedafewtimeswithoutseeingit. Theallocentricmodelhoweverdoesn’tforgettheplacedescriptionovertimebutgetslostonce
leavingtheplaceitiscurrentlyin.Whilethecognitivemapknowsthelinkbetweenlocationsandisabletocorrectlyinferstheplacetobe
expectedbehindthedoorgivingaresultmuchsimilartothegroundtruth.

=== INSTRUCTIONS ===

0. PROFESSIONAL TONE REQUIREMENTS:
   - Begin directly with the paper title or content - NO conversational openings
   - Do NOT use phrases like: 'Okay, here's...', 'Here's a summary...',
     'Let me summarize...', 'I'll extract...', or similar conversational language
   - Start immediately with substantive content in formal academic tone
   - Example BAD: 'Okay, here's a summary of the paper...'
   - Example GOOD: 'This paper investigates [topic]...'

1. Start with exact title: "Inferring Hierarchical Structure in Multi-Room Maze Environments"

2. EXTRACT QUOTES:
   - Extract 10-15 direct quotes from the paper that support key claims
   - QUOTE EXTRACTION AND FORMATTING:
     * Extract quotes VERBATIM from the paper text - do NOT modify or "correct" them
     * Extract quotes exactly as they appear in the source text
     * Preserve all aspects of the quote exactly as written, including spacing
     * Use proper quotation marks: "quote text" (double quotes)
     * CRITICAL: Only extract quotes that actually appear in the paper text
     * Do NOT generate, invent, or "fix" quotes - extract them exactly as written
   - QUOTE FORMATTING STANDARD:
     * Attribution format: 'The authors state: "quote text"' OR 'According to the paper: "quote text"'
     * Vary attribution phrases to avoid repetition (use: 'The authors state', 'They note',
       'The paper argues', 'According to the research', 'The study demonstrates')
     * Include section context when available: 'In the Introduction, the authors state: "quote text"'
     * Ensure proper spacing around quotes and punctuation
   - Search the full paper text to find relevant quotes
   - Each quote must be verbatim from the paper text (with spacing normalized)

3. IDENTIFY CLAIMS:
   - Identify the main claims and arguments made by the authors
   - State each claim clearly and support it with quotes from the paper
   - Distinguish between primary claims and supporting arguments

4. SUMMARIZE KEY FINDINGS:
   - Summarize the key findings with specific numbers, metrics, and results
   - Include quantitative data: percentages, statistics, measurements
   - Extract numerical results from the results section
   - Present findings with supporting evidence from the paper

5. DESCRIBE METHODS:
   - Describe the methodology, experimental setup, and approach used
   - Include details about: algorithms, procedures, experimental design
   - Explain how the research was conducted
   - Extract specific methodological details from the methods section

6. PRESENT RESULTS:
   - Present the results with quantitative data and statistical significance
   - Include specific numbers, tables, figures mentioned in the paper
   - Extract results from the results section with exact values
   - Support results with quotes or data from the paper

7. NO REPETITION - CRITICAL REQUIREMENT (ENHANCED):
   - CRITICAL: Before writing EACH sentence, check: 'Have I already said this exact idea?'
   - If you've already stated an idea, DO NOT repeat it - move to the next unique point
   - Each sentence must be COMPLETELY UNIQUE - no duplicate ideas, even with different words
   - Each claim appears EXACTLY ONCE - if you've stated it, move to the next unique point
   - Each paragraph must be COMPLETELY UNIQUE - no duplicate paragraphs
   - Do NOT repeat the same sentence, even with slight variations or word changes
   - Do NOT repeat paragraphs or sections - each section must have unique content
   - Each claim should appear only ONCE in the entire summary
   - Vary attribution phrases: use 'The authors state', 'They note', 'The paper argues',
     'According to the research', 'The study demonstrates' - do NOT repeat the same phrase
   - If you find yourself writing similar content, STOP immediately and write something completely different
   - Before each sentence, ask: 'Have I already said this?' If yes, write something new
   - Vary your language: use synonyms, different sentence structures, different perspectives
   - REPETITION CHECKLIST: After writing each sentence, verify it's not a duplicate of any previous sentence

   EXAMPLES OF WHAT NOT TO DO:
   ❌ BAD: 'The authors state: "X". The authors state: "Y". The authors state: "Z".'
   ✅ GOOD: 'The authors state: "X". They further note: "Y". The paper argues: "Z".'

   ❌ BAD: Repeating the same claim 3+ times with slight variations
   ✅ GOOD: State each claim once, then move to the next unique point

8. STRUCTURE:
   - Use markdown headers: ### Overview, ### Methodology, ### Results, ### Discussion
   - Target length: 1000-1500 words
   - Ensure all requested elements (quotes, claims, findings, methods, results) are included
