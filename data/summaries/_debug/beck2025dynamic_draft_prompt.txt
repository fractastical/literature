=== IMPORTANT: ISOLATE THIS PAPER ===
You are summarizing ONLY the paper below. Do NOT reference or use content from any other papers.
Do NOT mix information from different papers. Only use information from THIS specific paper.

Paper Title: Dynamic Markov Blanket Detection for Macroscopic Physics Discovery
Citation Key: beck2025dynamic
Authors: Jeff Beck, Maxwell J. D. Ramstead

REMEMBER: Extract quotes, claims, and findings ONLY from the paper text provided below.

Year: 2025

Abstract: The free energy principle (FEP), along with the associated constructs of Markov blankets and
ontologicalpotentials,haverecentlybeenpresentedasthecorecomponentsofageneralizedmodeling
method capable of mathematically describing arbitrary objects that persist in random dynamical
systems;thatis,amathematicaltheoryof“every”“thing.” Here,weleveragetheFEPtodevelopa
mathematicalphysicsapproachtotheidentificationofobjects,objecttypes,andthemacroscopic,
object-type-specificrulesthatgoverntheirbehavior. To...

Key Terms: blanket, systems, blankets, markov, noumenallabs, dynamic, physics, macroscopic, detection, discovery

=== FULL PAPER TEXT ===

DYNAMIC MARKOV BLANKET DETECTION FOR MACROSCOPIC
PHYSICS DISCOVERY
APREPRINT
JeffBeck
NoumenalLabs
DepartmentofNeurobiology,DukeUniversity
MaxwellJ.D.Ramstead
NoumenalLabs
QueenSquareInstituteofNeurology,UniversityCollegeLondon,UK
March3,2025
ABSTRACT
The free energy principle (FEP), along with the associated constructs of Markov blankets and
ontologicalpotentials,haverecentlybeenpresentedasthecorecomponentsofageneralizedmodeling
method capable of mathematically describing arbitrary objects that persist in random dynamical
systems;thatis,amathematicaltheoryof“every”“thing.” Here,weleveragetheFEPtodevelopa
mathematicalphysicsapproachtotheidentificationofobjects,objecttypes,andthemacroscopic,
object-type-specificrulesthatgoverntheirbehavior. Todoso,wedrawoutthedeepconnections
betweenMarkovblankets,reinforcementlearning,systemidentificationtheory,andmacroscopic
physics discovery. More specifically, we use the statistics of Markov blankets to operationalize
twoconditionsforsystemequivalenceintheliterature,andtodevelopanapproachtosubsystem
discovery,i.e.,howtobestpartitionasystemintosubsystems,andhowtobestclassify(sub)systems.
UsingthestatisticsofMarkovblankets,wedemonstratethattwosubsystemsofagivensystemare
weaklyequivalentiftheirblanketssharethesamesteadystatestatisticsorrewardrate;andstrongly
equivalentifthetimeevolutionorpathsoftheirboundarieshavethesamestatistics. Thisallowsusto
formallydefineobjecttypesintermsofhowtheyinteractwiththeirenvironment. Italsoallowsusto
reframetheproblemsofsystemsidentificationandmacroscopicphysicsdiscoveryasaproblemof
Markovblanketdetection. WetakeagenerativemodelingapproachandusevariationalBayesian
expectationmaximizationtodevelopadynamicMarkovblanketdetectionalgorithmthatiscapableof
identifyingandclassifyingmacroscopicobjects,givenpartialobservationofmicroscopicdynamics.
This unsupervised algorithm uses Bayesian attention to explicitly label observable microscopic
elementsaccordingtotheircurrentroleinagivensystem,aseithertheinternalorboundaryelements
of a given macroscopic object; and it identifies macroscopic physical laws that govern how the
object interacts with its environment. Because these labels are dynamic or evolve over time, the
algorithmiscapableofidentifyingcomplexobjectsthattravelthroughfixedmediaorexchangematter
withtheirenvironment. Thisapproachleadsdirectlytoaflexibleclassofstructured,unsupervised
algorithmsthatsensiblypartitioncomplexmany-particleormany-componentsystemsintocollections
ofinteractingmacroscopicsubsystems,namely,“objects”or“things.” Wederiveafewexamples
of this kind of macroscopic physics discovery algorithm and demonstrate its utility with simple
numericalexperiments,inwhichthealgorithmcorrectlylabelsthecomponentsofNewton’scradle,a
burningfuse,theLorenzattractor,andasimulatedcell.
Acknowledgments
WethankKarlFristonforusefulfeedback.
5202
beF
82
]CN.oib-q[
1v71212.2052:viXra
A PREPRINT - MARCH 3, 2025
1 Introduction
Inthispaper,wereconsiderapproachestosystemidentificationandtypificationusedinsystemsidentificationtheory,
engineering,andstatisticalphysicsusingthetoolsofinformationtheory,inparticular,theconstructsofMarkovblankets
andontologicalpotentialfunctionsthathavebeendevelopedintheliteratureonthefreeenergyprinciple(FEP).Inspired
byrecentderivationsofclassicalandstatisticalmechanicsfrominformationtheoreticprinciples[31,10],wepresent
anovelderivationoftheFEP,foregroundinghowitcanbeusedtowritedown“ontologicalpotentialfunctions”that
defineobjecttypesorphenotypes. Thisapproachisbaseduponaconsiderationoftherelativeentropyformulationof
Jaynes’principleofmaximumcaliber[41,36,42],withconstraintsimposedupontheboundaryorMarkovblanketofa
macroscopicobjectorsubsystemofacertaintype. WeshowthattheseMarkovblanketconstraintsfullycharacterize
theinteractionsbetweenanobjectorobjecttypeandtheotherobjectsinitsenvironment, therebyformalizingthe
behavioralprofileofasubsystemintermsoftheeffectsthatithasonothersubsystems. Thisapproachsubsumesthe
morestandardapproachestoidentificationandtypificationofphysicalobjectsincontemporaryreinforcementlearning,
systemidentificationtheory,andmacroscopicphysicsdiscovery.
Theproblemofidentificationandtypificationofsystemsandsubsystemsisdeceptivelysimple. Inplainlanguage,
traditionalsystemsidentificationtheoryasksthequestion: Howcanonecharacterizethecomplexinteractionsand
behaviorofamany-componentsystemusingasimpleblackboxfunctionapproximator? Inthestandardapproach
tosystemsidentification,theuseridentifiesasubsystemasaconnectedsubsetofalargemulti-componentcomplex
systemandthencharacterizestherelationshipbetweentheinputstoandoutputsfromthesubsystem. Forexample,
in reinforcement learning, the inputs to a system are the observations of the agent and the outputs are its actions.
Thefunctionthatmapsinputstooutputsiscalledthe“policy”andinthiscontext,twoagentsthatexecutethesame
policyperformthesameactionsgiventhesameinputconditionsand,therefore,areconsideredtobeequivalent. More
generally,twosubsystemswiththesameinput-outputrelationshipcanthenbesaidtobesubsystemsofthesametype.
Otherthanprovidingameansoftypingsubsystems,theutilityofthisapproachliesinitsabilitytoprovideacompact
descriptionofacomplexsubsystem,bymodelingitasasimpletransferfunctionorasalow-dimensionaldynamical
system. Thisusuallyinvolves“black-boxing”theinternalcomponentsofanoverallsystem: thatis,drawingaboundary
around a many-object or many-component system, and then determining a (hopefully simplified) mathematical
expressionthatsummarizestheeffectofthecomplexgoings-oninsidetheboundary,intermsoftheireffectsonthe
boundary of the subsystem, i.e., in terms of its input-output relationship to other subsystems. In this setting, the
boundaryitselfisanarbitrary,user-definedboundarythatseparatesthesubsystemofinterestfromothersubsystems.
Thedefinitionofsystemsequivalenceusedinreinforcementlearningistheonefromsystemsidentificationtheory: Two
systemsarethensaidtobeofthesametypeiftheyhavethesameinput-outputrelationshiporpolicy,regardlessofthe
detailsoftheirinnerworkings.
In statistical physics, a similar notion of equivalence between macroscopic systems isused. Two systems are said
to be of the same type if they can be modeled by the same dynamical system or energy function (Hamiltonian or
Lagrangian). Themaindifferencebetweenthesystemsidentificationapproachandthestatisticalphysicsapproachis
thelatter’suseofacoarse-grainingproceduretosimplifycomplexmicroscopicdynamics. Thisprocedurebeginsby
drawinganarbitraryboundaryaroundaconnectedvolumeofmicroscopicparticlesandidentifyingmacroscopicstate
variablesthatsummarizetheactivityofthemicroscopiccomponents(e.g.,temperature,pressure,anddensity)insidethe
volume. Rulesorlawsthatrelateinternalstatevariablestothenetfluxofconservedquantitiesattheboundaryarethen
derivedfromknowledgeofmicroscopicdynamics. Becausefluxisaconservedquantity,differentvolumescanthenbe
connectedtoyieldfieldequationsthatgovernalargersystemthatisitselfmadeupsmallersubsystemsthatusethesame
fluxvariables. Amacroscopicsystemofagiventypecanthenbeidentifiedasconsistingoftheconnectedvolumesthat
canbemodeledusingthesameflux-staterelationship,i.e.,itisabucketofwaterbecauseeachfluidelementinthe
buckethasthesameflux-staterelationship. Thisextendsthestatespacetoafieldthatisdependentontheshapeofthe
macroscopicobjectandestablishesthebucketasprovidingboundaryconditions.
Thefreeenergyprinciple(FEP)hasbeenproposedasageneralmathematicalmodelingframework,unifyingstatistical
mechanicsandinformationtheory,andprovidingaformal,biologicallyplausibleapproachtobeliefformationand
updatingaswellasinformationprocessing. TheFEPstartswithamathematicaldefinitionofa“thing”or“object”: any
objectthatwhencansensiblylabelassuchmustbeseparatedfromitsenvironmentbyaboundary. UndertheFEP,
thisboundaryisformalizedasaMarkovblanketthatestablishesconditionalindependencebetweenthatobjectand
itsenvironment. Withinthisframework,anobjectisdefinednotbyphysicalstatesandfluxesoruserlabeledinputs
andoutputs,butratherbytheflowofinformationacrosstheMarkovblanket. Strictlyspeaking,aMarkovblanket
definesthestatisticalboundaryforasetofvariablesZ ⊂X astheminimalsetB ⊂X suchthatZ isconditionally
independentofallvariablesnotinZ orB,giventheblanketB. [15,36]. IntheFEPliterature,Markovblanketsare
usuallydescribedasformalizingthenotionofobject,becausethestatisticsoftheMarkovblanketfullycharacterizethe
input-outputrelationshipbetweenanobjectandotherobjectsinitsenvironment.
2
A PREPRINT - MARCH 3, 2025
Thisseeminglyabstractdefinitionofaboundaryis,infact,implicitinthedefinitionsofaboundariesusedinsystems
identificationandstatisticalphysics. Insystemsidentification,theboundaryofasystemisdirectlydefinedbyitsinputs
andoutputs. Completespecificationoftheinputsandoutputsofasystemallowsonetothetreatthesubsystemas
a driving force on the system as a whole. Similarly, in statistical physics, knowledge of the fluxes into and out of
asubsystemfullycharacterizeboththesubsystemanditsimpactontherestofsystem,inthesamewaythatinitial
conditionsplusboundaryconditionsaresufficienttodeterminetheevolutionofthestatevariables. Thus,thenotionthat
conditionalindependenceisapropertyofboundariesbetweenasubsystemanditsenvironmentisuncontroversial. In
theFEPliterature,itisthereforearguedthatwecandefineobjecttypesorphenotypesintermsoftheirMarkovblankets.
Inthe interestofprecision, however, we notethatit wouldbemore accuratetosay thatthepresence ofa Markov
blanketinagivensystemmerelyindicatesapossiblepartitioningofthesystemintotwointeractingsubsystems—and
nothingelse. Havingidentifiedablanket,onecanthenmakeuseofthefactthattheblanketsummarizesinputsand
outputsoftheassociatedsubsystemtoconcludethatitisthestatisticsoftheblanketthatdefinesanobjecttype. Recent
workhasmadeexplicitthemathematicalconditionsunderwhichtheexistenceofapartitionintosubsystemswith
theirMarkovblanketscanbeguaranteedatsteadystate[44,20];andtheyareguaranteedtoexistinthepath-based
formulationoftheFEP[43,44]. Garneringsignificantlylessinterestisthequestionofhowtodiscovertheseboundaries
inthefirstplaceinadata-drivenmanner. Indeed,inmostoftheFEPliterature,thefocusisonexplicatingthedynamics
ofinformationflowinthepresenceofablanket,andsotheexistenceofaMarkovblanketisusuallyassumed,i.e.,the
existenceanddomainoftheblanketarespecifiedapriori. Whenmethodsareproposedintheliteraturetoidentify
Markovblankets,astheyare,e.g.,in[17],thefocusisonanapproximateblanketstructureinthestationarydistribution.
Thiskindofblanketisrarelyrealized,eveninsystemsthathaveactualblanketstructure. Moreover,Markovblankets
arealwaysassumedtobestatic—orareassociatedwithfixedcomponents,givingrisetothefalseimpressionthatthings
thatdisplaymaterialturnover,suchastravelingwaves,flames,andlivingcreaturescannotbemodeledashavinga
Markovblanket[35,30]. Takentogether,allthissuggeststhatthecriticalmissingingredientintheFEPliteratureisa
procedureforidentifyingdynamicMarkovblanketedsubsystems,whichistherebycapableofdescribingawiderange
ofstationaryandnon-stationaryphenomena,includingflames,lightningbolts,organisms,andothersystemsthathave
transientorporousboundaries,andthatcanpopinandoutofexistence.
Thisrequirestheelucidationofatheoreticalframeworkandassociatedclassofinferencealgorithmsthatallowusto
metaphorically“carvetheworldatitsjoints”: thatis,topartitioncomplexmany-componentsystemsintomacroscopic
objectsandobjecttypes,anddiscoverthephysicallawsormacroscopicrulesthatgoverntheinteractionsbetweenthese
objects. Ideally,suchanunsupervisedpartitioningwould(1)resultinacompact,low-dimensionaldescriptionofobjects
andtheirinteraction,and(2)largelyagreewithhumanintuition,inthatthepartitionsofsystemsintosubsystemsthatit
generatesshouldlargelybeconsistentwithhumanintuitionsabouttheassociatedperceptualphenomena. Forreasons
thatwillbecomeapparentbelow,theclassofalgorithmsthatwearedescribingaredynamicMarkovblanketdetection
algorithms. TheoverallapproachwetakeisbasedupontheformulationoftheFEPinthespaceofpathsortrajectories
ofsystemsovertime,whichisderivedfromJaynes’principleofmaximumcaliber,coupledtotheMarkovblanketbased
definitionofobjectandobjecttype. Thisformulationleadsdirectlytoanotionofan“ontologicalpotentialfunction,”
whichisspecifiedintermsofconstraintsontheblanketstatisticsandconstraintsonblanketdynamics,andwhichcanbe
usedasthebasisforataxonomyofobjecttypes. Here,“blanketstatistics”refertothetypicalsummaryofthedynamics
ofasubsystemintermsofitsinput-outputrelationshipwithitsenvironment;while“blanketdynamics”referstohow
theboundaryitselfchangesovertime.
Startingfromthisdefinitionofobjectsandobjecttypes,weconsideraclassofmacroscopicgenerativemodelsutilize
twotypesoflatentvariables: (1)macroscopiclatentvariablesthatcoarse-grainmicroscopicdynamicsinamanner
consistentwiththeimpositionofMarkovblanketstructure,and(2)latentassignmentvariablesthatlabelmicroscopic
elementsorobservationsintermsoftheirroleinamacroscopicobject,itsboundary,ortheenvironment. Critically,
theselatentassignmentvariablesarealsoallowedtoevolveovertime,inamannerconsistentwithMarkovblanket
structure. Finally,bytakingaBayesianapproachtomodeldiscovery,weleveragetoautomaticOccam’srazoreffectof
Bayesianinferencetoselectthepartitionsofthesystemintosubsystems,suchthattheglobaldynamicsisassimpleor
low-dimensionalaspossible.
Insummary,wereformulatetheproblemofsystemidentificationasaMarkovblanketdetectionproblem. Wetakea
generativemodelingapproachandusevariationalBayesianexpectationmaximizationtodevelopadynamicMarkov
blanketdetectionalgorithmthatiscapableofidentifyingandclassifyingmacroscopicobjects,givenpartialobservation
ofmicroscopicdynamics. ThisunsupervisedalgorithmusesBayesianattentiontoexplicitlylabelmicroscopicelements
accordingtotheircurrentrole,aseithertheinternalorboundaryelementsofagivenmacroscopicobject;anditidentifies
macroscopicphysicallawsthatgovernhowtheobjectinteractswithitsenvironment. Becausetheselabelsaredynamic
orevolveovertime,thealgorithmiscapableofidentifyingcomplexobjectsthattravelthroughfixedmediaorexchange
matterwiththeirenvironment.Crucially,thisapproacheliminatestheneedtoimposearbitraryuser-specifiedboundaries
uponwhichsystemsidentificationtypicallyrelies,allowingforunsupervisedsegmentationofcomplexsystemsinto
3
A PREPRINT - MARCH 3, 2025
collectionsofinteractingmacroscopicobjects. Furthermore,byvirtueofbeingbasedondiscoveringthestatisticsof
Markovblankets,itautomaticallyinheritstheabilitytoidentifyobjecttypes,allowingustoclassifysubsystemsin
termsofthemacroscopicrulesorlawsthatgovernhowtheobjectinteractswithitsenvironment.
The rest of this paper is structured as follows. We first present an overview of Markov blankets and their use in
theFEP.Wethenconsidercoreelementsofreinforcementlearning,systemsidentificationtheory,andmacroscopic
physicsdiscovery,mappingtwonotionsofsystemsequivalenceontothestatisticsofMarkovblankets,anddiscussing
limitations. Followingthis,wereturntoMarkovblanketsundertheFEPanddiscussthemathematicsofstaticand
dynamicMarkovblankets. WethenpresenttheMarkovblanketdetectionalgorithmandexaminenumericalwork
applyingittosimplesystems. WeconcludewithadiscussionofimplicationsofthisworkfortheFEPbroadlyand
directionsforfuturework. WearguethatthestatisticsofMarkovblanketsasformulatedintheFEPliteratureprovide
uswiththemathematicalapparatusneededtoestablishthenotionofan“ontologicalpotentialfunction,”i.e.,afunction
thatrigorouslydefinesobjecttypesviaboundaryconstraints.
2 Thefreeenergyprinciple: Coreelements
2.1 Markovblanketsintheformulationofthefreeenergyprinciple
Atahighlevel,thestandardformulationoftheFEPstartsfromtheequationsofstatisticalphysics,withMarkovblanket
structureimposed. ThenotionofaMarkovblanketwasoriginallyintroducedbyPearl[33]asameansofidentifying
thecompletesetofrandomvariablesthatimpactinferenceregardingthevalueofagivensetof“internal”random
variables.1 Pragmatically,knowledgeofaMarkovblanketforeachnodeinagraphicalmodelcanbeusedtoidentify
thestructureofmessagepassingalgorithmsusedforefficientprobabilisticinference. Thepropertyisinheriteddirectly
fromthedefinitionofaMarkovblanketofsetof“internal”randomvariablesz ⊂X assetb⊂X suchthatz ⊥s|b,
wheresisthecomplementoftheunionofzandb,orequivalently:
p(s,z|b)=p(s|b)p(z|b) (1)
Inadirectedgraphicalmodel,theMarkovblanketofasetofnodesZ consistsofalltheparentsofthenodesinZ,
allthechildrenofnodesinZ, andalltheparentsofthechildrenofthenodesinZ. Thisestablishesaconditional
independencerelationshipbetweennodesinZ andalloftheothernodesnotintheblanketofB,i.e. S =(Z∪B)c,
wherethesuperscriptcdenotesthecomplement,
p(z|b) = p(z|s,b) (2)
p(s|b) = p(s|z,b) (3)
wherethelowercasereferstothevaluesoftherandomvariablesinthecorrespondingset.
IntheFEP,thisMarkovblanketstructureisrealizedbyassumingthatthedynamicsofamicroscopicsystemcanbe
partitionedintothreesubsetsofvariables: internalvariables(z),boundaryvariables(b),andexternalorenvironmental
variables(s),suchthat:
ds
=f (s,b)+η (4)
dt s s
db
=f (s,b,z)+η (5)
dt b b
dz
=f (b,z)+η (6)
dt z z
where the η’s indicate noise that is independent across the s,b,z variables. This results in the desired posterior
probabilitydistributionovertrajectoriesorpaths(indicatedbysubscriptτ):
p(s ,z |b )p(b )=p(s |b )p(z |b )p(b ) (7)
τ τ τ τ τ τ τ τ τ
1NotethathereweareusingMarkovblanketandMarkovboundaryinterchangeably.Insomepartsoftheliterature,aMarkov
blanketreferstoanysetthatestablishesthedesiredconditionalindependencestructure,whiletheMarkovboundaryistheminimal
set.[33]
4
A PREPRINT - MARCH 3, 2025
Conditional independence follows from the absence of any direct causal interaction between s and z, but can be
intuitivelyunderstoodasresultingfromthatfactthat,ifthepathb isobserved,thenitcanbetreatedasaknowndriving
τ
forcetotwoindependentsubsystems. ItisimportanttonotethattheMarkovblanketassociatedwiththissystemapplies
topaths(i.e.,tothetimeevolutionortrajectoryofasystem),andnottosteadystatedistributions. Alsoimportantto
noteisthatdynamicalsystemsthathaveblanketstructure(i.e.,thatconformtoEq. 6)donotgenerallyresultinsteady
statedistributionsthatalsohaveblanketstructure. See[15]forsomeexceptionstothisgeneralrule.
ThelinkbetweentheMarkovblanketandsubsystemorobjecttypealsofollowsdirectlyfromtheconditionalinde-
pendencerelationship. Thisisbecausetwoobjectswhoseboundariesfollowthesamepathmust,bydefinition,have
thesameeffectontheenvironment,regardlessofthedetailsoftheirinternaldynamics. Asaresult,onecandefinean
objecttypebythepathstatisticsofaMarkovblanket. Seealso[42]. Crucially,wenotethatthisstatisticaldefinitionof
objecttypeisconsistentwiththedefinitionofobjecttypeusedinsystemsidentificationtheory,whichisstandardin
reinforcementlearning. Thisisbecausetheblanketstatisticsfullycharacterizetheinteractionsbetweenasubsystemand
itsenvironment,andthus,includeboththeinputsandoutputsofthesubsystem. Assuch,twoobjectswithverydifferent
internalstructureandstates,butwiththesameboundarystatistics,willalsohavethesameinput-outputrelationshipand
willinteractwiththeirenvironmentinpreciselythesameway. Thisistriviallyobservedinthesimplecasewhereone
canpartitiontheblanketintoactivestatesthatdirectlyinfluencetheexternalvariablesandsensorystatesthatdirectly
influencetheinternalvariables,i.e. b={a,o}. Inthiscase,straightforwardapplicationofBayesruletotheMarkov
blanketbaseddefinitionofobjecttype,p(b )=p(a ,o ),allowsforthedirectcomputationofp(at|o ),whichwe
τ τ τ τ<t
recognizeastheagent’spolicyorthesubsystem’sresponsefunction.
ItisworthnotingthatthisMarkov-blanket-statistics-basedformulationofsystemsequivalenceoffersamorecomplete
descriptionthantheonefromsystemsidentification,inthatitcontainsmorethanjustthepolicyoftheagentorobject
in question. This is because the equations are symmetric and so the blanket statistics also encode the “policy” of
the external system, p(ot|a ). This makes it clear that the Markov-blanket-based definition of an object type is
τ<t
environment-specific.
(a)’Actual’ (b)Equivalent
Figure1: TheMarkovblanketdefinitionofobjectequivalence. Therelationshipbetweentheboundary(green)and
environment(red)arefixed. Theobjectsareequivalentifreplacingtheinternalvariables(blue)andtheirconnectionsto
theboundarywithsomeothersetofvariablesandconnectionswithoutaffectingthedistributionofboundarypaths,
p(b ).
τ
2.2 Themaximumcaliberroutetoanontologicalpotentialfunction
Theutilityofanydefinitionliesinitspredictivepower. Here,weshowthat,whencombinedwithJaynes’principle
ofmaximumcaliber[23,10,31],thisblanketstatisticsbaseddefinitionofanobjectleadsdirectlytoan“ontological
potentialfunction”thatformalizesthenotionobjecttypeintermsofthemacroscopicrulesofbehaviornecessaryto
instantiateanobjectofagiventype,wheretypeisdefinedbyblanketstatistics[41,36]. Thatis,givenpathstatisticson
aMarkovblanket,p(b au),Jaynes’principlecanbeusedtoidentifyanenergyfunctionandassociatedLagrangian
t
thatspecifythedynamicsoftheenvironment,boundary,andobjectvariablesthatgiverisetoanobjectofthattype.
Thisisconsistentwiththenotionofsystemtypingusedinphysics,whereinphysicalsystemsaredefinedbytheenergy
functionsorstationaryactionsthattheyminimize. (Forasimilarargumentbasedonthemaximumentropyprinciple,see
[27].) Here,weshowthatboundarystatisticsleaddirectlytoanobject-specificenergyfunction,anontologicalpotential
functionthatcorrespondstothegeneralizedfreeenergyandassociatedLagrangian. Thisclosesthegapbetweenthe
Markovblanketbaseddefinitionofanobjecttypeandthenotionoftypeusedinstatisticalphysicsandleadsnaturally
toatypologyofsystemsbasedonstatisticalconstraintsimposedontheirMarkovblankets[37].
5
A PREPRINT - MARCH 3, 2025
TheobjectivefunctionthatoneobtainsfromcombiningblanketstatisticswithJaynes’principleofmaximumcaliberis
preciselythefreeenergy,providingthebasisforanalternativederivationoftheFEP.Tothisendwetakeinspiration
fromrecentderivationsofstatisticsphysicsfrompurelyinformationtheoreticconsiderations[31,10],andimpose
boundaryconstraintswithinthemaximumcaliberframework. Weshowthatthisultimatelyresultsinafreeenergy
minimization problem, consistent with the core elements of the path based formulation of the FEP [36]. Jaynes’
principleofmaximumcaliberisaninformationtheoreticformulationthatextendstheconstrainedmaximumentropy
approach[24]tothespaceofpathsortrajectoriesthroughstatespace. Thisinformationtheoreticapproachiscommonly
usedinstatisticalinference,todeterminethemostparsimoniousmodelofsomedata;wherewemaximizeentropyor
caliberunderconstraintderivedfromdataorknownphysicallaws[23]. Morerecently,Jaynes’principleappliedto
pathsthroughstatespacehasbeenshowntoprovideaninformationtheoreticfoundationuponwhichonecanderivethe
equationsuponwhichphysicsisbased;thatis,givenanappropriatelychosensetofconstraints,optimizingJaynes’
caliberobjectiveleadsdirectlytoallthecoreequationsofclassical,statistical,andquantumphysicsinsuchaway
thatthedeeprelationshipsbetweenaction,energy,work,andheat(HamiltonianorLagrangianfunctions)aremade
plain[10,31]. Itcanalsobeusedtodirectlyderivepowerfultheoremsinnon-equilibriumstatisticalphysics,including
Crook’stheorem,Noether’stheorem,theJarzynskiinequality,andthesecondlawofthermodynamicsitself[31,22,19].
ThenearuniformapplicabilityofJaynes’maximumcaliberprinciple,whencombinedwiththeblanket-statistics-based
definitionofanobjecttypeallowsustoincorporatenon-stationaryandnon-ergodicsystemsintotheFEPmodeling
framework,somethingthathadseemeddifficulttomodelusingpreviousformulations(see[6,35,11,30]). Aswe
willsee,thisflexibilitywillallowustodefine—andultimatelydiscover,inadata-drivenmanner—thedynamicor
wanderingMarkovblanketsthatarerequiredtomodelnon-stationary,changing,andmobilethingssuchasflames,
lightningbolts,andtravelingwaves,aswellasobjectsthatexchangematterwiththeirenvironments.
2.2.1 Jaynes’principleandontologicalpotentialfunctions
Mathematically,maximumcaliberbeginswithaprobabilistic,andoftencoarse,characterizationofthelawsofphysics,
p(x˙,x,t). Itthensupposesthatwehaveadditionalinformationabouthowaparticularsystemworks,whichisgivenby
certainconstraintsthattaketheformoftimedependentexpectations
F(t)=⟨f(x˙,x,t)⟩ (8)
These expectations provide “instantaneous” constraints and, when combined with prior knowledge of dynamics,
effectivelydefineasystemtype. Forexample,stationarygeometricconstraints<f(x)>=C,∀tleadtothetraditional
potentialfunctionofclassicalmechanics,whilethekinetictermarisesfromNewton’slaws,asexpressedviap(x˙,x,t).
Aprobabilitylawq(x˙,x,t)associatedwiththatsystemtypeisthenobtainedbymaximizingtherelativepathentropy,
withtheconstraintsenforcedbyLagrangemultipliers,λ(t),i.e.
(cid:28)(cid:90) (cid:29)
S[q(·),λ]=−KL(q(x˙,x,t),p(x˙,x,t))− λ(t)·f(x˙,x,t)dt (9)
q(·)
alongwiththeunstatedadditionalconstraintthatq(·)isawell-definedprobabilitydistribution,i.e. theintegraloverall
pathsis1. WrittenintermsoftheLagrangemultipliers,optimizationofS[·]resultsin
1 (cid:18) (cid:90) (cid:19)
q(x˙,x,t)= p(x˙,x,t)exp − λ(t)·f(x˙,x,t) (10)
Z[λ(t)]
wherethepathentropyatthemaximaisgivenby
(cid:90)
S = logZ[λ(t)]+ λ(t)·F(t)dt (11)
max
Entropy = −Freeenergy+Energy (12)
withassociateddimensionlessLagrangianandaction:
L(x˙,x,t)=logp(x˙,x,t)+λ(t)f(x˙,x,t) (13)
(cid:90)
A[x ]= dtL(x,x˙;t) (14)
τ
6
A PREPRINT - MARCH 3, 2025
Thisrelationshipbetweenexpectedenergy,entropy,andfreeenergyallowsustocastthemaximizationofcaliberasa
freeenergyminimization,consistentwithrecentformulationsoftheFEP[16]. Moreover,armedwiththeLagrangian,
one directly obtains the associated Hamiltonian with the interpretation that Hamiltonian dynamics yield the most
probable path [10]. Constraints that are also independent of time coupled with the assumption of time translation
symmetryleadsdirectlytoconstantλandtheidentificationofaconservedenergy(λ·F).
Critically,wecaninterpretthislogpartitionfunctionformoffreeenergyasapotentialfunction,thepartialderivatives
ofwhichresultingeneralizednotionsofheatandwork[31]. Inthismaximumcaliberframework,itistheconstraints
thatultimatelyleadtothispotentialfunction,aswellasthatLangevinandHamiltoniandynamicsthatdefinephysical
systems. Thisimpliesthattheconstraintsthemselvescanbethoughtofasdefiningsystemtype. Forthisreason,we
concludethatthisfreeenergyfunctionalisanontologicalpotentialfunctionfornoisydynamicalsystems,andacentral
componentofagenericdefinitionof“every”“thing.”
2.2.2 TheMarkovblanketsof“every”“thing”
WhattheFEPapproachaddstoJaynes’principleofmaximumcaliberisaphysicaldefinitionoftheboundaryof“every”
“thing.” Thatis,theFEPaddstomaximumcaliberawayofrepresentingthenotionthatboundariesarenotfictive(e.g.,
merefluxrelationsbetweenvolumes),butrather,thattheycorrespondtodistinct,seperableobjects. Thisisinherited
fromthenotionthatsubsystemsaredefinedbyboundaryorblanketconstraints.
Combiningthenotionofanontologicalpotentialfunction,asdefinedabove,withtheMarkovblanketdefinitionofa
subsystemtypeleadsdirectlytoasimpledefinitionofasubsystemor“object”or“thing”inagivenenvironment:
Maximumcaliberdefinitionofanobject
1. AtimedependentsetormanifoldB ⊂X⊗T,parameterizedbyΩ (t)⊂X thatmaintainsMarkov
B
blanketstructurewithrespecttotheprioronunconstraineddynamicsp(x,x˙)
2. AsetofinstantaneousconstraintsappliedtoboththesetΩ (t)andtheelementsofx∈Ω (t)
B B
Itiseasytoshowthatimposingblanketconstraintsdoesnotdisrupttheconditionalindependencestructureinherited
fromthepriordynamics. Whileitispossibletoenforcetheconstraintthataparticularp(b )berealizeddirectly[10],
τ
wefinditmoreintuitivetore-representtheblanketdistributionbya(possiblyinfinite)setofinstantaneousconstraints
on expectations. Of course, the constraints needed to represent an arbitrary p(b ) are not necessarily the kind of
τ
“instantaneous” constraints that are typically used with the maximum caliber objective. Instantaneous constraints,
however,arepreferredbecausetheyleadtocausaldynamicsandarethereforeconsidered“physicallyrealizable.” We
restrictourselvestothisclassofinstantaneousconstraintsbydefiningatime-dependentblanket, Ω (t) ⊂ X, and
B
imposingconstraintsoftheform
(cid:10) (cid:11)
F (t)= f (x˙,x,t,Ω (t)| (15)
B B B x∈ΩB(t)
Notethatwhenappliedtoablanketthatisamanifold,geometricconstraintssimplyaddanadditionalfluxtermto
theassociatedLangevinequations,butdonototherwisechangetheirstructure. Thisarisesfromthetimederivative
oftheindicatorfunctionthatrestrictsboundaryconstraintstoelementsintheboundary. Thisistrueregardlessof
whetherornottheblanketisconnectedorpersistsforanylengthoftime. Notealsothatjudiciouschoiceofconstraint
functions,f (·),canbeusedtoplaceconstraintsontheshapeandevolutionofthemanifoldΩ (t). Theflexibilityof
B B
thisapproachfollowsfromthefactthattheboundaryΩ (t)canbeeitherspecifiedortreatedasarandomvariablewith
B
supportonthesetofMarkovblanketsspecifiedbythepriorp(·).
Beforemovingon,wenotesomeconnectionstosystemsidentificationandreinforcementlearning.Aspreviouslyshown,
equivalenceofMarkovblanketstatisticsimpliespolicyequivalence. Inreinforcementlearning,thisisoftenreferredto
asstrongequivalencebetweentwoagents. Sincepoliciescanbederivedfromtheblanketstatistics,equivalenceof
Markovblanketstatisticsimpliespolicyequivalence;andtherefore,agentsthatshareMarkovblanketstatisticsare
agentsofthesametype. Reinforcementlearningalsohasanotionofweakequivalencethatisassociatedwithagents
thatachievethesamerewardrate. Inaninfinitehorizonsetting,witharewardfunctionthatonlydependsonactions
andoutcomes,agentsthataredefinedbystationaryboundarystatisticsnecessarilyachievethesamerewardrate. The
converseisalsotrue: namely,agentswiththesamestationaryboundarystatisticshavethesamerewardfunction,under
theassumptionsimposedbythemaximumentropyinversereinforcementlearningparadigm[49,45]. Thismeansthat
weaklyequivalentagentsareassociatedwithconstraintsonthestationarydistributionoftheboundary,p˜(b). Amore
directlinktoreinforcementlearningcanalsobeseenbynotingthelinkbetweenJaynes’maximumcaliberobjective
andthatofKLcontroltheory[26,12]. ThismakesitplainthattheMarkovblanketstatisticsbasednotionofobject
7
A PREPRINT - MARCH 3, 2025
typeandassociatedontologicalpotentialfunctionsubsumestherelevantnotionsofsystemsequivalenceusedinboth
systemsidentificationandcontemporaryreinforcementlearning.
Inshort,thismaximumcaliber,blanket-statistics-baseddefinitionofobjecttypehasthedesiredpropertythatitiswidely
applicable,consistentwithsystemsidentificationtheory,andassociatedwithaconsistentobjectivefunction,namely,
thefreeenergy. WhilethespecificdetailsoftheconstraintsimposedbyF indicateanobject’sparticulartype,gross
B
propertiesoftheconstraintfunctionsthemselvescanbeusedtoclassifydifferentkindsofobjects. Italsosuggeststhe
possibilityofdevelopingataxonomyofdifferentobjecttypesbasedonthedomainoftheblanketandthekindsof
“ontological”orobject-type-specificconstraintsimposed. Forexample,itisstandardinthestatisticalphysicsliterature
torefertoconstraintsthatonlydependuponxasgeometricconstraints. Theapproachoutlinedhereelucidatesatleast
threedegreesoffreedomalongwhichconstraintscanbedefined: theshapeortopologyoftheboundaryΩ (t),the
B
dynamicsoftheboundary,andthestatisticsoftheboundary. Forexample,theboundaryofacellis,topologically
speaking,asphericalsurfacethatisdynamicbecauseitexchangesmatterwithitsenvironment,andthathasstationary
boundarystatisticstotheextentthatachieveshomeostasisinitsenvironment. Arigidbody,ontheotherhand,hasno
internalstatesperse,andthushasaspherical“boundary”thatisstaticinthesensethatitdoesnotchangeshape,but
dynamicinthesensethatitcanmove.
2.3 Asimpleexample: theflame
AcommoncriticismoftheMarkovblanketdefinitionofa“thing”hasbeenthatthisdefinitiondoesnotapplytoflames
[30,35]. ThismisconceptionresultsfromthefalseassumptionthatMarkovblanketsmustbestaticortiedtomatter.
However,theformalismpresentedhereneatlycapturesflamesandothertravelingwaves,duetotheflexibilityendowed
viaaconsiderationofdynamicboundaries.
Forexample,considerasimpleflameburningdownaonedimensionalfuseasanunsteadytravelingwave(weprovide
anumericalexampleinthefollowingsections). Here,wewilldefinetheboundarytobethepointthatseparatesburned
fromunburnedregions,y (t). Theconstraintwewillimposeisthatthetemperatureatthispointshouldcorrespondto
b
theignitiontemperatureoftheexothermicchemicalreactionthatdrivestheflame
(cid:28)(cid:90) (cid:29)
θ = dy′δ(y′−y (t))T(y′,t) (16)
ig b
ImplementingthisconstraintresultsinaLagrangianandmaximumaposteriori(MAP)estimateoftemperaturegiven
by:
(cid:90)
L(T,T˙,∇2T,y (t),t)=logp(·)+λ(t) dy′δ(y′−y (t))T(y′,t) (17)
b b
(cid:18) ∂ ∂2 (cid:19)
− +h T =σ2λ(t)δ(y−y (t)) (18)
∂t ∂y2 map p b
Thus,theimpositionoftheconstraintresultsinapointheatsourceattheboundary,withmagnitudeproportionaltothe
Lagrangemultiplierthatimplementstheconstraint. Here,σ2representsthevarianceofthedeviationfromapriorthat
p
favorstheheatequationfora1dimensionalsolidsubjecttoNewton’slawofcooling. Recallthatenergyisgivenbythe
(cid:82)
constraint: dtλ(t)θ allowingfortheinterpretationofλ(t)astheenergythatmustbeinjectedintothesystemin
ig
ordertokeeptheflamemovingataspecifiedvelocityy˙ (t).
f
Whilethisexampleillustrateshowconstraintsandboundariescanworktogethertoleadtoconsistentandsensible
dynamics,itisnotquitewhatwewouldlike. Ideally,wewouldlikeaprobabilitydistributionoverpathsthatincludesa
distributionovertheboundarylocationandstate. Thisrequiresapriorthatoperatesonthelocationoftheboundary,and
thatingeneralcanincludeadditionalconstraints. Thisallowsustotreaty (t)inthesamewayasT(y,t),resultingin
b
anexpansionofthesetofequationsthatmustbesimultaneouslysolvedinordertodetermineMAPdynamicsforboth
temperatureandflamespeed. Forexample,ifweassumeapriorithattheflamespeedisnormallydistributed,thenwe
acquireanadditionalEuler-Lagrangeequationthatrelatesflamespeedfluctuationstoheatreleaseandtemperatureflux
attheboundary:
d2 ∂
y (t)=σ2 λ(t) T (y (t),t). (19)
dt2 b yb ∂y map b
8
A PREPRINT - MARCH 3, 2025
2.4 Summarysofar
Inpractice,howdoyouuseanontologicalpotentialfunction? Webeginbyspecifyingaphysicsviaapriorondynamics
p(x˙,x,t),andwethenspecifythestatisticalpropertiesofaboundaryviaconstraints. Thedynamicalsystemthatresults
fromthisspecificationisguaranteedtogiverisetothekindofobjectspecifiedbytheboundarystatistics. Thiscanbe
interpretedasansweringthequestions: (1)howmustmicroscopicelements(bothinternalandexternaltothesubsystem)
organizethemselves,or(2)howmustenergybeinjectedintoanddissipatedbythesystem,inordertoinstantiatea
boundaryofthespecifiedtype.2
However,thismethodofinstantiatingthedesiredobjectstilldoesnotallowustodeterminewhichparticularsubsetsof
agivendynamicalsystemsystemshouldqualifyasanobject. Itonlytellsussomethingaboutsystemsthatsupport
particularkindsofobjectsthatwehavealreadyidentified. Indeed,despitetheirutility,allthemethodsjustrevieweddo
notadequatelyaddresstheproblemofsubsystemidentificationandtypification,preciselybecausetheboundariesare
effectivelyuserdefined.
HavingestablishedthatsensibleboundariescorrespondtoMarkovblankets,itistemptingtoconcludethatanycollection
ofelementsthathasaMarkovblanketcorrespondstoanobject. Unfortunately,thedefinitionofaMarkovblanketistoo
expansivetobeofpracticaluse,sinceeverysnapshotofeverymicroscopicelementhasablanket(Fig2a);see[6]for
criticaldiscussion. Forthisreason,muchoftheFEPliteraturehasadoptedtheadditionalprinciplefor“thing-ness”:
namely, stationarity[9]. Thatis, theblanketandobjectmustbeapropersubsetofthesystemasawhole, andthe
elementsthatmakeuptheblanketandobjectmustnotchangewithtime[15]. Thisassumptioneliminatesanarbitrary
fluid element from consideration, since matter can freely pass into and out of the element. As it does, the matter
transitionsfrombeinginsidetooutsidetheobjectbypassingthroughtheblanket,andthus,theblanketisnotstationary
withrespecttotheelementsthatmakeupthefluid. Butthisrulesoutthepossibilityofmodelingallsortsofinteresting
systems,indeedperhapsthemostinterestingones,whichhavedynamicboundariesandwhichexperiencematerial
turnover.
Here,wearguethatthisstationaryformulationofboundariesisbothtoorestrictiveandnotrestrictiveenoughforour
purposes. Ontheonehand,itistoorestrictive,becauseblanketstationarityprohibitsonefromconcludingthataflame,
oranytravelingwave,forthatmatter,isanobject. Thisisbecausetheelementsofthemediumthatmakeupatraveling
wavechangeasthewavemovesthroughmatter. Ontheotherhand,itisnotrestrictiveenough,becauseitimpliesthat
anyarbitraryconnectedsubsetofelementscorrespondtoanobject. Intheflameexampleabove,thismeansthatany
segmentoftheoriginalfuse,downwhichtheflameburns,mustcountasathing,independentofthetemperatureprofile,
reactionrate,andtheirdynamics.
Whatthisexamplemakesclearisthatamoregeneraldefinitionofanobjectorthingshouldbeabletoaccommodate
thenotionofablanketthatcanmoveorchange,andshouldincorporatesomeaspectsofthedynamicsofthesystem
asawhole. Moreover,theinclusionofdynamicblanketsresultsinamassiveexpansionofthenumberofblankets
presentinanygivensystem. Itisclearthatwhatisneededisanadditionalprinciplethatallowsustoselectthose
blanketsthatcorrespondtothethingsthatwewouldliketocallthings. Sincethegoalistosensiblycarvetheworldat
itsjoints,anobviouschoiceforsuchaprincipleisOccam’srazor,appliedtotheglobaldynamics. Weimplementthis
newprinciplebyseekinglow-dimensionaldynamicalsystemswithdynamicMarkovblanketstructureandemploya
BayesianmodelingapproachtoinstantiateOccam’srazor.
3 AdynamicMarkovblanketdetectionalgorithm
Wenowpresent,ingeneralform,aprobabilisticgenerativemodelwithdynamicMarkovblanketstructurethatcanbe
invertedtoidentifyMarkovblanketsandwellasclassifyobjectsintotypesaccordingtotheirblanketstatisticsand
dynamics. Markovblanketdetectionis,ingeneral,adifficultproblem. Eveninstaticsettings,itisNP-hard[18,48].
Thisisbecause,eveninasituationwheretheblanketsarestationary,thenumberofMarkovblanketsinagivensystem
growscombinatoriallywiththenumberofsystemcomponents. Allowingforblanketstobedynamiconlymakesthings
worse.
Wesidestepthisissuebytakinginspirationfrommacroscopicphysicaldiscovery,whichfocusesondiscoveringlow-
dimensionaldynamicsthatsummarizehigh-dimensionalsystems. Specifically,weproposeaclassofdimensionality
reductionalgorithmsthatpartitionhigh-dimensionaldynamicalsystemsintosubsystemsthathaveMarkovblanket
structure.Thisisaccomplishedviathepresumptionthatlow-dimensionallatentdynamicshaveMarkovblanketstructure
andthateachelementintheoriginalhigh-dimensionalobservationspaceisdrivenbyjustoneofthelow-dimensional
2Ofcourse,thedynamicsobtainedtherebyarenotunique:Theremightindeedbelowerentropysolutions.However,theone
obtainedviathismaximumcaliberapproachcanbeguaranteedtobethemostgeneral.
9
A PREPRINT - MARCH 3, 2025
(a)Fundamentalblanket
Space
emiT
(b)Staticblanket
Space
emiT
(c)Disconnectedblanket
Space
emiT
(d)Movingblanket
Space
emiT
Figure2: Inaspatiallyconnecteddomainwithnearestneighborconnectivity,theblanketofasinglenodeattimet
(a)consistsofitsparents(thethreeadjacentnodesattheprevioustimestep),itschildren(thethreeadjacentnodesat
thenexttimestep),anditsco-parents(whichconsistofthetwonodesimmediatelytotheleftandright). Thisimplies
thatgradientscanalwaysbecomputedontheboundary. Astaticorstationaryblanket(b)isdefinedashavingaspatial
location that does not change. The intersection of any two blankets makes up blanket allowing for blankets to be
disconnected(c). Travelingwavesareassociatedwithmovingblankets(d). Alloftheseblankets(andmany,many
more)arepresentsolelybyvirtueofthetopologyofthenetworkindependentofitsdynamics.
10
A PREPRINT - MARCH 3, 2025
latents. Forexample,inthecasewhereasingleobjectisassumedtobepresent,weseekasetofstatevariablesthat
represents the environment (s) and two sets of state variables for each object: one that summarizes the collective
behavior of the elements that belong to the boundary (b) and another that describes the collective behavior of the
elementsthatareinsidetheboundary(z). Weleaveopenthepossibilitythatthesetofinternalelementsmaybeempty.
Wedesignenoughflexibilityintothemodeltodiscoverobjectsthathavenon-stationaryblanketsbydirectlymodeling
the boundary, Σ (t), as a latent assignment variable. This is accomplished by instantiating a dynamic attention
B
mechanismthatprobabilisticallyassignsalabeltoeachmicroscopicelementormeasurement. Theselabelsindicate
whetherthatelementisaninternal,external,orblanketelement. Transitionsbetweentheselabelsobeytheusualrules
forMarkovblankets,i.e.,labeltransitionsfrominternaltoexternalareprohibitedandlabeltransitionprobabilities
dependonlyonthemacroscopicblanketvariables. Whenmultipleobjectsarepresent,weallowforthepossibilitythat
thereareasetofmacroscopicvariablefortheboundaryofeachobject(b )aswellasitsinternalstate(z ),n=1···N
n n
andasingleenvironmentvariables. Observeddata,denotedy (t)∈RD,areassumedtobearelativelyfine-grained
i
measurementoftheactivity. Associatedwitheachobservationindexiisoneofthediscretetimedependentlabels
ω (t) ∈ {S,B ,Z }. These labels identify the boundary of each object and determine which of the macroscopic
i n n
variablesinfluencestheassociatedmicroscopicobservation. Specifically,thelabelassociatedwitheachmeasurement
determinestheconditionalindependencerelationship:
p(y (t)|ω (t)=Z ,s(t),{b( t),z (t)})=p(y (t)|ω (t)=Z ,z (t)) (20)
i i n n n i i n n
withsimilarequationsholdingforthecaseswhereω (t)isSorB . Thoughwritteningenerativeform,thisobservation
i n
modelcorrespondstoanoisynon-linearprojectionfromobservationstotargetmacroscopicvariables,modulatedbythe
assignmentvariables. Thedynamicsofboththemacroscopicvariablesandthetransitionprobabilitiesoftheassignment
variablesareconstrainedtoobeyMarkovblanketstructure,withtheaddedrestrictionthatthetransitionprobabilitiesfor
thelabelsdependonlyontheboundaryvariables.
dp
i =T({b })p (21)
dt n i
whereT(·)isa1+2nx1+2nmatrix,constrainedsuchthatT ({b }=T ({b })=0prohibitingelementlabels
SZn n ZnS n
fromtransitioningdirectlyfromobjecttoenvironment. Similarly,thedynamicsofthelatentvariablesareconstrained
suchthattheJacobianoftheglobaldynamicsonlyallowsz -b andb -sinteractions. SeeFig. 3a.
n n n
Thisconstitutesthegeneralformofthiskindclassofblanketdiscoveryalgorithms. Inordertoconvertthisgeneral
dynamicMarkovblanketmodelintoamoretractableform,afewadditionalsimplifyingassumptionsarerequired. For
example,non-lineardynamicscouldbeimplementedviarecurrentswitchingdynamicssystemanddiscoveredthrough
variationalinference[29]orspecifiedbyaneuralnetworkandlearnedviagradientdescent[34]. Here,wewillassume
simplelineardynamicsandinstantiatethenon-linearobservationalmodelusingaswitchinglineartransform. Wewill
alsoassumethattransitionprobabilitiesfortheassignmentvariablesareaprioriindependentofthemacroscopiclatents.
ThisleadstoafactorialHiddenMarkovModel(HMM)thatmixesdiscreteandcontinuouslatentvariables,withthe
uniquefeaturethatthelabelsassociatedwitheveryobservationalnodeihasitsowndiscreteHMM.SeeFig. 4.
Forasingleobjectthislinearmodelisgivenby
s′,b′,z′|s,b,z ∼ Normal(A[s,b,z]+B,Σ ) (22)
sbz
ω′ ∼ Categorical(Tω ) (23)
i i
y ∼ Normal(C [s,b,z]+D ,Σ ) (24)
i ωi ωi ωi
wherethematrixAisconstrainedtohaveMarkovblanketstructurebyplacingblocksofzerosintheupperrightand
lowerleftcorners. Similarly,themeansofC ,C ,andC areconstrainedtohaveblocksofzerossothatobservations
S B Z
onlydependupononeofthethreecontinuouslatents. Theseconstraintsareimposedonthemeanviatheactionof
Lagrange multipliers. We reduce the degeneracy of the model by assuming that Σ is diagonal, with unit trace
sbz
imposedontheposteriormean,alsoviatheactionofLagrangemultipliers. Thisfurtherencouragesthediscoveryof
low-dimensionalmacroscopicdynamicsviatheactionoftheautomaticOccam‘srazoreffectofBayesianinference.
Inordertomodelthenon-linearobservationmodel,weexpandthedomainofthediscretelatentassignmentvariablesto
include“roles”associatedwitheachofthelabels,S,B,Z. ThiseffectivelyinstantiatesahierarchicalhiddenMarkov
model(HHMM)forthelabelassignmentvariables,wheretheblanketstructureisenforcedatthehighestlevelofthe
hierarchy,andthelowestlevelrepresentsamixtureoflinearexpertsmodeltodescribetherelationshipbetweenthe
11
A PREPRINT - MARCH 3, 2025
(a)Transitionmatrix(AorT) (b)ObservationtensorB[:,roles,latents]
Figure3: (a)ConstraintsontransitionmatricesandobservationtensorsforN =3objects. (b)Theobservationmodel,
undertheassumptionthatthereare4rolesperlatentanda4dimensionsineachobservationvectory (t).
i
targeted macroscopic variable and the observation. This is depicted in Fig. 3b. Note that we could have used the
sametrickforthedynamics,effectivelyimplementingarecurrentswitchingdynamicalsystem,butrationalizedlinear
dynamicswithanon-linearobservationmodel,asaninstantiationoftheKoopmanembeddingtrick[28]
3.1 Inferenceandlearning
WeapproximateBayesianinferenceusingvariationalBayesianexpectationmaximization(VBEM),withaposterior
thatfactorizesoverparametersandthetwoclassesoflatents,i.e.
q(s,b,z,ω,Θ)=q (s,b,z)q (ω)q (Θ) (25)
sbz ω Θ
whereΘ={A,B,C ,D ,Σ−1,Σ−1 ,T}. Thisleadstoaninferencealgorithmthatiterativelyupdatesq (s,b,z)
ω ω sbz S,B,Z sbz
andq (ω)untilconvergence,i.e.,
ω
logq (ω) = ⟨logp(s,b,z,ω|Θ)⟩ (26)
ω p(s,b,z)p(Θ)
logq (s,b,z) = ⟨logp(s,b,z,ω|Θ)⟩ (27)
sbz p(ω)p(Θ)
Thisfollowstheattend,infer,repeat(AIR)paradigm[14],wheretheposteriorupdatesovertheassignmentvariable
trajectories,ω (t),correspondstotheattentionalupdate,whichisthenfollowedbyjointlyinferrings,b,andz,and
i
thenrepeatingpriortoupdatingtheposteriordistributionsovertheparameters. Notethatunrollingthesetwostepsinto
aneuralnetworkimplementationleadstoavariationonthepowerfultransformerarchitecture[46],butwithadded
structurethattiesattentionvariablesacrosslayersofthenetworkimplementation.
Note that we do not factorize q (·) or q (·) over time, but instead implement a forward-backward scheme that
sbz ω
performsexactcomputationoftheposteriordistributionoverthelatentvariables[3]. Conditionalconjugacyallowsus
touseamatrixnormalgammadistributionforq(A,B,Σ−1),amatrixnormalinverseWishartforq(C ,D ,Σ−1),
ω ω ω
DirichletforrowsofT,andnormalinverseWishartdistributionsandDirichletdistributionsfortherelevantinitial
conditions. CoordinateupdaterulesforthenaturalparametersoftheposteriorsoverΘwereaugmentedbyalearning
rateparameter,typicallysetto0.5,inordertoenableparameterlearningonminibatchesoftrajectoriesandreapthe
benefitsofstochasticnaturalgradientdescent[25].
12
A PREPRINT - MARCH 3, 2025
st−1 st st+1
bt−1 bt bt+1
zt−1 zt zt+1
yt−1 yt yt+1
i i i
ωt−1 ωt ωt+1
i i i
i=1,2,...,N
Figure 4: Generative model for factorial hidden Markov model with Markov blanket structure. The dashed lines
determinehowthemacroscopicblanketvariablesaffectstheevolutionoftheblanketlabels. Thisbreaksthefactorial
structure,increasingthecomplexityofinference. However,whensimulatingdataforalgorithmtestingpurposes,these
connectionshelpmaintainthestabilityorpermanenceofobjects.
4 Results
WepresentsimplenumericalexperimentsthatdemonstratehowadynamicMarkovblanketdetectionalgorithmsensibly
labelsthecomponentsofNewton’scradle,aburningfuse,theLorenzattractor,andanartificiallifesimulation.Inference
andlearningforthismodelareimplementedusingacustommessagepassingframework, specificallydesignedto
exploit conditional conjugacy and stochastic coordinate ascent [21]. The code for the dynamic Markov blanket
detectionalgorithmandtheVBEMinferencemodulesuponwhichitisbuiltcanbefoundathttps://github.com/
bayesianempirimancer/pyDMBD. Allsimulationsaretrainedonthecompletedataset,withalearningratesetto
0.5for50trainingepochs. Thisisdoneaminimumof10times. Resultsshownarefromthecomputationalrunthat
achievesthelargestexpectedlowerbound(ELBO)ontheloglikelihood.
4.1 Newton’scradle
ThesimulationofNewton’scradleconsistsof5ballsofequalsizeandshapethataresuspendedfromstrings,whichare
separatedbyadistanceequaltothediameterofanyball. Atrest,theballshangtogether,justbarelytouching. Whenthe
leftmostballisgivenaninitialpositionawayfromtheother4,itswingsdown,haltsitsmotionatitsrestingposition,
andtransfersitsmomentumthroughtotheotherballs. Thesemoveinsequenceandsimilarlytransfertheirmomentum
uptotherightmostball,whichthisswingsupandaway;beforereturning,andrepeatingtheprocess. Iftwoballsare
initiallyperturbed,thentwoballswillpopouttheotherside,andsoon. WesimulateaNewton’scradlewitheitherzero,
one,two,orthreeballsinitiallyperturbedbythesamerandomlyselectedanglebetween0and3π/2. Alltheballsare
thenrandomlyperturbedbyasmallangledifference,withstandarddeviation0.1radians.
13
A PREPRINT - MARCH 3, 2025
Appliedtothisdataset,astaticMarkovblanketdetectionalgorithmbaseduponexertedforces[15]discoversasingle
object,centeredonthemiddleball,regardlessofthedynamicsofthesystem,andwithoutregardforthenumberof
initiallydisplacedballs. Incontrast,thedynamicMarkovblanketdetectionalgorithmlabelstheballsinamannerthatis
consistentwithhumanintuition: thatis,wetendtoperceiveNewton’scradledynamicsaseitherasapendulumorasa
setpairofinteractingsetsofballs,oneontheleftandoneontheright. Thesetwocommonpreceptsmappreciselyonto
thetwomostcommonlydiscoveredpartitiondiscoveredbythissimpleDMBDalgorithm. Specifically,Fig. 5depicts
thesetwosolutions,wherecolorindicateslabel,withgreenforboundary,andredandblueforobjectandenvironment.
Iftwoballsormoreballsareinitiallyperturbed,thentheballsthatmovetogetherarealwaysgiventhesameassignment.
Themostcommonlydiscoveredsolution(Fig. 5(a-c))labelstheobjectasthemovingballs,regardlessofwhichsideof
thecradletheyareon. Inthiscase,theenvironmentlabelisassignedtothemoreorlessstationaryballs. Theboundary
consistsoftheballsthatverybrieflyobtainhighvelocityduetocollision. Asaresult,theboundaryisnotphysically
realisedmostofthetime. Thesecondmostcommonlyidentifiedpartitionlocatestheboundaryasthestationaryballs,
andlabelstheobjectandenvironmentasthemovingballs. Theballononesideisalwayslabeledenvironmentandthe
ballontheothersideislabeledobject. SeeFig5(d-f). Onceagain,whentheleftmostorrightmostballsaremoreorless
stationary,theybecomepartoftheboundary.
(a)Theobject(blue)startsontheright (b)Acollisioncreatesablanket (c)Theobjectemergesontheleft
(d)Theobject(blue)startsontheright (e)Theballisabsorbedintotheblanket (f)Theenvironmentemergesontheleft
Figure5: Newton’sCradle. In(a-c),theballthatmakesuptheobject(blue)collideswiththeenvironment(red). Since
theforcetransmittedmustpassthroughtheboundary,thedynamicMarkovblanketdiscoveryalgorithmlabelsthe
ballsontheperipheryastemporarilybecomingpartoftheblanket. Themomentumisthenpassedthroughtotheballs
thatmakeuptheenvironment,andistransferredtotheballontheleft,whichalsotemporarilybecomespartofthe
blanket,beforeemergingastheobjectontheotherside. In(d-f),weseeanothercommonsolutiontothisproblem
thatisdiscoveredbythedynamicMarkovblanketdiscoveryalgorithm. Inthatsolution,theblanketconsistsofthe
stationaryballs. Whenenergyistransferredtotheballontheright,itispartoftheobject. Whenenergyistransferred
totheballontheleft,itispartoftheenvironment.
4.2 Aburningfuse
Todemonstratehowthisapproachcanhandleflamesandtravelingwaves,wemodelacombustionfronttravelingdown
aonedimensionalmedium,i.e.,aburningfuse. Thefuseismodeledasanin-homogeneousmediumcomposedof
discretefuelparticlesseparatedbyarandomdistance,withunitmeanandvarianceof0.02. Anoxidizerismodeled
asadiffusiveprocesswithaninexhaustiblesource,orthogonaltothefuse. Itseffectoncombustionistodetermine
therateofheatrelease. Ignitionoccurswhentheparticlereachesacriticaltemperature. Thefuseisassumedhave
constantthermaldiffusivityof1. Weselectthistoymodelbecauseitisknowntosupporttravelingwavesthatpropagate
smoothly,periodically,orchaotically,evenintheabsenceofrandomperturbationstofuelparticlesize,location,and
oxidizeravailability[4]. Here,theobservablevariables,ytconsistofthefuelandoxidizerconcentrations,aswellas
i
thetemperatureateachlocationonthefuse,i. Broadlyspeaking,aheadofthecombustionfront,fuelandoxidizerare
plentiful;andbehindthecombustionfront,fuelisabsentbutoxidizerisplentiful. Insidethecombustionfront,fuel
rapidlydropstozero,oxidizerdipsandthenreturnstoalevelthatcorrespondstoitscurrentavailability,andheatis
released(SeeFig. 8a). Wesimulateavarietyofcombustionwavesbysystematicallyvaryingthefuelavailabilityas
afunctionoflocationandtheoxidizeravailabilityasafunctionoftime. Theconjunctionoftheseparametersdrives
14
A PREPRINT - MARCH 3, 2025
(a)Case1:Middleballscorrespondtotheenvironmentand (b)Case2:Thestationaryballsareassignedtotheboundary.
movingballsistheenvironment. Duringtransitionofthe When the moving ball is on the left, it is labeled as the
objectfromthelefttotherightside,thereisabriefperiod environment;andwhenthemovingballisontheright,itis
whentheboundaryappearsassociatedwithimpacts. labeledastheobject.
Figure 6: The principal component is computed independently for the most likely path taken for each of the 4
dimensionallatents: s,b,z. Thedynamicsofthelatentassignmentsforeachballaresummarizedbythetotalnumberof
ballsassignedtotheenvironment,blanket,andobject. Notethatthemacroscopiclatentvariablesarehighlycorrelated
andpersistevenwhentheylackphysicalrealizationviaassignmenttoaball. Thisisconsistentwiththenotionthat
internal(andblanket)variablesmaintainarepresentationoftheenvironment,consistentwithBayesianmechanics.
variabilityinrateofheatreleasedasthefuelparticlesburned. Wealsomanipulatetheignitiontemperatureacrossa
smallrangeofvalues(0.4,0.5). Thisleadstocombustionwavesthattravelatdifferentaveragespeeds,witharangeof
periodicorrandomfluctuations. Somecombustionwavesalsogoextinct. Fig. 8(b)showsanexampleofawavethat
hasperiodicfluctuationsinwavespeed. Curiously,theinternalvariableshowslittlecorrelationwithobjectpositionand
seemstoonlyrepresentheatrelease9. Incontrast,itistheenvironmentalvariablethatismoststronglycorrelatedwith
flameposition. Forcompleteness,wenotethatwhiletheresultsshownherearethemostcommonresult,thealgorithm
sometimesconvergesonlesssensiblesolutions. Forexample,theobjectsometimescorrespondstotheburnedportion
behindthecombustionwaveandtheboundarysometimescorrespondstotheregioninwhichheatisreleased. The
solutionspreviouslydescribed,however,areassociatedwiththegreatestELBOsandsoarestronglypreferredbya
Bayesianmodelcomparison.
4.3 Lorenzattractor
TheLornezattractoralsoprovidesauniquetestbedforthisapproach. Inthiscase,thereisasingle3dimensional
observation,thex,y,zpositionoftheobject. Thechaoticdynamicsofthesystemsupportstwolow(∼2)dimensional
attractorsandglobaldynamicsthatswitchbetweentheattractingmanifolds. Here,thealgorithmdiscoverswhatcould
becalledaphasetransition,bylabelingtheobservationaspartofthe“object”whenitisneartotheattractorontheleft
andpartofthe”environment”whenitisneartoattractorontheright. Theboundarylabelissensiblyassociatedwith
thepartofthetrajectorythatdescribesthetransitionbetweenthetwoattractors. Becauseofthesymmetryassociated
withobjectandenvironment,wecouldinterpretthisasmodelingaphasetransitioninwhichansingleobjectchanges
identityafterpassingthroughaphasetransitionboundary.
4.4 Syntheticbiologysimulation
For a final example, we use Particle Lenia to simulate a self-organizing system that exhibit cell-like structure and
behavior. We use the “rotator” example [7] for the simulation. Individual particles are characterized by different
distance-dependentattractionandrepulsionfunctions. Thisleadstointerestingself-organizingbehaviordepictedinFig.
11,whichshowsaninitiallyrandomsoupofparticlesquicklythatformsintoacell-likeobject,witha“nucleus”and
simple“cellmembrane.” Aftersometime,themembranedevelopsrotatingflagella-likestructures,andthenucleus
tightensintoasmallershape. Weusethissimulationasatestbedforthismultiple-objectdiscoveryscheme,inthe
hopesthatitisabletodiscoverthatthedifferent“parts”ofthecellaredifferentobjectsinacommonenvironment. We
assumethepresenceof11differentobjects,eachcharacterizedby2dimensionaldynamicsfortheblanketandobject
variables. Eachobjectislinkedtoobservationsviaasingleroleforeachoftheblanketandobjectlatents,toencourage
15
A PREPRINT - MARCH 3, 2025
(a)Idealizedcombustionwave (b)Fuseinthewind
Figure7
Figure 8: The algorithm is trained on 200 flame trajectories with 4 dimensions per latent and a total of 12 roles.
Observablesaresampledat200even-spacedlocationsand800pointsintime. Discovereddynamicsareroughly6
dimensional. Typicalroleusageisabout7intotal. Fig. 9showsthemaximumaposteriorilabelassignmentsthat
thealgorithmmakestoeachnodeateachpointintime,whenpresentedwithaflamethatgoesextinctatapproximate
t=120. Bluerepresentstheflame,redtheenvironment,andgreentheboundary. Theuseofrolesiscriticalinthiscase,
becausetheenvironmentbehavesverydifferentlydependinguponwhetheritcorrespondstoburnedversusunburned
fuse. Indeed, theblanketonlyusestworoles: oneforeachofthefrontandbackofthereactionzone. Theobject
requiresonlyasinglerole.
(a)NodeAssignments:environmentinred,blanketingreen, (b)Theinternalvariable(blue)tracksthenegativeofheat
objectinblue. Aroundtimet=120theflamegoesextinct released. Theenvironmentvariabletracksflamelocation.
anddisappears. Notethatatapproximatelyt=125,theflamegoesextinct.
Figure9
thediscoveryofspatiallylocalizedobjects. Intheexampleshown,thesimulationdiscovers5objects,correspondingto
(1)adisorderedstate(green),(2)simplecellmembrane(yellow),(3)complexcellmembrane(orange),(4)disordered
nucleus (purple), and (5) tight nucleus (blue). This illustrates the potential utility of thisapproach for segmenting
complexsystemsintomultipleinteractingdynamicsubsystems.
5 Discussion
Inthispaper,wesituatedtheFEP,Bayesianmechanics,Markovblankets,andontologicalpotentialfunctionswithin
thebroadersetofideasinBayesianstatisticsandinformationtheory,attheintersectionofJaynesianandBayesian
approachestomathematicalphysics,andtomathematicalmodelingmoregenerally. Inparticular,theworkthatwe
presentedhereshowsthat,inordertoapplythelogicandconstructsoftheFEPtomodelinterestingthings,wemust
16
A PREPRINT - MARCH 3, 2025
(c) Principal components and assign-
(a)LorenzAttractor. (b)Twodimensionalprojection ments
Figure10: Redrepresentstheenvironment,greenrepresentstheblanket,bluerepresentstheobject. Wheninthe∼2
dimensionaloscillatingstate,theobjectispresent. Notethat,ataboutt=50,theattractorontheleftnearlycompletely
capturesthedynamicsforanextendedperiodoftime.
stepoutsideofthelogicoftheFEPitselfandcalluponanadditionalprinciple, bywhichtopickthebestMarkov
blanketpartition,outoftheexponentiallymanydifferentpossibleones. Satisfyingly,thisturnedouttobethesamecore
ideasfromwhichwestartedindevelopingtheFEPinthefirstplace: Jaynes’principleandsurpriseminimization. This
isunsurprisingtous,becausethedynamicMarkovblanketdetectionalgorithmthatwedevelopedisitselfbasedonthe
sameunderlyingideasthatledtothedevelopmentoftheFEP.
WeproposedaclassofmodelsandassociatedinferencealgorithmsthattreattheproblemofdynamicMarkovblanket
detection as a macroscopic physics discovery problem, which are fundamentally based upon the identification of
dynamicboundaryelementsthatresultinthesimplestmacroscopicdescriptionofthesystemasawhole. Theoutput
ofthisprocessisasetofmacroscopicobject-type-specificrulesthatgoverntheinteractionsbetweentheboundary
ofanobjectandtheenvironmentinwhichitisembedded(mediatedbysomepossiblyfictiveinternalvariables). We
motivated this approach by arguing that it is the statistics of Markov blankets that define object type, in a manner
consistentwithsystemsidentificationtheoryandreinforcementlearning;andbyarguingthat,whencombinedwith
Jaynes’principleofmaximumcaliber,thisdefinitionleadstofamiliardescriptionsoftheassociatedphysicalsystemsin
termsofenergyfunctions,Hamiltonians,andLagrangians. Moreover,thecombinationofthesemathematicaltools
leadsdirectlytoacharacterizationofobjectsintermsofanontologicalpotentialfunctionthatpreciselycorrespondsto
thefreeenergyfunctional,andtherefore,correspondstoanalternativederivationoftheFEPthatstartsfrominformation
theory(maximumcalibermodeling),asopposedtothetraditionalapproachtoderivingtheFEP,whichbeginswiththe
equationsofstatisticalphysics.
Onitsown,thisinformationtheoreticapproachtotypingobjectsisincapableofdeterminingwhichofthemanydynamic
blanketsinasystemshouldbelabeledaspropersubsystem. Toresolvethisambiguity,weappealedtoanadditional
principle: parsimony. Thatis,goodlabelsshouldleadtoacompact,low-dimensionaldescriptionofthesystemasa
whole. Thisisnotmeanttoimplythatlabeledobjectshavesomekindofmetaphysicalsignificance,onlythatgood
labelsareusefulforprediction,generalization,anddatacompression.
Toseehowallthismightapplyingeneral,considerthehumbleproton. Despitebeingcomposedofaveritablezoo
of more fundamental particles, correctly applying the label “proton“ to the zoo results in a lower entropy of our
observations,iffornootherreasonthanthefactthatprotonshavepositivecharge,aparticularmass,etc.,andbehave
accordingly; whilearandomlyselectedparticlemighthaveadifferentmass,charge,etc.,andaccordingly,behave
differently. Indeed,thatiswhythezoowasgivenalabel: Thelabelhaspredictivepower,inthesensethat,giventhe
labelandknowledgeoftheobservablepropertiesofaproton(position,momentum,spin,etc.),wecanpredicthowthe
particlewillinteractwithotherthingsinitsenvironmentwithouthavingtothinkaboutwhat’sgoingoninside.
Thatis,goodlabelsgloballyminimizetheconditionalentropyoffutureobservations(orsurprise). Inthatsense,in
mathematicalphysicsmodeling,labelsplaytheexplanatoryroleoftestablehypotheses: agoodhypothesismakessense
ofdata,inthesensethatthedatabecomesunsurprisingunderthehypothesisthattheprocessgeneratingthedatacanbe
labeledasbeingofthisorthattype. So,labelsareusefulbecausetheyallowustocompactlydescribethedynamics
orobservablebehaviorsofthings, generatinglesssurpriseuponobservingnewdataoruponconsideringpastdata
thanifthelabelhadnotbeenused. Thedynamicsofthingsdependontheirproperties,andlabelsareausefulwayof
denotingthingswithsimilarpropertiesandbehavior. Indeed,iftheentropyofourobservationsdoesnot,infact,go
downconditionedonthatlabel,thenthemutualinformationbetweenlabelandobservationsiszerobydefinition,and
therefore,thelabelismeaningless,bothpragmaticallyandinaninformationtheoreticsense.
17
A PREPRINT - MARCH 3, 2025
(a)Initialdisorderedstate. (b)’Cellmembrane’forms. (c)’Flagella’begintoform.
(d)’Flagella’fullyformed (e)’Organelles’form. (f)’Organelles’interact.
Figure11: DMBDfittoinitialevolutionofparticleLenia’rotator’. Timeincreaseslefttoright. Intheinitialdisordered
statenearlyallparticlesareassignedtoasingleobject. Astimeprogressesacellmembraneformswhichisassignedto
anewobjecttype. Thecellmembranethenundergoesaphasechangeas’flagella’. Thisalterstheobjectlabelofthe
membrane. Meanwhileatightlyboundnucleusformswhichisalsogivenauniquelabel. Anadditional8repulsive
particlesmoveabouttheregionbetweenthenucleusandmembrane. Thisconfigurationissemistablewiththeinner8
particlestransitingaroundthenucleus. Themembranepulsesandrotatesslightlyperturbingthe8innerparticleswhich
causesthenucleustopulsateaswell. Thiscausestheinner8particlestoregularlyshiftintheirobjectassignments
transitioningfromnucleustoorganelletomembraneandback.
Interestingly,conditionalentropyispreciselythesurpriseobjectivemoststronglyassociatedwiththeFEP.However,
inthatliterature,theroleofsurpriseminimizationistreatedtautologically,notempirically: theideaisthat“things
minimizesurprise,”asopposedto“labelingsomethingasanobjectofaspecifictypeminimizesmysurprise.” Asa
concreteexample,considerthehumbleproton. Correctlyapplyingthelabel“proton“toaparticleresultsinalower
entropyofourobservations,iffornootherreasonthanthefactthatprotonshavepositivecharge,aparticularmass,etc.,
andbehaveaccordingly;whilearandomlyselectedparticlemighthaveadifferentmass,charge,etc.,andaccordingly,
behavedifferently. Indeed,thatiswhyitwasgivenalabel: thelabelhaspredictivepower,inthesensethat,giventhe
labelandknowledgeoftheobservablepropertiesofaproton(position,momentum,spin,etc.),wecanpredicthowthe
particlewillinteractwithotherthingsinitsenvironment. Tothisend,considerwhywebotheredtolabelaprotona
“thing.” Correctlyapplied,thelabelreducesuncertainty/entropyandenhancesourabilitytopredictthebehaviorofboth
theprotonandthesystemasawhole. Thatis,goodlabelsgloballyminimizesurprise. Thissuggeststhatthesurprise
minimizationobjectiveplaysacriticalempiricalrole.
ThisisdistinctfromthemannerinwhichtheFEPistraditionallydiscussed. Agoodtautologyprovidesagoodstarting
pointforadefinition. TheFEPstartswiththedefinitionofanobjectasablanketedcollectionofstates,whoseinternal
and active states or paths minimizes surprise (as characterized by the free energy of blanket states or paths)—and
derivesaprincipleofleastactionandensuingBayesianmechanics. Thatis,theprinciplefocusoftheFEPliteraturehas
beenonnecessarypropertiesofthings,andnotonempiricallydiscoveringwhichcollectionswecansensiblylabel
asobjects. Converselyandinacomplementaryfashion,theapproachdescribedherestartsfromaMarkovblanket
18
A PREPRINT - MARCH 3, 2025
baseddefinitionofsystemtypes,buttakesanempiricalpointofviewofanobserverormodelerandseekstoprovidea
justificationforthedecisionsthatanobservermakeswhenmodelingthedynamicsofasystem.
5.1 ResponsetotechnicalcritiquesoftheFEP
ThisworkaddressessomecoretechnicalcriticismandlimitationsofmodelingbasedontheFEP,whichupuntilnow
werearguablystillopen.3 TheMarkovblanketbasedapproachtosystemidentificationhasprovencontroversial(see,
e.g.,[6,35,11,5]). SomehavearguedthattheMarkovblanketbaseddefinitionofobjectandobjecttypeisnotas
obviousortrivialasitsproponentssayitis[35].4 AnotherlineofcriticismarguesthatactuallyidentifyingMarkov
blankets(bothmathematicallyandempirically,inrealworlddata)restsuponnontrivialmodelingdecisions,andthat,as
aresult,theMarkovblanketformalismislesseasilyorgenerallyapplicablethanclaimed[6]. Stillothershavenoted
thatdemonstrationsofthenearuniversalapplicabilityoftheFEPseemsatoddswiththeassumedformoftheMarkov
blanketandnonequilibriumsteadystateconditionthattogetherguaranteeapartitionbetweenorganismandenvironment
orbetweeninternalandexternalstates[1,5,11,30]. Indeed,theMarkovblanketbaseddefinitionofamacroscopic
objecthasbeencriticizedasbeingillposed(sincemanyinterestingtypesofsystemswillappeartohavemanyMarkov
blankets[6])orinapplicabletosystemsthatarestronglycoupledtotheirenvironment,highlyvariable,orexchange
matterwiththeirenvironment[35,11,30]. Plainly,thesystemsthatareofmostinteresttousareopensystemsthat
exchangematterandenergywiththeirenvironments, existfarfromthermodynamicequilibrium, andusuallyhave
mobileanddynamic—andpossiblynoncontiguous—boundaries. Candidatecounterexamplestotheapplicabilityofthe
Markovblanketbasedapproachturnedouttobethingswithmobileorwanderingboundaries,likeflamesandorganisms.
ItwasespeciallyproblematicbecausetheFEPwasdevelopedoriginallytomodelthedynamicsofthebrainandthe
behavioroflivingthings,andisprobablybestknowninthisapplication.
Asonewouldhope,thesecriticismshaveledtosubstantialdebateandanexplicitacknowledgmentthattheFEP,as
formulated for systems at steady state, applies only to a rather “particular” class of macroscopic objects that only
sparselyorweaklyinteractwiththeirenvironment[15,1]. Here,wearguethatmanyofthesecriticismultimatelystem
fromtheFEPliterature’spriorfocuson“static”Markovblanketconstruct. Fromamathematicalpointofview,several
oftheseobjectionswereresolvedbymovingfromastate-wiseformulationtoapath-basedorpathintegralformulation
oftheFEP[43,16],allowingustoavoidhavingtomakeassumptionsaboutthesteadystatestatisticsofasystem(see
[36]foradetaileddiscussion)orrelyonapproximateMarkovblanketstructureinthestationarystatisticsofthesystem
asawhole. Inthepath-basedformulationsoftheFEP,quantitiesofinterestandtheequationsthatrelatethemnow
aredefinedforpathsofasystem,i.e.,theyaredefinedinobjectsthatmakeupastructuredspaceorsetoftrajectories
thateachrepresentaspecificwaythesystemmightevolveovertime. Moreover,aconsiderationofdynamicblankets
andmaximumcalibermodeling[36,42]allowsustoidentifysensibleobjectsandboundariesincomplexsystemsthat
includephasetransitions,andtomodelsofobjectswithtransientandmovingboundaries. Ourcontributionhereisto
provideamathematicalframeworkandnumericaldemonstrationsthatshowdefinitivelythatsuchdynamicobjectscan
bemodeledwithinthisframework,therebyresolvingthisdebateintheliteratureempirically.
5.2 Nicheconstructionandtheroleoftheenvironmentinactiveinference
Inoursimulationofaburningfuse,theenvironmentplayedanunexpectedrole: wenotethatthepositionoftheflameis
besttrackedbythestateoftheenvironment,ratherthanbyinternalstatesofthecombustionnetwork. Wealsonoted
abovethat,becausetheequationsthatgovernthedynamicsofMarkovblanketsaresymmetricwithrespecttointernal
andexternalstates,theblanketencodesthepoliciesofboththeinternalandtheexternalsubsystems,concludingthatthe
Markovblanketbaseddefinitionofanobjecttypeisalwaysenvironment-specific. Thisresultsitswellwithrecentwork
reconsideringtheroleoftheenvironmentinactiveinferenceandwithworkonactiveinferenceinsocioculturalsystems
[47]. Thisworkconsidersthemultiscalerecursivelynestedstructureofthedynamicsthatcoupledindividualagents,
thesocioculturalsystemstheyform,andtheecologicalnichethattheseshapethroughaction[8,39,47,32]. Thereis
noapriorireasontoalwayscenterourmodelonagentsforeverykindoftaskandsituation. Instead,wecanmodel
agentsasspecialpartsofthewiderenvironment—thatarehighlysalienttootheragents;seee.g.,[13]. Thisalsospeaks
topreviousworkinthistraditiononnicheconstructionwork,emphasizingthatthepropertyofthesynchronization
betweenobjectsthattheFEPdescribes—i.e.,thatitissymmetric—canbeexploitedbyagents. Thisworkmodelsthe
3Albeit,seesection3.4.“Someremarksaboutthestateoftheart”in[36]foradiscussionofthecurrentstateofaffairsregarding
technicalcritiquesoftheFEP,andresponsestothem).
4Interestingly to us, when considering what possible alternative there could be to the FEP from an information theoretic
perspective,theauthors[35]landuponmaximumentropyasapossiblealternative.Thischoiceofcandidatealternativeapproachis
telling,especiallyinlightofrecentdevelopmentsonthedualityoftheFEPandmaximumentropy/caliber.Indeed,thereseemstobe
noothergameintown.
19
A PREPRINT - MARCH 3, 2025
passive(habitual,unintentional)andactiveconstruction(e.f.,deliberatedesign)ofanecologicalnichebyitsdenizens,
suchthatcertainkindsofpatternedbehavioraresolicited,asopposedtoothersthatarediscouraged[8,38].
5.3 Futuredirections
OurspecificrealizationofamemberofthisclassofMarkovblanketdetectionalgorithmsreliedonlinearapproximations
andadecouplingofblanket(label)dynamicsandmacroscopicdynamics. Thischoiceresultedinanalgorithmthat
sensiblypartitionsystems,butthatcannotberelieduponforprediction. Thisisfortworeasons: (1)theassumptionof
lineardynamicscausestheeffectsofanynon-linearitiesinthesystemtobeattributedtonoise,causinganeffective
enhancement of diffusive strength; and (2) the assumption that the boundary dynamics are decoupled from the
macroscopicdynamicsmeansthatlatentassignmentvariablesquicklydiffusetoauniformstationarydistributionin
theabsenceofobserveddata. WeplantoaddresstheseissuesinfutureworkbyimposingMarkovblanketstructure
on Bayesian instantiations of switching linear dynamical systems models. This work is also related to work on
mathematicallymodelingdownwardcausalityandemergentphenomenaviadimensionalityreduction[2,40],inways
thatweplantoexplore.
References
[1] MiguelAguileraetal.“Howparticularisthephysicsofthefreeenergyprinciple?”In:PhysicsofLifeReviews
40(2022),pp.24–50.
[2] LionelBarnettandAnilKSeth.“Dynamicalindependence:discoveringemergentmacroscopicprocessesin
complexdynamicalsystems”.In:PhysicalReviewE108.1(2023),p.014304.
[3] MatthewJamesBeal.VariationalalgorithmsforapproximateBayesianinference.UniversityofLondon,Univer-
sityCollegeLondon(UnitedKingdom),2003.
[4] J.M.BeckandV.A.Volpert.“Nonlineardynamicsinasimplemodelofsolidflamemicrostructure”.In:Physica
D:NonlinearPhenomena182.1–2(2003),pp.86–102.DOI:10.1016/S0167-2789(03)00189-5.
[5] Martin Biehl, Felix A. Pollock, and Ryota Kanai. “A Technical Critique of Some Parts of the Free Energy
Principle”.In:Entropy23.3(2021).Ed.byKevinH.Knuth,p.293.DOI:10.3390/e23030293.
[6] JohanBruinebergetal.“TheEmperor’sNewMarkovBlankets”.In:BehavioralandBrainSciences45(2022),
E183.DOI:10.1017/S0140525X21002351.
[7] BertWang-ChakChan.“Lenia:BiologyofArtificialLife”.In:ComplexSystems28.3(2019),pp.251–286.DOI:
10.25088/ComplexSystems.28.3.251. URL:https://doi.org/10.25088/ComplexSystems.28.3.
251.
[8] AxelConstantetal.“Avariationalapproachtonicheconstruction”.In:JournaloftheRoyalSocietyInterface
15.141(2018),p.20170685.
[9] LancelotDaCostaetal.“Bayesianmechanicsforstationaryprocesses”.In:ProceedingsoftheRoyalSocietyA
477.2256(2021),p.20210518.
[10] SergioDavisandDiegoGonzález.“Hamiltonianformalismandpathentropymaximization”.In:Journalof
PhysicsA:MathematicalandTheoretical48.42(2015),p.42500.DOI:10.1088/1751-8113/48/42/42500.
[11] EzequielDiPaolo,EvanThompson,andRandallBeer.“Layingdownaforkingpath:Tensionsbetweenenaction
andthefreeenergyprinciple”.In:PhilosophyandtheMindSciences3(2022).
[12] KrishnamurthyDvijothamandEmanuelTodorov.“InverseOptimalControlwithLinearly-SolvableMDPs”.In:
InternationalConferenceonMachineLearning.2010.
[13] KanakoEsakietal.“Environment-CentricActiveInference”.In:arXivpreprintarXiv:2408.12777(2024).
[14] S.M.AliEslamietal.“Attend,Infer,Repeat:FastSceneUnderstandingwithGenerativeModels”.In:arXiv
preprint arXiv:1603.08575 (2016). arXiv: 1603.08575 [cs.CV]. URL: https://doi.org/10.48550/
arXiv.1603.08575.
[15] KarlFriston.“Afreeenergyprincipleforaparticularphysics”.In:arXivpreprintarXiv:1906.10184(2019).
arXiv:1906.10184.
[16] KarlFristonetal.“Pathintegrals,particularkinds,andstrangethings”.In:PhysicsofLifeReviews(2023).
[17] KarlJFristonetal.“Parcelsandparticles:Markovblanketsinthebrain”.In:NetworkNeuroscience5.1(2021),
pp.211–251.
[18] Clark Glymour, Kun Zhang, and Peter Spirtes. “Review of Causal Discovery Methods Based on Graphical
Models”.In:FrontiersinGenetics10.June(2019).ThisarticleispartoftheResearchTopicShifttheCurrent
ParadigmofGeneticStudiesofComplexDiseasesfromAssociationtoCausation,p.524.ISSN:1664-8021.
DOI:10.3389/fgene.2019.00524.URL:https://doi.org/10.3389/fgene.2019.00524.
20
A PREPRINT - MARCH 3, 2025
[19] DiegoGonzálezandSergioDavis.“Jarzynskiequalityinthecontextofmaximumpathentropy”.In:arXiv
preprintarXiv:1607.07287(2016).URL:https://arxiv.org/abs/1607.07287.
[20] ConorHeinsandLancelotDaCosta.“SparsecouplingandMarkovblankets:Acommenton"Howparticularis
thephysicsoftheFreeEnergyPrinciple?"byAguilera,Millidge,TschantzandBuckley”.In:arXivpreprint
arXiv:2205.10190(2022).
[21] MatthewD.Hoffmanetal.“StochasticVariationalInference”.In:JournalofMachineLearningResearch14
(2013),pp.1303–1347.URL:http://www.jmlr.org/papers/volume14/hoffman13a/hoffman13a.pdf.
[22] ChristopherJarzynski.“Equalitiesandinequalities:Irreversibilityandthesecondlawofthermodynamicsatthe
nanoscale”.In:Time:PoincaréSeminar2010.Springer.2012,pp.145–172.
[23] EdwinTJaynes.“Theminimumentropyproductionprinciple”.In:AnnualReviewofPhysicalChemistry31.1
(1980),pp.579–601.
[24] EdwinT.Jaynes.“Informationtheoryandstatisticalmechanics”.In:PhysicalReview106.4(1957),p.620.DOI:
10.1103/PhysRev.106.620.
[25] MattJones,PeterChang,andKevinMurphy.“BayesianOnlineNaturalGradientBONG”.In:arXivpreprint
arXiv:2405.19681(2024).URL:https://arxiv.org/abs/2405.19681.
[26] B.Kappen,V.Gomez,andM.Opper.“Optimalcontrolasagraphicalmodelinferenceproblem”.In:Machine
LearningJournal(2012).arXiv:arXiv:0901.0633[math.OC][math.OC].
[27] AlexBKiefer.“Psychophysicalidentityandfreeenergy”.In:JournaloftheRoyalSocietyInterface17.169
(2020),p.20200370.
[28] Bernard O Koopman. “Hamiltonian systems and transformation in Hilbert space”. In: Proceedings of the
NationalAcademyofSciences17.5(1931),pp.315–318.
[29] ScottLindermanetal.“BayesianLearningandInferenceinRecurrentSwitchingLinearDynamicalSystems”.
In:Proceedingsofthe20thInternationalConferenceonArtificialIntelligenceandStatistics.Ed.byAartiSingh
and Jerry Zhu. Vol. 54. Proceedings of Machine Learning Research. PMLR, Apr. 2017, pp. 914–922. URL:
https://proceedings.mlr.press/v54/linderman17a.html.
[30] KathrynNave.Adrivetosurvive:Thefreeenergyprincipleandthemeaningoflife.MITPress,2025.
[31] RobertK.Niven.“Minimizationofafree-energy-likepotentialfornon-equilibriumflowsystemsatsteadystate”.
In:PhilosophicalTransactionsoftheRoyalSocietyB:BiologicalSciences365.1545(2010),pp.1323–1331.
DOI:10.1098/rstb.2009.0296.
[32] ThomasParr.“ChoosingaMarkovblanket.”In:Behavioral&BrainSciences43(2020).
[33] JudeaPearl.QuantifiedRepresentationofUncertaintyandImprecision.Graphicalmodelsforprobabilisticand
causalreasoning.Springer,1998,pp.367–389.
[34] MaziarRaissi,ParisPerdikaris,andGeorgeEKarniadakis.“Physics-informedneuralnetworks:Adeeplearning
framework for solving forward and inverse problems involving nonlinear partial differential equations”. In:
JournalofComputationalPhysics378(2019),pp.686–707.
[35] VicenteRajaetal.“TheMarkovblankettrick:Onthescopeofthefreeenergyprincipleandactiveinference”.
In:PhysicsofLifeReviews39(2021),pp.49–72.
[36] MaxwellJ.D.Ramsteadetal.“OnBayesianmechanics:aphysicsofandbybeliefs”.In:InterfaceFocus13.3
(2023),p.20220029. DOI:10.1098/rsfs.2022.0029. URL:https://doi.org/10.1098/rsfs.2022.
0029.
[37] MaxwellJDRamstead,DaltonARSakthivadivel,andKarlJFriston.“Anapproachtonon-equilibriumstatistical
physicsusingvariationalBayesianinference”.In:arXivpreprintarXiv:2406.11630(2024).
[38] MaxwellJDRamstead,SamuelPLVeissière,andLaurenceJKirmayer.“Culturalaffordances:Scaffoldinglocal
worldsthroughsharedintentionalityandregimesofattention”.In:Frontiersinpsychology7(2016),p.1090.
[39] MaxwellJDRamsteadetal.“Variationalecologyandthephysicsofsentientsystems”.In:PhysicsoflifeReviews
31(2019),pp.188–205.
[40] Fernando E Rosas et al. “Reconciling emergences: An information-theoretic approach to identify causal
emergenceinmultivariatedata”.In:PLoScomputationalbiology16.12(2020),e1008289.
[41] DaltonARSakthivadivel.“TowardsaGeometryandAnalysisforBayesianMechanics”.In:arXivpreprint
arXiv:2204.11900 (2022). DOI: 10.48550/arXiv.2204.11900. arXiv: 2204.11900 [math-ph]. URL:
https://arxiv.org/abs/2204.11900.
[42] DaltonARSakthivadivel.“AworkedexampleoftheBayesianmechanicsofclassicalobjects”.In:International
WorkshoponActiveInference.Springer.2022,pp.298–318.
[43] DaltonARSakthivadivel.“RegardingFlowsUndertheFreeEnergyPrinciple:ACommenton"HowParticular
isthePhysicsoftheFreeEnergyPrinciple?"byAguilera,Millidge,Tschantz,andBuckley”.In:arXivpreprint
arXiv:2205.07793(2022).
21
A PREPRINT - MARCH 3, 2025
[44] DaltonARSakthivadivel.“WeakMarkovblanketsinhigh-dimensional,sparsely-coupledrandomdynamical
systems”.In:arXivpreprintarXiv:2207.07620(2022).
[45] Aaron J. Snoswell, Surya P. N. Singh, and Nan Ye. “Revisiting Maximum Entropy Inverse Reinforcement
Learning:NewPerspectivesandAlgorithms”.In:arXivpreprintarXiv:2108.10056(2021).
[46] AVaswani.“Attentionisallyouneed”.In:AdvancesinNeuralInformationProcessingSystems(2017).
[47] SamuelPLVeissièreetal.“Thinkingthroughotherminds:Avariationalapproachtocognitionandculture”.In:
Behavioralandbrainsciences43(2020),e90.
[48] Hao Wang et al. “Towards efficient and effective discovery of Markov blankets for feature selection”. In:
InformationSciences509(2020),pp.227–242.DOI:10.1016/j.ins.2019.09.053.URL:https://doi.
org/10.1016/j.ins.2019.09.053.
[49] BrianDZiebartetal.“Maximumentropyinversereinforcementlearning”.In:Proceedingsofthe23rdAAAI
Conference.2008.
22

=== INSTRUCTIONS ===

0. PROFESSIONAL TONE REQUIREMENTS:
   - Begin directly with the paper title or content - NO conversational openings
   - Do NOT use phrases like: 'Okay, here's...', 'Here's a summary...',
     'Let me summarize...', 'I'll extract...', or similar conversational language
   - Start immediately with substantive content in formal academic tone
   - Example BAD: 'Okay, here's a summary of the paper...'
   - Example GOOD: 'This paper investigates [topic]...'

1. Start with exact title: "Dynamic Markov Blanket Detection for Macroscopic Physics Discovery"

2. EXTRACT QUOTES:
   - Extract 10-15 direct quotes from the paper that support key claims
   - QUOTE EXTRACTION AND FORMATTING:
     * Extract quotes VERBATIM from the paper text - do NOT modify or "correct" them
     * Extract quotes exactly as they appear in the source text
     * Preserve all aspects of the quote exactly as written, including spacing
     * Use proper quotation marks: "quote text" (double quotes)
     * CRITICAL: Only extract quotes that actually appear in the paper text
     * Do NOT generate, invent, or "fix" quotes - extract them exactly as written
   - QUOTE FORMATTING STANDARD:
     * Attribution format: 'The authors state: "quote text"' OR 'According to the paper: "quote text"'
     * Vary attribution phrases to avoid repetition (use: 'The authors state', 'They note',
       'The paper argues', 'According to the research', 'The study demonstrates')
     * Include section context when available: 'In the Introduction, the authors state: "quote text"'
     * Ensure proper spacing around quotes and punctuation
   - Search the full paper text to find relevant quotes
   - Each quote must be verbatim from the paper text (with spacing normalized)

3. IDENTIFY CLAIMS:
   - Identify the main claims and arguments made by the authors
   - State each claim clearly and support it with quotes from the paper
   - Distinguish between primary claims and supporting arguments

4. SUMMARIZE KEY FINDINGS:
   - Summarize the key findings with specific numbers, metrics, and results
   - Include quantitative data: percentages, statistics, measurements
   - Extract numerical results from the results section
   - Present findings with supporting evidence from the paper

5. DESCRIBE METHODS:
   - Describe the methodology, experimental setup, and approach used
   - Include details about: algorithms, procedures, experimental design
   - Explain how the research was conducted
   - Extract specific methodological details from the methods section

6. PRESENT RESULTS:
   - Present the results with quantitative data and statistical significance
   - Include specific numbers, tables, figures mentioned in the paper
   - Extract results from the results section with exact values
   - Support results with quotes or data from the paper

7. NO REPETITION - CRITICAL REQUIREMENT (ENHANCED):
   - CRITICAL: Before writing EACH sentence, check: 'Have I already said this exact idea?'
   - If you've already stated an idea, DO NOT repeat it - move to the next unique point
   - Each sentence must be COMPLETELY UNIQUE - no duplicate ideas, even with different words
   - Each claim appears EXACTLY ONCE - if you've stated it, move to the next unique point
   - Each paragraph must be COMPLETELY UNIQUE - no duplicate paragraphs
   - Do NOT repeat the same sentence, even with slight variations or word changes
   - Do NOT repeat paragraphs or sections - each section must have unique content
   - Each claim should appear only ONCE in the entire summary
   - Vary attribution phrases: use 'The authors state', 'They note', 'The paper argues',
     'According to the research', 'The study demonstrates' - do NOT repeat the same phrase
   - If you find yourself writing similar content, STOP immediately and write something completely different
   - Before each sentence, ask: 'Have I already said this?' If yes, write something new
   - Vary your language: use synonyms, different sentence structures, different perspectives
   - REPETITION CHECKLIST: After writing each sentence, verify it's not a duplicate of any previous sentence

   EXAMPLES OF WHAT NOT TO DO:
   ❌ BAD: 'The authors state: "X". The authors state: "Y". The authors state: "Z".'
   ✅ GOOD: 'The authors state: "X". They further note: "Y". The paper argues: "Z".'

   ❌ BAD: Repeating the same claim 3+ times with slight variations
   ✅ GOOD: State each claim once, then move to the next unique point

8. STRUCTURE:
   - Use markdown headers: ### Overview, ### Methodology, ### Results, ### Discussion
   - Target length: 1000-1500 words
   - Ensure all requested elements (quotes, claims, findings, methods, results) are included
