=== IMPORTANT: ISOLATE THIS PAPER ===
You are summarizing ONLY the paper below. Do NOT reference or use content from any other papers.
Do NOT mix information from different papers. Only use information from THIS specific paper.

Paper Title: Active Inference for Closed-loop transmit beamsteering in Fetal Doppler Ultrasound
Citation Key: federici2024active
Authors: Beatrice Federici, Ruud JG van Sloun, Massimo Mischi

REMEMBER: Extract quotes, claims, and findings ONLY from the paper text provided below.

Year: 2024

Key Terms: beamsteering, heart, closed, fetal, university, doppler, department, electrical, engineering, inference

=== FULL PAPER TEXT ===

Active Inference for Closed-loop transmit
beamsteering in Fetal Doppler Ultrasound
Beatrice Federici Ruud JG van Sloun Massimo Mischi
Department of Electrical Engineering Department of Electrical Engineering Department of Electrical Engineering
Eindhoven University of Technology Eindhoven University of Technology Eindhoven University of Technology
Eindhoven, The Netherlands Eindhoven, The Netherlands Eindhoven, The Netherlands
b.federici@tue.nl r.j.g.v.sloun@tue.nl m.mischi@tue.nl
Abstract—Doppler ultrasound is widely used to monitor fetal and noisy HR traces or no HR tracing at all. Sometimes,
heart rate during labor and pregnancy. Unfortunately, it is maternal insertion can also occur, where the system may
highly sensitive to fetal and maternal movements, which can
pick up and display the maternal HR [2]. During prolonged
cause the displacement of the fetal heart with respect to the
periodsofsuchweakandmixedsignals,thefetusisnotbeing
ultrasound beam, in turn reducing the Doppler signal-to-noise
ratioandleadingtoerratic,noisy,ormissingheartratereadings. adequately monitored, and the clinical staff has to reposition
To tackle this issue, we augment the conventional Doppler the ultrasound transducer.
ultrasoundsystemwitharationalagentthatautonomouslysteers
To improve robustness to displacement, modern ultrasound
the ultrasound beam to track the position of the fetal heart.
Theproposedcognitiveultrasoundsystemleveragesasequential transducers for fetal HR monitoring often incorporate large
Monte Carlo method to infer the fetal heart position from elementsthatgeneraterelativelywidebeams(e.g.,aneffective
the power Doppler signal, and employs a greedy information- radiating area at -12 dB of 4.47 ± 0.89 cm2 [2]). While
seeking criterion to select the steering angle that minimizes the
this approach helps mitigate the impact of small displace-
positional uncertainty for future timesteps. The fetal heart rate
ments, larger displacements such as fetal reorientation still
is then calculated using the Doppler signal at the estimated
fetal heart position. Our results show that the system can compromise the acquisition. Additionally, the wider beam has
accuratelytrackthefetalheartpositionacrosschallengingsignal- alowerbeamforminggaincomparedtotightlyfocusedbeams,
to-noise ratio scenarios, mainly thanks to its dynamic transmit resulting in reduced resiliance to noise. Transducer design
beam steering capability. Additionally, we find that optimizing therefore constitutes a trade-off between the achieved Dopper
the transmit beamsteering to minimize positional uncertainty
SNR and its robustness to fetal movements.
also optimizes downstream heart rate estimation performance.
In conclusion, this work showcases the power of closed-loop In this work, we present an alternative approach. Instead
cognitive ultrasound in boosting the capabilities of traditional
of widening the ultrasound beam to reduce the sensitivity
systems.
to displacement, we propose a closed-loop cognitive ultra-
Index Terms—action-perception, cognitive systems, Doppler
ultrasound sound system [3] that autonomously steers a highly focused
ultrasound beam to ensure that the heart is always properly
I. INTRODUCTION insonified, tracking displacements relative to the ultrasound
transducer. In practice, we adopt a phased array and control it
Fetalheartrate(HR)monitoringiscriticaltoadequateprenatal
througharationalagentwhosetaskistosequentiallyselectthe
care,providingessentialinsightintothehealthandwell-being
optimalfocusedtransmitbeamfortrackingthepositionofthe
of the fetus. One of the most widely used and non-invasive
fetalheart.Tothisend,theagentcombinesasequentialMonte
methods for monitoring fetal HR is Doppler ultrasound [1].
Carlomethod(particlefilter)toinferaBayesianposteriorfetal
In fetal Doppler ultrasound, a transducer is carefully placed
heart position from the measured power Doppler signal at
on the maternal abdomen to insonify the fetal heart using an
timepoint t, with an information maximization strategy that
ultrasound beam. The backscattered echoes are then recorded
selects the future beam steering angle that is expected to
andprocessedtodetectmotion(i.e.Dopplerprocessing),from
reduce the positional uncertainty the most at timepoint t+1.
which the HR is derived.
The one-dimensional Doppler signal at the estimated heart
Despite its extensive use, Doppler ultrasound is highly sen-
position is then used to compute the HR.
sitive to both fetal and maternal movements, which can cause
the displacement of the fetal heart relative to the ultrasonic The remainder of this paper is organized as follows. Sec-
beam [2]. When this happens, the signal-to-noise ratio (SNR) tion II describes the proposed Doppler ultrasound system,
of the Doppler signal drops significantly, resulting into erratic including the closed-loop probabilistic framework and the
HR estimation approach. Section III presents the experiments
ThisprojectissupportedbytheChipsJointUndertaking(GrantAgreement conducted to evaluate the performance of the system in-silico
No.101095792)anditsmembersFinland,Germany,Ireland,theNetherlands,
andin-vitro.WediscusstheresultsinSectionIVandconclude
Sweden,Switzerland.Thisworkincludestop-upfundingfromtheSwissState
SecretariatforEducation,ResearchandInnovation. in Section V.
4202
tcO
7
]PS.ssee[
1v96840.0142:viXra
B. Perception
Sinceourobservationmodelp(y |x ,a )ishighlynonlinear
t t t
andhigh-dimensional,weuseapproximateBayesianinference
to update the agent’s beliefs about the state given new obser-
vations and actions ˆ¯y = {ˆy ,a }. More specifically, we
0:t 0:t 0:t
useaparticle-basedapproximationtotheposteriorq(x |ˆ¯y )
0:t 0:t
with a set of N samples/particles and importance weights
p
{xi,wi}Np
:
t t i=1
Np
(cid:88)
q(x |ˆ¯y )= wiδ(x −xi) , (3)
Fig. 1: Closed-loop fetal Doppler ultrasound. 0:t 0:t t t t
i=1
where we track the particles and weights using a sequential
II. METHODS Monte Carlo filtering method, the particle filter.
We model the fetal heart as a moving Doppler target, with
unknown fetal HR and position. This target is observed by a C. Action
phased array transducer, which probes the external environ-
Given the updated posterior, the agent selects the beam
ment using a pulsed wave Doppler scheme with a focused
steering angle, a∗ , that minimizes the expected posterior
beam having a fixed focal depth and an adaptive steering t+1
entropy. This is equivalent to selecting the action that max-
angle. At any time point t, a rational agent is tasked with the
imizes the conditional mutual information between the state
selection of the optimal future steering angle, a∗ ∈ Θtx,
t+1 and future observations [4]:
that maximizes information gain with respect to the future
state x t+1 : the angular position of the Doppler target at a∗ = max I(x ,y |a ,ˆ¯y )
t+1 t+1 t+1 t+1 0:t
timestep t+1. This steering action subsequently leads to a at+1∈Θtx
newobservationˆy ∈RNΘ,aclutter-filteredpowerDoppler = max H(y |a ,ˆ¯y )−H(y |x ,a ,ˆ¯y ) .
t+1 t+1 t+1 0:t t+1 t+1 t+1 0:t
image beamformed on a polar grid (Θ,r) and subsequently at+1∈Θtx
(4)
integrated across the depth.
Figure 1 illustrates the proposed closed-loop cognitive ul-
This reduces to maximizing the marginal differential entropy
trasoundsystem.Itcomprisesaprobabilisticgenerativemodel
of future observations as the uncertainty about y given x
t+1 t
and iterates between two steps: (1) perception, the updating
is independent of the action a according to the defined
t+1
of the Bayesian posterior about fetal heart position, and (2)
generative model p(ˆy |x ,a )∼N(f (x ,a );σ ).
t t t y t t y
action, the selection of an information-maximizing transmit Inpractice,theagentusesthesetofparticles{xi,wi}Np
to
steering angle. t t i=1
derivehypotheticalfuturesstatesxi ∼p(xi |xi),usingthe
t+1 t+1 t
linearGaussianstatetransitionmodel.Then,foreachpossible
A. Generative Model
action a , the agent computes N hypothetical measure-
t+1 p
The agent’s generative model across Doppler observations ments {yi |a ∼ p(y |xi ,a )}Np and uses them
(y ), angular fetal heart positions (x ), and beamsteering t+1 t+1 t+1 t+1 t+1 i=1
0:T 0:T to approximate the marginal differential entropy, assuming a
actions (a ) is given by:
0:T marginal multivariate Gaussian distribution:
p(y 0:T ,x 0:T ,a 0:T )=p(y 0:T |x 0:T ,a 0:T )p(a 0:T |x 0:T )p(x 0:T ( ) 1 . ) H(y t+1 |a t+1 ,ˆ¯y 0:t )∝ 2 1 log(|Σ y t+1 (a t+1 ,ˆ¯y 0:t )|) , (5)
We assume that each measurement y is conditionally in-
t
dependent of measurements at other time points given x where Σ (a ,ˆ¯y ) is the covariance of the marginal
t y t+1 t+1 0:t
and a t and that the state dynamics can be described as a p(y t+1 |a t+1 ,ˆ¯y 0:t ), which we approximate from the samples
first-order Markovian process. Hence, the state dynamics and {yi |a }Np .
t+1 t+1 i=1
the measurement process are governed by the state transition
p(x |x ) and the observation model p(y |x ,a ), respec-
t t−1 t t t D. Heart rate estimation
tively. We adopt a linear Gaussian state transition dynam-
ics p(x |x ) = N(x ,σ ), and a Gaussian non-linear At each iteration, the posterior mean is used as a point
t t−1 t−1 x
observation model p(y|x ,a ) = N(f (x ;a ),Σ ), where estimate of the angular position of the fetal heart: x∗ =
t t y t t y t
f
y
(·;a
t
):R1 →RNΘ maps the angular position of the target E
q(x0:t|ˆ¯y
0:t
)
(x
t
) = (cid:80)N
i=
p
1
w
t
ixi
t
. Its range r
t
∗ is derived by
to a simulated power Doppler measurement, considering an searchingforthemaximumpointinthepowerDopplerimage
approximate action-conditional transmit beam profile: along x∗. The one-dimensional Doppler signal at the esti-
t
mated coordinates {x∗,r∗} is processed by an (open-source)
f y (x t ;a t
)=e−(Θ
2
−
b
a
w
t)2 e−(Θ
2
−
h
x
w
t)2
. (2) autocorrelation-based
t
me
t
thod [5] to compute the HR.
III. EXPERIMENTS
A. Validation Setup
The performance of the proposed framework was assessed
in-silico and in-vitro, comparing the performance of the
closed-loop system with an actively steered focused beam
withthatofanopen-loopsystemhavinganon-adaptive,fixed,
ultrasound beam steered at 0 rad. Fig. 2: Experimental setup, including a submerged Philips s5-
Forthein-silicoanalysis,weusedtheVerasonicsultrasound 1 phased array probe manipulated by a translation stage and a
simulator software [6]. We model the beating heart through a suspendedchickenheartattachedtoanaxialmotiongenerator.
set of point scatters distributed within a 2-cm-diameter disk
at a depth of 13 cm. The scatter points move concentrically,
following a sinusoidal motion having an amplitude compa- detection. In contrast, with a fixed steering angle, the target
rable with fetal cardiac wall displacements and a frequency eventually drifts outside the beam, causing the target Doppler
that yields a realistic HR. Fetal displacement relative to the signal to fall below the noise level, leading to the tracking
ultrasoundtransducerissimulatedbymovingthescatterpoints errors visible in Fig. 3b and an inaccurate HR estimation
laterally. We set a maximum relative displacement of 9 cm, displayed in Fig. 3c.
which, given the target depth, corresponds to an angular dis- We then quantified the performance of the proposed ap-
placementof0.6radians.Wesimulatedstatictissuescattering proach for different SNR conditions. To that end, we added
by adding a random distribution of point scatters of low variouslevelsofwhiteGaussiannoisetothemeasuredchannel
reflectivity in the background. Imaging was simulated using data. Fig. 4 shows both the tracking MAE in radians and the
an s5-1 (Philips) probe geometry and transducer parameters. accuracy of fetal HR estimation with a tolerance of 5 bpm,
For the in-vitro analysis, we built an experimental setup againstthepowerDopplerSNRatthetargetdepthwithoutany
basedtheoneproposedbyHamelmannetal.[7].Asdisplayed transmit focusing gain. The latter is computed by transmitting
in Fig. 2, a chicken heart moves rhythmically along the axial- with a single element and performing full coherent receive
direction through a chain of threads driven by a waveform focusing, clutter filtering, and power Doppler processing. The
generator, and it is imaged by a submerged s5-1 (Philips) proposed approach with an adaptively-steered focused beam
phased array. To mimic the relative displacement between the (continuousline)maintainsexcellenttrackingperformanceand
fetal heart and the transducer, the phased array is mounted accurate HR estimation for a wider range of SNR levels,
on a translation stage, which in our experiments was pro- down to 0 dB. The fixed beam strategy (dashed line), instead,
grammed to displace laterally according to a sinusoidal wave. is unable to properly track the target, dropping its Doppler
The maximum displacement with respect to the ultrasound signal power below the noise level by not benefiting from an
transducerwas8cm,leadingtoanangularrangeof±0.5rad. optimized transmit beamforming gain, in turn resulting in an
The distance between the phased array and the chicken heart inaccurate downstream HR estimate.
was around 13 cm. We added cornstarch (Maizena) to the As for the in-vitro online experiments, we found that
water tank to introduce some background scattering. the proposed closed-loop system can accurately track the
For both in-silico and in-vitro experiments, the focused position of the chicken heart even when the Doppler target
beam had a fixed focal depth of 13 cm and steering angle is continuously moving, and the agent needs to infer its
between ±0.7 rad. The pulse repetition frequency was set to positionandtheoptimalsteeringangleon-the-fly.Overatarget
1.5 kHz and the ensemble length to 1 s, which was needed to trajectory spanning three periods of the sinusoidal waveform
cover the typical fetal HR range of 110 bpm-160 bpm. The controllingtheprobe’slateralmotion,wemeasuredatracking
setofbeamsteeringactionsΘtx consideredbytheagentspans mean absolute error of 0.03 rad and a 5-bpm HR accuracy
21 angles between -0.7 rad and +0.7 rad. (|GT−HR| ≤ 5 bpm) of 82%. In terms of inference time,
the posterior state estimate and action selection are completed
B. Results inlessthan1susinganon-optimizedimplementationrunning
Arepresentativeexampleofthein-silicoofflineexperiments on a CPU.
isshowninFig.3,wherewecomparedtheperformanceofthe
IV. DISCUSSION
proposed adaptively-steered focused beam (green) with an ul-
trasoundbeamfixedat0rad(red),i.e.thebesta-prioriguess. This work presents a closed-loop cognitive ultrasound system
The adaptive strategy outperforms the fixed beam when the designed to improve the performance of current fetal Doppler
target displaces substantially from the transducer location. As ultrasound systems. We propose to add, upstream the fetal
visualized in Fig. 3a, the beam steering angle that maximizes HR estimation task, an agent that sequentially selects the
informationgainI(x ,y |a ,ˆ¯y )effectivelytracksthe optimal focused transmit beam to accurately track the fetal
t+1 t+1 t+1 0:t
target angular position. By steering the beam close to the heart angular position.
target,thetargetsignalbenefitsfrombothtransmitandreceive Ourfindingsindicatethatbyadjustingthesteeringangleof
beamforming gain, ensuring a strong signal and consistent a focused beam to maximize expected information gain, the
(a) Steering Angle Selection (b) Angular Position Tracking (c) Heart Rate Estimate
Fig.3:In-silicoofflineexperimentcomparingtheperformanceoftheproposedclosed-loopsystemwithadaptivefocusedbeam
and an open-system with a focused beam fixed at 0 rad at an SNR of 10 dB. (a) Selected steering angle compared to the
Doppler target extent. (b) Angular position tracking over time. (c) Heart rate (HR) estimate over time compared to ground
truth (GT). Note how the HR estimation fails when the Doppler target moves out of the fixed transmit beam.
ments and targets the modelling may need to be expanded,
e.g. by learning parts of the model from data (i.e. deep
generativemodeling).Nevertheless,wehereshowthatclosed-
loopsystemsequippedwithsimplemodelscanalreadysignifi-
cantlyenhancetheoverallsystemperformancewithfavourable
robustness.
V. CONCLUSION
In this work, we showcased the potential of closed-loop
ultrasoundinboostingthecapabilitiesoftraditionalultrasound
imaging. We focused on improving the robustness of conven-
tional fetal HR monitoring systems against fetal and mater-
nal movements. To this end, we augmented a fetal Doppler
ultrasound system with a rational agent that autonomously
Fig. 4: Tracking mean absolute error (MAE) and heart rate steers a focused transmit beam to accurately track the fetal
(HR) accuracy (|GT−HR| ≤ 5 bpm) as a function of the heartposition.Ourresultsshowthatbydynamicallyadjusting
power Doppler signal-to-noise ratio (SNR), for the fixed and the steering angle, this cognitive system delivers accurate HR
adaptive beam steering policies. estimatesinthepresenceofstrongnoiseandsubstantialtarget
movement.
REFERENCES
closed-loopsystemdemonstratesrobustnessagainstbothnoise
[1] P. Hamelmann, R. Vullings, A. F. Kolen, J. W. Bergmans, J. O. van
and displacement, effectively addressing the trade-offs faced
Laar, P. Tortoli, and M. Mischi, “Doppler ultrasound technology for
by most conventional non-adaptive systems. fetalheartratemonitoring:areview,”IEEEtransactionsonultrasonics,
ferroelectrics,andfrequencycontrol,vol.67,no.2,pp.226–238,2019.
Wealsofoundthatthepositionalinformationmaximization
[2] Philips, Instruction for Use Avalon Fetal Monitor FM20/30, FM40/50,
objective aligns with the downstream fetal HR estimation AvalonCL. Philips.
objective. Although the agent’s primary objective is to select [3] R. J. Van Sloun, “Active inference and deep generative modeling for
cognitiveultrasound,”IEEETransactionsonUltrasonics,Ferroelectrics,
thebeamsteeringanglethatimprovestrackingoftheDoppler
andFrequencyControl,pp.1–1,2024.
target, this adaptive beam steering also indirectly benefits [4] D.V.Lindley,“Onameasureoftheinformationprovidedbyanexper-
the downstream HR estimation task. In fact, to minimize iment,” The Annals of Mathematical Statistics, vol. 27, no. 4, pp. 986–
1005,1956.
uncertainty in the target’s position, the agent tends to steer
[5] C. E. Valderrama, L. Stroux, N. Katebi, E. Paljug, R. Hall-Clifford,
the ultrasound beam towards the target. By focusing the beam P. Rohloff, F. Marzbanrad, and G. D. Clifford, “An open source
on the target, the Doppler signal benefits from both transmit autocorrelation-based method for fetal heart rate estimation from one-
dimensional doppler ultrasound,” Physiological measurement, vol. 40,
and receive beamforming, leading to a higher Doppler SNR
no.2,p.025005,2019.
and a more accurate HR estimate. [6] A.Cigier,F.Varray,andD.Garcia,“Simus:anopen-sourcesimulatorfor
medical ultrasound imaging. part ii: comparison with four simulators,”
Our generative model is relatively simple, and only loosely
Computer Methods and Programs in Biomedicine, vol. 220, p. 106774,
approximates the true physical data generating process. Yet, 2022.
the model seems to be sufficiently accurate for facilitating [7] P.Hamelmann,M.Mischi,A.F.Kolen,J.O.VanLaar,R.Vullings,and
J. W. Bergmans, “Fetal heart rate monitoring implemented by dynamic
adequate posterior inference and action selection in both in-
adaptation of transmission power of a flexible ultrasound transducer
silico and in-vitro experiments. For more complex environ- array,”Sensors,vol.19,no.5,p.1195,2019.

=== INSTRUCTIONS ===

0. PROFESSIONAL TONE REQUIREMENTS:
   - Begin directly with the paper title or content - NO conversational openings
   - Do NOT use phrases like: 'Okay, here's...', 'Here's a summary...',
     'Let me summarize...', 'I'll extract...', or similar conversational language
   - Start immediately with substantive content in formal academic tone
   - Example BAD: 'Okay, here's a summary of the paper...'
   - Example GOOD: 'This paper investigates [topic]...'

1. Start with exact title: "Active Inference for Closed-loop transmit beamsteering in Fetal Doppler Ultrasound"

2. EXTRACT QUOTES:
   - Extract 10-15 direct quotes from the paper that support key claims
   - QUOTE EXTRACTION AND FORMATTING:
     * Extract quotes VERBATIM from the paper text - do NOT modify or "correct" them
     * Extract quotes exactly as they appear in the source text
     * Preserve all aspects of the quote exactly as written, including spacing
     * Use proper quotation marks: "quote text" (double quotes)
     * CRITICAL: Only extract quotes that actually appear in the paper text
     * Do NOT generate, invent, or "fix" quotes - extract them exactly as written
   - QUOTE FORMATTING STANDARD:
     * Attribution format: 'The authors state: "quote text"' OR 'According to the paper: "quote text"'
     * Vary attribution phrases to avoid repetition (use: 'The authors state', 'They note',
       'The paper argues', 'According to the research', 'The study demonstrates')
     * Include section context when available: 'In the Introduction, the authors state: "quote text"'
     * Ensure proper spacing around quotes and punctuation
   - Search the full paper text to find relevant quotes
   - Each quote must be verbatim from the paper text (with spacing normalized)

3. IDENTIFY CLAIMS:
   - Identify the main claims and arguments made by the authors
   - State each claim clearly and support it with quotes from the paper
   - Distinguish between primary claims and supporting arguments

4. SUMMARIZE KEY FINDINGS:
   - Summarize the key findings with specific numbers, metrics, and results
   - Include quantitative data: percentages, statistics, measurements
   - Extract numerical results from the results section
   - Present findings with supporting evidence from the paper

5. DESCRIBE METHODS:
   - Describe the methodology, experimental setup, and approach used
   - Include details about: algorithms, procedures, experimental design
   - Explain how the research was conducted
   - Extract specific methodological details from the methods section

6. PRESENT RESULTS:
   - Present the results with quantitative data and statistical significance
   - Include specific numbers, tables, figures mentioned in the paper
   - Extract results from the results section with exact values
   - Support results with quotes or data from the paper

7. NO REPETITION - CRITICAL REQUIREMENT (ENHANCED):
   - CRITICAL: Before writing EACH sentence, check: 'Have I already said this exact idea?'
   - If you've already stated an idea, DO NOT repeat it - move to the next unique point
   - Each sentence must be COMPLETELY UNIQUE - no duplicate ideas, even with different words
   - Each claim appears EXACTLY ONCE - if you've stated it, move to the next unique point
   - Each paragraph must be COMPLETELY UNIQUE - no duplicate paragraphs
   - Do NOT repeat the same sentence, even with slight variations or word changes
   - Do NOT repeat paragraphs or sections - each section must have unique content
   - Each claim should appear only ONCE in the entire summary
   - Vary attribution phrases: use 'The authors state', 'They note', 'The paper argues',
     'According to the research', 'The study demonstrates' - do NOT repeat the same phrase
   - If you find yourself writing similar content, STOP immediately and write something completely different
   - Before each sentence, ask: 'Have I already said this?' If yes, write something new
   - Vary your language: use synonyms, different sentence structures, different perspectives
   - REPETITION CHECKLIST: After writing each sentence, verify it's not a duplicate of any previous sentence

   EXAMPLES OF WHAT NOT TO DO:
   ❌ BAD: 'The authors state: "X". The authors state: "Y". The authors state: "Z".'
   ✅ GOOD: 'The authors state: "X". They further note: "Y". The paper argues: "Z".'

   ❌ BAD: Repeating the same claim 3+ times with slight variations
   ✅ GOOD: State each claim once, then move to the next unique point

8. STRUCTURE:
   - Use markdown headers: ### Overview, ### Methodology, ### Results, ### Discussion
   - Target length: 1000-1500 words
   - Ensure all requested elements (quotes, claims, findings, methods, results) are included
