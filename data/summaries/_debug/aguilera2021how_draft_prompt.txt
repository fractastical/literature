=== IMPORTANT: ISOLATE THIS PAPER ===
You are summarizing ONLY the paper below. Do NOT reference or use content from any other papers.
Do NOT mix information from different papers. Only use information from THIS specific paper.

Paper Title: How particular is the physics of the free energy principle?
Citation Key: aguilera2021how
Authors: Miguel Aguilera, Beren Millidge, Alexander Tschantz

REMEMBER: Extract quotes, claims, and findings ONLY from the paper text provided below.

Year: 2021

Abstract: The free energy principle (FEP) states that any dynamical system can be
interpreted as performing Bayesian inference upon its surrounding environ-
ment. In this work, we examine in depth the assumptions required to de-
rive the FEP in the simplest possible set of systems – weakly-coupled non-
equilibrium linear stochastic systems. Specifically, we explore (i) how general
the requirements imposed on the statistical structure of a system are and (ii)
how informative the FEP is about the behaviour ...

Key Terms: principle, system, systems, energy, united, kingdom, university, dynamics, states, physics

=== FULL PAPER TEXT ===

How particular is the physics of the free energy
principle?
Miguel Aguileraa, Beren Millidgeb, Alexander Tschantza,c, Christopher L.
Buckleya
aSchool of Engineering and Informatics, University of Sussex, Falmer, Brighton, BN1
9QJ, United Kingdom
bMRC Brain Network Dynamics Unit, University of Oxford, Oxford, OX1 3TH, United
Kingdom
cSackler Center for Consciousness Science, University of Sussex , Falmer,
Brighton, BN1 9QJ, United Kingdom
Abstract
The free energy principle (FEP) states that any dynamical system can be
interpreted as performing Bayesian inference upon its surrounding environ-
ment. In this work, we examine in depth the assumptions required to de-
rive the FEP in the simplest possible set of systems – weakly-coupled non-
equilibrium linear stochastic systems. Specifically, we explore (i) how general
the requirements imposed on the statistical structure of a system are and (ii)
how informative the FEP is about the behaviour of such systems. We dis-
cover that two requirements of the FEP – the Markov blanket condition
(i.e. a statistical boundary precluding direct coupling between internal and
external states) and stringent restrictions on its solenoidal flows (i.e. tenden-
cies driving a system out of equilibrium) – are only valid for a very narrow
spaceofparameters. Suitablesystemsrequireanabsenceofperception-action
asymmetries that is highly unusual for living systems interacting with an en-
vironment. More importantly, we observe that a mathematically central step
in the argument, connecting the behaviour of a system to variational infer-
ence, relies on an implicit equivalence between the dynamics of the average
states of a system with the average of the dynamics of those states. This
equivalence does not hold in general even for linear systems, since it requires
an effective decoupling from the system’s history of interactions. These ob-
Email address: sci@maguilera.net (Miguel Aguilera)
Preprint submitted to Physics of Life Reviews May 23, 2022
2202
yaM
91
]CN.oib-q[
3v30211.5012:viXra
servations are critical for evaluating the generality and applicability of the
FEP and indicate the existence of significant problems of the theory in its
current form. These issues make the FEP, as it stands, not straightforwardly
applicable to the simple linear systems studied here and suggest that more
development is needed before the theory could be applied to the kind of
complex systems that describe living and cognitive processes.
Keywords: Free energy principle, Markov blanket, Non-equilibrium
systems, Bayesian inference, Linear stochastic systems
1. Introduction
During the last decade, the ‘free energy principle’ (FEP) has become
an influential framework which aims to provide a grand theory promoting a
Bayesian interpretation of living systems [1, 2, 3]. The FEP states that any
self-organizing system (i.e. any dynamical system, and therefore any living
or cognitive entity) equipped with a Markov blanket – a statistical separa-
tion between internal and external states – can be interpreted as performing
Bayesian inference upon the surrounding environment, such that its internal
states come to encode probabilistic beliefs about the external environment
[3, 4].
The core claim of the FEP is exceptionally ambitious. It implies that
the dynamics of any pair of coupled systems, under specific conditions about
the interaction of internal and external states, can be described as one sys-
tem trying to statistically infer the states of the second system (cf an agent
and its environment). This claim licenses an interpretation of the agent as
performing a basic kind of Bayesian inference and encoding beliefs about
the surrounding environment [5, 6]. Such an equivalence could have a far-
reaching influence on the study of living systems. For example, it could en-
able approximate calculations of the dynamics of complex systems in terms
of a more tractable description of the dynamics of their sufficient statistics.
Furthermore, the FEP has been defended based on singular claims about its
explanatory power, suggesting that it reveals novel insights among funda-
mental psychological concepts such as memory, attention, value, reinforce-
ment, and salience [7] and unifies different aspects of motor behaviour and
perception, from retinal stabilization to goal-seeking [8]. In addition, it has
been proposed that the FEP provides a basis for integrating several general
brain theories, including the Bayesian brain hypothesis, neural Darwinism,
2
Hebbian cell assembly theory, and optimal control and decision theory [9].
The FEP has also inspired theories such as predictive coding [10, 11, 12,
13] and active inference [14, 15, 16], which offer explanations and models of
brain function and dysfunction [17] through the lens of Bayesian inference,
and have become widely influential in theoretical neuroscience and beyond.
For instance, predictive coding has been proposed to be a biologically plau-
sible model of cortical function [11, 12, 18], and has been applied to explain
binocular rivalry [19] or attention [20]. Active inference, on the other hand,
has seen substantial use in modelling the behaviour of human or animal sub-
jectsinvariousparadigms[14,15], aswellasunderstandingrationaldecision-
making and behavioural control [21, 22, 23, 24]. Moreover, biological theories
proposing that neurons [25], synapses [26], bacteria [27] or plants [28] could
be explicitly performing Bayesian (variational) inference by minimizing free
energy gradients have been proposed and justified using explicit appeals to
the FEP. While such theories do not entirely depend upon the validity of the
mathematical core of the FEP reviewed here, they nevertheless derive a sub-
stantial amount of their intellectual and rhetorical support from it. Thus,
the fundamental validity of the mathematical framework of the FEP is of
great importance to this large and rapidly increasing modelling literature.
In a vast body of work that spans over the course of about 15 years,
the FEP has detailed the mathematical steps required to derive its central
claims. In the first phase, an intuitive and heuristic idea of an imperative to
minimize variational free energy was developed [29, 7] based on the need for
any recognizable ‘system’ to maintain itself in a low entropy configuration
over time against dissipative forces trying to push it towards a high entropy
equilibrium state. Later, this heuristic argument and intuition was more for-
mally related to concepts from stochastic thermodynamics [2, 1], specifically
by bringing in the Markov blanket condition and expressing the dynamics of
the system in terms of a gradient descent on a variational free energy corre-
sponding to a generative model of the environment of the system. Finally,
the mathematical formulation and some of its arguments have been recently
refined in a new series of publications [3, 4, 30], a process that is still ongoing.
Despite the extensive literature on the FEP, there are few concrete ex-
amples that apply all the required steps to a specific, well-studied system.
Similarly, it has rarely been explored whether the assumptions (which are
sometimes left unstated) required for deriving the principle hold under the
dynamics we expect from cognitive and living systems. In light of the in-
creasing rate of publications concerning the FEP (the number of published
3
publications per year
1500
1000
500
0
2000 2005 2010 2015 2020
year
Figure 1: Growth in publications pertaining the free energy principle. Publica-
tions per year searching for ‘free energy principle’. Source: Google Scholar. The number
of papers has approximately doubled from 2013 (link) to 2017 (link) and from 2017 to
2020 (link), as indicated by the dashed lines.
papers on the topic doubles every few years, Fig. 1), we believe it is imper-
ative to ground and test the foundations of the theory in concrete models
to assess the generality and validity of its claims. To this end, we explore
a class of systems defined by stochastic linear differential equations, under
a weak-coupling assumption. Such systems are the simplest possible exam-
ple that can display the dynamics required for the FEP, as well as capture
non-equilibriumpropertiesofsystemsengagedinperception-actioncycles(as
we expect from living systems). Moreover, the absence of nonlinear interac-
tions in this class of systems allows for precise analytic calculations, which
offers an interesting test-bed to examine, in detail, the connection between
non-trivial dynamics and the statistical properties of coupled systems. In
general, due to the special independence properties imposed by the theory, if
the assumptions and steps of the FEP do not hold in such simple systems, we
consider it unlikely that they hold in more complex nonlinear systems where
the dynamics are expected to be more deeply intertwined. Moreover, we
observe that stronger couplings result in higher-order interactions that make
difficult the separation between internal and external states required by the
FEP. Because of this, we expect that the introduction of non-linearities will
in general have a similar effect.
4
How general is the free energy principle
We first inspect the generality of the assumptions about the statistical
structure of a system required by the principle. A crucial step to derive the
FEP is to establish a relation between the average flow of change of a system
that interacts with an environment and the gradient of a variational free en-
ergy of a model of this environment. This step relies on specific assumptions
about how perception and action mediate the interaction of the internal and
external states of a system. We aim to explore how general these assump-
tions are and whether they can be expected in the dynamical systems models
of living systems.
Perception-action interface. The FEP partitions the states of a sys-
tem into external, sensory, active and internal states. Then, the theory
assumes that perception-action cycles involve causal dependencies such that
internal and external states are only mutually influenced through the effect
of active and sensory states [2]. We will refer to this idea as a perception-
action interface (see Appendix A). One example of this interface is a cell
membrane around a cell [2], although the formal definition of a perception-
action interface does not require the interface to be a physical boundary.
Thus, a perception-action interface could describe any set of variables me-
diating between system and environment as, for example, a combination of
retinal activity and oculomotor states mediating between neural activity in
the visual cortices and the location of an object in the environment [4].
Then, the FEP requires the system to be endowed with a particular sta-
tistical structure with two special properties: a Markov blanket (i.e. condi-
tional independence between internal and external states) and the absence
of solenoidal couplings.
Markov blanket. The FEP prescribes that variables in a perception-
action interface constitute a Markov blanket [2, 30]. A Markov blanket (see
Appendix A) is defined as a set of states (the ‘blanket’) that separates two
other sets in a statistical sense (i.e. they are conditionally independent, given
the blanket). The term was initially introduced in the context of Bayesian
networks or graphs [31], and it is also known as the general Markov condition
[32]. In the FEP, Markov blankets are used for identifying a set of variables
that separate the internal and external states of a system (see [33] for a
detailed study on the specific use of the concept of Markov blanket in the
FEP). Here, we note that Markov blankets can be easily identified in models
defined by directed acyclic Bayesian networks (Fig. 2.A). In these systems,
a sufficient condition for a Markov blanket of variable x (e.g., an internal
5
A Directed acyclic graph B Cyclic causal model
s s y s s y
y x y x
a x a x
a a
Figure 2: Markov blankets and causal cyclic models. (A) An example of a Markov
blanket (grey nodes s,a, e.g. perception and action) for a variable x (e.g. an internal
state) in a directed acyclic graph representing a Bayesian network. (B) An example of a
cyclic causal model where the Markov blanket is not directly identifiable from the graph
structure. In this case, nodes that meet the local Markov condition (grey nodes) do not
guarantee the conditional independence required for a Markov blanket, as new couplings
mightemerge(dashedarrowsbetweenx,y). Ineachcase,thegraphattherightrepresents
the equivalent correlations of the system probability distribution for fixed s,a.
state) is that it contains the parent nodes of x, the children nodes of x and
the other parents of each children node (in this case, the minimum Markov
blanket is composed by the grey nodes, s,a, in Fig. 2.A). This is defined as
the local Markov condition [32] (which implies the general Markov condition
inthedirectedacyclicgraphsofBayesiannetworks). However, in[2]theFEP
suggests that a Markov blanket arises naturally from the perception-action
interface depicted in Fig. 2.B (although recent works restrict this to the
case of an absence of particular solenoidal flows [30]). However, such a cyclic
structure can generate couplings that propagate beyond causal interactions.
In this case, the local Markov condition does not imply a Markov blanket, as
marginalization over local blanket variables generates new couplings (dashed
arrows in Fig. 2.B). This important issue (identified by [34]) contradicts the
intuition that perception-action states always constitute Markov blankets,
which we will explore in following sections.
Solenoidal couplings. The second required property is that solenoidal
couplingsbetweeninternal, external, sensorandmotorstatesareabsent. The
idea of solenoidal flows (see Appendix A) arises from the separation of the
flow of a dynamical system into two components. The first component is a
dissipative (curl-free) flow that counters the dispersion of the density caused
by random fluctuations in the system. The second component, the solenoidal
flow, is defined as a conservative (divergent-free) flow capturing dissipative
tendencies in the system, driving it away from equilibrium [3, p.11]. This
6
nonequilibrium nature is a fundamental aspect of living entities. Examples
of this are asymmetric organism-environment interactions [35] or the oscil-
latory behaviour underpinning most biorhythms and neural dynamics [36].
The FEP assumes that solenoidal couplings between internal and external
states are absent, meaning that these flows will not penetrate through the
perception-action interface.
Average flows and the variational free energy. The confluence of
these properties entails an important result: due to this particular statisti-
cal structure, the average flow of a system can be described in terms of a
variational free energy gradient. The average flow (also called the marginal
flow, see Appendix A) describes the average rate of change of the system
conditioned on the blanket state. In turn, the variational free energy (see
Appendix A) represents an upper bound of the surprise of observed states,
according to an internal model of the environment.
Inthefirstsectionofthismanuscript,westudyhowlikelytheseconditions
are for the type of dynamical interactions we expect to find in living system.
By considering the simplest case of non-equilibrium stochastic dynamics,
we show that Markov blankets and absence of solenoidal flows only emerge
for very particular perception-action interfaces, forcing symmetries in agent-
environment interactions that are not expected in living beings.
The core issue is that these three requirements – a perception-action par-
tition where sensor and active states mediating the internal and the external
states, the existence of a Markov blanket, and decoupled solenoidal flows –
are, in principle, independent conditions. A perception-action interface does
notnecessarilyguaranteetherequiredconditionalindependencerelationships
and, in fact, generally does not since statistical correlations can propagate
beyond this interface over time due to the intrinsic fluctuations and reen-
trant connections in the system. Conversely, the conditional independence
relationship decreed by the Markov blanket does not imply that there is a
lack of dynamical coupling between internal and external states [34]. In prac-
tice, we discover that the kinds of systems that can fulfil both the Markov
blanket condition and the block-diagonal solenoidal coupling condition are
extremely specialized and generally do not possess the kind of sparsity and
asymmetry of dynamical couplings that we expect from a perception-action
interface. These asymmetries are present at different levels of living systems,
leading to qualitative differences between the inside and outside of a system,
shaping system-environment interactions and its related flows of energy and
matter [35, 37, 38, 39].
7
In other words, although the Markov blanket assumption is typically
maintained in systems with very weak couplings, we observe that there are
direct interactions between external and internal states in the system’s dy-
namics. This subtle distinction between the conditional independence rela-
tionships of the mechanisms of a system (perception-action interface) and its
statistical couplings (Markov blanket) – which is analogous to the distinction
between anatomical and functional connectivity in neuroscience – has per-
haps been underappreciated in the FEP literature. This ambiguity leads to
the claim that the requirements of the FEP naturally describe systems with
a causal boundary between the external and internal states [2], when this is
not necessarily the case.
How informative is the free energy principle
Once the relation between a free energy gradient and the average flow of a
system has been established, we explore how informative this relationship is
about the behaviour of an organism or the evolution of a dynamical system.
Conditional synchronisation manifold. To justify the relation be-
tween a gradient of a free energy functional and the behaviour of a system,
theFEPassumes theexistenceofa conditional synchronisation manifold(see
Appendix A). This manifold is defined as a mapping that, given a blanket
state, connects the most likely internal and external states. The FEP pro-
poses that its existence allows us to characterise the relationship between
(maximum a posteriori) internal and external states in terms of internal
states ‘sensing’ or ‘tracking’ external states through the Markov blanket [3].
Next, the FEP links the evolution of the most likely external states with
the average flow of the system, conditioned on the blanket states. Since the
step described in the previous section connects the free energy gradient with
theaverageflow, thisassumptionimpliesthattheevolutionofthemostlikely
external states is driven by the gradient of a variational free energy. More-
over, given the conditional synchronisation manifold, the most likely internal
states are also driven by this free energy gradient. The FEP suggests this
result leads to the appearance that any system with the properties described
above behaves as if internal states were performing variational inference to
predict external states.
Average flows and the rate of change of the average. The claim
that systems under the required properties behave as if performing infer-
ence relies on a venturesome assumption. It implicitly attributes the rate of
change of the average (expected) state of a system– i.e. the expected change
8
in the internal state of an agent at a particular moment – can be roughly
described by the steady-state average flow of the system conditioned on a
blanket state – i.e. the average rate of that state during many trajectories
(see Appendix A). This assumption is driven by the intuition that if the
average flow points in a direction that minimizes variational free energy, in-
ternal states will behave as if they are trying, on average, to minimize this
free energy. As well, this can be read as an implicit assumption that these
two quantities are approximately the same. However, as we will show, this
intuition is incorrect since the average flow conditioned on blanket states dis-
connects the rate of change in the system from its previous trajectory, which
is crucial to predict the system’s behaviour. In practice, this assumption
implies decoupling the actions of an agent from its history of previous states.
We will show that, in the class of linear system explored in this work, this
results in the free energy gradients being uninformative about the behaviour
of an agent or its specific trajectories.
We should note that this claim has been relaxed in more recent work
[30], proposing (instead of an equivalence between rates of change of ex-
pected states and average rates) that an interpretation in terms of Bayesian
inference emerges only in expectation. We will see however that this still
presents important practical and conceptual problems. To draw an analogy
that portrays this issue, we could propose that the actions of a population
of organisms in a particular evolutionary context maximize, on average, a
fitness function – e.g. the number of genes the population passes on to the
next generation. That is, however, a largely uninformative statement for
describing the behaviour of an individual organism, which depends on that
organism’s specific history. Moreover, the behaviour of an organism that
systematically inferred what to do next in terms of (evolutionary) fitness
maximization would likely be entirely different from the realized behaviour
of any living organism. This is not only a point of philosophical nuance
but, as we will show, translates into assumptions and important equations
required for deriving the FEP.
Overview of the mathematical review
In this article, we present a technical and conceptual critique of the FEP.
As the theory is in continuous development, its mathematical details have
been described in different forms and notations in the literature. For our
study we try to remain as close as possible to the verbal and formal descrip-
tions described in the most recent publications [3, 4, 30]. However, in at least
9
two instances (see Assumption 1 and Assumptions 3∗ and 3∗∗), we identify
conflicting interpretations of the theory. In these cases, we attempt to derive
our argument with as much mathematical coherence as possible while also
presenting results that address the different identified possibilities.
Therestofthearticleisorganizedasfollows. First, wepresentasummary
of the FEP, including a list of conditions and assumptions required to derive
it. Next, we survey the steps prescribed to derive the FEP for a linear
stochastic system under a weak coupling assumption. We then evaluate in
which cases we expect the requirements of the FEP to hold. Finally, we
evaluate the implications of our study for the theory and its applicability to
the type of processes that living systems are expected to manifest.
2. Summary of the theory
Here we present a succinct description of the theory, based on the most
recent publications [3, 4, 30], although some steps apply to previous versions
as well. Generally, the FEP assumes a random dynamical system described
in terms of a Langevin stochastic differential equation:
dz
t = f(z )+ω , (1)
t t
dt
where z = z ,i = 1...N is a vector, f is an arbitrary but differentiable
t i,t
{ }
function and ω = ω is a Gaussian white noise with covariance 2Γ, which
t i,t
{ }
is a diagonal matrix. Throughout this article, bold symbols represent vectors
and matrices.
The FEP further assumes that the system can be decomposed into ex-
ternal, sensory, active and internal states, z = y,s,a,x , configured as a
{ }
perception-actionloopreflectinganinterfacemediatingbetween‘autonomous’
states (active and internal states a,x ) and ‘non-autonomous’ states (ex-
{ }
ternal and sensory states y,s ). This leads to
{ }
Condition1. Theflowfunctionf decouplesautonomousandnon-autonomous
states according to the following perception-action interface:
f (y ,s ,a )
y t t t
f (y ,s ,a )
f(z ) =  s t t t . (2)
t f (s ,a ,x )
a t t t
f (s ,a ,x )
x t t t
 
 
10
Condition 1 Condition 2 Condition 3
y y y
s
s s
y x b b = {s, a}
a a
x x a x
Assumption 1 Assumption 2 Assumption 3*
m m m
y y y
s
b
y x b
Causal influence
a m Diffusion tensor, Γ
x Solenoidal coupling, Q
Statistical dependence
Mapping
Figure 3: Conditions for the free energy principle. List of conditions and assump-
tions for deriving the FEP. The conditions for the FEP are: the flow of the system is
constrained to define a perception-action interface (Condition 1, illustrated in the figure
for an Euler integration step), the system has a global attractor described by a state-
independent SDE decomposition (Condition 2), and from this configuration a Markov
blanket emerges (Condition 3). The assumptions necessary for deriving the FEP are: the
global attractor presents an uncoupling of solenoidal flows (Assumption 1), there is an
invertible mapping between the most likely internal and external states (Assumption 2)
and the evolution of the most likely external dynamics is described by the marginal flow
(Assumption 3∗).
11
Under the presence of random fluctuations, some systems will converge
toward a stable global attractor reflecting the steady-state dynamics of the
system. In systems out of thermodynamic equilibrium, this global attrac-
tor will describe a non-equilibrium steady-state (NESS), characterized by a
continuous energy flux between the system and its environment. The next
condition of the FEP is that this global attractor exists and can be described
by a stochastic differential equation (SDE) decomposition [40, 41] (often re-
ferred in the FEP literature as a ‘Helmholtz’ decomposition) describing the
flow function as a linear function of the logarithmic steady state distribution
of the system:
Condition 2. The FEP assumes that the system will reach a non-equilibrium
steady state described by the probability density function p(z ), which can be
t
described using a SDE decomposition that separates the flow into dissipative
( Γ J(z )) and solenoidal (Q J(z )) components
z t z t
− ∇ ∇
f(z ) =(Q Γ) J(z ), (3)
t z t
− ∇
J(z ) = logp(z ), (4)
t t
−
where Q is an antisymmetric matrix – i.e. equal to its negative transpose,
Q = Q(cid:124). This condition requires Γ and Q to be constant matrices – i.e.
−
state-independent, as it is the case in linear systems1.
The third condition is that the perception-action interface induces a
Markov blanket into the NESS probability distribution. In a Markov blan-
ket, internal states are independent when conditioned on the blanket states,
composed of sensory and active states, b = s,a :
{ }
Condition 3. The steady state distribution is described in terms of a Markov
blanket, where internal/external states are independent when conditioned on
its blanket states.
p(y ,x b ) = p(y b )p(x b ). (5)
t t t t t t t
| | |
1Recent works have relaxed this assumption, considering the case of state-dependent
Γ and Q matrices [42, 43]. However, these changes do not materially affect our critique
(which uses systems where these matrices are independent of the state of the system) and
we focus on the state-independent case here.
12
It is important to note (see [34]), that Conditions 1 and Condition 3
are independent and one does not entail the other. This is an important
point, as some presentations of the FEP assume that a perception-action
interface directly involves a causal barrier (Markov blanket) between system
and environment, and this is not always the case.
2.1. First move: Capturing Bayesian inference with an average flow
The FEP starts by describing the average flows of the external states of
a system as following a gradient minimizing a variational free energy. This
connects these flows with notions from Bayesian inference.
The principle starts from a description of the ‘surprise’ of the observed
blanket states, under the steady-state distribution defined by the (random)
dynamics of the system, which we denote with J(b) being the negative log-
probability
J(b) = logp(b). (6)
−
This implies that highly unlikely states will have a large surprise value and
vice versa.
However, a system cannot access this surprise value without complete
knowledge of its environment. Thus, Bayesian inference prescribes to use a
lower bound of this surprise described by the variational free energy F(θ,b):
logp(b) < F(θ,b) = logp(b)+D (q(y θ) p(y b)) (7)
KL
− − | || |
q(y θ)
D (q(y θ) p(y b)) = dyq(y θ)log | (8)
KL | || | | p(y b)
(cid:90) |
which is composed of the surprise plus a term capturing the distance from
the probability of external states given the blanket p(y b) to a variational
|
model of the environment q(y θ) parametrized by θ.
|
This free energy constitutes a bound on the surprise, which is exact
when the variational distribution q(y θ) is equal to the reference distribution
|
p(y b). The FEP often assumes that q is a normal distribution:
|
q(y θ) = (θ,Σθ), (9)
| N
where θ are the most likely states of the system and Σθ its covariance matrix.
A simple instance of Bayesian inference can be derived from the assump-
tion that the integral of the negative conditional log-probability (or surprise)
13
in the Free energy equation is approximately quadratic in the region near the
mode of the conditional density θ. This is called the Laplace approximation
[44] and allows approximating
n 1
F(θ,b) y (1+log(2π)) log Σθ
≈− 2 − 2 | |
1
+ dyq(y θ) J(θ,b)+ (y θ) (cid:124) H (y θ)
yy
| 2 − −
(cid:90) (cid:18) (cid:19)
1 n 1
=J(θ,b)+ Tr ΣθH y (1+log(2π)) log Σθ . (10)
yy
2 − 2 − 2 | |
(cid:2) (cid:3)
where Tr is a trace operator, H = J(θ,b) is the Hessian matrix respect
yy yy
∇
to y of the marginal probability distribution p(y,b) at y = θ.
In this scenario, finding the model q(y θ) that minimizes the variational
|
free energy is equivalent to approximating the distribution p(y b). From a
|
gradient descent perspective, if we are interested in adjusting parameters θ,
this minimization process results from following the negative gradient
F(θ,b) = J(θ,b). (11)
θ θ
∇ ∇
Under the FEP it is suggested that a system displaying a Markov blanket
minimizes the free energy functional by implementing a gradient descent
schemereferredtoasrecognitiondynamics[7,45,46]. Aliteralinterpretation
of this claim involves a dynamics of the variational parameter with the form
dθ
t = γ J(θ ,b ), (12)
θ t t
dt − ∇
where γ is a matrix characterizing the rates of adjustment of the variational
parameters. This type of dynamics (or a discrete counterpart) is usually
proposed by active inference schemes (e.g. [46]). However, in the most recent
articles (e.g. [30]) this claim is not taken literally, and the proponents of the
FEP suggest that it is only the average flows of the system (not the actual
dynamics)thatpointinthedirectionofthefreeenergygradient. Throughout
this manuscript, we will explore both a literal interpretation of a gradient
descent on the free energy and the case in which the free energy gradient is
only connected with the average flows.
The FEP asserts that any system with a Markov blanket partition that
reaches a non-equilibrium steady-state (NESS) can be construed as perform-
ing an elementary sort of Bayesian inference. This implies that the behaviour
14
of a system can be described by some variable that behaves as θ in Eq. 12,
t
at least on average. Specifically, the FEP proposes that the evolution of the
statistics of internal states can be described in terms of the variational free
energy, given a blanket b .
t
Under Condition 3, given a blanket state at time t (b ), the statistics
t
of internal and external states can be described independently. The FEP
proposes to describe change in internal and external states through variables
encoding the most likely2 internal and external states conditioned on the
blanket
m (b ) =argmax p(x b ), (13)
x t x t t
|
m (b ) =argmax p(y b ). (14)
y t y t t
|
Then, the average flow of the system (or marginal flow) conditioned on
the blanket b can be computed from the SDE decomposition in Condition 2
t
as
f (y ,b ) = dx dy p(y ,x b )f (y ,b )
(cid:104) y t t (cid:105)bt t t t t | t y t t
(cid:90)
= dx dy p(y ,x b )(Q Γ ) J(z )
t t t t t yz yz z t
| − ∇
(cid:90)
=(Q Γ ) J(z )
yy − yy (cid:104)∇ y t (cid:105)bt
+Q J(z ) +Q J(z ) . (15)
yb (cid:104)∇ b t (cid:105)bt yx (cid:104)∇ x t (cid:105)bt
The first term in this expression can be related to the gradient of the
surprise in Eq. 11 (see below). However, the second and third terms in the
Eq. 15 preclude a straightforward connection between the average flow of the
system and the minimization of the variational free energy. The necessary
step in deriving the FEP is removing the solenoidal couplings between blocks
of the system, encoded in the matrix Q, to remove these second and third
terms. Thus, in order to describe the equivalence between the dynamics of a
system and free energy minimization, the FEP assumes that
2Choosing the argmax function can imply problems in some cases (e.g. if it is non-
differentiable), and in some cases the expectation has been proposed as an alternative
statistic. However, in the case of Gaussian systems these two functions are equivalent, so
this does not affect the conclusions in this article.
15
Assumption 1. Solenoidal couplings between ‘blocks’ of states (y,s,a,x)
are precluded when a Markov blanket emerges under sparse coupling [3].
Q
yy
Q
Q =  ss . (16)
Q
aa
 Q 
xx
 
 
This leads to
f (y ,b ) =(Q Γ ) J(z )
(cid:104) y t t (cid:105)bt yy − yy (cid:104)∇ y t (cid:105)bt
(Q Γ ) J(m (b ),b ). (17)
≈
yy
−
yy
∇
my y t t
Where the approximation is obtained neglecting couplings of order larger
than quadratic in the average of the surprise J(z ), as prescribed by the
t
Laplace assumption, knowing that the flow of external states is independent
of internal states x. The obtained expression is proportional to the gradient
in Eq. 11 for θ = m (b ), therefore pointing to a direction minimizing the
t y t
free energy, where the factor (Q Γ ) represents the rate of adjustment
yy yy
− −
of variational parameters (γ in Eq. 12).
In a recent work [30], it has been proposed that in the general case Q
is only block-diagonal for autonomous ( a,x ) and ‘non-autonomous’ states
{ }
( y,s ),allowingnon-zerocomponentsQ ,Q ,Q ,Q . However,itisnot
ys sy ax xa
{ }
clear (to our knowledge) how this case can be directly connected with free
energy minimization, and this should be perhaps clarified by future work. In
any case, the findings in the next sections of this article bring forward similar
problems considering one type of block-diagonal matrix or the other.
This step concludes the first move for deriving the FEP, by connecting
the average flow of a system with the gradient minimizing a variational free
energy functional.
2.2. Second move: Linking the average flow with the dynamics of the most
likely states
The second move for deriving the FEP involves connecting the average
flow in the system with its (averaged) dynamics. This second step starts by
assuming a mapping connecting the most likely internal and external states:
16
Assumption 2. There is a smooth and differentiable function σ that maps
between the most likely internal and external states given a blanket state,
m (b ) = σ(m (b )), (18)
y t x t
and the gradient σ(m ) is invertible (i.e. ( σ(m ))−1 exists)
∇
mx x
∇
mx x
A sufficient requisite for Assumption 2 is that the mapping from b to
t
m (b ) is injective [4].
x t
Once the mapping between internal and external states is defined, the
next step, as we anticipated, admits two possible interpretations. The first is
an interpretation in which the dynamics of the average states of the system
strictlyfollowagradientdescentonthefreeenergy(intheformofEq.12, e.g.
[46]). A second interpretation relaxes this view to propose that free energy
minimization only takes place on average over counterfactual trajectories
(rather than directly). The distinction between the two (see Assumptions
3∗ and 3∗∗) has been generally not discussed in detail, but it is of great
importance to evaluate the claims of the FEP.
The first interpretation proposes that the dynamics of the most likely
states can be described by the gradient on the free energy captured by the
average flow described by Eq. 17, which results in:
Assumption 3∗. The evolution of the most likely external states is similar
to their conditional marginal flow given the blanket state
dm (b )
y t f (y ,b ) . (19)
dt ≈(cid:104) y t t (cid:105)bt
The star symbol in this assumption indicates that this assumption is
∗
in general not explicitly stated, and that two competing interpretations are
possible. The first interpretation, in which Assumption 3∗ holds strictly, is
supported by verbal descriptions and some mathematical steps in [3] and
[4] (specifically the equivalents of Eq. 20 and 21 below3 and several verbal
3In these works, the same symbol is used to represent dmy(bt) and f (y ,b ) in
dt (cid:104) y t t (cid:105)bt
Eq. 20 and 21 (Eq. 3.3 and 3.5 in [4], Eq. 8.22 and 8.23 in [3]), therefore making the
implicit assumption that they are approximately the same quantity. Also, it should be
noted that Eq. 22 can only be obtained under the combination of Assumption 2 and
Assumption 3∗, as it combines properties of the mapping σ (related to the most likely
states) with the gradient of the free energy (related to the average flows).
17
descriptions4). The alternative interpretation of this assumption relaxes the
equivalence between dmy(bt) and f (y ,b ) (see Assumption 3∗∗ below).
dt (cid:104) y t t (cid:105)bt
Taken together, these three assumptions let us derive a connection be-
tween the evolution of the most likely states and the gradient of the varia-
tional free energy:
dm (b )
y t =(Q Γ ) J(m (b ),b ). (20)
dt
yy
−
yy
∇
my y t t
This has an important implication, as it allows us to derive that m (b )
y t
behaves as the variational inference parameter θ in Eq. 11. Therefore, the
dynamics of a system can be described as if performing variational inference.
This is possible because the conditional synchronisation manifold (As-
sumption 2) allows deriving a mapping between the evolution of the most
likely states through the chain rule:
dm (b ) dm (b )
m (b ) = σ(m (b )) y t = σ x t . (21)
y t x t
⇒ dt ∇
mx
dt
Finally, under Assumption 3∗, the dynamics of the most likely internal
states can be described as minimizing the variational free energy about ex-
ternal states
dm (b ) dm (b )
x t =( σ)−1 y t
dt ∇
mx
dt
( σ)−1(Q Γ)( σ)−1 J(σ(m (b )),b ), (22)
≈ ∇
mx
− ∇
mx
∇
mx x t t
which corresponds to following the gradient descent on the variational free
energy described by Eq. 12, now rewritten in terms of the most likely internal
states.
Here, we shall note that, in general, Assumption 3∗ does not hold for
most dynamical systems with stochastic fluctuations, as it equates the rate
of change of an average with the average of the rate of change. The propo-
nents of the FEP in recent works offer instead a more relaxed interpretation
of the gradient descent on the variational free energy. This interpretation
proposes that the FEP applies just to the marginal flows, and thus a system
4Particularly sentences about variable η˙(b) in these works, for which it is stated ‘the
dynamics of the internal mode as a gradient flow on the surprisal of the external mode’
([3], p. 97) ‘the rate of change of the most likely internal states’ ([4]), p. 7.)
18
behaves ‘as if’ performing Bayesian inference just on average. For exam-
ple in [30] the authors propose that ‘the interpretation in terms of Bayesian
inference emerges only in expectation — or on average [...] The classical
example here is the averaging of multiple responses to sensory perturbations,
when characterizing evoked responses in internal states’. This results in the
substitution of Assumption 3∗ by
Assumption 3∗∗. If the conditional average flows follow the direction of a
descending gradient of a variational free energy, the behaviour of the states
of the system can be interpreted ‘as if’ they were, on average, performing a
gradient descent or minimizing a free energy functional.
In general, it is not easy to distinguish in the FEP literature when As-
sumption 3∗ or Assumption 3∗∗ is considered, as verbal descriptions some-
times refer to dynamics of most likely states and average flows indistinctly.
Note also that some important steps like the chain rule in Eq. 21 can only
be derived for the interpretation promoted by Assumption 3∗. Despite the
interpretation, under these assumptions the proponents of the FEP conclude
that the dynamics of the most likely internal and external states can be de-
scribed as following a negative free energy gradient, which is equivalent to
stating that they evolve as if performing a Bayesian inference. Moreover,
the FEP proposes that this can be extended to the dynamics of actions a [4],
deriving the principle of active inference [10, 12].
The two moves described here make important assumptions about the
underlying dynamical systems used to derive the theory. The first move
assumes a very specific statistical structure in which a gradient of the free
energy functional is directly connected to average flows in the systems, with-
out justifying to what extent it can be expected from the classes of systems
capturing properties from biological systems. The second move makes fur-
ther assumptions to justify that average flows (i.e. the average of the rate
of change) in the system are informative about its behaviour and dynamics
(i.e. the rate of change of the average), supporting an interpretation that
described the behaviour of a system as if performing Bayesian inference. In
the next sections, we will see that the steps for deriving this interpretation
are not justified for the non-equilibrium linear systems studied in this paper.
In the rest of the document, we will take Conditions 1 and 2 for granted
and explore the generality of the other conditions and assumptions in linear
stochastic systems with weak couplings. We will see that Assumption 2 hold
under special conditions and can be expected for a given class of systems.
19
In contrast, we show that Condition 3 and Assumption 1 only hold for very
specific sensorimotor loops and Assumption 3∗ and 3∗∗ do not hold in gen-
eral, threatening the viability of the FEP and its applicability to most living
systems.
3. Mathematical review of the FEP under linear stochastic dynam-
ics
Inordertoexploretheassumptionsenumeratedaboveinaclassoftractable
non-equilibrium dynamical systems, we restrict our analysis to the class of
systems captured by a linear Langevin dynamics (which can be seen as an
approximation of an Ornstein-Uhlenbeck process [47]) defined by
dz
t = J(z ρ)+ω , (23)
t t
dt −
where J is an n n invertible real matrix, ρ is an n dimensional real vector,
×
ω is a standard n-dimensional Gaussian white noise with a diagonal covari-
t
ance matrix 2Γ. The linearity of the process guarantees that the model will
eventually result in a Gaussian distribution.
The solution of this system (see Appendix B) in the non-equilibrium
steady state (NESS) takes the form of a multivariate Gaussian distribution
(ρ,Σ∗) [47, 48] with statistical moments:
N
lim m =ρ, (24)
t
t→∞
lim Σ =Σ∗, JΣ∗ +Σ∗J (cid:124) +2Γ = 0, (25)
t
t→∞
whereΣ∗ canbefoundnumericallybysolvingtheabovecontinuous Lyapunov
equation. If J is symmetric, the steady state of the system is a state of
equilibrium with Σ∗ = J−1Γ. However, the FEP focuses instead on NESS,
−
which are more appropriate for describing living systems.
For studying the NESS of the system, in this article we explore the case
in which non-diagonal couplings in J are small, although we explore the
effect of considering higher orders of this approximation. Thus, we define
the coupling matrix as, J = I+C, where C2 are assumed to be small.
−
This leads to the following power series expansion,
1 1
Σ∗ = Γ+ (CΓ+ΓC (cid:124) )+ C2Γ+2CΓC (cid:124) +Γ(C (cid:124) )2 + (C3). (26)
2 4 O
(cid:0) (cid:1)
20
To further simplify things, we also define a homogeneously distributed noise
Γ = ς2I, being ς a scalar constant. The details of the derivation of the
equations above are described in Appendix B.
3.1. Can we expect the requirements for deriving the FEP in living systems?
Toexplorethegeneralityoftheconditionsrequiredtoconnecttheaverage
flow of a system to the gradient of the free energy, here we explore Conditions
3 and Assumption 1 required to derive the first move of the FEP.
Condition 3: Markov blanket
First, theFEP requiresthe existence ofa Markov blanketimposing a con-
ditional independence between internal and external states given a blanket
state (Condition 3, [3, 4]). We will see that not all linear systems meet this
condition, although it can be considered as an approximation in the case of
very weak-couplings.
For systems represented by Gaussian distributions, the Markov blanket
condition (Condition 3) is only met when the inverse of the covariance, the
Hessian matrix H = (Σ∗) −1 , satisfies,
H = H = 0. (27)
yx xy
Thus this begs the questions: How common are Markov blankets? And
when can we expect to find them in living systems? The FEP generally
proposesthatthetheoryholdswhentheMarkovblanketconditionissatisfied
under a ‘canonical flow constraint’ [30] that is defined in our linear system
by f(z) = J structured as in Fig. 4.A. This means that, mechanistically,
z
∇
external and sensory states do not depend on internal states, and that action
andinternalstatesdonotdependonexternalstates. Thisisrepresentativeof
thekindofasymmetriesweexpectfromasensorimotorloopinlivingsystems.
However, even in linear systems, it is not easy to know under what conditions
a system can satisfy both the canonical flow constraint and possess a Markov
blanket. As [34] points out, neither one of these conditions is sufficient to
guarantee the other.
In the case of weak couplings where J = I+C, and homogenous noise
−
Γ = ς2I, the covariance of the system can be expanded as Eq. 26, and the
inversecovariance(Hessian)canbecomputedasaNeumannseries(Appendix
B),
ς−2 ς−2
H =(Σ∗) −1 = ς−2I (C+C (cid:124) )+ (C (cid:124) C CC (cid:124) )+ (C3). (28)
− 2 4 − O
21
A 'Canonical' loop
s
y x
a
B Circular loop
s
y x
a
C Symmetric loop
y s a x
Figure 4: Sensorimotor loop structures. The figure shows the ‘canonical’ or general
sensorimotorstructureproposedbytheFEP[30](A),acircularloopwhereallconnections
between elements are asymmetric and unidirectional (B) and a restricted sensorimotor
loop where all interactions between blocks of the system are symmetric, only allowing
asymmetric connections within blocks (B).
22
Under the couplings determined by Condition 1 we can see that for a
first order approximation H = 0+ (C2), satisfying the Markov blanket
yx
O
condition.
For a second order weak coupling approximation we have,
ς−2
H = (C C (cid:124) +C C (cid:124) )+ (C3). (29)
yx − 4 ys xs ya xa O
Under the canonical flow constraints, relatively few systems will display an
exact Markov blanket, except for combinations of parameters that happen
to cancel the terms in the equation above. One exception is systems with
weak couplings under circular loops (Fig. 4.B) or systems with two layers of
blanket states (e.g. the system in Fig. 4.C). Note that this is because cycles
generating conditional couplings between x,y are of order higher than 2. In
general, these cases will not display a Markov blanket for stronger couplings
(see Eq. B.15,B.16, except for perfectly symmetric couplings). Thus, we can
conclude that Markov blankets will emerge only for particular combinations
of parameters, as cycles in the system will in general introduce couplings
preventing their existence.
Assumption 1: solenoidal coupling
The FEP requires that the averaged marginal flow of external states y,
givenablanketstateb, dependsonlyonthegradientsofitsmarginaldensity.
For this, it is a requirement that there is no solenoidal coupling between
external and other states (Assumption 1). We will see in this section that
most linear systems will not meet this condition.
We can rewrite Eq. 25 to express the matrix of solenoidal couplings Q as
(see Appendix B.2 or [34])
(cid:124) (cid:124)
JQ+QJ = JΓ ΓJ . (30)
−
Again, the values of Q can be obtained by solving the corresponding
continuous Lyapunov equation. Assuming J = C I, this matrix can be
−
expressed as the power series
1 1
Q = (CΓ ΓC (cid:124) )+ C2Γ Γ(C2) (cid:124) + (C3). (31)
2 − 4 − O
(cid:0) (cid:1)
The first order approximation under weak coupling J = I + C and
−
Γ = ς2I and the canonical flow constraints (Condition 1, Fig. 4.A) results in
23
the solenoidal coupling matrix
C C(cid:124) C C(cid:124) C
ς2 C yy − C y (cid:124) y C ys − C s (cid:124) y C ya C(cid:124) C(cid:124)
Q = 2  sy C −(cid:124) ys C ss − C s (cid:124) s C sa − C a (cid:124) s C − x C s (cid:124) + O (C2). (32)
 − ya as C − sa C aa − C a (cid:124) a C ax − C x (cid:124) a 
 xs xa − ax xx − xx
 
Where Assumption 1 is not met for most parameter combinations.
In the best-case scenario, we can make many terms in the matrix above
disappear by making blocks symmetric when possible. This however does
not completely remove non-diagonal blocks, and leaves
C C(cid:124) C
ς2 yy − yy C C(cid:124) ya C(cid:124)
Q = 2  C(cid:124) ss − ss C C(cid:124) − xs + O (C2). (33)
 − ya C aa − aa C C(cid:124) 
 xs xx − xx
 
Thus we observe that, even in a very weakly coupled system, the only way of
setting Q Q and their antisymmetric counterparts to zero is to effectively
ya sx
decouple some parts of the sensorimotor loop completely that results in a
‘symmetric’ interaction loop with the form displayed in Fig. 4.C). In this
type of system, detailed balance is only broken by interactions inside blocks
y,s,a,x, as all couplings between blocks are symmetric. Therefore, the sys-
tem is driven out-of-equilibrium only by internal tendencies of these blocks,
not by their interactions between them. This precludes for example the ex-
istence of asymmetric agent-environment interactions, which may be crucial
for many living processes as a mechanism for generating qualitative differ-
ences between the inside and the outside of a system, as well as for regulating
exchanges of matter and energy with the environment [35, 37, 38, 39].
For a second order approximation, we find the solenoidal coupling terms
24
between external and autonomous states:
ς2
Q = 2C +C C +C C +C C C (cid:124) C (cid:124) + (C3), (34)
ya 4 ya yy ya ys sa ya aa − sy as O
ς2 (cid:0) (cid:1)
Q = C C C (cid:124) C (cid:124) + (C3), (35)
yx 4 ya ax − sy xs O
ς2 (cid:0) (cid:1)
(cid:124)
Q = 2(C C )+C C +C C +C C
sa 4 sa − sa sy ya ss sa sa aa
(cid:16) C (cid:124) C (cid:124) C (cid:124) C (cid:124) C (cid:124) C (cid:124) + (C3), (36)
− ss as − as aa − xs ax O
ς2 (cid:17)
Q = ( 2C (cid:124) +C C C (cid:124) C (cid:124) C (cid:124) C (cid:124) C (cid:124) C (cid:124) )+ (C3). (37)
sx 4 − xs sa ax − ss xs − as xa − xs xx O
We can see thatthis matrix will ingeneral only be blockdiagonal in veryspe-
cific cases, exemplifying how the presence of higher-order terms complicates
the uncoupling of solenoidal terms.
These results show how, in the case of linear, weakly-coupled systems,
the assumptions about the statistical structure of a system required by the
FEP is restricted to a very narrow space of parameters (i.e. values of C).
In particular, removing solenoidal couplings between blocks of the system
requires a highly symmetric coupling structure (Fig. 4.C). This prevents the
application of the theory to many common structures found in biological
systems.
3.2. Can the FEP explain and describe the behaviour of living systems?
Above, we have shown that the conditions for connecting the conditional
average flow with the gradient of the free energy functional only hold for a
verynarrowclassofsystems. Nowweexplore, inthecaseswheretheprevious
requirements are met, the connection between the conditional average flow
and the behaviour of the most likely states of the system. That is, are
the results of the FEP able to describe, explain or predict the dynamics of
the systems that conform to its assumptions? Here we will see that, while
Assumption 2 follows from a broad class of linear systems, one of the major
findings of our study is that Assumptions 3∗ and 3∗∗ present important issues
that prevent the results of the FEP to be good descriptions of the behaviour
of stochastic dynamical systems
Assumption 2: Mapping between internal and external statistics
A further requirement of the FEP is that a mapping σ exists between in-
ternaland external states(Assumption2). Wewillsee thatinlinear systems,
25
at least, there are many systems that meet this condition.
Given a NESS well characterized by Gaussian distributions over states
p(z ) = (ρ,Σ∗), the conditional distributions given a particular blanket
t
N
state b = s,a results in the most likely states (Eq. 13 and 14) being
{ }
described as
m (b ) =ρ +Σ∗ (Σ∗ )g(b ρ ), (38)
x t x xb bb t − b
m (b ) =ρ +Σ∗ (Σ∗ )g(b ρ ), (39)
y t y yb bb t − b
where(Σ∗ )g isageneralizedinversematrix(whichisequivalenttotheinverse
bb
for nonsingular matrices). If Σ∗ and Σ∗ are nonsingular (this implies that
xb bb
n n ), we can derive the linear mapping,
x b
≥
m (b ) =ρ +Σ∗ (Σ∗ ) −1 (m (b ) ρ ) σ(m (b )), (40)
y t y yb xb x t − x ≡ x t
which is invertible if Σ∗ is non-singular (for this n n is required)
yb y ≥ b
m (b ) =m +Σ∗ Σ∗ −1 m (b ) ρ σ−1(m (b )). (41)
x t x xb yb y t − y ≡ y t
(cid:0) (cid:1) (cid:0) (cid:1)
Yielding the evolution of the most likely states as,
dm (b ) dm (b ) dm (b )
x t = σ−1(m (b )) y t = Σ∗ Σ∗ −1 y t . (42)
dt ∇ my y t dt xb yb dt
(cid:0) (cid:1)
This shows that, in general, a mapping between the most likely internal
and external states exists if the corresponding covariance submatrices are
invertible.
The FEP often states that the existence of this mapping is a consequence
of a Markov blanket [4], but we note that the existence of such a mapping is
independentofConditions1and3. TheexistenceofaMarkovblanketimplies
a conditional covariance Σ (b ) = 0, but this does not affect the relation
yx t
between internal and external states. Thus, in linear systems any variable
can potentially mediate an invertible mapping, independently of a Markov
blanket, if the corresponding covariance submatrices are nonsingular5.
5At the moment of writing this manuscript, we have found that a similar result has
been found independently in unpublished work [49].
26
Assumption 3∗: The dynamics and Bayesian inference
The final assumption for deriving the FEP is that the evolution of the
most likely external states is linked with the evolution of the marginal flow
conditioned on blanket states b . In this section, we see that this assumption
t
does not hold in general.
The time derivative of m (b ) yields,
y t
dm (b ) db
y t =Σ∗ (Σ∗ )g t = Σ∗ (Σ∗ )g(J (z ρ)+ω ). (43)
dt yb bb dt yb bb bz t − b,t
Conversely, the equation proposed by the FEP uses the marginal flow
(Assumption 3∗, see [4] or Appendix B in [3]). We represent the dynamics of
a variable driven by this marginal flow as
dm (b )
y t f (y ,b ) = (Q Γ ) J(z )
dt ≡(cid:104) y t t (cid:105)bt yz − yz (cid:104)∇ z t (cid:105)bt
(cid:101) =J yy (m y (b t ) − ρ y )+J yb (b t − ρ b ), (44)
where m (b ) captures the evolution of the most likely dynamics in a system
y t
behaving in a way that strictly minimizes the free energy. The difference
between the behaviour of m (b ) and m (b ) allows us to evaluate how in-
(cid:101) y t y t
formative is the FEP about the behaviour of a system. If a system approx-
imately follows a free energy gradient, the behaviour of these two variables
(cid:101)
willpresentsomesimilaritiesintheirevolution. Thisapproximationiscrucial
for the FEP as it is this marginal flow that is connected with the gradient of
the free energy (therefore equating dynamics and inference, see Assumption
3∗). By using Eq. 39 this expression can be rewritten simply as,
dm (b )
y t = J Σ∗ (Σ∗ )g +J (b ρ ). (45)
dt yy yb bb yb t − b
We can thus see th(cid:101)at these tw(cid:0)o equations represe(cid:1)nt quite different quantities
and that, in general, Assumption 3∗ will not hold for linear systems.
Furthermore, we can show that this equivalence is also incorrect even in
the case of weak couplings. Specifically, for the first order weak coupling
approximation with J = I+C and Γ = ς2I. Assuming Σ∗ is nonsingular
(i.e. (Σ∗ )g = (Σ∗ ) −1 ), th − e weak coupling expansion of its in bb verse according
bb bb
to the Neumann series (other expansions exist in the case of generalized
inverses [50]) is,
1
(Σ∗ ) −1 =ς−2(I (C +C (cid:124) ))+ (C2). (46)
bb − 2 bb bb O
27
A B
×
10− 6
5
0.02
my
0.00
my
0
5
0.02 −
−
0 × 10− 16 10 2 t 0 30 0 × 10− 5 10 2 t 0 30
2.5 2
my 0.0 my 0
e − 2.5 e − 2
0 10 20 30 0 10 20 30
t t
Figure 5: Divergence between system evolution and the marginal flow. Compar-
isonbetweenthetrueevolutionofthesystemm (b )versusthemarginalflowm (b )for
y t y t
(A) ς =0.1 and random couplings C = 0.1 with the connection scheme from Fig. 4.C
ij
±
and (B) ς = 10−3 and random couplings C
ij
= 0.1 with the connection sch(cid:101)eme from
±
Fig. 4.B but with C = 0. In both cases n = n = 2,n = n = 1. Note that different
yb y x a s
parameters (e.g. reducing the noise) yield qualitatively similar results.
Using the weak-coupling approximation of Σ∗ (Eq. 26), Eq. 43 results in
dm (b ) 1 1
y t = (C +C (cid:124) )(I (C +C (cid:124) )) ( I +C )(z ρ)
dt 2 yb by − 2 bb bb − bz bz t −
+ω + (C2) (cid:0)
b,t
O
1
= (C(cid:1) +C (cid:124) )(b ρ ω )+ (C2). (47)
− 2 yb by t − b − b,t O
In contrast, the marginal flow in Eq. 44 results in
dm (b ) 1 1
y t = ( I +C ) (C +C (cid:124) )(I (C +C (cid:124) ))
dt − yy yy 2 yb by − 2 bb bb
(cid:16)
(cid:101) +C (b ρ )+ (C2)
yb t − b O
1 (cid:17)
= ( C +C (cid:124) )(b ρ )+ (C2), (48)
− 2 − yb by t − b O
which not only ignores the random fluctuations term, but also reverses the
(cid:124)
sign of the term C . Note that C = C when we force solenoidal uncou-
yb yb by
pling (Assumption 1, see Section 3.1), making dm (cid:101)y(bt) = 0 in that case (while
dt
dmy(bt)
is non-zero).
dt
28
For this weak coupling approximation, the only case in which the approx-
imation is valid is one in which ς = 0 (a deterministic system) and C = 0
yb
(a system where the agent just observes the environment without affecting
it). Similar expressions could be derived for higher order approximations.
As an example of the dissimilarity of these quantities, in Fig. 5.A we
display m (b ) and m (b ) for arbitrary parameters structured as the senso-
y t y t
rimotor loop described in Fig. 4.C with random couplings C = 0.1 (note
ij
±
that some weights are set to zero and others forced to be symmetric) and
(cid:101)
n = n = 2,n = n = 1,ς = 0.1. We see that m (b ) cannot capture the
y x a s y t
structure in m (b ). The reason behind this is that the derivative of m (b )
y t y t
accumulates an error from fluctuations in the system that are not captured,
(cid:101)
displayingarandomwalkbehaviourthatisabsentintherealvariablem (b )
(cid:101) y t
. Similarly, in the most favourable case, setting a very small noise ς = 10−3
and C = 0 (Figure 5.B), the situation is similar, as even very small noise
yb
terms are sufficient for driving the two terms apart due to the integration of
random fluctuations over time.
Assumption3∗∗: Awayout? ProblemswithinterpretingbehaviourasBayesian
inference only ‘on average’
The results of the previous section suggest that the FEP could be, in
practice, inapplicable for describing or explaining the behaviour of living
systems. Some of the most recent works on the FEP [30] try to avoid the
problems described above and state that the free energy principle describes
just marginal flows, that is, it describes the behaviour of a system just on
average over different trajectories. This could appear to circumvent some
issues presented in the previous section, as it implies substituting Assump-
tion 3∗ by a more relaxed interpretation of a gradient descent on the free
energy described by Assumption 3∗∗. However, under a close inspection, we
encounter that the situation is not improved by this claim. Assumption 3∗∗
entails two problems: 1) the mapping described by Assumption 2 no longer
connects internal and external flows, and 2) the conditional average flow fol-
lowing the gradient of the free energy does not guarantee a gradient descent
in the effective behaviour. While the first problem can be solved, the second
has deep implications as in most cases the average flow does not describe
the true behaviour of a system in the presence of stochastic fluctuations,
therefore threatening to render the FEP inapplicable to describe most living
systems. In this last section, we briefly explore the validity of the theory
when applied only to the average flows of a system (and not the evolution of
29
the most likely states).
A first, practical problem implied by this claim is that if the FEP only
applies to marginal flows f (y ,b ) , f (b ,x ) , then a new mapping
(cid:104) y t t (cid:105)bt (cid:104) x t t (cid:105)bt
between flows is required. As we described in Eq. 21, a mapping between
the dynamics of the most likely states is derived from the chain rule as the
gradient of the mapping σ. If instead one interprets the FEP as connecting
the conditional average flow of external and internal states a new mapping
is required:
f (y ,b ) = φ( f (b ,x ) ). (49)
(cid:104) y t t (cid:105)bt (cid:104) x t t (cid:105)bt
In general, this mapping can take complicated forms, and often a unique
mapping will not exist. In linear systems, however, we can simplify the
marginal flows
f (y ,b ) =J (m (b ) ρ )+J (b ρ )
(cid:104) y t t (cid:105)bt yy y t − y yb t − b
= J +(Σ∗ (Σ∗ )g)−1 (m (b ) ρ )
yy yb bb y t − y
= J +(Σ∗ (Σ∗ )g)−1 Σ∗ (Σ∗ ) −1 (m (b ) ρ ), (50)
(cid:0) yy yb bb (cid:1) yb xb x t − x
f (b ,x ) =J (m (b ) ρ )+J (b ρ )
(cid:104) x t t (cid:105)bt (cid:0)xx x t − x (cid:1)xb t − b
= J +(Σ∗ (Σ∗ )g)−1 (m (b ) ρ ). (51)
xx xb bb x t − x
Which, if Σ∗ is inv (cid:0) ertible, yields (cid:1)
bb
f (y ,b ) = J +Σ∗ (Σ∗ )−1 Σ∗ (Σ∗ ) −1
(cid:104) y t t (cid:105)bt yy bb yb yb xb
(cid:0) J +Σ∗ (Σ∗ )− (cid:1) 1 −1 f (b ,x )
· xx bb xb (cid:104) x t t (cid:105)bt
φ( f (b ,x ) ), (52)
≡ (cid:0) (cid:104) x t t (cid:105)bt (cid:1)
that results in the mapping φ being very different from σ. Thus, in
∇
mx
general,
f (y ,b ) = σ f (b ,x ) , (53)
(cid:104) y t t (cid:105)bt (cid:54) ∇ mx (cid:104) x t t (cid:105)bt
thus contradicting [3, 4]. Thus, an interpretation of the FEP over condi-
tional average flows should replace Assumption 2 with a new mapping. This
result, in combination with a block-diagonal Q (Assumption 1) allows rewrit-
ing f (y ,b ) and f (x ,b ) pointing in the direction of free energy
(cid:104) y t t (cid:105)bt (cid:104) x t t (cid:105)bt
minimization, mediated by a mapping φ.
30
However, there is an important conceptual problem that remains even if
a new mapping is derived. The FEP relies on finding a variable that behaves
as a gradient descent on the free energy functional as described in Eq. 12.
If Assumption 3∗ is not met, then there is no variable in the system that
behaves following a gradient descent on the free energy (i.e. a variable θ
t
with behaviour determined by dθt = γ F(θ ,b )). In this case, this
dt − ∇ θ t t
assumption could be relaxed to Assumption 3∗∗ but, as we observed in the
results and simulations above, even when the average flow of the system is
related with the free energy (i.e. dθt = γ F(θ ,b )) this is not a
dt bt − ∇ θ t t
good description of the behaviour of a system.
(cid:10) (cid:11)
Inthiscase, theclaimoftheFEP,ifallotherassumptionsarehold, canbe
describedbyEq.17,whichrelaxestherequirementofastrictgradientdescent
(described by Eq. 20) and requires instead that the conditional average flow
is directed in the direction of the gradient of the free energy. The problem
with this relaxed gradient descent interpretation is that it does not guarantee
that a system effectively performs a gradient descent, not even on average.
In Appendix C we illustrate this issue in a simple bivariate linear stochastic
model with variables y,b. We observe that this particular model presents a
global attractor located at y = b = 0 with solenoidal flows in the form of
a spiral flow (Fig. C.2.A). In contrast, the conditional average flow suggests
a monotonic gradient ascent on m2(b), dismissing solenoidal flows in the
y
system and transforming an attracting flow into a repelling one. This is a
simple example showing how, in general, the conditional average flows do not
describe the behaviour of the system. Moreover, conditional average flows
can be misleading and not even a good approximation about the average
behaviour of a system, indicating a gradient ascent/descent on some quantity
when the behaviour of the system performs the opposite action. This is also
exemplified in recent work simulating linear systems, where the free energy
gradient only captures attracting tendencies at highly surprising states, not
capturing solenoidal flows nor behaviour near the NESS global attractor [49,
43].
To summarize, our results show that, in general, even if a relaxed version
of the assumptions of the FEP holds, a system cannot be interpreted as if
performing Bayesian inference over external states. The reason behind this
is that the average flows f (y ,b ) and f (b ,x ) do not describe the
(cid:104) y t t (cid:105)bt (cid:104) x t t (cid:105)bt
behaviour of the system, as it can be easily seen from the results in Fig. 5.
Intuitively, substituting the true flow – f (y ,b ) – by an average flow fixing
y t t
the blanket state – f (y ,b ) –decouples the trajectory of y from its pre-
(cid:104) y t t (cid:105)bt
31
vious state, which in most dynamical systems will result in an impoverished
description, not capturing its real, history-dependent, behaviour.
4. Conclusion
The latest formulation of the free energy principle [3, 4] states that, in
any dynamical system equipped with a Markov blanket, the flow of internal
states can be construed as a gradient ascent on Bayesian model evidence.
This assumption rests on two crucial moves. The first move connects the
system’s average flow with a gradient on a variational free energy. This
connection relies on the existence of a Markov blanket and the emergence of
a particular statistical structure precluding solenoidal couplings. The second
is the interpretation that this relation between free energy and an average
flow results in systems behaving as if performing variational inference over
the states of its environment. In this review, we have summarized crucial
steps required for this claim (Conditions 1–3 and Assumptions 1–3∗) and
have shown that several of these conditions cannot be met in general by
linear, weakly-coupled stochastic systems.
The first step compels a discussion about the generality of the FEP. That
is, if the principle requires a particular statistical structure, how general is
this structure, and how broadly can we expect it to be present among the
class of systems capturing the properties of living and cognitive processes?
We discover that, in the class of linear systems explored, the answer to this
question is that the statistical structure required by the FEP only arises in
a very narrow class of systems, requiring stringent conditions such as fully
symmetric agent-environment interactions that we cannot, in general, expect
from living systems [35, 37, 38, 39]. The generality of the FEP has been ques-
tioned in the past due to conceptual issues [51, 33] or the existence of coun-
terexamples challenging the idea that perception-action interfaces, Markov
blankets and solenoidal decoupling follow from each other [34]. However, to
our knowledge, our study is the first that shows that the assumptions of the
FEP do not hold for a vast class of systems, namely, linear, weakly coupled
systems, except for the limited case of fully symmetric agent-environment
interaction.
This is concerning for two reasons. First, the FEP is designed for Gaus-
sian (i.e. in most cases linear) stochastic systems [4, 34]. Thus, our results
would imply that, as currently defined, the FEP cannot be fully implemented
inabroadsetofsystemsfromtheclassitwasdesignedfor. Second, onecould
32
hope that the introduction of strong couplings or non-linearity allows some
specificsystemstomeettherequiredconditions. Somerecentapproximations
of the behaviour of chaotic oscillators point in this direction [42]. However,
this claim should be regarded with some scepticism, as the introduction of
stronger or higher-order couplings would result in additional terms in the
expansions explored in this article (see Appendix B). For most parameter
settings, systems with stronger couplings will not result in the independence
relations required for Condition 3 and Assumption 1. This will lead, in gen-
eral, to a more significant divergence between the evolution of the system
and its average flow, making it more unlikely that Assumptions 3∗ or 3∗∗ will
hold. We leave it to future work to explore the accuracy of this claim and
investigate whether the assumptions of the FEP can be met beyond the class
of systems explored here, e.g. displaying strong or nonlinear couplings.
The second step concerns how informative the FEP is about the be-
haviour of an agent. The FEP justifies that any system can be described
as if performing variational inference through the existence of a conditional
synchronization manifold relating the direction of the free energy gradient
and the evolution of the most likely states of a system. We observe that
this manifold can exist in a broad class of systems. Nevertheless, assuming
a strict gradient descent interpretation (Assumption 3∗), it is problematic to
connect the evolution of the most likely states to the average flow of a system
(and, in consequence, to assume a system will behave as if minimizing the
variational free energy). The problem lies in implicitly relating the rate of
change of the average (expected) state as being described by the average flow
(the expectation of the rate of change) conditioned on a blanket state. If,
instead, we consider a more relaxed interpretation of the free energy gradi-
ent descent (i.e. just taking place on average, Assumption 3∗∗), we encounter
that new problems arise. First, a new mapping between the flows of internal
and external states is required. Second, we observe that the average flow
cannot, in general, describe the true behaviour of a system. In sum, the FEP
as it stands does not do justice to the influence of the system’s trajectory in
determining its future behaviour. The reason behind this is that the gradient
of the free energy defined by the principle is computed for the average of an
ensemble of trajectories. Thus, even when the free energy gradient can be
connected with an average flow (which, as we have shown, happens under
very specific conditions), this is mainly uninformative about the behaviour
of a system subject to stochastic interactions. This is especially relevant for
emergent discussions about the compatibility of the FEP with enactive and
33
autopoietic theories of cognition (e.g. [52, 53, 54]). Specifically, enactive
principles stress the history-dependence of living systems, and this supposes
a fundamental incompatibility with the assumptions of the FEP [55]. In
particular, enactive views of cognition conceive sense-making as a process
emerging from the history of interactions of a system, which is invisible for
a gradient of the free energy described as an average flow.
The motivation behind the FEP aims to connect ideas from variational
inference with the dynamics of complex, self-organizing systems. This claim
is exceptionally appealing, as it could potentially allow applying the machin-
ery from Bayesian and information theoretical approaches to describe many
systems that are intractable in practice. However, by inspecting the theory
and its assumptions in the context of a broad class of analytically tractable
models, we discover that many of the steps required to derive the theory
do not straightforwardly follow or present significant conceptual problems
that need to be resolved. This finding illustrates the difficulties in develop-
ing a theory of life and cognition over interdependent sets of mathematical
assumptions, and how testing these assumptions and their relations against
tractable models can help overcome these difficulties.
Acknowledgements
We are grateful to Karl Friston, Lancelot Da Costa, Thomas Parr, In˜igo
Arandia-Romero and Hideaki Shimazaki for their constructive feedback and
comments on this manuscript. M.A. is thankful to Martin Biehl for helpful
discussionsaboutreferences[3,4,30]. WearealsogratefultoManuelBaltieri
for his open peer-review of a preprint of this manuscript.
M.A. was funded by the European Union’s Horizon 2020 research and in-
novation programme under a Marie Sk(cid:32)lodowska-Curie Action (grant agree-
ment 892715) and supported in part by the Basque Government project
IT 1228-19andtheSpanishMinistryofScienceandInnovationprojectPID2019-
104576GB-I00. C.L.B. is supported by BBRSC grant BB/P022197/1.
References
[1] K. Friston, P. Ao, Free energy, value, and attractors, Computational
and mathematical methods in medicine 2012 (2012).
[2] K. Friston, Life as we know it, Journal of the Royal Society Interface
10 (86) (2013) 20130475.
34
[3] K. Friston, A free energy principle for a particular physics, arXiv
preprint arXiv:1906.10184 (2019).
[4] T. Parr, L. Da Costa, K. Friston, Markov blankets, information geom-
etry and stochastic thermodynamics, Philosophical Transactions of the
Royal Society A 378 (2164) (2020) 20190159.
[5] J. Hohwy, The self-evidencing brain, Nous 50 (2) (2016) 259–285.
[6] A. Clark, Surfing uncertainty: Prediction, action, and the embodied
mind, Oxford University Press, 2015.
[7] K. Friston, The free-energy principle: a rough guide to the brain?,
Trends in cognitive sciences 13 (7) (2009) 293–301.
[8] K. Friston, J. Daunizeau, J. Kilner, S. J. Kiebel, Action and behavior: a
free-energy formulation, Biological cybernetics 102 (3) (2010) 227–260.
[9] K. Friston, The free-energy principle: a unified brain theory?, Nature
reviews neuroscience 11 (2) (2010) 127–138.
[10] K. Friston, J. Mattout, N. Trujillo-Barreto, J. Ashburner, W. Penny,
Variational free energy and the laplace approximation, Neuroimage
34 (1) (2007) 220–234.
[11] K. Friston, A theory of cortical responses, Philosophical transactions of
the Royal Society B: Biological sciences 360 (1456) (2005) 815–836.
[12] C. L. Buckley, C. S. Kim, S. McGregor, A. K. Seth, The free energy
principle for action and perception: A mathematical review, Journal of
Mathematical Psychology 81 (2017) 55–79.
[13] B. Millidge, A. Seth, C. L. Buckley, Predictive coding: a theoretical and
experimental review, arXiv preprint arXiv:2107.12979 (2021).
[14] K.Friston,F.Rigoli,D.Ognibene,C.Mathys,T.Fitzgerald,G.Pezzulo,
Activeinferenceandepistemicvalue,Cognitiveneuroscience6(4)(2015)
187–214.
[15] K. Friston, J. Daunizeau, S. J. Kiebel, Reinforcement learning or active
inference?, PloS one 4 (7) (2009) e6421.
35
[16] K. Friston, T. FitzGerald, F. Rigoli, P. Schwartenbeck, G. Pezzulo, Ac-
tive inference: a process theory, Neural computation 29 (1) (2017) 1–49.
[17] M. Cullen, B. Davey, K. Friston, R. J. Moran, Active inference in ope-
nai gym: A paradigm for computational investigations into psychiatric
illness, Biological psychiatry: cognitive neuroscience and neuroimaging
3 (9) (2018) 809–818.
[18] B. Millidge, A. Tschantz, C. L. Buckley, Predictive coding approx-
imates backprop along arbitrary computation graphs, arXiv preprint
arXiv:2006.04182 (2020).
[19] J. Hohwy, A. Roepstorff, K. Friston, Predictive coding explains binocu-
larrivalry: Anepistemologicalreview,Cognition108(3)(2008)687–701.
[20] R.Kanai, Y.Komura, S.Shipp, K.Friston, Cerebralhierarchies: predic-
tive processing, precision and the pulvinar, Philosophical Transactions
of the Royal Society B: Biological Sciences 370 (1668) (2015) 20140169.
[21] A. Tschantz, B. Millidge, A. K. Seth, C. L. Buckley, Reinforce-
ment learning through active inference, arXiv preprint arXiv:2002.12636
(2020).
[22] L. Da Costa, T. Parr, N. Sajid, S. Veselic, V. Neacsu, K. Friston, Active
inference on discrete state-spaces: a synthesis, Journal of Mathematical
Psychology 99 (2020) 102447.
[23] B. Millidge, Deep active inference as variational policy gradients, Jour-
nal of Mathematical Psychology 96 (2020) 102348.
[24] T. H. FitzGerald, P. Schwartenbeck, M. Moutoussis, R. J. Dolan,
K. Friston, Active inference, evidence accumulation, and the urn task,
Neural computation 27 (2) (2015) 306–328.
[25] T.Parr, D.Markovic, S.J.Kiebel, K.Friston, Neuronalmessagepassing
using mean-field, bethe, and marginal approximations, Scientific reports
9 (1) (2019) 1–18.
[26] D. Kappel, C. Tetzlaff, A synapse-centric account of the free energy
principle, arXiv preprint arXiv:2103.12649 (2021).
36
[27] A. Tschantz, A. K. Seth, C. L. Buckley, Learning action-oriented mod-
els through active inference, PLoS computational biology 16 (4) (2020)
e1007805.
[28] P. Calvo, K. Friston, Predicting green: really radical (plant) predic-
tive processing, Journal of the Royal Society Interface 14 (131) (2017)
20170096.
[29] K. Friston, J. Kilner, L. Harrison, A free energy principle for the brain,
Journal of physiology-Paris 100 (1-3) (2006) 70–87.
[30] K. Friston, L. Da Costa, T. Parr, Some interesting observations on the
free energy principle, Entropy 23 (8) (2021) 1076.
[31] J.Pearl, Probabilisticreasoninginintelligentsystems: networksofplau-
sible inference, Elsevier, 1988.
[32] T. S. Richardson, P. Spirtes, et al., Automated discovery of linear feed-
back models, Carnegie Mellon, 1996.
[33] J. Bruineberg, K. Dolega, J. Dewhurst, M. Baltieri, The emperor’s new
markov blankets, Behavioral and Brain Sciences (2021) 1–63.
[34] M. Biehl, F. A. Pollock, R. Kanai, A technical critique of some parts of
the free energy principle, Entropy 23 (3) (2021) 293.
[35] J. E. Rothman, J. Lenard, Membrane asymmetry, Science 195 (4280)
(1977) 743–753.
[36] G. Buzsaki, Rhythms of the Brain, Oxford University Press, 2006.
[37] B. Fadeel, D. Xue, The ins and outs of phospholipid asymmetry in
the plasma membrane: roles in health and disease, Critical reviews in
biochemistry and molecular biology 44 (5) (2009) 264–277.
[38] X. E. Barandiaran, E. Di Paolo, M. Rohde, Defining agency: Individual-
ity, normativity, asymmetry, and spatio-temporality in action, Adaptive
Behavior 17 (5) (2009) 367–386.
[39] K. Ruiz-Mirazo, A. Moreno, Basic autonomy as a fundamental step in
the synthesis of life, Artificial life 10 (3) (2004) 235–259.
37
[40] C. Kwon, P. Ao, Nonequilibrium steady state of a stochastic system
drivenbyanonlineardriftforce,PhysicalReviewE84(6)(2011)061106.
[41] R.Yuan, Y.Tang, P.Ao, Sdedecompositionanda-typestochasticinter-
pretation in nonequilibrium processes, Frontiers of Physics 12 (6) (2017)
1–9.
[42] K. Friston, C. Heins, K. Ueltzho¨ffer, L. Da Costa, T. Parr, Stochastic
chaos and markov blankets, Entropy 23 (9) (2021) 1220.
[43] T. Parr, L. Da Costa, C. Heins, M. J. D. Ramstead, K. Friston, Memory
and markov blankets, Entropy 23 (9) (2021) 1105.
[44] N. Reid, Approximate likelihoods, Proceedings of the ICIAM (2015).
[45] C. S. Kim, Recognition dynamics in the brain under the free energy
principle, Neural computation 30 (10) (2018) 2616–2659.
[46] L. Da Costa, T. Parr, B. Sengupta, K. Friston, Neural dynamics under
active inference: Plausibility and efficiency of information processing,
Entropy 23 (4) (2021) 454.
[47] P. Vatiwutipong, N. Phewchean, Alternative way to derive the distribu-
tion of the multivariate ornstein–uhlenbeck process, Advances in Differ-
ence Equations 2019 (1) (2019) 1–7.
[48] C. Godr`eche, J.-M. Luck, Characterising the nonequilibrium stationary
states of ornstein–uhlenbeck processes, Journal of Physics A: Mathe-
matical and Theoretical 52 (3) (2018) 035002.
[49] L. Da Costa, K. Friston, C. Heins, G. A. Pavliotis, Bayesian mechanics
for stationary processes, arXiv preprint arXiv:2106.13830 (2021).
[50] J.J.Climent, N.Thome, Y.Wei, A geometrical approach ongeneralized
inverses by neumann-type series, Linear algebra and its applications 332
(2001) 533–540.
[51] V.Raja, D.Valluri, E.Baggs, A.Chemero, M.L.Anderson, Themarkov
blanket trick: On the scope of the free energy principle and active in-
ference, Physics of Life Reviews (2021).
38
[52] J. Bruineberg, J. Kiverstein, E. Rietveld, The anticipating brain is not a
scientist: the free-energy principle from an ecological-enactive perspec-
tive, Synthese 195 (6) (2018) 2417–2444.
[53] A. Constant, A. Clark, K. J. Friston, Representation wars: Enacting
an armistice through active inference, Frontiers in Psychology 11 (2021)
3798.
[54] M. J. Ramstead, M. D. Kirchhoff, A. Constant, K. J. Friston, Multi-
scale integration: beyond internalism and externalism, Synthese 198 (1)
(2021) 41–70.
[55] E. Di Paolo, E. Thompson, R. D. Beer, Laying down a forking
path: Incompatibilities between enaction and the free energy principle,
PsyArXiv (2021).
39
Appendix A. Mathematical definitions of main concepts of the
free energy principle
Perception-action partition. The FEP assumes that the system can
bedecomposedintoexternal,sensory,activeandinternalstates,z = y,s,a,x ,
{ }
configured as a perception-action loop reflecting an interface mediating be-
tween‘autonomous’states(activeandinternalstates a,x )and‘non-autonomous’
{ }
states (external and sensory states y,s ). This leads to describing the evo-
{ }
lution of the system as
dz
t =f(z )+ω , (A.1)
t t
dt
f (y ,s ,a )
y t t t
f (y ,s ,a )
f(z ) = s t t t . (A.2)
t f (s ,a ,x )
a t t t
f (s ,a ,x )
x t t t
 
 
NESS and solenoidal flows. The FEP assumes that the system will
reach a non-equilibrium steady state described by the probability density
function p(z ), which can be described using a SDE decomposition that sep-
t
arates the flow into dissipative ( Γ J(z )) and solenoidal (Q J(z )) com-
z t z t
− ∇ ∇
ponents
f(z ) =(Q Γ) J(z ), (A.3)
t z t
− ∇
J(z ) = logp(z ), (A.4)
t t
−
The FEP makes some requirements about the solenoidal flow matrix Q, as it
assumes it is state-independent (i.e. Q does not change with z) and that it
is sparse in the sense that couplings between some states (e.g. internal and
external) are zero (see 1).
Markov blanket. The steady state distribution of the system is de-
scribed in terms of a Markov blanket, where internal/external states are
independent when conditioned on its blanket states.
p(y ,x b ) = p(y b )p(x b ). (A.5)
t t t t t t t
| | |
Conditional synchronisation manifold. The FEP assumes that there
is a smooth and differentiable function, σ, which maps between the most
likely internal and external states given a blanket state,
m (b ) = σ(m (b )), (A.6)
y t x t
40
and the gradient σ(m ) is invertible (i.e. ( σ(m ))−1 exists). The
∇
mx x
∇
mx x
FEP generally refers to this mapping as a conditional synchronisation man-
ifold, and proposes that its existence allows to characterise the relationship
between(maximumaposteriori)internalandexternalstatesintermsofinter-
nal states ‘sensing’ or ‘tracking’ external states through the Markov blanket
[3].
Rate of change of the average. By virtue of the conditional synchro-
nisation manifold, the rate of change of the average internal and external
states of the system are connected by the gradients of the mapping function.
dm (b ) dm (b )
m (b ) = σ(m (b )) y t = σ x t . (A.7)
y t x t
⇒ dt ∇
mx
dt
Variational free energy. A system performing Bayesian inference tries
to minimize the surprise of observed states ( logp(b)), according to an
−
internal model. However, a system cannot access this surprise value without
completeknowledgeofitsenvironment, Bayesianinferenceprescribestousea
lower bound of this surprise described by the variational free energy F(θ,b):
logp(b) < F(θ,b) = logp(b)+D (q(y θ) p(y b)), (A.8)
KL
− − | || |
whichiscomposedofthesurpriseplusatermcapturingthedistancefromthe
probability of external states given the blanket p(y b) to an internal model
|
of the world q(y θ) parametrized by θ.
|
Average flow and the free energy gradient. The FEP proposes that
the evolution of internal and external states of a system can be described,
under a Gaussian approximation, as a gradient of the free energy of the
system respect to its sufficient statistics.
f (y ,b ) =(Q Γ ) J(z )
(cid:104) y t t (cid:105)bt yy − yy (cid:104)∇ y t (cid:105)bt
(Q Γ ) F(θ,b). (A.9)
≈
yy
−
yy
∇
my
Then, the conditional synchronization manifold is proposed to connect the
internal and external average flows (i.e. the gradients and ), sug-
∇
my
∇
mx
gesting that internal states are behaving as if trying to perform Bayesian
inference over external states.
Appendix B. Solution of the linear Langevin dynamics.
We start with the Ornstein-Uhlenbeck process
dz = J(z ρ)dt+dw , (B.1)
t t t
−
41
which can be approximated by the equivalent Langevin dynamics
dz
t = J(z ρ)+ω , (B.2)
t t
dt −
whereJisann ninvertiblerealmatrix,ρisanndimensionalrealvector,w
t
×
is a standard n-dimensional Wiener process, ω is a standard n-dimensional
t
Gaussian white noise with covariance matrix 2Γ.
The model can be solved using standard methods for systems of differen-
tial equations
dz
e−Jt t e−JtJ(z ρ) =e−Jtω , (B.3)
t t
dt − −
d
(e−Jt(z ρ)) =e−Jtω , (B.4)
t t
dt −
t
z =eJt(z ρ)+ρ+ dt(cid:48)e−J(t(cid:48)−t)ω . (B.5)
t 0 t(cid:48)
−
(cid:90)0
This solution of the system [47, 48] yields statistical moments
m = dωp(ω)z
t t
(cid:90)
=eJtz +(I eJt)ρ, (B.6)
0
−
(cid:124)
Σ = dωp(ω)(z m )(z m )
t t t t t
− −
(cid:90)
t t
= dωp(ω) dt(cid:48) dt(cid:48)(cid:48)eJ(t−t(cid:48))ω ω (cid:124) eJ(cid:124)(t−t(cid:48)(cid:48))
t(cid:48) t(cid:48)(cid:48)
(cid:90) (cid:90)0 (cid:90)0
t
=2
dt(cid:48)e−J(t(cid:48)−t)Γe−J(cid:124)(t(cid:48)−t).
(B.7)
(cid:90)0
These equations are hard to solve analytically. However, we can find the
differential equations that result in equivalent integrals, obtaining the time
evolution of statistical moments
dm
t =eJtJ(z ρ) = J(m ρ), (B.8)
0 t
dt − −
dΣ
zz,t =2Γ+Σ J (cid:124) +JΣ . (B.9)
zz,t zz,t
dt
42
At equilibrium or at the NESS, when the solution is unique, the system
stabilizes to the values that make the derivatives equal to zero
lim m =ρ, (B.10)
t
t→∞
lim Σ =Σ∗, JΣ∗ +Σ∗J (cid:124) +2Γ = 0. (B.11)
zz,t
t→∞
where Σ∗ can be found numerically solving the above continuous Lyapunov
equation (a particular case of a Sylvester equation). If J is symmetric, the
steady state of the system is a state of equilibrium with Σ∗ = J−1Γ. How-
−
ever, the FEP focuses instead on NESS, which are more appropriate for
describing living systems.
Appendix B.1. Weak coupling approximation
In order to study the solution at the NESS, we assume weak couplings of
the form J = I+C, with C2 being small. We derive
−
2Γ = JΣ∗ Σ∗J (cid:124) = 2Σ∗ CΣ∗ Σ∗C (cid:124) , (B.12)
− − − −
1
Σ∗ =Γ+ (CΣ∗ +Σ∗C (cid:124) ). (B.13)
2
Recursively substituting Σ∗ in the right-hand side with Γ+ 1CΣ∗+ 1Σ∗C(cid:124) ,
2 2
we obtain the time series expansion
1 1
Σ∗ =Γ+ (CΓ+ΓC (cid:124) )+ C2Γ+2CΓC (cid:124) +Γ(C (cid:124) )2
2 4
+ 1 C3Γ+3C2ΓC (cid:124) + (cid:0) 3CΓ(C (cid:124) )2 +Γ(C (cid:124) )3 + (cid:1) (C4). (B.14)
8 O
(cid:0) (cid:1)
In the equilibrium case of symmetric couplings, the Hessian is trivially
H = JΓ−1. ForsystemsataNESS,forJ = I+Candunderauniformnoise
−
Γ = ς−2I, the inverse covariance (Hessian) can be computed as a Neumann
43
series,
∞
1 1
H =(Σ∗) −1 = ς−2 (C+C (cid:124) ) C2 +2CC (cid:124) +(C (cid:124) )2
− 2 − 4
(cid:88)
k=0(cid:16)
(cid:0) (cid:1)
1 k
C3 +3C2C (cid:124) +3C(C (cid:124) )2 +(C (cid:124) )3 + (C4)
− 8 O
(cid:0) ς−2 ς−2 (cid:1) (cid:17)
=ς−2I (C+C (cid:124) ) C2 +2CC (cid:124) +(C (cid:124) )2
− 2 − 4
ς−2 (cid:0) (cid:1)
+ C2 +CC (cid:124) +C (cid:124) C+(C (cid:124) )2
4
ς−2 (cid:0) (cid:1)
C3 +3C2C (cid:124) +3C(C (cid:124) )2 +(C (cid:124) )3
− 8
ς−2 (cid:0) (cid:1)
C3 +C2C (cid:124) +CC (cid:124) C+C(C (cid:124) )2
− 8
+C (cid:124) C(cid:0)2 +C (cid:124) CC (cid:124) +(C (cid:124) )2C+(C (cid:124) )3
ς−2 (cid:17)
+ 2C3 +3C2C (cid:124) +2CC (cid:124) C+3C(C (cid:124) )2
8
+C (cid:124) C (cid:16) 2 +2C (cid:124) CC (cid:124) +(C (cid:124) )2C+2(C (cid:124) )3 + (C4)
O
ς−2 ς−2 (cid:17)
=ς−2I (C+C (cid:124) )+ (C (cid:124) C CC (cid:124) )
− 2 4 −
ς−2
+ (C(C (cid:124) C CC (cid:124) )+(C (cid:124) C CC (cid:124) )C (cid:124) ))+ (C4). (B.15)
8 − − O
The submatrix of the Hessian for y,x couplings is
ς−2
(cid:124) (cid:124)
H = C C +C C
yx − 4 ys xs ya xa
ς−2(cid:16) (cid:17)
(cid:124) (cid:124) (cid:124) (cid:124) (cid:124) (cid:124)
+ C ( C C C C C C +C C C C
8 ya − aa xa − as xs − ax xx aa ax − aa xa
C
(cid:124) C(cid:16)(cid:124)
+C
(cid:124)
C C
(cid:124)
C
(cid:124)
)
− sa xs xa xx − xa xx
(cid:124) (cid:124) (cid:124) (cid:124) (cid:124) (cid:124) (cid:124) (cid:124)
+C ( C C C C +C C C C C C +C
ys − sa xa − ss xs as ax − as xa − ss xs xs
(cid:124) (cid:124) (cid:124) (cid:124) (cid:124) (cid:124)
C C C )+C ( C C C C C C )
xx − xs xx yy − ya xa − ys xs − sy xs
+C (cid:124) (C C (cid:124) +C C (cid:124) )+C (cid:124) (C C (cid:124) +C C (cid:124) ) + (C4)
sy sa xa ss xs yy ya xa ys xs O
(cid:17) (B.16)
44
Appendix B.2. Solenoidal flows
We can describe the surprise of the system and its gradient as
J(z) = logp(z)
−
1 k 1
= (z m ) (cid:124) Σ−1(z m )+ log(2π)+ log Σ , (B.17)
2 − z zz − z 2 2 | zz |
J(z) =(Σ∗) −1 (z m ). (B.18)
z z
∇ −
where we know from Eq. 25 that Σ∗ = 2J−1Γ J−1Σ∗J(cid:124) .
− −
At the NESS, the solution can be described in two terms consistent with
a SDE decomposition:
J(z ρ) =(Q Γ)( 2J−1Γ J−1Σ∗J (cid:124) )−1(z ρ), (B.19)
− − − − −
Q =Γ J(2J−1Γ+J−1Σ∗J (cid:124) ) = Σ∗J (cid:124) Γ = Γ+JΣ∗. (B.20)
− − −
Rearranging the terms in the equation above to substitute Σ∗ = J−1(Q
−
Γ) we obtain the equivalence
(cid:124) (cid:124)
JQ+QJ = JΓ ΓJ , (B.21)
−
whichagaintakestheformofacontinuousLyapunovequation. Thisequation
can be solve numerically, or analytically using a power series expansion of
J = I+C, expanding the expression
−
1 1
(cid:124) (cid:124)
Q = (CΓ ΓC )+ (CQ+QC ), (B.22)
2 − 2
into the power series
1 1
Q = (CΓ ΓC (cid:124) )+ C2Γ Γ(C (cid:124) )2
2 − 4 −
+ 1 C3Γ+C2ΓC (cid:124) (cid:0) CΓ(C (cid:124) )2 Γ( (cid:1) C (cid:124) )3 + (C4). (B.23)
8 − − O
(cid:0) (cid:1)
Appendix B.3. Mapping between the most likely internal and external states
If z can be divided into blanket states b, and internal/external states
h = x,y , the conditional distribution given blanket states is a Normal
{ }
distribution with moments
m (b ) =ρ +Σ∗ (Σ∗ )g(b ρ ), (B.24)
h t h hb bb t − b
Σ (b ) =Σ∗ Σ∗ (Σ∗ )gΣ∗ . (B.25)
hh t hh − hb bb bh
45
Note that the Markov blanket imposes that Σ (b ) = Σ (b ) = 0, since
xy t yx t
x,y are conditionally independent.
Similarly, we can decompose h into an internal and external state
m (b ) =ρ +Σ∗ (Σ∗ )g(b ρ ), (B.26)
x t x xb bb t − b
m (b ) =ρ +Σ∗ (Σ∗ )g(b ρ ). (B.27)
y t y yb bb t − b
If the mapping from b to x is injective (for this n n is required), the first
x b
≥
term can be rearranged into
b ρ = Σ∗ (Σ∗ ) −1 (m (b ) ρ ), (B.28)
t − b bb xb x t − x
yielding
m (b ) =m +Σ∗ (Σ∗ )gΣ∗ (Σ∗ ) −1 (m (b ) ρ ),
y t y yb bb bb xb x t − x
=ρ +Σ∗ (Σ∗ ) −1 (m (b ) ρ ) σ(m (b )), (B.29)
y yb xb x t − x ≡ x t
which is a linear mapping of m (b ) to m (b ).
x t y t
m (b ) =m +Σ∗ (Σ∗ )gΣ∗ Σ∗ −1 (m (b ) m (b ))
x t x xb bb bb yb y t − y t
=m
x
+Σ∗
xb
Σ∗
yb
−1 (m(cid:0)y (b t(cid:1))
−
m
y
(b
t
))
≡
σ−1(m
y
(b
t
)). (B.30)
In the NESS limit (cid:0) (cid:1)
dm (b ) dm (b ) dm (b )
y t =Σ∗ (Σ∗ ) −1 x t = σ(m (b )) x t . (B.31)
dt yb xb dt ∇ mx x t dt
Similarly, ifthemappingfrombtoy isinjective(forthisn n isrequired),
y b
≥
we can invert the relation
dm (b ) dm (b ) dm (b )
x t =Σ∗ Σ∗ −1 y t = σ−1(m (b )) y t . (B.32)
dt xb yb dt ∇ my y t dt
(cid:0) (cid:1)
Appendix C. How informative are conditional marginal flows? A
minimal example
In order to illustrate the debate about how informative are average flows,
we study a simple two-dimensional linear stochastic system
dy
t
=J y +J b +ω , (C.1)
yy t yb t y,t
dt
db
t
=J y +J b +ω , (C.2)
by t bb t b,t
dt
46
which can be studied as the Langevin dynamics described in Appendix B.
We select a variance of ω ,ω , ς2 = 1, and
y,t b,t
1 1.2
J = − . (C.3)
1 1
(cid:20)− − (cid:21)
The resulting covariance matrix is
0.9545 0.04545
Σ = . (C.4)
0.04545 1.05455
(cid:20) (cid:21)
Fig. C.1 displays an example of a trajectory of this system.
Appendix C.1. Conditional marginal flows capture partial tendencies, not
real behaviour
Flows in the system are described as
f (y ,b ) =J y +J b , (C.5)
y t t yy t yb t
f (y ,b ) =J y +J b . (C.6)
b t t by t bb t
Following the results in Appendix B, conditional average flows can be
described as
f (y ,b ) =J m (b )+J b
(cid:104) y t t (cid:105)bt yy y t yb t
= J Σ∗ /Σ∗ +J b , (C.7)
yy yb bb yb t
f (y ,b ) = J +J Σ∗ /Σ∗ y , (C.8)
(cid:104) y t t (cid:105)yt (cid:0) yy yb by yy(cid:1) t
f (y ,b ) = J Σ∗ /Σ∗ +J b , (C.9)
(cid:104) b t t (cid:105)bt (cid:0) by yb bb bb (cid:1) t
f (y ,b ) = J +J Σ∗ /Σ∗ y . (C.10)
(cid:104) b t t (cid:105)yt (cid:0) by bb by yy(cid:1) t
InFig.C.2.Awedescribetheflo(cid:0)wstructureinthe(cid:1)system,whichdescribes
a spiral behaviour due to the non-equilibrium tendencies in the system. This
is an example of the solenoidal flows captured by the matrix Q.
Incontrast, Fig.C.2.Bcapturesthemarginalflowstructurewhenvariable
b is fixed. This separates tendencies in the system, resulting in a diverging
tendency for variable y (diverging to for negative b and to + for
−∞ ∞
positive b. Similarly, combining cross marginal flows (fix b for the marginal
flowofy andviceversa)resultinanothercombinationofpartialtendenciesas
shown in Fig. C.2.C. In this case, the rotation of solenoidal flows is captured,
but no the attractor that structures this rotation into an spiral behaviour.
47
2 2
y
0 0 b
2 2
− −
0 5 10 15 20 25 30 35
t
Figure C.1: Evolution of a bivariate linear stochastic system. Example trajectory
of the system described by Eq. C.2 with parameters ς = 1, J = J = 1, J = 1.2,
yy bb yb
−
J = 1.
by
−
In sum, conditonal marginal flows do not capture the behaviour of the
system. Even if the flows point in some direction (e.g. free energy mini-
mization) we cannot conclude that this is equivalent to the system behaving
‘as if’ following that particular direction. An alternative illustration of this
problem can be described by writing the conditional average flow of y in
terms of the most likely state m (b)
y
f (y ,b ) = J +J Σ∗ /Σ∗ m (b ). (C.11)
(cid:104) y t t (cid:105)bt yy yb by yy y t
(cid:0) (cid:1)
Where the term J +J Σ∗ /Σ∗ is a positive constant (see Fig. C.3.B).
yy yb by yy
Following the logic of a relaxed interpretation of the FEP, this could be inter-
(cid:0) (cid:1)
preted as a gradient ascent on m2(b ). However, as we see in the Fig. C.2.A
y t
the real behaviour of the system will display a global attractor at y = b = 0
with solenoidal couplings, eventually minimizing m2(b ).
y t
Appendix C.2. Ratesofconditionalaveragesaredifferenttoconditionalmarginal
flows
The second issue we illustrate in this simple system is the difference be-
tween conditional marginal flows and the dynamics of the most likely states.
From Appendix B we can derive
dm (b ) db
y t =Σ∗ /Σ∗ t = Σ∗ /Σ∗ (J y +J b +ςω ). (C.12)
dt yb bb dt yb bb by t bb t b,t
48
A B C
fy(y,b),fb(y,b) h fy(yt,bt) ibt , h fb(yt,bt) ibt h fy(yt,bt) ibt , h fb(yt,bt) iyt
3 3 3
2 2 2
1 1 1
y y y
0 0 0
1 1 1
− − −
2 2 2
− − −
3 3 3
− − −
2 0 2 2 0 2 2 0 2
− b − b − b
Figure C.2: Flow structure vs conditional average flow structure of the system.
Comparison between the flow structure in the system displaying a spiral behaviour (A),
the conditional average flows when variable b is fixed, displaying divergent tendencies in y
andconvergenttendenciesinb(B),andthecrossconditionalaverageflowwhenvariableb
is fixed for f and variable y is fixed for f , displaying rotation without an attractor (B).
y b
For a fixed b, this variable is distributed as a Normal distribution (u,s),
N
with mean and standard deviation
u =Σ∗ /Σ∗ J m (b), (C.13)
yb bb by y
s =Σ∗ /Σ∗ J (Σ∗ Σ∗ Σ∗ /Σ∗ )+√2ςs , (C.14)
yb bb by yy − yb by bb ω
(cid:16) (cid:17)
where s is the standard deviation of the noise introduced in the Langevin
ω
dynamics (described as 1).
dt
For a range of values(cid:113)of b, Fig. C.3 captures the conditional average flows
f (y ,b ) (solid dark line), and the distribution of the derivatives of the
(cid:104) y t t (cid:105)bt
conditional average state
dmy(bt)
(the mean is represented by the dashed line
dt
and error bars of three standard deviations by the light area). As we can
observe, the dependency with m (b) is positive with respect to f (y ,b )
y (cid:104) y t t (cid:105)bt
(indicating a gradient ascent on m2(b)) while the true dynamics is captured
y
by the negative dependency between
dmy(bt)
and m (b) (indicating a gradient
dt y
descent on m2(b)). Note that for different parameters the sign of the slope of
y
f (y ,b ) can change (being negative or positive) but the slope of
dmy(bt)
(cid:104) y t t (cid:105)bt dt
is always negative, given the presence of a global attractor. This shows how,
even in very simple examples, these quantities can have radically different
49
A B
3 3 3 3
2 2 2 2
1 1 1 1
h fy(yt,bt) ibt0 0dmy(bt) h fy(yt,bt) ibt0 0dmy(bt)
dt dt
1 1 1 1
− − − −
2 2 2 2
− − − −
3 3 3 3
− − − −
3 2 1 0 1 2 3 0.10 0.05 0.00 0.05 0.10
− − − b − − my(b)
Figure C.3: Rate of conditional averages versus conditional average flows. The
conditional average flow of y fixing b, f (y ,b ) , is represented by the solid dark line.
(cid:104) y t t (cid:105)yt
The rate of change of the conditional average
my(bt)
is represented by the dashed line
dt
(representingitsaveragevalueforagivenb,andthelightarea(representingerrorbarsfor
3 standard deviations for a fixed b.). These quantities are represented with respect to a b
axis (A) and a m (b) axis (B), as one is a linear transformation of the other.
y
behavioursandthattheconditionalaverageflowdoesnotnecessarilycapture
the true behaviour of a system.
50

=== INSTRUCTIONS ===

0. PROFESSIONAL TONE REQUIREMENTS:
   - Begin directly with the paper title or content - NO conversational openings
   - Do NOT use phrases like: 'Okay, here's...', 'Here's a summary...',
     'Let me summarize...', 'I'll extract...', or similar conversational language
   - Start immediately with substantive content in formal academic tone
   - Example BAD: 'Okay, here's a summary of the paper...'
   - Example GOOD: 'This paper investigates [topic]...'

1. Start with exact title: "How particular is the physics of the free energy principle?"

2. EXTRACT QUOTES:
   - Extract 10-15 direct quotes from the paper that support key claims
   - QUOTE EXTRACTION AND FORMATTING:
     * Extract quotes VERBATIM from the paper text - do NOT modify or "correct" them
     * Extract quotes exactly as they appear in the source text
     * Preserve all aspects of the quote exactly as written, including spacing
     * Use proper quotation marks: "quote text" (double quotes)
     * CRITICAL: Only extract quotes that actually appear in the paper text
     * Do NOT generate, invent, or "fix" quotes - extract them exactly as written
   - QUOTE FORMATTING STANDARD:
     * Attribution format: 'The authors state: "quote text"' OR 'According to the paper: "quote text"'
     * Vary attribution phrases to avoid repetition (use: 'The authors state', 'They note',
       'The paper argues', 'According to the research', 'The study demonstrates')
     * Include section context when available: 'In the Introduction, the authors state: "quote text"'
     * Ensure proper spacing around quotes and punctuation
   - Search the full paper text to find relevant quotes
   - Each quote must be verbatim from the paper text (with spacing normalized)

3. IDENTIFY CLAIMS:
   - Identify the main claims and arguments made by the authors
   - State each claim clearly and support it with quotes from the paper
   - Distinguish between primary claims and supporting arguments

4. SUMMARIZE KEY FINDINGS:
   - Summarize the key findings with specific numbers, metrics, and results
   - Include quantitative data: percentages, statistics, measurements
   - Extract numerical results from the results section
   - Present findings with supporting evidence from the paper

5. DESCRIBE METHODS:
   - Describe the methodology, experimental setup, and approach used
   - Include details about: algorithms, procedures, experimental design
   - Explain how the research was conducted
   - Extract specific methodological details from the methods section

6. PRESENT RESULTS:
   - Present the results with quantitative data and statistical significance
   - Include specific numbers, tables, figures mentioned in the paper
   - Extract results from the results section with exact values
   - Support results with quotes or data from the paper

7. NO REPETITION - CRITICAL REQUIREMENT (ENHANCED):
   - CRITICAL: Before writing EACH sentence, check: 'Have I already said this exact idea?'
   - If you've already stated an idea, DO NOT repeat it - move to the next unique point
   - Each sentence must be COMPLETELY UNIQUE - no duplicate ideas, even with different words
   - Each claim appears EXACTLY ONCE - if you've stated it, move to the next unique point
   - Each paragraph must be COMPLETELY UNIQUE - no duplicate paragraphs
   - Do NOT repeat the same sentence, even with slight variations or word changes
   - Do NOT repeat paragraphs or sections - each section must have unique content
   - Each claim should appear only ONCE in the entire summary
   - Vary attribution phrases: use 'The authors state', 'They note', 'The paper argues',
     'According to the research', 'The study demonstrates' - do NOT repeat the same phrase
   - If you find yourself writing similar content, STOP immediately and write something completely different
   - Before each sentence, ask: 'Have I already said this?' If yes, write something new
   - Vary your language: use synonyms, different sentence structures, different perspectives
   - REPETITION CHECKLIST: After writing each sentence, verify it's not a duplicate of any previous sentence

   EXAMPLES OF WHAT NOT TO DO:
   ❌ BAD: 'The authors state: "X". The authors state: "Y". The authors state: "Z".'
   ✅ GOOD: 'The authors state: "X". They further note: "Y". The paper argues: "Z".'

   ❌ BAD: Repeating the same claim 3+ times with slight variations
   ✅ GOOD: State each claim once, then move to the next unique point

8. STRUCTURE:
   - Use markdown headers: ### Overview, ### Methodology, ### Results, ### Discussion
   - Target length: 1000-1500 words
   - Ensure all requested elements (quotes, claims, findings, methods, results) are included
