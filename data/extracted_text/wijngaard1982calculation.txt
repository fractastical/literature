ON THE CALCULATION OF THE TOTAL EXPECTED 
COST IN SKIP-FREE MARKOV CHAINS; 
THE MATRIX CASE 
JACOB WIJNGAARD, EINDHOVEN 
Zusammenfassung. In [4] wird eine Methode beschrieben fUr die Berechnung der totalen 
erwarteten Kosten in einer abzahlbaren Markoffschen Kette mit skip-free-Struktur; das 
heiBt}daB von Zustand n nur Obergange stattfinden konnen zu den Zustanden 0,1, •. ,n+1. 
Diese Methode kann in Warteschlangenproblemen mitexponentieller Bedienung angewandt 
werden. Hier entwickeln wir ein Matrix-Analogon dieser Methode. Diese erweiterte Me­
thode ist anwendbar in Warteschlangenproblemen mit Phase-type-Bedienung. Ein Vo;fteil 
der Methode ist, daB sie auch im Fall zustandsabhangiger AnkUnfte und Bedienung an­
wendbar ist. Das macht die Methode attraktiv fUr Anwendungen in Entscheidungsmodellen. 
Numerische Methoden fUr Systeme mit ahnlicher Struktur wurden von Stewart und Marie 
[3] und Neuts [2] betrachtet. 
Summary. In [4] a method was developed to calculate total expected cost and related 
quantitles in a countable sti'.te Markov chain which is skip-free to the right. That 
means that from state n transitions can only take place to the states 0,1, ... ,n+1. 
That method can be used in queues with exponential service. Here we will develop a 
kind of matrix analogon of that method. The method is applicable, for instance, to 
queues with phase-type service in batches. Difficulties due to the restricted accu­
racy of the computer are investigated and resolved. 
One advantage of the method is that it also works in cases with all kinds of state 
dependencies. That makes it attractive for use in decision models. Numerical methods 
for systems with about the same structure have been cohsidered in Stewart and Marie 
[3] and Neuts [2]. 
1. Model and idea of the algorithm 
We consider a Markov chain with states (n,j) n=1,2, ... , ; j=l, ... ,m and 
an absorbing state O. For fixed n the set of states (n,j), j=1,2, ... ,m 
is called level n. For fixed j the set of states {(n,j), n=1,2, •.. } is 
called line j. The transition structure is such that if the actual state 
is in 1 evel n then the next state can only be in the 1 evel s 1,2, ... ,n+1 
or the absorbing state. That means that the transition matrix is of the 
following type: 
Operations Research Proceedings 1980 
© Springer.Verlag Berlin Heidelberg 
450 
state 0 1 eve 1 level 2 level 3 level 4 
s ta te 0 0 0 0 0 
level I bl All AIO 0 0 
1 eve 1 2 b2 A22 A21 A20 0 
1 e ve 1 3 b3 A33 A32 A31 A30 
The matri ces A£k are of si ze m x m. The (i,j) th el ement of A£k is the 
probability of a transition from level £, line i to level k, line j. The 
vectors b£ are m-vectors. The ith element of b£ is the probability of a 
transition from level £, line i to the absorbing state. 
The transition matrix is assumed to be stochastic. That means that, for 
1 the m-vector with all elements equal to I, we have 
n 
l: A .1 + b n i=O n1 
( I) 
We also assume the existence of cost. The (expected) cost in state (n,j) 
is denoted by Cnj,C nj ~ 0 for all (n,j). The vector with elements c nj , 
j=l, ... ,m is denoted by c n ' 
The problem we will consider is the calculation of the total expected 
cost until absorption in state O. 
Define vnj as the total expected cost until absorption, starting in state 
(n,j) (see section 2 for the existence of this cost). 
The vector with elements vnj , j=l, ... ,m is denoted by vn ' The vectors 
v1 ,v 2 ,v 3 "" satisfy the following system of equations (see section 2): 
n 
xn = AnOxn+1 + l: A 1 .x. + c n ' i=l nn+ -1 1 n ~ (2 ) 
Suppose AnO has an inverse. If VI is given then it is easy to calculate 
v2 ,v 3 ,v 4 "" from (2). The problem of course is to get VI' If one tries 
Xl = x for some arbitrary x one will get a very fast diverging sequence 
{Xi}' unless x is very close to VI' This property can be used to appro­
ximate VI' Consider the homogeneous version of the system of equations 
( 2 ) 
n 
xn = AnOxn+l + l: A 1 .x., i=l nn+ -1 1 n ~ ( 3 ) 
Let gl,g~,gj, ... be the solution of this system of equations generated 
by Xl = e i (e i is the vector with a 1 on the ith place and further O's). 
Let Gn be the matrix with columns g~,g~,g~, ... ,g~. Then 