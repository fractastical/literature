Free Energy Principle for State and Input Estimation of a Quadcopter
Flying in Wind
Fred Bos 1, Ajith Anil Meera 2, Dennis Benders 3 and Martijn Wisse 4
Abstract—The free energy principle from neuroscience pro-
vides a brain-inspired perception scheme through a data-
driven model learning algorithm called Dynamic Expectation
Maximization(DEM).Thispaperaimsatintroducinganexper-
imental design to provide the first experimental confirmation
of the usefulness of DEM as a state and input estimator for
real robots. Through a series of quadcopter flight experiments
under unmodelled wind dynamics, we prove that DEM can
leverage the information from colored noise for accurate state
andinputestimationthroughtheuseofgeneralizedcoordinates.
WedemonstratethesuperiorperformanceofDEMforstatees-
timationundercolorednoisewithrespecttootherbenchmarks
likeStateAugmentation,SMIKFandKalmanFilteringthrough
Fig. 1: The schematic representation of our experimental setup for its minimal estimation error. We demonstrate the similarities
the DEM’s state and input estimation using a quadrotor.
in the performance of DEM and Unknown Input Observer
(UIO) for input estimation. The paper concludes by showing
theinfluenceofpriorbeliefsinshapingtheaccuracy-complexity
trade-off during DEM’s estimation. 2) Provide the first experimental confirmation for the ad-
vantageofgeneralizedcoordinatesinhandlingcolored
I. INTRODUCTION noise during state and input estimation on robots.
3) Demonstrate the influence of prior beliefs in shaping
Thewidespreaduseofunmannedaerialvehicles(UAV)as
the accuracy-complexity trade-off during estimation.
delivery drones has increased the need for robust state and
input estimators, mainly owing to its safety during uncertain II. RELATEDWORK
eventssuchasstrongwind.Wetakeastepinthisdirectionby
ThissectionintroducestheinterdisciplinarynatureofFEP,
evaluating the usefulness of an approach from neuroscience
connecting neuroscience and robotics.
to handle the wind during estimation.
In literature, a wide range of approaches have been used A. Neuroscience
forthestateestimationoflineartimeinvariant(LTI)systems. FEP emerges from neuroscience as a unified theory of
However, most of them assume the noise to be white [1], the brain which posits that all biological systems resist their
which is often a wrong assumption in practice [2]. For natural tendency to disorder by minimizing their free energy
example,Kalmanfilter(KF)[3]ensuresoptimalitywhenthe [7], where free energy is an information theoretic measure
noises are white [4], but it is suboptimal when the noises that bounds sensory surprisal. FEP provides a mathematical
are colored. An interesting approach from neuroscience formalism for the brain related functions [8], unifies action
called the Free Energy Principle (FEP) uses the concept and perception [9], connects memory and attention [8] and
called generalized coordinates that can leverage the noise explains Freudian ideas [10]. The brain inspired nature of
derivativeinformationinthebrainsignalsforperception.The FEP has already attracted roboticists to apply it to build in-
FEP based perception scheme called Dynamic Expectation telligentagents.Afewofthemincludesthebodyperception
Maximization (DEM) [5] was recently reformulated into a of humanoid robots [11], control of manipulator robot [12],
state and input observer for LTI systems with colored noise, system identification of a quadrotor [13, 14], SLAM [15]
and was shown to outperform the KF in simulation [6]. In etc. With this work we aim to assess the performance of
this paper, we aim to provide the experimental validation of DEM for state and input estimation of a quadrotor under
the DEM observer for a quadrotor under wind conditions wind conditions.
using the setup given in Figure 1. The main contributions of
B. Robotics and control systems
the paper are:
In control systems literature, numerous approaches are
1) Introduce an experimental design with real robots to
usedtodealwithcolorednoiseduringstateestimation.State
provide the proof of concept for DEM as a state and
Augmentation (SA) assumes the colored process noise as
input observer.
an auto-regressive (AR) noise and augments the state space
equationtotransformitintoanequivalentsysteminfluenced
AlltheauthorsarewiththeCognitiveRoboticsdepartmentatTUDelft,
TheNetherlands.Correspondingauthor:ajitham1994@gmail.com. by white noise [2]. The Measurement Differencing [16]
1202
peS
42
]OR.sc[
1v25021.9012:viXra
approach deals with handling colored measurement noise. divergence involves the maximization of free energy. This is
SMIKF[17]extendsKFforcolourednoisebyincorporating the fundamental idea behind using free energy as the proxy
the temporal correlations of the AR noise into the prior for brain’s inference through the minimization of its sen-
covariancecalculationofKF.Inthefaultdetectionliterature, sory surprisal [7]. DEM uses this mathematical framework,
many observers have been developed for input estimation, in conjunction with the use of generalized coordinates to
like the Unknown Input Observer (UIO) [18]. However, provide a hierarchical brain model [22]. We will be using a
none of these methods perform simultaneous state and input reformulated version of DEM given in [6] for this work.
estimation under colored noise other than DEM [6].
B. Generative model
In robotics, different approaches are used for state es-
timation of quadrotors under wind conditions. The most The key concept that differentiates DEM from other
common approach (Dryden wind model) is to treat wind methods is its use of generalized coordinates for noise color
as a colored noise shaped by a filter acting on the white handling. This is done by keeping track of the trajectory
noise. Another approach is to model the wind dynamics of all time-varying quantities (instead of only its point
and estimate wind velocity using complex nonlinear models estimates) through a vector of derivatives. The state vector
[19]. Using additional cameras for accurate state estimation in generalized coordinates are written using a tilde operator
is another solution [20]. Our approach differs from these as x˜ = [x x(cid:48) x(cid:48)(cid:48) ....]T where the dash operator represents
methods as we treat the wind noises as colored and use the the derivatives. Since the noises are colored, the higher
information in the noise derivatives for accurate state and derivatives of the system model can be written as [5]:
input estimation.
x(cid:48) =Ax+Bv+w y =Cx+z
III. PROBLEMSTATEMENT x(cid:48)(cid:48) =Ax(cid:48)+Bv(cid:48)+w(cid:48) y(cid:48) =Cx(cid:48)+z(cid:48) (3)
Consider the plant dynamics given in Equation 1, where ... ...
A, B and C are constant system matrices, x ∈ Rn is the
hidden state, v∈Rr is the input and y∈Rm is the output. which can be compactly written as:
x˙ =Ax+Bv+w, y=Cx+z. (1) x˜˙ =Dxx˜=A˜x˜+B˜v˜+w˜ y˜=C˜x˜+z˜ (4)
(cid:34) (cid:35)
H (c e o r l e ore w d) ∈ and R r n epr a e n s d en z t th ∈ e p R ro m ces a s re an t d em m p e o a r s a u ll r y em c e o n r t re n la o t i e s d e where Dx = 0 0 1 1 . 0 . 1 ⊗I n×n .
respectively. The noises are assumed to be the result of the Here, Dx represents t 0 he ( s p h + i 1 f ) t × m (p a + t 1 ri ) x, which performs the
convolution of a Gaussian kernel on a white noise signal.
derivativeoperationonthegeneralizedstatevector.Similarly,
The goal of the DEM observer is to simultaneously estimate Dv performs the same operation on inputs and has size
x and v, when the noises are colored (or non-white). The
r(d+1)×r(d+1).panddrepresenttheembeddingorderfor
goal of this paper is to design an experimental setup for a
the hidden states and the inputs respectively, indicating the
realrobotthatcanbeusedtovalidatetheDEMobserverand
numberofderivativesused.Thegeneralizedsystemmatrices
its usefulness in the presence of colored noise. aregivenbyA˜=I ⊗A, B˜ =I ⊗B, C˜ =I ⊗
p+1 p+1 p+1
IV. PRELIMINARIES C,whereI denotestheidentitymatrixand⊗theKronecker
tensor product. The generalized output y˜ is calculated from
This section introduces the DEM observer fundamentals. (cid:34) ... (cid:35)
y(t−dt)
the discrete measurements yˆ = y(t) using the
A. Free energy principle
y(t+dt)
... m(p+1)
Fundamentally based on Bayesian Inference, methodology in [5], resulting in a latency of pdt during
2
FEP estimates the posterior probability p(ϑ/y) = online estimation, which is negligible for the large sampling
(cid:82)
p(ϑ,y)/ p(ϑ,y)dϑ, where ϑ is the component to rate (120Hz) used in this paper.
be estimated and y is the measurement [21]. The
presence of an intractable integral motivates the use C. Noise modeling
of a variational density q(ϑ), called the recognition density The use of generalized coordinates helps to model the
that approximates the posterior as q(ϑ) ≈ p(ϑ/y). This noise color through the temporal precision matrix of the
approximation is achieved by minimizing the Kullback- noise derivatives. In DEM, the noise is assumed to be the
Leibler (KL) divergence of the distributions given by result of a white noise signal that has been convoluted using
KL(q(ϑ)||p(ϑ/y)) = (cid:104)lnq(ϑ)(cid:105) q(ϑ) − (cid:104)lnp(ϑ/y)(cid:105) q(ϑ) , a Gaussian filter of the form: K(t) = √1 exp(−1(t)2).
where (cid:104).(cid:105) represents the expectation over q(ϑ). Upon 2πσ 2 σ
q(ϑ) This provides an easy computation of the covariance of the
simplification using p(ϑ/y) = p(ϑ,y)/p(y), it can be
noise derivatives using the temporal precision matrix S [5]:
rewritten as [7]:
 1 0 − 1 .. −1
lnp(y)=F +D (q(ϑ)||p(ϑ|y)), (2) 2σ2
whereF =(cid:104)lnp(ϑ,y)(cid:105) −(cid:104)l k n l q(ϑ)(cid:105) isthefreeenergy. S(σ2)=   − 0 1 2 0 σ 1 2 0 3 . . . .    (5)
q(ϑ) q(ϑ) 2σ2 4σ4
Since lnp(y) is independent of ϑ, minimization of the KL .. .. .. ..
(p+1)×(p+1)
σ is close to zero for white noise, while σ > 0 for colored V. EXPERIMENTALDESIGN
noise. The generalized noise precision matrix can be written
The distinctive feature of DEM that enables it to handle
using S as Π˜ = diag(Π˜z,Pv˜,Π˜w), where Π˜z = S ⊗Πz,
colored noise (to outperform a KF for state estimation) is
Π˜w = S ⊗Πw, and Pv˜ = S ⊗Pv. Here Πw and Πz are
its use of generalized coordinates [5, 6]. This section aims
thenoiseprecisions(inversecovariance),andPv istheprior
at designing an experimental setup (as simple as possible)
precision on inputs.
for real robots that can leverage this property and provide a
proofofconceptforourDEM-basedstateandinputobserver
D. State and Input Observer
design for LTI systems with colored noise [6].
The DEM observer in [6] simultaneously estimates the
(cid:2) (cid:3)
generalized state and input vector X = x˜ through the A. Experimental setup
v˜
gradient ascend over its variational free energy V(t):
Our experimental setup consist of a quadrotor (Parrot
X˙ =kV(t) +DX, (6) AR.drone 2.0) hovering in wind produced by a blower in
X
a controlled lab, as shown in Figure 2. The blower induces
where k is the learning rate, V(t) X is the gradient of wind in the negative y direction, against the hovering quad-
V(t) with respect to X and DX = (cid:20) Dx O (cid:21) . Using the copter.ThePIDcontrollertriestoresistthewindtohoverthe
O Dv quadrotoratthegivenposition(0m,0m,1m)andorientation
Laplaceapproximation[23],simplifiesV(t)astheprecision (0◦,0◦,0◦). We use an OptiTrack motion capture system to
weighted prediction error, V(t) = −1(cid:15)˜TΠ˜(cid:15)˜, where (cid:15)˜is the
2 recordthepositionandorientationofthequadcopter.Atotal
prediction error given by:
of 9 hovering experiments were performed - 4 experiments
 y˜−C˜x˜  without wind (blower off) and 4 experiments with wind
(cid:15)˜= v˜−ηv˜  (7) (blower on). The final experiment was used to tune all the
Dxx˜−A˜x˜−B˜v˜ benchmarkobserversandwillnotbeusedforbenchmarking.
Each experiment lasted 10s with dt=0.0083s.
Here ηv˜ denotes the prior on the input. Therefore, V(t) =
X
−(cid:15)˜TΠ˜(cid:15)˜, where (cid:15)˜ is given by:
X X
 −C˜ O 
(cid:15)˜
X
= O I . (8)
Dx−A˜ −B˜
Substituting these results to Equation 6 upon simplification
yields the DEM state and input observer of [6]:
(cid:20) x˜˙(cid:21) (cid:20)
x˜
(cid:21) (cid:20)
˜y
(cid:21)
X˙ = =A +B and Y =X, (9)
v˜˙ 1 v˜ 1 −η˜ Fig. 2: The controlled lab environment for the experimental setup
with the quadrotor and the blower.
where Y is the output of the observer, A =DX −kA ,
1 2
(cid:20) C˜TΠ˜zC˜+(DA)TΠ˜wDA −(DA)TΠ˜wB˜(cid:21) Since wind is the result of another (unmodelled) dynamic
A = , (10)
2 −B˜TΠ˜wDA P˜v+B˜TΠ˜wB˜ system, we hypothesize that the introduction of wind in-
fluences the quadrotor dynamics and acts as the source of
(cid:20) −C˜TΠ˜z O (cid:21) colorednoisetothesystem.Theexperimentaldesignenables
B =− and DA =Dx−A˜.
1 O P˜v us to control the level of noise color entering the system
This observer was proved to outperform the KF for state by controlling the blower for its wind speed and direction.
estimation on LTI systems with colored noise in simulation We hypothesize that our DEM observer can leverage on the
[6]. We will use this observer design throughout the paper information contained in the colored noise by keeping track
to provide the experimental validation on a real robot. of the higher derivatives of states and inputs through the
generalized coordinates.
E. Uncertainty in state and input estimation
B. Quadrotor model selection
DEM provides a means to compute the uncertainty in
estimation through the precision of estimates given by the The quadrotor model selection was performed to accom-
negative curvature of variational free energy [24]: modate the influence of wind using minimum number of
states,resultinginacontrollableandobservableLTIsystem.
ΠX =−V(t) =(cid:15)˜TΠ˜(cid:15)˜ =A , (11)
XX X X 2 Sincethewindflowsinnegativey direction,itinfluencesthe
where A is given in Equation 10. Therefore, the precision
rollangle(φaroundx-axis)andtherollangularvelocity(φ˙)
2 (cid:104) (cid:105)
φ
of DEM’s state and input estimates is independent of time, the most. Therefore, we only consider states x= φ˙ . The
and is given by Πx˜x˜ =C˜TΠ˜zC˜+(DA)TΠ˜wDA and Πv˜v˜ = model involving these states is based on the one provided in
P˜v+B˜TΠ˜wB˜ respectively. [25]. By assuming small angles, φ and φ˙ can be decoupled
(a) Histograms of the process noise w φ and w φ˙ (b) Histograms of the process noise w φ and w φ˙ (c) The auto-correlations for the process noises
withaGaussianfitfornowindconditions. withaGaussianfitunderwindconditions. w φ andw φ˙ underwindconditions.
Fig. 3: The properties of process noise of our experiment. The wind introduces a colored Gaussian distributed disturbance to the system.
from the other system dynamics. Linearizing these states Π˜w):
around hovering conditions gives: 1
p(y˜)= (cid:113) e− 2 1(y˜−C˜x˜)TΠ˜z(y˜−C˜x˜),
(cid:20) φ˙(cid:21) (cid:20) 0 1 (cid:21)(cid:20) φ (cid:21) (cid:20) 0 0 0 0 (cid:21)(cid:34) pwm1 (cid:35) (2π)m(p+1)|Σ˜z|
φ¨ = 0 0 φ˙ + c I B xx φ −c I B xx φ −c I B xx φ c I B xx φ p p p w w w m m m 2 3 4 p(x˜/v˜)= (cid:113) 1 e− 2 1(cid:15)˜xTΠ˜w(cid:15)˜x , (13)
(cid:2) (cid:3) (cid:20) φ (cid:21) (2π)n(p+1)|Σ˜w|
y = 1 0
φ˙
(12)
where(cid:15)˜x =Dxx˜−A˜x˜−B˜v˜.Thevalidityofthisapproxima-
Herepwm isthePulseWidthModulationsignalprovidedto tion on our experimental design was investigated by plotting
i
the ith motor by the controller for stable hovering. I is the theprocessnoisehistogramsforbothwithoutwindandwith
xx
quadcopter’s moment of inertia around the x-axis. It’s value wind conditions (for 400 data points each) and is shown
isidentifiedusingthebifilarpendulumexperimentandequals in Figure 3a and 3b respectively. Similar trend holds for
3.4·10−3kgm2. c is the thrust coefficient that models the measurementnoiseaswell.ThestrongGaussianfitindicates
Bφ
relation between the PWM values and the thrust generated the validity of Laplace approximation for our experimental
by the quadcopter rotors. It’s value is obtained by averaging design.
the results of several static thrust tests and equals 1.274· B. Influence of wind on states and process noise
10−3Nm. We normalize the input pwm signals using v =
In this section we validate the direct influence of wind
v−mean(v) and use the same factor to multiply the B
max(v)−min(v) on the states and process noise. Table I demonstrates a
matrix,suchthatthesystemdynamicsareunaltered.See[26]
higherstandarddeviationforwindyconditionsthanfornon-
for more details regarding the model derivation and system
windy conditions. A similar trend can be observed from the
identification procedure.
width of histograms in Figure 3a and 3b, indicating that our
Since we use an accurate measurement system, Πz is
experimental design can control the noise generation.
very high for all experiments. However, the presence of
Π co w lor i e s d f p u r r o th c e e r ss in n fl o u is e e nc w ed th b ro y ug th h e w m in o d de m ll a in k g es e Π rr w ors << dur Π in z g . Withoutwind 0 φ .0 ( 0 r 8 a 5 d 5 ) φ˙ 0. ( 0 ra 5 d 4 / 4 s) 0 w .0 φ 00 (r 4 a 1 d 6 ) w φ 0 ˙ .0 ( 2 ra 8 d 4 /s)
linearization as the wind aggressively drives the quadrotor Withwind 0.0460 0.260 0.000937 0.0607
away from its equilibrium. TABLE I: The standard deviations of the states, φ and φ˙, and the
processnoises,w andw ,forexperimentswithandwithoutwind.
φ φ˙
VI. RESULTSANDANALYSIS
C. Confirmation of noise color
This section aims to investigate the validity of the as-
sumptions in our experimental design and to compare the In this section we confirm that our experimental design
performance of DEM observer against other benchmarks. generatescoloredprocessnoise.Figure3cshowsthesample
auto-correlationoftheprocessnoiseofallexperiments(with
wind). There is stronger autocorrelation for w than for
A. Validity of Laplace Approximation φ˙
w , because φ is observed. The auto-correlation is different
φ
The DEM framework approximates the probability densi- from that expected from a white noise signal where the
ties of p(y˜) and p(x˜/v˜) to be Gaussian in nature, centred auto-correlation immediately drops to 0 after zero lag. This
around their mean predictions (C˜x˜ and A˜x˜+B˜v˜, respec- confirms the presence of strong noise color (time-correlated
tively) with the same precision as that of the noises (Π˜z and noise) in data.
(a)Stateestimationbenchmarks(withwind). (b)AverageSSEofallflights. (c)AverageSSEdropsexponentiallywithp.
Fig. 4: DEM outperforms other benchmarks with minimal SSE in state estimation for a quadrotor flying under windy conditions. The
performance of DEM improves exponentially with higher orders of generalized motion p, for a quadrotor flying under windy conditions,
highlighting the importance of generalized coordinates in the presence of colored noise.
D. Estimator settings for benchmarking [6] on large simulated data, and indicates the importance of
generalized coordinates in accurate state estimation in the
We aim to benchmark the state estimation against KF,
presence of colored noise.
SMIKF and SA, and the input estimation against UIO, for a
totalof8experiments(4withand4withoutwind).DEMwas G. State estimation as free energy maximization
set with the order of generalized motion of states and inputs
The fundamental idea behind state estimation using DEM
top=6andd=2respectively.TheSMIKFimplementation
is the gradient ascent over the variational free energy man-
could only accommodate a first order AR model, while the
ifold. In this section, we visually demonstrate that DEM’s
SAimplementationusesa6thorderARmodel,similartothe
state estimates for flight experiment maximize the VFE.
6th order derivatives (p) of DEM. The noise precision Πw
Figure 5 shows that the DEM state estimate is on top of
was calculated for each experiment, while Πz = 8.1·10−9
the V(t) curve at each time instance.
was calculated from static drone data. The 9th experiment
was used to tune the noise smoothness to σ =0.006, which
was used for all experiments.
E. State estimation - benchmarking
Inthissection,wecomparetheperformanceofDEMwith
the aforementioned benchmarks for state estimation with
known inputs. Figure 4a shows the state estimates of all
benchmarks for an experiment with wind. Although most
benchmarks follow the general trend of the measured states
(in blue), DEM performs the best. KF shows an inferior
performance due to its incapability of dealing with colored
noise. We use the sum of squared errors (SSE) between
the estimate of φ˙ and its measurement as the metric to
Fig. 5: The DEM state estimate (blue curve) lies on top of the
denote the quality of state estimation. The average SSE of variational free energy surface, indicating that the DEM observer
all 4 experiments (with and without wind separately) for all maximized V(t).
benchmarksareshowninFigure4b.DEMoutperformsother
benchmarks in state estimation under wind conditions with
minimal SSE, demonstrating that it is a competitive state
estimator.
F. Role of Generalized Coordinates
One of the main strengths of DEM - the capability to
deal with colored noise - comes from the use of generalized
coordinates.Inthissection,wedemonstratetheusefulnessof
generalized coordinates in state estimation on experimental
data. The mean (and standard deviations of) SSE of state
estimationforallexperiments(withwind)forvaryingorders
of generalized motion p is shown in Figure 4c. The expo- Fig. 6: DEM’s input estimation coinciding with that of UIO.
nential decrease in SSE is consistent with the results from
H. Input Estimation - benchmarking the measured input (in blue). As Pv is relaxed, the input
estimation moves away from the wrong prior ηv and moves
Inthissection,weaimtodemonstrateourDEMobserver’s
closer to the correct inputs. The shift from wrong priors
capability to estimate inputs in real robot application and
to the correct measurements, mediated by Pv can be seen
benchmark it against an input observer (UIO) from control
as a balance (trade-off) between complexity and accuracy.
systems. We use the same settings as given in Section VI-D,
Figure 9 demonstrates this balance for all experiments with
exceptforprovidingtheinputpriorsforpwm withawrong
1
value of ηpwm1 = 0.5 with a low precision of Ppwm1 = 1 windy conditions, both for state and input estimation. The
to encourage exploration and Πw =e3I . We use C =I for increasing SSE for higher Pv indicates the shift from high
2
accuracy with low complexity region to the low accuracy
this section to meet the observability requirements of our
with high complexity region. This trade-off is useful mainly
benchmark (UIO). Both DEM and UIO estimated the first
in industrial fault detection systems where any major de-
pwm signal and the result is shown in Figure 6. Both DEM
viations from the prior (known) inputs could be detected
and UIO followed the trend of measured inputs (in blue).
and isolated during runtime. DEM’s inherent capability to
balanceaccuracyandcomplexityisanaddedadvantagewhen
compared to other input estimators in literature like UIO.
Fig.7:SimilarperformanceofDEMandUIOforinputestimation
indicated by similar SSE in input estimation.
ThecoincidinginputestimatesforDEMandUIOdemon-
strate that both estimators behave the same. The estimation
was repeated for all experiments and the SSE for input
estimationisshowninFigure7.Thisconfirmsthesimilarity Fig. 9: The SSE plot of state and input estimation demonstrating
in performance of UIO and DEM for input estimation in the DEM’saccuracy-complexitytradeoff.TheSSEmovesfromaregion
ofhighcomplexityandlowaccuracytoaregionoflowcomplexity
presence of colored noise.
and high accuracy as the prior precision Pv is relaxed.
VII. CONCLUSIONSANDFUTUREWORK
The FEP based perception scheme called DEM, has re-
cently been reformulated into a simulataneous state and
input observer for LTI systems under colored noise. With
this paper, we propose an experimental design to validate
the DEM observer on real robots. Through a series of
quadrotor experiments under wind conditions, we show that
the DEM based observer outperforms other benchmarks like
KF, SMIKF and SA for state estimation with minimum esti-
Fig. 8: The input estimates moving from a wrong prior of ηv =1
tothemeasuredinput(inblue),mediatedbythepriorprecisionP . mation errors. We show that DEM’s input estimation shows
v
similar performance compared to classical input observers
like UIO. With this paper, we provide the first experimental
I. Accuracy v/s complexity validationfortheuseofgeneralizedcoordinatestodealwith
colorednoiseduringstateandinputestimationonrealrobots.
The inherent capability of DEM to balance between es-
We further demonstrate the unique capability of DEM to
timation accuracy and complexity is mediated by the priors
ηv and Pv. Here, accuracy is the measure of closeness of balance between accuracy and complexity during state and
inputestimation.ThemainchallengeoftheDEMobserveris
estimates to the real measurement, and complexity is the
theneedtoknowthenoiseprecisionandnoisesmoothnessa
measure of deviation from the priors. This section aims at
priori.Weintendtoextendthisworkforsimultaneousnoise
demonstrating this balance for simultaneous state and input
precision and smoothness estimation in future.
estimation on quadrotor data. This section follows the same
settings as Section VI-D with Πw = e3I . Simultaneous
2 VIII. ACKNOWLEDGEMENT
state and input estimation was performed using wrong input
prior ηv = 1 for varying prior precisions Pv, and the We would like to thank Prof. Tama´s Keviczky for letting
resulting input estimation is shown in Figure 8, along with us use the lab facilities in the midst of corona crisis.
REFERENCES tionmaximization,”Master’sthesis,2020,availableathttp://resolver.
tudelft.nl/uuid:156157c6-d7f0-4dc1-a55a-b2e4ed66f1c2.
[1] A. C. Jalfon and Y. Halevi, “On partially augmented observers for
systems with coloured noises,” International Journal of Control,
vol.57,no.2,pp.335–349,1993.
[2] A.BrysonandD.Johansen,“Linearfilteringfortime-varyingsystems
usingmeasurementscontainingcolorednoise,”IEEETransactionson
AutomaticControl,vol.10,no.1,pp.4–10,1965.
[3] B.P.Gibbs,AdvancedKalmanfiltering,least-squaresandmodeling:
apracticalhandbook. JohnWiley&Sons,2011.
[4] R. E. Kalman, “A new approach to linear filtering and prediction
problems,”TransactionsoftheASME–JournalofBasicEngineering,
vol.82,no.SeriesD,pp.35–45,1960.
[5] K. J. Friston, N. Trujillo-Barreto, and J. Daunizeau, “Dem: a varia-
tionaltreatmentofdynamicsystems,”Neuroimage,vol.41,no.3,pp.
849–885,2008.
[6] A. A. Meera and M. Wisse, “Free energy principle based state and
inputobserverdesignforlinearsystemswithcolorednoise,”in2020
AmericanControlConference(ACC). IEEE,2020,pp.5052–5058.
[7] K.Friston,“Thefree-energyprinciple:aunifiedbraintheory?”Nature
reviewsneuroscience,vol.11,no.2,pp.127–138,2010.
[8] ——,“Thefree-energyprinciple:aroughguidetothebrain?”Trends
incognitivesciences,vol.13,no.7,pp.293–301,2009.
[9] K. J. Friston, J. Daunizeau, J. Kilner, and S. J. Kiebel, “Action and
behavior:afree-energyformulation,”Biologicalcybernetics,vol.102,
no.3,pp.227–260,2010.
[10] R. L. Carhart-Harris and K. J. Friston, “The default-mode, ego-
functions and free-energy: a neurobiological account of freudian
ideas,”Brain,vol.133,no.4,pp.1265–1283,2010.
[11] G. Oliver, P. Lanillos, and G. Cheng, “Active inference body
perception and action for humanoid robots,” arXiv preprint
arXiv:1906.03022,2019.
[12] C.Pezzato,R.Ferrari,andC.H.Corbato,“Anoveladaptivecontroller
forrobotmanipulatorsbasedonactiveinference,”IEEERoboticsand
AutomationLetters,vol.5,no.2,pp.2973–2980,2020.
[13] A.AnilMeeraandM.Wisse,“Abraininspiredlearningalgorithmfor
theperceptionofaquadrotorinwind,Underreview,”2021.
[14] ——, “On the convergence of dem’s linear parameter estimator,
Accepted,”inInternationalWorkshoponActiveInference,2021.
[15] O. C¸atal, T. Verbelen, T. Van de Maele, B. Dhoedt, and A. Safron,
“Robotnavigationashierarchicalactiveinference,”NeuralNetworks,
vol.142,pp.192–204,2021.
[16] A. Bryson Jr and L. Henrikson, “Estimation using sampled data
containing sequentially correlated noise.” Journal of Spacecraft and
Rockets,vol.5,no.6,pp.662–665,1968.
[17] Z.Zhou,J.Wu,Y.Li,C.Fu,andH.Fourati,“Criticalissuesonkalman
filter with colored and correlated system noises,” Asian Journal of
Control,vol.19,no.6,pp.1905–1919,2017.
[18] B.A.CharandabiandH.J.Marquez,“Observerdesignfordiscrete-
time linear systems with unknown disturbances,” in 2012 IEEE 51st
IEEEConferenceonDecisionandControl(CDC). IEEE,2012,pp.
2563–2568.
[19] S.WaslanderandC.Wang,“Winddisturbanceestimationandrejection
forquadrotorpositioncontrol,”inAIAAInfotech@Aerospaceconfer-
enceandAIAAunmanned...Unlimitedconference,2009,p.1983.
[20] D. Abeywardena, Z. Wang, G. Dissanayake, S. L. Waslander, and
S. Kodagoda, “Model-aided state estimation for quadrotor micro air
vehicles amidst wind disturbances,” in 2014 IEEE/RSJ International
ConferenceonIntelligentRobotsandSystems. IEEE,2014,pp.4813–
4818.
[21] C. L. Buckley, C. S. Kim, S. McGregor, and A. K. Seth, “The free
energy principle for action and perception: A mathematical review,”
JournalofMathematicalPsychology,vol.81,pp.55–79,2017.
[22] K. Friston, “Hierarchical models in the brain,” PLoS computational
biology,vol.4,no.11,p.e1000211,2008.
[23] K.Friston,J.Mattout,N.Trujillo-Barreto,J.Ashburner,andW.Penny,
“Variationalfreeenergyandthelaplaceapproximation,”Neuroimage,
vol.34,no.1,pp.220–234,2007.
[24] A. Anil Meera and M. Wisse, “Dynamic expectation maximiza-
tion algorithm for estimation of linear systems with colored noise
(Underreview),”2021.
[25] S. Bouabdallah, P. Murrieri, and R. Siegwart, “Design and control
of an indoor micro quadrotor,” in IEEE International Conference on
RoboticsandAutomation,2004.Proceedings.ICRA’04.2004,vol.5,
2004,pp.4393–4398Vol.5.
[26] D. Benders, “Ar.drone 2.0 state estimation using dynamic expecta-