Reward Maximisation through Discrete Active Inference
Lancelot Da Costa l.da-costa@imperial.ac.uk
Department of Mathematics
Imperial College London
London, SW7 2AZ, UK
Noor Sajid noor.sajid.18@ucl.ac.uk
Thomas Parr thomas.parr.12@ucl.ac.uk
Karl Friston k.friston@ucl.ac.uk
Wellcome Centre for Human Neuroimaging
University College London
London, WC1N 3AR, UK
Ryan Smith rsmith@laureateinstitute.org
Laureate Institute for Brain Research
Tulsa, OK 74136, United States
Abstract
Active inference is a probabilistic framework for modelling the behaviour of biological and artiﬁcial
agents, which derives from the principle of minimising free energy. In recent years, this framework
has successfully been applied to a variety of situations where the goal was to maximise reward,
oﬀering comparable and sometimes superior performance to alternative approaches. In this paper,
we clarify the connection between reward maximisation and active inference by demonstrating
how and when active inference agents perform actions that are optimal for maximising reward.
Precisely, we show the conditions under which active inference produces the optimal solution to
the Bellman equation—a formulation that underlies several approaches to model-based reinforce-
ment learning and control. On partially observed Markov decision processes, the standard active
inference scheme can produce Bellman optimal actions for planning horizons of 1, but not beyond.
In contrast, a recently developed recursive active inference scheme (sophisticated inference) can
produce Bellman optimal actions on any ﬁnite temporal horizon. We append the analysis with a
discussion of the broader relationship between active inference and reinforcement learning.
Keywords: Generative model; control as inference; dynamic programming; Bellman optimality;
model-based reinforcement learning; discrete-time stochastic optimal control; Bayesian inference;
Markov decision process
Contents
1 Introduction 2
1.1 Active inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
1.2 Reward maximisation through active inference? . . . . . . . . . . . . . . . . . . . . . 3
1.3 Organisation of paper . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
2 Reward maximisation on ﬁnite horizon MDPs 4
2.1 Basic deﬁnitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
2.2 Bellman optimal state-action policies . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2.3 Backward induction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
3 Active inference on ﬁnite horizon MDPs 7
3.1 Perception as inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
3.2 Planning as inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
1
arXiv:2009.08111v4  [cs.AI]  11 Jul 2022
4 Reward maximisation on MDPs through active inference 9
4.1 Reward maximisation as reaching preferences . . . . . . . . . . . . . . . . . . . . . . 9
4.2 Reward maximisation on MDPs with a temporal horizon of1 . . . . . . . . . . . . . 10
4.3 Reward maximisation on MDPs with ﬁnite temporal horizons . . . . . . . . . . . . . 12
5 Generalisation to POMDPs 13
5.1 Active inference on ﬁnite horizon POMDPs . . . . . . . . . . . . . . . . . . . . . . . 13
5.1.1 Perception as inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
5.1.2 Planning as inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
5.2 Maximising reward on POMDPs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
6 Discussion 16
6.1 Decision-making beyond reward maximisation . . . . . . . . . . . . . . . . . . . . . . 16
6.2 Learning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
6.3 Scaling active inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
7 Conclusion 18
A Active inference and reinforcement learning 28
A.1 Main diﬀerences between active inference and reinforcement learning . . . . . . . . . 29
A.2 Reward learning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
A.3 Solving the exploration-exploitation dilemma . . . . . . . . . . . . . . . . . . . . . . 32
B Proofs 33
B.1 Proof of Proposition 9 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
B.2 Proof of Proposition 10 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
B.3 Proof of Proposition 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
B.4 Proof of Lemma 14 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
B.5 Proof of Theorem 15 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
B.6 Proof of Theorem 16 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
B.7 Proof of Proposition 18 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
1. Introduction
1.1 Active inference
Active inference is a normative framework for modelling intelligent behaviour in biological and
artiﬁcial agents. It simulates behaviour by numerically integrating equations of motion thought to
describe the behaviour of biological systems, a description based on the free energy principle (Barp
et al., 2022; Friston, 2010; Friston et al., 2022; Ramstead et al., 2022). Active inference comprises
a collection of algorithms for modelling perception, learning, and decision-making in the context of
both continuous and discrete state spaces (Barp et al., 2022; Buckley et al., 2017; Da Costa et al.,
2020; Friston et al., 2021, 2010, 2017c). Brieﬂy, building active inference agents entails:1) equipping
the agent with a (generative) model of the environment,2) ﬁtting the model to observations through
approximate Bayesian inference by minimising variational free energy (i.e., optimising an evidence
lower bound (Beal, 2003; Bishop, 2006; Blei et al., 2017; Jordan et al., 1998)) and3) selecting
actions that minimise expected free energy, a quantity that that can be decomposed into risk (i.e.,
the divergence between predicted and preferred paths) and ambiguity, leading to context-speciﬁc
combinations of exploratory and exploitative behaviour (Millidge, 2021; Schwartenbeck et al., 2019).
This framework has been used to simulate and explain intelligent behaviour in neuroscience (Adams
et al., 2013; Parr, 2019; Parr et al., 2021; Sajid et al., 2022), psychology and psychiatry (Smith et al.,
2020a,b,d, 2021a,b,c,d, 2022b), machine learning (Çatal et al., 2020; Fountas et al., 2020; Mazzaglia
2
et al., 2021; Millidge, 2020; Tschantz et al., 2019, 2020a) and robotics (Çatal et al., 2021; Lanillos
et al., 2020; Oliver et al., 2021; Pezzato et al., 2020; Pio-Lopez et al., 2016; Sancaktar et al., 2020;
Schneider et al., 2022).
1.2 Reward maximisation through active inference?
In contrast, the traditional approaches towards simulating and explaining intelligent behaviour—
stochastic optimal control (Bellman, 1957; Bertsekas and Shreve, 1996) and reinforcement learning
(RL;BartoandSutton(1992))—derivefromthenormativeprincipleofexecutingactionstomaximise
reward scoring the utility aﬀorded by each state of the world. This idea dates back to expected utility
theory (Von Neumann and Morgenstern, 1944), an economic model of rational choice behaviour,
which also underwrites game theory (Von Neumann and Morgenstern, 1944) and decision theory
(Berger, 1985; Dayan and Daw, 2008). Several empirical studies have shown that active inference can
successfully perform tasks that involve collecting reward, often (but not always) showing comparative
or superior performance to RL (Cullen et al., 2018; Marković et al., 2021; Mazzaglia et al., 2021;
Millidge, 2020; Paul et al., 2021; Sajid et al., 2021a; Smith et al., 2020d, 2021b,c, 2022b; van der
Himst and Lanillos, 2020), and marked improvements when interacting with volatile environments
(Marković et al., 2021; Sajid et al., 2021a). Given the prevalence and historical pedigree of reward
maximisation, we ask:
How and when do active inference agents execute actions that are optimal with respect to reward
maximisation?
1.3 Organisation of paper
Inthispaper, weexplain(andprove)howandwhenactiveinferenceagentsexhibit(Bellman)optimal
reward maximising behaviour.
For this, we start by restricting ourselves to the simplest problem: maximising reward on a ﬁnite
horizon Markov decision process (MDP) with known transition probabilities—a sequential decision-
making task with complete information. In this setting, we review the backward induction algorithm
from dynamic programming, which forms the workhorse of many optimal control and model-based
RL algorithms. This algorithm furnishes a Bellman optimal state-action mapping, which means that
it provides provably optimal decisions from the point of view of reward maximisation (Section 2).
We then introduce active inference on ﬁnite horizon MDPs (Section 3)—a scheme consisting of
perception as inference followed by planning as inference, which selects actions so that future states
best align with preferred states.
In Section 4, we show how and when active inference maximises reward in MDPs. Speciﬁcally,
when the preferred distribution is a (uniform mixture of) Dirac distribution(s) over reward maximis-
ing trajectories, selectingaction sequencesaccording to active inference maximises reward (Section
4.1). Yet, active inference agents, in their standard implementation, can selectactions that max-
imise reward only when planning one step ahead (Section 4.2). It takes a recursive,sophisticated
form of active inference to select actions that maximise reward—in the sense of a Bellman optimal
state-action mapping—on any ﬁnite time-horizon (Section 4.3).
In Section 5, we introduce active inference on partially observable Markov decision processes with
known transition probabilities—a sequential decision-making task where states need to be inferred
from observations—and explain how the results from the MDP setting generalise to this setting.
Our ﬁndings are summarised in Section 7.
All of our analyses assume that the agent knows the environmental dynamics (i.e., transition
probabilities) and reward function. In Appendix A, we discuss how active inference agents can
learn their world model and rewarding states when these are initially unknown—and the broader
relationship between active inference and RL.
3
Figure 1: Finite horizon Markov decision process.This is a Markov decision process pictured
as a Bayesian network (Jordan et al., 1998; Pearl, 1998). A ﬁnite horizon MDP comprises
a ﬁnite sequence of states, indexed in time. The transition from one state to the next
state depends on action. As such, for any given action sequence, the dynamics of the
MDP form a Markov chain on state-space. In this fully observed setting, actions can be
selected under a state-action policy,Π, indicated with a dashed line: this is a probabilistic
mapping from state-space and time to actions.
2. Reward maximisation on ﬁnite horizon MDPs
Inthissection, weconsidertheproblemofrewardmaximisationinMarkovdecisionprocesses(MDPs)
with known transition probabilities.
2.1 Basic deﬁnitions
MDPsareaclassofmodelsspecifyingenvironmentaldynamicswidelyusedindynamicprogramming,
model-based RL, and more broadly in engineering and artiﬁcial intelligence (Barto and Sutton,
1992; Stone, 2019). They are used to simulate sequential decision-making tasks with the objective
of maximising a reward or utility function. An MDP speciﬁes environmental dynamics unfolding in
discrete space and time under the actions pursued by an agent.
Deﬁnition 1 (Finite horizon MDP). A ﬁnite horizon MDP comprises the following collection of
data:
• S a ﬁnite set of states.
• T = {0,...,T }a ﬁnite set which stands for discrete time.T is the temporal horizon (a.k.a.
planning horizon).
• A is a ﬁnite set of actions.
• P(st = s′|st−1 = s,at−1 = a) is the probability that actiona∈A in states∈S at timet−1
will lead to states′∈S at timet. st are random variables overS that correspond to the state
being occupied at timet= 0,...,T .
• P(s0 = s) speciﬁes the probability of being at states∈S at the start of the trial.
• R(s) is the ﬁnite reward received by the agent when at states∈S.
The dynamics aﬀorded by a ﬁnite horizon MDP (see Figure 1) can be written globally as a proba-
bility distribution over state trajectoriess0:T := (s0,...,s T), given a sequence of actionsa0:T−1 :=
(a0,...,a T−1), which factorises as follows:
P(s0:T |a0:T−1) = P(s0)
T∏
τ=1
P(sτ |sτ−1,aτ−1).
4
Remark 2 (On the deﬁnition of reward). More generally, the reward function can be taken to be
dependent on the previous action and previous state:Ra(s′|s) is the reward received after transi-
tioning from states to state s′, due to actiona (Barto and Sutton, 1992; Stone, 2019). However,
given an MDP with such a reward function, we can recover our simpliﬁed setting by deﬁning a new
MDP where the new states comprise the previous action, previous state, and current state in the
original MDP. By inspection, the resulting reward function on the new MDP depends only on the
current state (i.e.,R(s)).
Remark 3 (Admissible actions). In general, it is possible that onlysome actions can be taken at
each state. In this case, one deﬁnesAs to be the ﬁnite set of (allowable) actions from states∈S.
All forthcoming results concerning MDPs can be extended to this setting.
To formalise what it means to choose actions in each state, we introduce the notion of a state-
action policy.
Deﬁnition 4(State-action policy). A state-action policyΠ is a probability distribution over actions,
that depends on the state that the agent occupies, and time. Explicitly,
Π : A ×S ×T →[0,1]
(a,s,t ) ↦→Π(a|s,t)
∀(s,t) ∈S ×T :
∑
a∈A
Π(a|s,t) = 1.
When st = s, we will writeΠ(a|st) := Π(a|s,t). Note that the action at the temporal horizonT is
redundant, as no further reward can be reaped from the environment. Therefore, one often speciﬁes
state-action policies only up to timeT −1, asΠ : A ×S ×{0,...,T −1}→ [0,1]. The state-action
policy—as deﬁned here—can be regarded as a generalisation of a deterministic state-action policy
that assigns the probability of1 to an available action and0 otherwise.
Remark 5 (Conﬂicting terminologies: policy in active inference). In active inference, apolicy is
deﬁned as a sequence of actions indexed in time1. To avoid terminological confusion, we useaction
sequences to denote policies under active inference.
At timet, the goal is to select an action that maximises future cumulative reward:
R(st+1:T) :=
T∑
τ=t+1
R(sτ).
Speciﬁcally, this entails following a state-action policyΠ that maximises thestate-value function:
vΠ(s,t) := EΠ[R(st+1:T) |st = s]
for any (s,t) ∈S ×T. The state-value function scores the expected cumulative reward if the
agent pursues state-action policyΠ from the state st = s. When the state st = s is clear from
context, we will often writevΠ(st) := vΠ(s,t). Loosely speaking, we will call the expected reward
the return.
Remark 6 (Notation EΠ). Whilst standard in RL (Barto and Sutton, 1992; Stone, 2019), the
notation EΠ[R(st+1:T) |st = s] can be confusing. It denotes the expected reward, under the transition
probabilities of the MDP and a state-action policyΠ
EP(st+1:T|at:T−1,st=s)Π(at:T−1|st+1:T−1,st=s)[R(st+1:T)].
It is important to keep this correspondence in mind, as we will use both notations depending on
context.
1. These are analogous to temporally extended actions oroptions introduced under the options framework in
RL (Stolle and Precup, 2002).
5
Remark 7(Temporal discounting). In inﬁnite horizon MDPs (i.e., whenT is inﬁnite), RL often
seeks to maximise the discounted sum of rewards
vΠ(s,t) := EΠ
[ ∞∑
τ=t
γτ−tR(sτ+1) |st = s
]
,
for a given temporal discounting termγ ∈(0,1) (Barto and Sutton, 1992; Bertsekas and Shreve,
1996; Kaelbling et al., 1998). In fact, temporal discounting is added to ensure that the inﬁnite sum of
future rewards converges to a ﬁnite value (Kaelbling et al., 1998). In ﬁnite horizon MDPs temporal
discounting is not necessary so we setγ = 1 (c.f., (Schmidhuber, 2006, 2010)).
To ﬁnd the best state-action policies, we would like to rank them in terms of their return. We
introduce a partial ordering such that a state-action policy isbetter than another if it yields a higher
return in any situation:
Π ≥Π′ ⇐⇒ ∀(s,t) ∈S ×T : vΠ(s,t) ≥vΠ′(s,t).
Similarly, a state-action policyΠ is strictly betterthan anotherΠ′if it yields strictly higher returns:
Π >Π′ ⇐⇒Π ≥Π′and ∃(s,t) ∈S ×T : vΠ(s,t) >vΠ′(s,t).
2.2 Bellman optimal state-action policies
A state-action policy is Bellman optimal if it is better than all alternatives.
Deﬁnition 8(Bellman optimality). A state-action policyΠ∗is Bellman optimalif and only if it is
better than all other state-action policies:
Π∗≥Π,∀Π.
In other words, it maximises the state-value functionvΠ(s,t) for any states at timet.
It is important to verify that this concept is not vacuous.
Proposition 9 (Existence of Bellman optimal state-action policies). Given a ﬁnite horizon MDP
as speciﬁed in Deﬁnition 1, there exists a Bellman optimal state-action policyΠ∗.
A proof can be found in Appendix B.1. Note that uniqueness of the Bellman optimal state-action
policy is not implied by Proposition 9; indeed, multiple Bellman optimal state-action policies may
exist (Bertsekas and Shreve, 1996; Puterman, 2014).
Now that we know that Bellman optimal state-action policies exist, we can characterise them as
a return-maximising action followed by a Bellman optimal state-action policy.
Proposition 10 (Characterisation of Bellman optimal state-action policies). For a state-action
policy Π, the following are equivalent:
1. Π is Bellman optimal.
2. Π is both
(a) Bellman optimal when restricted to{1,...,T }. In other words,∀state-action policyΠ′
and (s,t) ∈S ×{1,...T }
vΠ(s,t) ≥vΠ′(s,t).
(b) At time0, Π selects actions that maximise return:
Π(a|s,0) >0 ⇐⇒a∈arg max
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a], ∀s∈S. (1)
A proof can be found in Appendix B.2. Note that this characterisation oﬀers a recursive way to
construct Bellman optimal state-action policies by successively selecting the best action, as speciﬁed
by (1), starting fromT and inducting backwards (Puterman, 2014).
6
2.3 Backward induction
Proposition 10 suggests a straightforward recursive algorithm to construct Bellman optimal state-
action policies known as backward induction (Puterman, 2014). Backward induction has a long
history. It was developed by the German mathematician Zermelo in 1913 to prove that chess has
Bellman optimal strategies (Zermelo, 1913). In stochastic control, backward induction is one of the
main methods for solving the Bellman equation (Adda and Cooper, 2003; Miranda and Fackler, 2002;
Sargent, 2000). In game theory, the same method is used to compute sub-game perfect equilibria in
sequential games (Fudenberg and Tirole, 1991).
Backward induction entails planning backwards in time, from a goal state at the end of a problem,
by recursively determining the sequence of actions that enables reaching the goal. It proceeds by ﬁrst
considering the last time at which a decision might be made and choosing what to do in any situation
at that time in order to get to the goal state. Using this information, one can then determine what
to do at the second-to-last decision time. This process continues backwards until one has determined
the best action for every possible situation or state at every point in time.
Proposition11 (Backwardinduction: constructionofBellmanoptimalstate-actionpolicies) . Back-
ward induction
Π(a|s,T −1) >0 ⇐⇒a∈arg max
a∈A
E[R(sT) |sT−1 = s,aT−1 = a], ∀s∈S
Π(a|s,T −2) >0 ⇐⇒a∈arg max
a∈A
EΠ[R(sT−1:T) |sT−2 = s,aT−2 = a], ∀s∈S
...
Π(a|s,0) >0 ⇐⇒a∈arg max
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a], ∀s∈S
(2)
deﬁnes a Bellman optimal state-action policyΠ. Furthermore, this characterisation is complete: all
Bellman optimal state-action policies satisfy the backward induction relation(2).
A proof can be found in Appendix B.3.
Example 1(Intuition for backward induction). To give a concrete example of this kind of planning,
backward induction(2) would consider the actions below in the following order:
1. Desired goal: I would like to go to the grocery store,
2. Intermediate action: I need to drive to the store,
3. Current best action: I should put my shoes on.
Proposition 11 tells us that to be optimal with respect to reward maximisation, one must plan like
backward induction. This will be central to our analysis of reward maximisation in active inference.
3. Active inference on ﬁnite horizon MDPs
We now turn to introducing active inference agents on ﬁnite horizon MDPs with known transition
probabilities. We assume that the agent’s generative model of its environment is given by the
previously deﬁned ﬁnite horizon MDP (see Deﬁnition 1). We do not consider the case where the
transitions have to be learned but comment on it in the Appendix A.2 (see also (Da Costa et al.,
2020; Friston et al., 2016)).
In what follows, we ﬁx a timet≥0 and suppose that the agent has been in statess0,...,s t. To
ease notation, we let⃗ s:= st+1:T,⃗ a:= at:T be the future states and future actions. We deﬁneQ to
be thepredictive distribution, which encodes the predicted future states and actions given that the
agent is in statest
Q(⃗ s,⃗ a|st) :=
T−1∏
τ=t
Q(sτ+1 |aτ,sτ)Q(aτ |sτ).
7
3.1 Perception as inference
In active inference, perception entails inferences about future, past, and current states given observa-
tions and a sequence of actions. When states are partially observed, this is done through variational
Bayesian inference by minimising a free energy functional (a.k.a. an evidence bound (Beal, 2003;
Bishop, 2006; Blei et al., 2017; Wainwright and Jordan, 2007)).
IntheMDPsetting, pastandcurrentstatesareknown, soitisonlynecessarytoinferfuturestates
given the current state and action sequenceP(⃗ s|⃗ a,st). These posterior distributionsP(⃗ s|⃗ a,st) can
be computed exactly in virtue of the fact that the transition probabilities of the MDP are known;
hence variational inference becomes exact Bayesian inference.
Q(⃗ s|⃗ a,st) := P(⃗ s|⃗ a,st) =
T−1∏
τ=t
P(sτ+1 |sτ,aτ). (3)
3.2 Planning as inference
Now that the agent has inferred future states given alternative action sequences, we must assess these
alternative plans by examining the resulting state trajectories. The objective that active inference
agents optimise—in order to select the best possible actions—is theexpected free energy(Barp et al.,
2022; Da Costa et al., 2020; Friston et al., 2021). Under active inference, agents minimise expected
free energy in order to maintain themselves distributed according to a target distributionC over the
state-space S encoding the agent’s preferences.
Deﬁnition 12(Expected free energy on MDPs). On MDPs, the expected free energy of an action
sequence⃗ astarting fromst is deﬁned as (Barp et al., 2022):
G(⃗ a|st) = DKL[Q(⃗ s|⃗ a,st) |C(⃗ s)] (4)
Therefore, minimising expected free energy corresponds to making the distribution over predicted
states close to the distributionC that encodes prior preferences. Note that the expected free energy
in partially observed MDPscomprises an additional ambiguity term (see Section 5), which is dropped
here as there is no ambiguity about observed states.
Since the expected free energy assesses the goodness of inferred future states under a course of
action, we can refer to planning as inference (Attias, 2003; Botvinick and Toussaint, 2012). The
expected free energy may be rewritten as
G(⃗ a|st) = EQ(⃗ s|⃗ a,st)[−log C(⃗ s)]  
Expected surprise
− H[Q(⃗ s|⃗ a,st)]  
Entropy of future states
(5)
Hence, minimisingexpectedfreeenergyminimisestheexpectedsurpriseofstates 2 accordingto Cand
maximises the entropy of Bayesian beliefs over future states (a maximum entropy principle (Jaynes,
1957a), which is sometimes cast as keeping options open (Klyubin et al., 2008)).
Remark 13(Numerical tractability). The expected free energy is straightforward to compute using
linear algebra. Given an action sequence⃗ a, C(⃗ s) and Q(⃗ s|⃗ a,st) are categorical distributions over
ST−t. Let their parameters bec,s⃗ a∈[0,1]|S|(T−1), where|·| denotes the cardinality of a set. Then
the expected free energy reads
G(⃗ a|st) = sT
⃗ a(log s⃗ a−log c). (6)
2. The surprise (a.k.a. self information or surprisal) of states−log C(⃗ s) is information theoretic nomenclature (Stone,
2015) that scores the extent to which an observation is unusual underC. It does not imply that the agent
experiences surprise in a subjective or declarative sense.
8
Notwithstanding, (6) is expensive to evaluate repeatedly when all possible action sequences are con-
sidered. In practice, one can adopt a temporal mean ﬁeld approximation over future states (Millidge
et al., 2020a):
Q(⃗ s|⃗ a,st) ≈
T∏
τ=t+1
Q(sτ |⃗ a,st),
which yields the simpliﬁed expression
G(⃗ a|st) ≈
T∑
τ=t+1
DKL[Q(sτ |⃗ a,st) |C(sτ)]. (7)
Expression (7) is much easier to handle: for each action sequence⃗ a, 1) one evaluates the sum-
mands sequentiallyτ = t+ 1,...,T , and 2) if and when the sum up toτ becomes signiﬁcantly higher
than the lowest expected free energy encountered during planning,G(⃗ a|st) is set to an arbitrarily
high value. SettingG(⃗ a|st) to a high value is equivalent to pruning away unlikely trajectories. This
bears some similarity to decision tree pruning procedures used in RL (Huys et al., 2012). It ﬁnesses
exploration of the decision-tree in full depth and provides an Occam’s window for selecting action
sequences.
Complementary approaches can help make planning tractable. For example, hierarchical gener-
ative models factorise decisions into multiple levels. By abstracting information at a higher-level,
lower-levels entertain fewer actions (Friston et al., 2018)—which reduces the depth of the decision
tree by orders of magnitude. Another approach is to use algorithms that search the decision-tree
selectively, such as Monte-Carlo tree search (Champion et al., 2021a,b; Fountas et al., 2020; Maisto
et al., 2021; Silver et al., 2016), and amortising planning using artiﬁcial neural networks (i.e.,
learning to plan) (Çatal et al., 2020; Fountas et al., 2020; Sajid et al., 2021b).
4. Reward maximisation on MDPs through active inference
Here, we show how active inference solves the reward maximisation problem.
4.1 Reward maximisation as reaching preferences
From the deﬁnition of expected free energy (4), active inference on MDPs can be thought of as
reaching and remaining at a target distributionC over state-space.
The idea that underwrites this section is that when the stationary distribution has all of its
mass on reward maximising states, the agent will maximise reward. To illustrate this, we deﬁne a
preference distributionCβ,β >0 over state-spaceS, such that preferred states are rewarding states3
Cβ(σ) := exp βR(σ)∑
ς∈S exp βR(ς) ∝exp(βR(σ)), ∀σ∈S
⇐⇒ −log Cβ(σ) = −βR(σ) −c(β), ∀σ∈S, for somec(β) ∈R constant w.r.tσ.
The (inverse temperature) parameterβ >0 scores how motivated the agent is to occupy reward
maximising states. Note that states s ∈S that maximise the rewardR(s) maximise Cβ(s) and
minimise −log Cβ(s) for anyβ >0.
Using the additive property of the reward function, we can extendCβ to a probability distribution
over trajectories ⃗ σ:= ( σ1,...,σ T) ∈ST. Speciﬁcally, Cβ scores to what extent a trajectory is
preferred over another trajectory:
3. Note the connection with statistical mechanics:β is an inverse temperature parameter,−Ris a potential function
and Cβ is the corresponding Gibbs distribution (Pavliotis, 2014; Rahme and Adams, 2019).
9
Cβ(⃗ σ) := exp βR(⃗ σ)∑
⃗ ς∈ST exp βR(⃗ ς) =
T∏
τ=1
exp βR(στ)∑
ς∈S exp βR(ς) =
T∏
τ=1
Cβ(στ), ∀⃗ σ∈ST
⇐⇒ −log Cβ(⃗ σ) = −βR(⃗ σ) −c′(β) = −
T∑
τ=1
βR(στ) −c′(β), ∀⃗ σ∈ST,
(8)
where c′(β) := c(β)T ∈R is constant w.r.t⃗ σ.
When the preferences are deﬁned in this way, the zero-temperature limitβ →+∞is the case
where the preferencesCβ are non-zero only for states or trajectories that maximise reward. In this
case, limβ→+∞Cβ is a uniform mixture of Dirac distributions over reward maximising trajectories:
lim
β→+∞
Cβ ∝
∑
⃗ s∈IT−t
Dirac⃗ s
I := arg max
s∈S
R(s).
(9)
This is because, for a reward maximising stateσ, exp(βR(σ)) will converge to+∞more quickly
than exp(βR(σ′)) for a non-reward maximising stateσ′. SinceCβ is constrained to be normalised to
1 (as it is a probability distribution),Cβ(σ′)
β→+∞
−−−−−→0. Hence, in the limitβ →+∞, Cβ is non-zero
(and uniform) only on reward maximising states.
We now show how reaching preferred states can be formulated as reward maximisation:
Lemma 14. The sequence of actions that minimises expected free energy also maximises expected
reward in the zero temperature limitβ →+∞(9):
lim
β→+∞
arg min
⃗ a
G(⃗ a|st) ⊆arg max
⃗ a
EQ(⃗ s|⃗ a,st)[R(⃗ s)]
Furthermore, of those action sequences that maximise expected reward, the expected free energy
minimisers will be those that maximise the entropy of future statesH[Q(⃗ s|⃗ a,st)].
A proof can be found in Appendix B.4. In the zero temperature limitβ →+∞, minimising
expected free energy corresponds to choosing the action sequence⃗ asuch thatQ(⃗ s|⃗ a,st) has most
mass on reward maximising states or trajectories (see Figure 2). Of those reward maximising
candidates, the minimiser of expected free energy maximises the entropy of future statesH[Q(⃗ s|
⃗ a,st)], thus leaving options open.
4.2 Reward maximisation on MDPs with a temporal horizon of1
In this section, we ﬁrst consider the case of a single-step decision problem (i.e., a temporal horizon of
T = 1) and demonstrate how the standard active inference scheme maximises reward on this problem
in the limitβ →+∞. This will act as an important building block for when we subsequently consider
more general multi-step decision problems.
The standard decision-making procedure in active inference consists of assigning each action
sequence with a probability given by the softmax of the negative expected free energy (Barp et al.,
2022; Da Costa et al., 2020; Friston et al., 2017a)
Q(⃗ a|st) ∝exp(−G(⃗ a|st)).
Agents then select the most likely action under this distribution
at ∈arg max
a∈A
Q(a|st) = arg max
a∈A
∑
⃗ a
Q(a|⃗ a)Q(⃗ a|st)
= arg max
a∈A
∑
⃗ a
Q(a|⃗ a) exp(−G(⃗ a|st)) = arg max
a∈A
∑
⃗ a
(⃗ a)t=a
exp(−G(⃗ a|st)).
10
Figure 2: Reaching preferences and the zero temperature limit.We illustrate how active
inference selects actions such thatQ(⃗ s|⃗ a,st) most closely matches the preference distri-
bution Cβ (top-right). In this example, the discrete state-space is a discretisation of a
continuous interval inR, and the preferences and predictive distributions over states have
a Gaussian shape. The predictive distributionQis assumed to have a ﬁxed variance with
respect to action sequences, such that the only parameter that can be optimised by action
selection is its mean. Crucially, in the zero temperature limit (9),limβ→+∞Cβ becomes a
Dirac distribution over the reward maximising state (bottom). Thus, minimising expected
free energy corresponds to selecting the action such that the predicted states assign most
mass to the reward maximising state (bottom-right). Q∗ := Q(⃗ s|⃗ a∗,st) denotes the
predictive distribution over states given the action sequence that minimises expected free
energy ⃗ a∗= arg min⃗ aG(⃗ a|st).
In summary, this scheme selects the ﬁrst action within action sequences that, on average, max-
imise their exponentiated negative expected free energies. As a corollary, if the ﬁrst action is in a
sequence with a very low expected free energy, this adds an exponentially large contribution to the
selection of this particular action. We summarise this scheme in Table 1.
Process Computation
Perceptual inference Q(⃗ s|⃗ a,st) = P(⃗ s|⃗ a,st) = ∏T−1
τ=t P(sτ+1 |sτ,aτ)
Planning as inference G(⃗ a|st) = DKL[Q(⃗ s|⃗ a,st) |C(⃗ s)]
Decision-making Q(⃗ a|st) ∝exp(−G(⃗ a|st))
Action selection at ∈arg maxa∈A [Q(at = a|st) = ∑
⃗ aQ(at = a|⃗ a)Q(⃗ a|st)]
Table 1: Standard active inference scheme on ﬁnite horizon MDPs (Barp et al., 2022).
Theorem 15. In MDPs with known transition probabilities and in the zero temperature limitβ →
+∞(9), the scheme of Table 1
at ∈ lim
β→+∞
arg max
a∈A
∑
⃗ a
(⃗ a)t=a
exp(−G(⃗ a|st)), G (⃗ a|st) = DKL[Q(⃗ s|⃗ a,st) |Cβ(⃗ s)] (10)
is Bellman optimal for the temporal horizonT = 1.
11
A proof can be found in Appendix B.5. Importantly,the standard active inference scheme(10)
falls short in terms of Bellman optimality on planning horizons greater than one; this rests upon
the fact that it does not coincide with backward induction. Recall that backward induction oﬀers a
complete description of Bellman optimal state-action policies (Proposition 11). In contrast, active
inference plans by adding weighted expected free energies of each possible future course of action.
In other words, unlike backward induction, it considers future courses of action beyond the subset
that will subsequently minimise expected free energy, given subsequently encountered states.
4.3 Reward maximisation on MDPs with ﬁnite temporal horizons
To achieve Bellman optimality on ﬁnite temporal horizons, we turn to the expected free energy of
an action given future actions that also minimise expected free energy. To do this we can write the
expected free energy recursively, as the immediate expected free energy, plus the expected free energy
that one would obtain by subsequently selecting actions that minimise expected free energy (Friston
et al., 2021). The resulting scheme consists of minimising an expected free energy deﬁned recursively,
from the last time step to the current timestep. In ﬁnite horizon MDPs, this reads
G(aT−1 |sT−1) = DKL[Q(sT |aT−1,sT−1) |Cβ(sT)]
G(aτ |sτ) = DKL[Q(sτ+1 |aτ,sτ) |Cβ(sτ+1)]
+ EQ(aτ+1,sτ+1|aτ,sτ)[G(aτ+1 |sτ+1)], τ = t,...,T −2,
where, at each time-step, actions are chosen to minimise expected free energy
Q(aτ+1 |sτ+1) >0 ⇐⇒aτ+1 ∈arg min
a∈A
G(a|sτ+1). (11)
To make sense of this formulation, we unravel the recursion
G(at |st) = DKL[Q(st+1 |at,st) |Cβ(st+1)] + EQ(at+1,st+1|at,st)[G(at+1 |st+1)]
= DKL[Q(st+1 |at,st) |Cβ(st+1)] + EQ(at+1,st+1|at,st) [DKL[Q(st+2 |at+1,st+1) |Cβ(st+2)]]
+ EQ(at+1:t+2,st+1:t+2|at,st)[G(at+2 |st+2)]
= ... = EQ(⃗ a,⃗ s|at,st)
T−1∑
τ=t
DKL[Q(sτ+1 |aτ,sτ) |Cβ(sτ+1)]
= EQ(⃗ a,⃗ s|at,st) DKL[Q(⃗ s|⃗ a,st) |Cβ(⃗ s)],
(12)
which shows that this expression is exactly the expected free energy under actionat, if one is to
pursue future actions that minimise expected free energy (11). We summarise this ’sophisticated
inference’ scheme in Table 2.
Process Computation
Perceptual inference Q(sτ+1 |aτ,sτ) = P(sτ+1 |aτ,sτ)
Planning as inference G(aτ |sτ) = DKL[Q(sτ+1 |aτ,sτ) |Cβ(sτ+1)] ...
... + EQ(aτ+1,sτ+1|aτ,sτ)[G(aτ+1 |sτ+1)]
Decision-making Q(aτ |sτ) >0 ⇐⇒aτ ∈arg mina∈A G(a|sτ)
Action selection at ∼Q(at |st)
Table 2: Sophisticated active inference scheme on ﬁnite horizon MDPs (Friston et al., 2021).
The crucial improvement over the standard active inference scheme (Table 1) is that planning is
now performed based on subsequent counterfactual actions that minimise expected free energy, as
12
opposed to considering all future courses of action. Translating this into the language of state-action
policies yields∀s∈S
aT−1(s) ∈arg min
a∈A
G(a|sT−1 = s)
aT−2(s) ∈arg min
a∈A
G(a|sT−2 = s)
...
a1(s) ∈arg min
a∈A
G(a|s1 = s)
a0(s) ∈arg min
a∈A
G(a|s0).
(13)
Equation (13) is strikingly similar to the backward induction algorithm (Proposition 11), and
indeed we recover backward induction in the limitβ →+∞.
Theorem 16(Backward induction as active inference). In MDPs with known transition probabili-
ties, and in the zero temperature limitβ →+∞(9), the scheme of Table 2
Q(aτ |sτ) >0 ⇐⇒at ∈ lim
β→+∞
arg min
a∈A
G(a|sτ)
G(aτ |sτ) = DKL[Q(sτ+1 |aτ,sτ) |Cβ(sτ+1)] + EQ(aτ+1,sτ+1|aτ,sτ)[G(aτ+1 |sτ+1)]
(14)
is Bellman optimal on any ﬁnite temporal horizon as it coincides with the backward induction algo-
rithm from Proposition 11. Furthermore, if there are multiple actions that maximise future reward,
those that are selected by active inference also maximise the entropy of future statesH[Q(⃗ s|⃗ a,a,s0)].
Note that maximising the entropy of future states keeps the agent’s options open (Klyubin et al.,
2008) in the sense of committing the least to a speciﬁed sequence of states. A proof of Theorem 16
can be found in Appendix B.6.
5. Generalisation to POMDPs
Partially observable Markov decision processes (POMDPs) generalise MDPs in that the agent ob-
serves a modalityot, which carries incomplete information about the current statest, as opposed to
the current state itself.
Deﬁnition 17(Finite horizon POMDP). A ﬁnite horizon POMDP is an MDP (see Deﬁnition 1)
with the following additional data:
• O a ﬁnite set of observations.
• P(ot = o|st = s) is the probability that the states∈S at timet will lead to the observation
o ∈O at time t. ot are random variables overO that correspond to the observation being
sampled at timet= 0,...,T .
5.1 Active inference on ﬁnite horizon POMDPs
We brieﬂy introduce active inference agents on ﬁnite horizon POMDPs with known transition prob-
abilities (for more details, see (Da Costa et al., 2020; Parr et al., 2022; Smith et al., 2022a)). We
assume that the agent’s generative model of its environment is given by the previously deﬁned
POMDP (Deﬁnition 17)4.
4. We do not consider the case where the model parameters have to be learned but comment on it in Appendix A.2
(details in (Da Costa et al., 2020; Friston et al., 2016)).
13
Let ⃗ s:= s0:T,⃗ a:= a0:T−1 be all states and actions (past, present, and future), let˜o := o0:t be
the observations available up to timet, and⃗ o:= ot+1:T be the future observations. The agent has
a predictive distribution over states given actions
Q(⃗ s|⃗ a,˜o) :=
T−1∏
τ=0
Q(sτ+1 |aτ,sτ,˜o).
that is continuously updated following new observations.
5.1.1 Perception as inference
In active inference, perception entails inferences about (past, present, and future) states given ob-
servations and a sequence of actions. When states are partially observed, the posterior distribution
P(⃗ s|⃗ a,˜o) is intractable to compute directly. Thus, one approximates it by optimising a varia-
tional free energy functionalF⃗ a(a.k.a. an evidence bound (Beal, 2003; Bishop, 2006; Blei et al.,
2017; Wainwright and Jordan, 2007)) over a space of probability distributionsQ(·| ⃗ a,˜o) called the
variational family
P(⃗ s|⃗ a,˜o) = arg min
Q
F⃗ a[Q(⃗ s|⃗ a,˜o)] = arg min
Q
DKL[Q(⃗ s|⃗ a,˜o) |P(⃗ s|⃗ a,˜o)]
F⃗ a[Q(⃗ s|⃗ a,˜o)] := EQ(⃗ s|⃗ a,˜o)[log Q(⃗ s|⃗ a,˜o) −log P(˜o,⃗ s|⃗ a)].
(15)
Here, P(˜o,⃗ s|⃗ a) is the POMDP, which is supplied to the agent, andP(⃗ s|⃗ a,˜o). When the free
energy minimum (15) is reached, the inference is exact
Q(⃗ s|⃗ a,˜o) = P(⃗ s|⃗ a,˜o). (16)
For numerical tractability, the variational family may be constrained to a parametric family of
distributions, in which case equality is not guaranteed
Q(⃗ s|⃗ a,˜o) ≈P(⃗ s|⃗ a,˜o). (17)
5.1.2 Planning as inference
The objective that active inference minimises in order the select the best possible courses of action is
the expected free energy(Barp et al., 2022; Da Costa et al., 2020; Friston et al., 2021). In POMDPs,
the expected free energy reads (Barp et al., 2022)
G(⃗ a|˜o) = DKL[Q(⃗ s|⃗ a,˜o) |Cβ(⃗ s)]  
Risk
+ EQ(⃗ s|⃗ a,˜o) H[P(⃗ o|⃗ s)]  
Ambiguity
.
The expected free energy on POMDPs is the expected free energy on MDPs plus an extra term
called ambiguity. This ambiguity term accommodates the uncertainty implicit in partially observed
problems. The reason that this resulting functional is called expected free energy is because it com-
prises a relative entropy (risk) and expected energy (ambiguity). The expected free energy objective
subsumes several decision-making objectives that predominate in statistics, machine learning, and
psychology, which confers it with several useful properties when simulating behaviour (see Figure 3
for details).
5.2 Maximising reward on POMDPs
Crucially, our reward maximisation results translate to the POMDP case. To make this explicit, we
rehearse Lemma 14 in the context of POMDPs.
14
Figure 3: Active inference. The top panels illustrate the perception-action loop in active infer-
ence, in terms of minimisation of variational and expected free energy. The lower panels
illustrate how expected free energy relates to several descriptions of behaviour that pre-
dominate in the psychological, machine learning, and economics. These descriptions are
disclosed when one removes particular terms from the objective. For example, if we ignore
extrinsic value, we are left with intrinsic value, variously known as expected information
gain (Lindley, 1956; MacKay, 2003). This underwrites intrinsic motivation in machine
learning and robotics (Barto et al., 2013; Deci and Ryan, 1985; Oudeyer and Kaplan,
2007) and expected Bayesian surprise in visual search (Itti and Baldi, 2009; Sun et al.,
2011) and the organisation of our visual apparatus (Barlow, 1961, 1974; Linsker, 1990; Op-
tican and Richmond, 1987). In the absence of ambiguity, we are left with minimising risk,
which corresponds to aligning predicted states to preferred states. This leads to risk averse
decisions in behavioural economics (Kahneman and Tversky, 1979) and formulations of
control as inference in engineering such as KL control (van den Broek et al., 2010). If we
then remove intrinsic value, we are left with expected utility in economics (Von Neumann
and Morgenstern, 1944) that underwrites RL and behavioural psychology (Barto and Sut-
ton, 1992). Bayesian formulations of maximising expected utility under uncertainty are
also the basis of Bayesian decision theory (Berger, 1985). Finally, if we only consider a fully
observed environment with no preferences, minimising expected free energy corresponds
to a maximum entropy principle over future states (Jaynes, 1957a,b). Note that hereC(o)
denotes the preferences over observations derived from the preferences over states. These
are related byP(o|s)C(s) = P(s|o)C(o).
15
Proposition 18(Reward maximisation on POMDPs). In POMDPs with known transition probabil-
ities, provided that the free energy minimum is reached(16), the sequence of actions that minimises
expected free energy also maximises expected reward in the zero temperature limitβ →+∞(9):
lim
β→+∞
arg min
⃗ a
G(⃗ a|˜o) ⊆arg max
⃗ a
EQ(⃗ s|⃗ a,˜o)[R(⃗ s)].
Furthermore, of those action sequences that maximise expected reward, the expected free energy
minimisers will be those that maximise the entropy of future states minus the (expected) entropy of
outcomes given statesH[Q(⃗ s|⃗ a,˜o)] −EQ(⃗ s|at,˜o) H[P(⃗ o|⃗ s)]].
From Proposition 18 we see that if there are multiple maximise reward action sequences, those
that are selected maximise
H[Q(⃗ s|⃗ a,˜o)]  
Entropy of future states
− EQ(⃗ s|at,˜o)[H[P(⃗ o|⃗ s)]]  
Entropy of observations given future states
.
In other words, they least commit to a prespeciﬁed sequence of future states and ensure that their
expected observations are maximally informative of states. Of course, when inferences are inexact,
the extent to which Proposition 18 holds depends upon the accuracy of the approximation (17). A
proof of Proposition 18 can be found in Appendix B.7.
The schemes of Table 1 & 2 exist in the POMDP setting, (e.g., (Barp et al., 2022) and (Fris-
ton et al., 2021), respectively). Thus, in POMDPs with known transition probabilities, provided
that inferences are exact (16) and in the zero temperature limitβ →+∞(9), standard active
inference (Barp et al., 2022) maximises reward on temporal horizons of1 but not beyond, and a
recursive scheme such as sophisticated active inference (Friston et al., 2021) maximises reward on
ﬁnite temporal horizons. Note that, for computational tractability, the sophisticated active infer-
ence scheme presented in (Friston et al., 2021) does not generally perform exact inference; thus, the
extent to which it will maximise reward in practice will depend upon the accuracy of its inferences.
Nevertheless, our results indicate that sophisticated active inference will vastly outperform standard
active inference in most reward maximisation tasks.
6. Discussion
In this paper, we have examined a speciﬁc notion of optimality; namely, Bellman optimality; deﬁned
as selecting actions to maximise future expected rewards. We demonstrated how and when active
inference is Bellman optimal on ﬁnite horizon POMDPs with known transition probabilities and
reward function.
These results highlight important relationships between active inference, stochastic control, and
RL,aswellasconditionsunderwhichtheywouldandwouldnotbeexpectedtobehavesimilarly(e.g.,
environments with multiple reward-maximising trajectories, those aﬀording ambiguous observations,
etc.). We refer the reader to Appendix A for a broader discussion of the relationship between active
inference and reinforcement learning.
6.1 Decision-making beyond reward maximisation
More broadly, it is important to ask if reward maximisation is the right objective underwriting
intelligent decision-making? This is an important question for decision neuroscience. That is, do
humans optimise a reward signal, expected free energy, or other planning objectives. This can be
addressed by comparing the evidence for these competing hypotheses based on empirical data (e.g.,
see (Smith et al., 2020d, 2021b,c, 2022b)). Current empirical evidence suggests that humans are not
purely reward-maximising agents: they also engage in both random and directed exploration (Daw
et al., 2006; Gershman, 2018; Mirza et al., 2018; Schulz and Gershman, 2019; Wilson et al., 2014,
16
2021; Xu et al., 2021) and keep their options open (Schwartenbeck et al., 2015b). As we have
illustrated, active inference implements a clear form of directed exploration through minimising
expected free energy. Although not covered in detail here, active inference can also accommodate
random exploration by sampling actions from the posterior belief over action sequences, as opposed
to selecting the most likely action as presented in Tables 1 and 2.
Note that behavioural evidence favouring models that do not solely maximise reward within
reward maximisation tasks—i.e., where "maximise reward" is the explicit instruction—is not a
contradiction. Rather, gathering information about the environment (exploration) generally helps
to reap more reward in the long run, as opposed to greedily maximising reward based on imperfect
knowledge (Cullen et al., 2018; Sajid et al., 2021a). This observation is not new and many approaches
to simulating adaptive agents employed today diﬀer signiﬁcantly from their reward maximising
antecedents (Appendix A.3).
6.2 Learning
When the transition probabilities or reward function are unknown to the agent, the problem becomes
one of reinforcement learning (RL) (Shoham et al., 2003) as opposed to stochastic control. Although
we did not explicitly consider it above, this scenario can be accommodated by active inference by
simply equipping the generative model with a prior, and updating the model via variational Bayesian
inference to best ﬁt observed data. Depending on the speciﬁc learning problem and generative model
structure, this can involve updating the transition probabilities and/or the target distributionC.
In POMDPs it can also involve updating the probabilities of observations under each state. We
refer to Appendix A.2 for discussion of reward learning through active inference and connections to
representative RL approaches, and (Da Costa et al., 2020; Friston et al., 2016) for learning transition
probabilities through active inference.
6.3 Scaling active inference
When comparing RL and active inference approaches generally, one outstanding issue for active
inference is whether it can be scaled up to solve the more complex problems currently handled by
RL in machine learning contexts (Çatal et al., 2020, 2021; Fountas et al., 2020; Mazzaglia et al.,
2021; Millidge, 2020; Tschantz et al., 2019). This is an area of active research.
One important issue along these lines is that planning ahead by evaluating all or many possible
sequences of actions is computationally prohibitive in many applications. Three complementary
solutions that have emerged are: 1) employing hierarchical generative models that factorise decisions
into multiple levels and reduce the size of the decision tree by orders of magnitude (Çatal et al.,
2021; Friston et al., 2018; Parr et al., 2021), 2) eﬃciently searching the decision tree using algorithms
like Monte Carlo tree search (Champion et al., 2021a,b; Fountas et al., 2020; Maisto et al., 2021;
Silver et al., 2016), and 3) amortising planning using artiﬁcial neural networks (Çatal et al., 2020;
Fountas et al., 2020; Sajid et al., 2021b).
Another issue rests upon learning the generative model. Active inference may readily learn the
parameters of a generative model; however, more work needs to be done on devising algorithms for
learning the structure of generative models themselves (Friston et al., 2017b; Smith et al., 2020c).
This is an important research problem in generative modelling, called Bayesian model selection or
structure learning (Gershman and Niv, 2010; Tervo et al., 2016).
Note that these issues are not unique to active inference. Model-based RL algorithms deal with
the same combinatorial explosion when evaluating decision trees, which is one primary motivation for
developing eﬃcient model-free RL algorithms. However, other heuristics have also been developed
for eﬃciently searching and pruning decision trees in model-based RL, e.g., (Huys et al., 2012;
Lally et al., 2017). Furthermore, model-based RL suﬀers the same limitation regarding learning
generative model structure. Yet, RL may have much to oﬀer active inference in terms of eﬃcient
17
implementation and the identiﬁcation of methods to scale to more complex applications (Fountas
et al., 2020; Mazzaglia et al., 2021).
7. Conclusion
In summary, we have shown that under the speciﬁcation that the active inference agent prefers
maximising reward (9):
1. On ﬁnite horizon POMDPs with known transition probabilities, the objective optimised for
action selection in active inference (i.e., expected free energy) produces reward maximising
action sequences when state-estimation isexact. When there are multiple reward maximising
candidates, this selects those sequences that maximise the entropy of future states—thereby
keeping options open—and that minimise the ambiguity of future observations so that they
are are maximally informative. More generally, the extent to which action sequences will be
reward maximising will depend on the accuracy of state-estimation.
2. The standard active inference scheme (e.g., (Barp et al., 2022)) produces Bellman optimal
actions for planning horizons of1 when state-estimation is exact, but not beyond.
3. A sophisticated active inference scheme (e.g., (Friston et al., 2021)) produces Bellman opti-
mal actions on any ﬁnite planning horizon when state-estimation isexact. Furthermore, this
scheme generalises the well-known backward induction algorithm from dynamic programming
to partially observed environments. Note that, for computational eﬃciency, the scheme pre-
sented in (Friston et al., 2021) does not generally perform exact state-estimation; thus, the
extent to which it will maximise reward in practice will depend upon the accuracy of its infer-
ences. Nevertheless, it is clear from our results that sophisticated active inference will vastly
outperform standard active inference in most reward maximisation tasks.
Note that, for computational tractability, the sophisticated active inference scheme presented
in (Friston et al., 2021) does not generally perform exact inference; thus, the extent to which it
will maximise reward in practice will depend upon the accuracy of its inferences. Nevertheless, it
is clear from these results that sophisticated active inference will vastly outperform standard active
inference in most reward maximisation tasks.
Acknowledgements
The authors thank Dimitrije Markovic and Quentin Huys for providing helpful feedback during the
preparation of the manuscript.
Funding information
LD is supported by the Fonds National de la Recherche, Luxembourg (Project code: 13568875).
NS is funded by the Medical Research Council (MR/S502522/1) and 2021-2022 Microsoft PhD
Fellowship. KF is supported by funding for the Wellcome Centre for Human Neuroimaging (Ref:
205103/Z/16/Z), a Canada-UK Artiﬁcial Intelligence Initiative (Ref: ES/T01279X/1) and the Eu-
ropean Union’s Horizon 2020 Framework Programme for Research and Innovation under the Speciﬁc
Grant Agreement No. 945539 (Human Brain Project SGA3). RS is supported by the William K.
Warren Foundation, the Well-Being for Planet Earth Foundation, the National Institute for General
Medical sciences (P20GM121312), and the National Institute of Mental Health (R01MH123691).
This publication is based on work partially supported by the EPSRC Centre for Doctoral Training
in Mathematics of Random Systems: Analysis, Modelling and Simulation (EP/S023925/1).
18
Author contributions
LD: conceptualisation, proofs, writing – ﬁrst draft, review and editing. NS, TP, KF, RS: conceptu-
alisation, writing – review and editing.
References
Rick A. Adams, Klaas Enno Stephan, Harriet R. Brown, Christopher D. Frith, and Karl J. Friston.
The Computational Anatomy of Psychosis.Frontiers in Psychiatry, 4, 2013. ISSN 1664-0640. doi:
10.3389/fpsyt.2013.00047.
Jerome Adda and Russell W. Cooper.Dynamic Economics Quantitative Methods and Applications.
MIT Press, 2003.
Hagai Attias. Planning by Probabilistic Inference. In9th Int. Workshop on Artiﬁcial Intelligence
and Statistics, page 8, 2003.
H. B. Barlow.Possible Principles Underlying the Transformations of Sensory Messages. The MIT
Press, 1961. ISBN 978-0-262-31421-3.
H B Barlow. Inductive Inference, Coding, Perception, and Language. Perception, 3(2):123–134,
June 1974. ISSN 0301-0066. doi: 10.1068/p030123.
Alessandro Barp, Lancelot Da Costa, Guilherme França, Karl Friston, Mark Girolami, Michael I.
Jordan, and Grigorios A. Pavliotis. Geometric Methods for Sampling, Optimisation, Inference and
Adaptive Agents. In Geometry and Statistics, number 46 in Handbook of Statistics. Academic
Press, 2022. ISBN 978-0-323-91345-4.
Andrew Barto and Richard Sutton.Reinforcement Learning: An Introduction. 1992.
Andrew Barto, Marco Mirolli, and Gianluca Baldassarre. Novelty or Surprise?Frontiers in Psy-
chology, 4, 2013. ISSN 1664-1078. doi: 10.3389/fpsyg.2013.00907.
Matthew James Beal. Variational Algorithms for Approximate Bayesian Inference. PhD thesis,
University of London, 2003.
Richard E. Bellman.Dynamic Programming. Princeton University Press, Princeton, NJ, US, 1957.
ISBN 978-0-691-14668-3.
Richard E. Bellman and Stuart E. Dreyfus.Applied Dynamic Programming. Princeton University
Press, December 2015. ISBN 978-1-4008-7465-1.
James O. Berger. Statistical Decision Theory and Bayesian Analysis. Springer Series in Statis-
tics. Springer-Verlag, New York, second edition, 1985. ISBN 978-0-387-96098-2. doi: 10.1007/
978-1-4757-4286-2.
Oded Berger-Tal, Jonathan Nathan, Ehud Meron, and David Saltz. The Exploration-Exploitation
Dilemma: A Multidisciplinary Framework.PLOS ONE, 9(4):e95693, April 2014. ISSN 1932-6203.
doi: 10.1371/journal.pone.0095693.
Dimitri P. Bertsekas and Steven E. Shreve.Stochastic Optimal Control: The Discrete Time Case.
Athena Scientiﬁc, 1996. ISBN 978-1-886529-03-8.
Christopher M. Bishop.Pattern Recognition and Machine Learning. Information Science and Statis-
tics. Springer, New York, 2006. ISBN 978-0-387-31073-2.
19
David M. Blei, Alp Kucukelbir, and Jon D. McAuliﬀe. Variational Inference: A Review for Statis-
ticians. Journal of the American Statistical Association, 112(518):859–877, April 2017. ISSN
0162-1459, 1537-274X. doi: 10.1080/01621459.2017.1285773.
Matthew Botvinick and Marc Toussaint. Planning as inference.Trends in Cognitive Sciences, 16
(10):485–488, October 2012. ISSN 13646613. doi: 10.1016/j.tics.2012.08.006.
Christopher L. Buckley, Chang Sub Kim, Simon McGregor, and Anil K. Seth. The free energy
principle for action and perception: A mathematical review.Journal of Mathematical Psychology,
81:55–79, December 2017. ISSN 00222496. doi: 10.1016/j.jmp.2017.09.004.
Ozan Çatal, Tim Verbelen, Johannes Nauta, Cedric De Boom, and Bart Dhoedt. Learning Per-
ception and Planning With Deep Active Inference. InICASSP 2020 - 2020 IEEE International
Conference on Acoustics, Speech and Signal Processing (ICASSP), pages 3952–3956, May 2020.
doi: 10.1109/ICASSP40776.2020.9054364.
Ozan Çatal, Tim Verbelen, Toon Van de Maele, Bart Dhoedt, and Adam Safron. Robot navigation
as hierarchical active inference.Neural Networks, 142:192–204, October 2021. ISSN 0893-6080.
doi: 10.1016/j.neunet.2021.05.010.
Théophile Champion, Howard Bowman, and Marek Grześ. Branching Time Active Inference: Em-
pirical study and complexity class analysis.arXiv:2111.11276 [cs], November 2021a.
Théophile Champion, Lancelot Da Costa, Howard Bowman, and Marek Grześ. Branching Time
Active Inference: The theory and its generality.arXiv:2111.11107 [cs], November 2021b.
Maell Cullen, Ben Davey, Karl J. Friston, and Rosalyn J. Moran. Active Inference in OpenAI Gym:
A Paradigm for Computational Investigations Into Psychiatric Illness. Biological Psychiatry:
Cognitive Neuroscience and Neuroimaging, 3(9):809–818, September 2018. ISSN 24519022. doi:
10.1016/j.bpsc.2018.06.010.
Lancelot Da Costa, Thomas Parr, Noor Sajid, Sebastijan Veselic, Victorita Neacsu, and Karl Friston.
Active inference on discrete state-spaces: A synthesis.Journal of Mathematical Psychology, 99:
102447, December 2020. ISSN 0022-2496. doi: 10.1016/j.jmp.2020.102447.
Lancelot Da Costa, Pablo Lanillos, Noor Sajid, Karl Friston, and Shujhat Khan. How Active
Inference Could Help Revolutionise Robotics.Entropy, 24(3):361, March 2022a. ISSN 1099-4300.
doi: 10.3390/e24030361.
Lancelot Da Costa, Samuel Tenka, Dominic Zhao, and Noor Sajid. Active Inference as a Model of
Agency. In Workshop on RL as a Model of Agency, 2022b.
Nathaniel D. Daw, John P. O’Doherty, Peter Dayan, Ben Seymour, and Raymond J. Dolan. Cortical
substrates for exploratory decisions in humans.Nature, 441(7095):876–879, June 2006. ISSN 1476-
4687. doi: 10.1038/nature04766.
P.DayanandN.D.Daw. Decisiontheory, reinforcementlearning, andthebrain. Cognitive, Aﬀective,
& Behavioral Neuroscience, 8(4):429–453, December 2008. ISSN 1530-7026, 1531-135X. doi:
10.3758/CABN.8.4.429.
Edward Deci and Richard M. Ryan.Intrinsic Motivation and Self-Determination in Human Behav-
ior. Perspectives in Social Psychology. Springer US, New York, 1985. ISBN 978-0-306-42022-1.
doi: 10.1007/978-1-4899-2271-7.
Benjamin Eysenbach and Sergey Levine. If maxent rl is the answer, what is the question?arXiv
preprint arXiv:1910.01913, 2019.
20
Zafeirios Fountas, Noor Sajid, Pedro A. M. Mediano, and Karl Friston. Deep active inference agents
using Monte-Carlo methods.arXiv:2006.04176 [cs, q-bio, stat], June 2020.
Karl Friston. The free-energy principle: A uniﬁed brain theory?Nature Reviews Neuroscience, 11
(2):127–138, February 2010. ISSN 1471-003X, 1471-0048. doi: 10.1038/nrn2787.
Karl Friston, Spyridon Samothrakis, and Read Montague. Active inference and agency: Optimal
control without cost functions.Biological Cybernetics, 106(8):523–541, October 2012. ISSN 1432-
0770. doi: 10.1007/s00422-012-0512-8.
Karl Friston, Thomas FitzGerald, Francesco Rigoli, Philipp Schwartenbeck, John O’Doherty, and
Giovanni Pezzulo. Active inference and learning. Neuroscience & Biobehavioral Reviews, 68:
862–879, September 2016. ISSN 01497634. doi: 10.1016/j.neubiorev.2016.06.022.
Karl Friston, Thomas FitzGerald, Francesco Rigoli, Philipp Schwartenbeck, and Giovanni Pezzulo.
Active Inference: A Process Theory. Neural Computation, 29(1):1–49, January 2017a. ISSN
0899-7667, 1530-888X. doi: 10.1162/NECO_a_00912.
Karl Friston, Lancelot Da Costa, Danijar Hafner, Casper Hesp, and Thomas Parr. Sophisticated
Inference. Neural Computation, 33(3):713–763, February 2021. ISSN 0899-7667. doi: 10.1162/
neco_a_01351.
Karl Friston, Lancelot Da Costa, Noor Sajid, Conor Heins, Kai Ueltzhöﬀer, Grigorios A. Pavliotis,
and Thomas Parr. The free energy principle made simpler but not too simple.arXiv:2201.06387
[cond-mat, physics:nlin, physics:physics, q-bio], January 2022.
Karl J. Friston, Jean Daunizeau, and Stefan J. Kiebel. Reinforcement Learning or Active Inference?
PLoS ONE, 4(7):e6421, July 2009. ISSN 1932-6203. doi: 10.1371/journal.pone.0006421.
Karl J. Friston, Jean Daunizeau, James Kilner, and Stefan J. Kiebel. Action and behavior: A free-
energy formulation. Biological Cybernetics, 102(3):227–260, March 2010. ISSN 1432-0770. doi:
10.1007/s00422-010-0364-z.
Karl J. Friston, Marco Lin, Christopher D. Frith, Giovanni Pezzulo, J. Allan Hobson, and Sasha On-
dobaka. Active Inference, Curiosity and Insight.Neural Computation, 29(10):2633–2683, October
2017b. ISSN 0899-7667, 1530-888X. doi: 10.1162/neco_a_00999.
Karl J. Friston, Thomas Parr, and Bert de Vries. The graphical brain: Belief propagation and
active inference. Network Neuroscience, 1(4):381–414, December 2017c. ISSN 2472-1751. doi:
10.1162/NETN_a_00018.
Karl J. Friston, Richard Rosch, Thomas Parr, Cathy Price, and Howard Bowman. Deep temporal
models and active inference.Neuroscience & Biobehavioral Reviews, 90:486–501, July 2018. ISSN
01497634. doi: 10.1016/j.neubiorev.2018.04.004.
Drew Fudenberg and Jean Tirole.Game Theory. MIT Press, 1991. ISBN 978-0-262-06141-4.
Samuel J. Gershman. Deconstructing the human algorithms for exploration.Cognition, 173:34–42,
April 2018. ISSN 1873-7838. doi: 10.1016/j.cognition.2017.12.014.
Samuel J. Gershman and Yael Niv. Learning latent structure: Carving nature at its joints.Current
Opinion in Neurobiology, 20(2):251–256, April 2010. ISSN 1873-6882. doi: 10.1016/j.conb.2010.
02.008.
Mohammad Ghavamzadeh, Shie Mannor, Joelle Pineau, and Aviv Tamar. Bayesian reinforcement
learning: A survey.arXiv preprint arXiv:1609.04436, 2016.
21
A. Guez, D. Silver, and P. Dayan. Scalable and Eﬃcient Bayes-Adaptive Reinforcement Learn-
ing Based on Monte-Carlo Tree Search.Journal of Artiﬁcial Intelligence Research, 48:841–883,
November 2013a. ISSN 1076-9757. doi: 10.1613/jair.4117.
Arthur Guez, David Silver, and Peter Dayan. Eﬃcient Bayes-Adaptive Reinforcement Learning
using Sample-Based Search.arXiv:1205.3109 [cs, stat], December 2013b.
Tuomas Haarnoja, Haoran Tang, Pieter Abbeel, and Sergey Levine. Reinforcement learning with
deep energy-based policies.arXiv preprint arXiv:1702.08165, 2017.
Tuomas Haarnoja, Aurick Zhou, Pieter Abbeel, and Sergey Levine. Soft actor critic: Oﬀ-policy
maximum entropy deep reinforcement learning with a stochastic actor.CoRR, abs / 1801.01290,
2018. URL http://arxiv.org/abs/1801.01290.
Quentin J. M. Huys, Neir Eshel, Elizabeth O’Nions, Luke Sheridan, Peter Dayan, and Jonathan P.
Roiser. Bonsai Trees in Your Head: How the Pavlovian System Sculpts Goal-Directed Choices
by Pruning Decision Trees. PLoS Computational Biology, 8(3):e1002410, March 2012. ISSN
1553-7358. doi: 10.1371/journal.pcbi.1002410.
Laurent Itti and Pierre Baldi. Bayesian surprise attracts human attention.Vision research, 49(10):
1295–1306, May 2009. ISSN 0042-6989. doi: 10.1016/j.visres.2008.09.007.
E. T. Jaynes. Information Theory and Statistical Mechanics.Physical Review, 106(4):620–630, May
1957a. doi: 10.1103/PhysRev.106.620.
E. T. Jaynes. Information Theory and Statistical Mechanics. II.Physical Review, 108(2):171–190,
October 1957b. doi: 10.1103/PhysRev.108.171.
Michael I. Jordan, Zoubin Ghahramani, Tommi S. Jaakkola, and Lawrence K. Saul. An Introduction
to Variational Methods for Graphical Models. In Michael I. Jordan, editor,Learning in Graphical
Models, pages 105–161. Springer Netherlands, Dordrecht, 1998. ISBN 978-94-010-6104-9 978-94-
011-5014-9. doi: 10.1007/978-94-011-5014-9_5.
Leslie Pack Kaelbling, Michael L. Littman, and Anthony R. Cassandra. Planning and acting in
partially observable stochastic domains. Artiﬁcial Intelligence, 101(1):99–134, May 1998. ISSN
0004-3702. doi: 10.1016/S0004-3702(98)00023-X.
Daniel Kahneman and Amos Tversky. Prospect Theory: An Analysis of Decision under Risk.
Econometrica, 47(2):263–291, 1979. ISSN 0012-9682. doi: 10.2307/1914185.
Hilbert J. Kappen, Vicenç Gómez, and Manfred Opper. Optimal control as a graphical model
inference problem.Machine Learning, 87(2):159–182, May 2012. ISSN 0885-6125, 1573-0565. doi:
10.1007/s10994-012-5278-7.
Alexander S. Klyubin, Daniel Polani, and Chrystopher L. Nehaniv. Keep Your Options Open:
An Information-Based Driving Principle for Sensorimotor Systems. PLOS ONE, 3(12):e4018,
December 2008. ISSN 1932-6203. doi: 10.1371/journal.pone.0004018.
Níall Lally, Quentin J. M. Huys, Neir Eshel, Paul Faulkner, Peter Dayan, and Jonathan P. Roiser.
The Neural Basis of Aversive Pavlovian Guidance during Planning.Journal of Neuroscience, 37
(42):10215–10229, October 2017. ISSN 0270-6474, 1529-2401. doi: 10.1523/JNEUROSCI.0085-17.
2017.
Pablo Lanillos, Jordi Pages, and Gordon Cheng. Robot self/other distinction: Active inference meets
neural networks learning in a mirror. InEuropean Conference on Artiﬁcial Intelligence. IOS press,
April 2020.
22
Sergey Levine. Reinforcement learning and control as probabilistic inference: Tutorial and review.
arXiv preprint arXiv:1805.00909, 2018a.
Sergey Levine. Reinforcement Learning and Control as Probabilistic Inference: Tutorial and Review.
arXiv:1805.00909 [cs, stat], May 2018b.
D. V. Lindley. On a Measure of the Information Provided by an Experiment. The Annals of
Mathematical Statistics, 27(4):986–1005, 1956. ISSN 0003-4851.
R Linsker. Perceptual Neural Organization: Some Approaches Based on Network Models and
Information Theory.Annual Review of Neuroscience, 13(1):257–281, 1990. doi: 10.1146/annurev.
ne.13.030190.001353.
David J. C. MacKay.Information Theory, Inference and Learning Algorithms. Cambridge University
Press, Cambridge, UK ; New York, sixth printing 2007 edition edition, September 2003. ISBN
978-0-521-64298-9.
Domenico Maisto, Francesco Gregoretti, Karl Friston, and Giovanni Pezzulo. Active Tree Search in
Large POMDPs. arXiv:2103.13860 [cs, math, q-bio], March 2021.
Dimitrije Marković, Hrvoje Stojić, Sarah Schwöbel, and Stefan J. Kiebel. An empirical evaluation
of active inference in multi-armed bandits.Neural Networks, 144:229–246, December 2021. ISSN
0893-6080. doi: 10.1016/j.neunet.2021.08.018.
Pietro Mazzaglia, Tim Verbelen, and Bart Dhoedt. Contrastive Active Inference. InAdvances in
Neural Information Processing Systems, May 2021.
Beren Millidge. Deep active inference as variational policy gradients. Journal of Mathematical
Psychology, 96:102348, June 2020. ISSN 0022-2496. doi: 10.1016/j.jmp.2020.102348.
Beren Millidge. Applications of the Free Energy Principle to Machine Learning and Neuroscience.
arXiv:2107.00140 [cs], June 2021.
Beren Millidge, Alexander Tschantz, and Christopher L. Buckley. Whence the Expected Free En-
ergy? arXiv:2004.08128 [cs], April 2020a.
Beren Millidge, Alexander Tschantz, Anil K. Seth, and Christopher L. Buckley. On the Relationship
Between Active Inference and Control as Inference. In Tim Verbelen, Pablo Lanillos, Christo-
pher L. Buckley, and Cedric De Boom, editors,Active Inference, Communications in Computer
and Information Science, pages 3–11, Cham, 2020b. Springer International Publishing. ISBN
978-3-030-64919-7. doi: 10.1007/978-3-030-64919-7_1.
Mario J. Miranda and Paul L. Fackler.Applied Computational Economics and Finance. The MIT
Press, Cambridge, Mass. London, new ed edition edition, September 2002. ISBN 978-0-262-63309-
3.
M. Berk Mirza, Rick A. Adams, Christoph Mathys, and Karl J. Friston. Human visual exploration
reduces uncertainty about the sensed world.PLOS ONE, 13(1):e0190429, 2018. ISSN 1932-6203.
doi: 10.1371/journal.pone.0190429.
Guillermo Oliver, Pablo Lanillos, and Gordon Cheng. An empirical study of active inference on a
humanoid robot. IEEE Transactions on Cognitive and Developmental Systems, pages 1–1, 2021.
ISSN 2379-8939. doi: 10.1109/TCDS.2021.3049907.
L. M. Optican and B. J. Richmond. Temporal encoding of two-dimensional patterns by single units in
primate inferior temporal cortex. III. Information theoretic analysis.Journal of Neurophysiology,
57(1):162–178, January 1987. ISSN 0022-3077. doi: 10.1152/jn.1987.57.1.162.
23
Pierre-Yves Oudeyer and Frederic Kaplan. What is Intrinsic Motivation? A Typology of Com-
putational Approaches. Frontiers in Neurorobotics, 1:6, November 2007. ISSN 1662-5218. doi:
10.3389/neuro.12.006.2007.
Thomas Parr. The Computational Neurology of Active Vision. PhD thesis, University College
London, London, 2019.
Thomas Parr, Dimitrije Markovic, Stefan J. Kiebel, and Karl J. Friston. Neuronal message passing
using Mean-ﬁeld, Bethe, and Marginal approximations.Scientiﬁc Reports, 9(1):1889, December
2019. ISSN 2045-2322. doi: 10.1038/s41598-018-38246-3.
Thomas Parr, Jakub Limanowski, Vishal Rawji, and Karl Friston. The computational neurology
of movement under active inference.Brain, March 2021. ISSN 0006-8950. doi: 10.1093/brain/
awab085.
Thomas Parr, Giovanni Pezzulo, and Karl J. Friston.Active Inference: The Free Energy Principle
in Mind, Brain, and Behavior. MIT Press, Cambridge, MA, USA, March 2022. ISBN 978-0-262-
04535-3.
Aswin Paul, Noor Sajid, Manoj Gopalkrishnan, and Adeel Razi. Active Inference for Stochastic
Control. arXiv:2108.12245 [cs], August 2021.
Grigorios A. Pavliotis. Stochastic Processes and Applications: Diﬀusion Processes, the Fokker-
Planck and Langevin Equations. Number volume 60 in Texts in Applied Mathematics. Springer,
New York, 2014. ISBN 978-1-4939-1322-0.
Judea Pearl. Graphical Models for Probabilistic and Causal Reasoning. In Philippe Smets, editor,
Quantiﬁed Representation of Uncertainty and Imprecision, Handbook of Defeasible Reasoning and
Uncertainty Management Systems, pages 367–389. Springer Netherlands, Dordrecht, 1998. ISBN
978-94-017-1735-9. doi: 10.1007/978-94-017-1735-9_12.
Corrado Pezzato, Riccardo Ferrari, and Carlos Hernández Corbato. A Novel Adaptive Controller
for Robot Manipulators Based on Active Inference.IEEE Robotics and Automation Letters, 5(2):
2973–2980, April 2020. ISSN 2377-3766. doi: 10.1109/LRA.2020.2974451.
Léo Pio-Lopez, Ange Nizard, Karl Friston, and Giovanni Pezzulo. Active inference and robot control:
A case study. Journal of The Royal Society Interface, 13(122):20160616, September 2016. doi:
10.1098/rsif.2016.0616.
Martin L. Puterman.Markov Decision Processes: Discrete Stochastic Dynamic Programming. John
Wiley & Sons, August 2014. ISBN 978-1-118-62587-3.
Jad Rahme and Ryan P. Adams. A Theoretical Connection Between Statistical Physics and Rein-
forcement Learning.arXiv:1906.10228 [cond-mat, stat], June 2019.
MaxwellJ.D.Ramstead, DaltonA.R.Sakthivadivel, ConorHeins, MagnusKoudahl, BerenMillidge,
Lancelot Da Costa, Brennan Klein, and Karl J. Friston. On Bayesian Mechanics: A Physics of
and by Beliefs, May 2022.
Konrad Rawlik, Marc Toussaint, and Sethu Vijayakumar. On Stochastic Optimal Control and Re-
inforcement Learning by Approximate Inference. InTwenty-Third International Joint Conference
on Artiﬁcial Intelligence, June 2013.
Stéphane Ross, Joelle Pineau, Brahim Chaib-draa, and Pierre Kreitmann. A Bayesian Approach for
Learning and Planning in Partially Observable Markov Decision Processes. page 42.
24
Stephane Ross, Brahim Chaib-draa, and Joelle Pineau. Bayes-Adaptive POMDPs. In J. C. Platt,
D.Koller, Y.Singer, andS.T.Roweis, editors, Advances in Neural Information Processing Systems
20, pages 1225–1232. Curran Associates, Inc., 2008.
Daniel Russo and Benjamin Van Roy. Learning to optimize via posterior sampling.Mathematics of
Operations Research, 39(4):1221–1243, 2014.
Daniel Russo and Benjamin Van Roy. An information-theoretic analysis of thompson sampling.The
Journal of Machine Learning Research, 17(1):2442–2471, 2016.
Daniel Russo, Benjamin Van Roy, Abbas Kazerouni, Ian Osband, and Zheng Wen. A tutorial on
thompson sampling. arXiv preprint arXiv:1707.02038, 2017.
Noor Sajid, Philip J. Ball, Thomas Parr, and Karl J. Friston. Active Inference: Demystiﬁed and
Compared. Neural Computation, 33(3):674–712, January 2021a. ISSN 0899-7667. doi: 10.1162/
neco_a_01357.
Noor Sajid, Panagiotis Tigas, Alexey Zakharov, Zafeirios Fountas, and Karl Friston. Exploration
and preference satisfaction trade-oﬀ in reward-free learning.arXiv:2106.04316 [cs, q-bio], July
2021b.
Noor Sajid, Emma Holmes, Lancelot Da Costa, Cathy Price, and Karl Friston. A mixed generative
model of auditory word repetition, January 2022.
Anna C. Sales, Karl J. Friston, Matthew W. Jones, Anthony E. Pickering, and Rosalyn J. Moran.
Locus Coeruleus tracking of prediction errors optimises cognitive ﬂexibility: An Active Inference
model. PLOS Computational Biology, 15(1):e1006267, January 2019. ISSN 1553-7358. doi:
10.1371/journal.pcbi.1006267.
Cansu Sancaktar, Marcel van Gerven, and Pablo Lanillos. End-to-End Pixel-Based Deep Active
Inference for Body Perception and Action.arXiv:2001.05847 [cs, q-bio], May 2020.
R. W. H. Sargent. Optimal control.Journal of Computational and Applied Mathematics, 124(1):
361–371, December 2000. ISSN 0377-0427. doi: 10.1016/S0377-0427(00)00418-0.
Jürgen Schmidhuber. Developmental robotics, optimal artiﬁcial curiosity, creativity, music, and
the ﬁne arts. Connection Science, 18(2):173–187, June 2006. ISSN 0954-0091. doi: 10.1080/
09540090600768658.
Jürgen Schmidhuber. Formal Theory of Creativity, Fun, and Intrinsic Motivation (1990–2010).
IEEE Transactions on Autonomous Mental Development, 2(3):230–247, September 2010. ISSN
1943-0604, 1943-0612. doi: 10.1109/TAMD.2010.2056368.
Tim Schneider, Boris Belousov, Hany Abdulsamad, and Jan Peters. Active Inference for Robotic
Manipulation, June 2022.
EricSchulzandSamuelJ.Gershman. Thealgorithmicarchitectureofexplorationinthehumanbrain.
Current Opinion in Neurobiology, 55:7–14, 2019. ISSN1873-6882. doi: 10.1016/j.conb.2018.11.003.
Philipp Schwartenbeck, Thomas H. B. FitzGerald, Christoph Mathys, Ray Dolan, and Karl Friston.
The Dopaminergic Midbrain Encodes the Expected Certainty about Desired Outcomes.Cerebral
Cortex (New York, N.Y.: 1991), 25(10):3434–3445, October 2015a. ISSN 1460-2199. doi: 10.
1093/cercor/bhu159.
Philipp Schwartenbeck, Thomas H. B. FitzGerald, Christoph Mathys, Ray Dolan, Martin Kron-
bichler, and Karl Friston. Evidence for surprise minimization over value maximization in choice
behavior. Scientiﬁc Reports, 5:16575, November 2015b. ISSN 2045-2322. doi: 10.1038/srep16575.
25
PhilippSchwartenbeck, JohannesPassecker, TobiasUHauser, ThomasHBFitzGerald, MartinKron-
bichler, and Karl J Friston. Computational mechanisms of curiosity and goal-directed exploration.
eLife, page 45, 2019.
Yoav Shoham, Rob Powers, and Trond Grenager. Multi-agent reinforcement learning: A critical
survey. Technical report, 2003.
David Silver, Aja Huang, Chris J. Maddison, Arthur Guez, Laurent Sifre, George van den Driessche,
Julian Schrittwieser, Ioannis Antonoglou, Veda Panneershelvam, Marc Lanctot, Sander Dieleman,
Dominik Grewe, John Nham, Nal Kalchbrenner, Ilya Sutskever, Timothy Lillicrap, Madeleine
Leach, Koray Kavukcuoglu, Thore Graepel, and Demis Hassabis. Mastering the game of Go with
deep neural networks and tree search.Nature, 529(7587):484–489, January 2016. ISSN 0028-0836,
1476-4687. doi: 10.1038/nature16961.
Ryan Smith, Philipp Schwartenbeck, Thomas Parr, and Karl J. Friston. An active inference model
of concept learning.bioRxiv, page 633677, May 2019. doi: 10.1101/633677.
Ryan Smith, Rayus Kuplicki, Justin Feinstein, Katherine L. Forthman, Jennifer L. Stewart, Mar-
tin P. Paulus, Tulsa 1000 Investigators, and Sahib S. Khalsa. A Bayesian computational model
reveals a failure to adapt interoceptive precision estimates across depression, anxiety, eating, and
substance use disorders.PLOS Computational Biology, 16(12):e1008484, December 2020a. ISSN
1553-7358. doi: 10.1371/journal.pcbi.1008484.
Ryan Smith, Rayus Kuplicki, Adam Teed, Valerie Upshaw, and Sahib S. Khalsa. Conﬁrmatory evi-
dence that healthy individuals can adaptively adjust prior expectations and interoceptive precision
estimates, September 2020b.
Ryan Smith, Philipp Schwartenbeck, Thomas Parr, and Karl J. Friston. An Active Inference Ap-
proach to Modeling Structure Learning: Concept Learning as an Example Case. Frontiers in
Computational Neuroscience, 14, May 2020c. ISSN 1662-5188. doi: 10.3389/fncom.2020.00041.
Ryan Smith, Philipp Schwartenbeck, Jennifer L. Stewart, Rayus Kuplicki, Hamed Ekhtiari, and
Martin P. Paulus. Imprecise Action Selection in Substance Use Disorder: Evidence for Active
Learning Impairments When Solving the Explore-Exploit Dilemma.Drug and alcohol dependence,
215:108208, October 2020d. ISSN 0376-8716. doi: 10.1016/j.drugalcdep.2020.108208.
Ryan Smith, Sahib S. Khalsa, and Martin P. Paulus. An Active Inference Approach to Dissecting
Reasons for Nonadherence to Antidepressants.Biological Psychiatry. Cognitive Neuroscience and
Neuroimaging, 6(9):919–934, September 2021a. ISSN 2451-9030. doi: 10.1016/j.bpsc.2019.11.012.
Ryan Smith, Namik Kirlic, Jennifer L. Stewart, James Touthang, Rayus Kuplicki, Sahib S. Khalsa,
Justin Feinstein, Martin P. Paulus, and Robin L. Aupperle. Greater decision uncertainty char-
acterizes a transdiagnostic patient sample during approach-avoidance conﬂict: A computational
modelling approach.Journal of psychiatry & neuroscience: JPN, 46(1):E74–E87, January 2021b.
ISSN 1488-2434. doi: 10.1503/jpn.200032.
Ryan Smith, Namik Kirlic, Jennifer L. Stewart, James Touthang, Rayus Kuplicki, Timothy J.
McDermott, Samuel Taylor, Sahib S. Khalsa, Martin P. Paulus, and Robin L. Aupperle. Long-
termstabilityofcomputationalparametersduringapproach-avoidanceconﬂictinatransdiagnostic
psychiatric patient sample. Scientiﬁc Reports, 11(1):11783, June 2021c. ISSN 2045-2322. doi:
10.1038/s41598-021-91308-x.
Ryan Smith, Ahmad Mayeli, Samuel Taylor, Obada Al Zoubi, Jessyca Naegele, and Sahib S. Khalsa.
Gut inference: A computational modelling approach.Biological Psychology, 164:108152, Septem-
ber 2021d. ISSN 0301-0511. doi: 10.1016/j.biopsycho.2021.108152.
26
Ryan Smith, Karl J. Friston, and Christopher J. Whyte. A step-by-step tutorial on active inference
and its application to empirical data. Journal of Mathematical Psychology, 107:102632, April
2022a. ISSN 0022-2496. doi: 10.1016/j.jmp.2021.102632.
Ryan Smith, Samuel Taylor, Jennifer L. Stewart, Salvador M. Guinjoan, Maria Ironside, Namik
Kirlic, Hamed Ekhtiari, Evan J. White, Haixia Zheng, Rayus Kuplicki, Tulsa 1000 Investigators,
and Martin P. Paulus. Slower Learning Rates from Negative Outcomes in Substance Use Disorder
over a 1-Year Period and Their Potential Predictive Utility. Computational Psychiatry, 6(1):
117–141, June 2022b. ISSN 2379-6227. doi: 10.5334/cpsy.85.
SusanneStillandDoinaPrecup. Aninformation-theoreticapproachtocuriosity-drivenreinforcement
learning. Theory in Biosciences = Theorie in Den Biowissenschaften, 131(3):139–148, September
2012. ISSN 1611-7530. doi: 10.1007/s12064-011-0142-z.
Martin Stolle and Doina Precup. Learning options in reinforcement learning. In International
Symposium on abstraction, reformulation, and approximation, pages 212–223. Springer, 2002.
James V. Stone. Information Theory: A Tutorial Introduction. Sebtel Press, England, 1st edition
edition, February 2015. ISBN 978-0-9563728-5-7.
James V Stone.Artiﬁcial Intelligence Engines: A Tutorial Introduction to the Mathematics of Deep
Learning. 2019.
Yi Sun, Faustino Gomez, and Juergen Schmidhuber. Planning to Be Surprised: Optimal Bayesian
Exploration in Dynamic Environments.arXiv:1103.5708 [cs, stat], March 2011.
Toshiyuki Tanaka. A Theory of Mean Field Approximation. page 10, 1999.
D. Gowanlock R. Tervo, Joshua B. Tenenbaum, and Samuel J. Gershman. Toward the neural
implementation of structure learning. Current Opinion in Neurobiology, 37:99–105, April 2016.
ISSN 1873-6882. doi: 10.1016/j.conb.2016.01.014.
Emanuel Todorov. Linearly-solvable markov decision problems. InAdvances in neural information
processing systems, pages 1369–1376, 2007.
Emanuel Todorov. General duality between optimal control and estimation.2008 47th IEEE Con-
ference on Decision and Control, pages 4286–4292, 2008. doi: 10.1109/cdc.2008.4739438.
Emanuel Todorov. Eﬃcient computation of optimal actions.Proceedings of the national academy of
sciences, 106(28):11478–11483, 2009.
Michel Tokic and Günther Palm. Value-Diﬀerence Based Exploration: Adaptive Control between
Epsilon-Greedy and Softmax. In Joscha Bach and Stefan Edelkamp, editors,KI 2011: Advances
in Artiﬁcial Intelligence, Lecture Notes in Computer Science, pages 335–346, Berlin, Heidelberg,
2011. Springer. ISBN 978-3-642-24455-1. doi: 10.1007/978-3-642-24455-1_33.
Marc Toussaint. Robot trajectory optimization using approximate inference. In Proceedings of
the 26th Annual International Conference on Machine Learning, ICML ’09, pages 1049–1056,
Montreal, Quebec, Canada, June 2009. Association for Computing Machinery. ISBN 978-1-60558-
516-1. doi: 10.1145/1553374.1553508.
Alexander Tschantz, Manuel Baltieri, Anil K. Seth, and Christopher L. Buckley. Scaling active
inference. arXiv:1911.10601 [cs, eess, math, stat], November 2019.
Alexander Tschantz, Beren Millidge, Anil K. Seth, and Christopher L. Buckley. Reinforcement
Learning through Active Inference. InICLR, February 2020a.
27
Alexander Tschantz, Anil K. Seth, and Christopher L. Buckley. Learning action-oriented models
through active inference.PLOS Computational Biology, 16(4):e1007805, April 2020b. ISSN 1553-
7358. doi: 10.1371/journal.pcbi.1007805.
Bart van den Broek, Wim Wiegerinck, and Bert Kappen. Risk sensitive path integral control.UAI,
2010.
Otto van der Himst and Pablo Lanillos. Deep Active Inference for Partially Observable MDPs.
arXiv:2009.03622 [cs, stat], 1326:61–71, 2020. doi: 10.1007/978-3-030-64919-7_8.
J. Von Neumann and O. Morgenstern.Theory of Games and Economic Behavior. Theory of Games
and Economic Behavior. Princeton University Press, Princeton, NJ, US, 1944.
Martin J. Wainwright and Michael I. Jordan. Graphical Models, Exponential Families, and Vari-
ational Inference. Foundations and Trends® in Machine Learning, 1(1–2):1–305, 2007. ISSN
1935-8237, 1935-8245. doi: 10.1561/2200000001.
Robert C. Wilson, Andra Geana, John M. White, Elliot A. Ludvig, and Jonathan D. Cohen. Hu-
mans Use Directed and Random Exploration to Solve the Explore–Exploit Dilemma.Journal
of experimental psychology. General, 143(6):2074–2081, December 2014. ISSN 0096-3445. doi:
10.1037/a0038199.
Robert C. Wilson, Elizabeth Bonawitz, Vincent D. Costa, and R. Becket Ebitz. Balancing ex-
ploration and exploitation with information and randomization.Current Opinion in Behavioral
Sciences, 38:49–56, 2021. ISSN 2352-1554. doi: 10.1016/j.cobeha.2020.10.001.
He A Xu, Alireza Modirshanechi, Marco P Lehmann, Wulfram Gerstner, and Michael H Herzog.
Novelty is not surprise: Human exploratory and adaptive behavior in sequential decision-making.
PLOS Computational Biology, 17(6):e1009070, 2021.
Ernst Zermelo. über eine Anwendung der Mengenlehre auf die Theorie des Schachspiels. 1913.
B. Ziebart.Modeling Purposeful Adaptive Behavior with the Principle of Maximum Causal Entropy.
PhD thesis, Carnegie Mellon University, Pittsburgh, 2010.
Brian D Ziebart, Andrew L Maas, J Andrew Bagnell, and Anind K Dey. Maximum entropy inverse
reinforcement learning. 2008.
Luisa Zintgraf, Kyriacos Shiarlis, Maximilian Igl, Sebastian Schulze, Yarin Gal, Katja Hofmann,
and Shimon Whiteson. VariBAD: A Very Good Method for Bayes-Adaptive Deep RL via Meta-
Learning. arXiv:1910.08348 [cs, stat], February 2020.
Luisa M Zintgraf, Leo Feng, Cong Lu, Maximilian Igl, Kristian Hartikainen, Katja Hofmann, and
Shimon Whiteson. Exploration in approximate hyper-state space for meta reinforcement learning.
In International Conference on Machine Learning, pages 12991–13001. PMLR, 2021.
Appendix A. Active inference and reinforcement learning
This paper considered how active inference can solve the stochastic control problem. In this ap-
pendix, we discuss the broader relationship between active inference and RL.
Loosely speaking, RL is the ﬁeld of methodologies and algorithms that learn reward-maximising
actions from data and seek to maximise reward in the long run. Because RL is a data-driven ﬁeld,
algorithms are selected based on how well they perform on benchmark problems. This has produced
a plethora of diverse algorithms, many designed to solve speciﬁc problems, each with their own
28
strengths and limitations. This makes RL diﬃcult to characterise as a whole. Thankfully, many
approaches to model-based RL and control can be traced back to approximating the optimal solution
to the Bellman equation (Bellman and Dreyfus, 2015; Bertsekas and Shreve, 1996) (although this
may become computationally intractable in high-dimensions (Barto and Sutton, 1992)). Our results
showed how and when decisions under active inference and such RL approaches are similar.
This appendix discusses how active inference and RL relate and diﬀer more generally. Their rela-
tionship has become increasingly important to understand, as a growing body of research has begun
to 1) compare the performance of active inference and RL models in simulated environments (Cullen
et al., 2018; Millidge, 2020; Sajid et al., 2021a), 2) apply active inference to model human behaviour
on reward learning tasks (Smith et al., 2020d, 2021b,c, 2022b), and 3) consider the complementary
predictions and interpretations they each oﬀer in computational neuroscience, psychology, and psy-
chiatry (Cullen et al., 2018; Huys et al., 2012; Schwartenbeck et al., 2015a, 2019; Tschantz et al.,
2020b).
A.1 Main diﬀerences between active inference and reinforcement learning
Philosophy. Active inference and RL diﬀer profoundly in their philosophy. RL derives from
the normative principle of maximising reward (Barto and Sutton, 1992), while active inference
describes systems that maintain their structural integrity over time (Barp et al., 2022; Friston et al.,
2022). Despite this diﬀerence, there are many practical similarities between these frameworks. For
example, recallthatbehaviourinactiveinferenceiscompletelydeterminedbytheagent’spreferences,
determined as priors in their generative model. Crucially, log priors can be interpreted as reward
functions and vice-versa, which is how behaviour under RL and active inference can be related.
Modelbasedandmodelfree. Activeinferenceagents always embodyagenerative(i.e., forward)
model of their environment, while RL comprises both model-based algorithms and simpler model-
free algorithms. In brief, ’model-free’ means that agents learn a reward-maximising state-action
mapping, based on updating cached state-action pair values, through initially random actions that
do not consider future state transitions. In contrast, model-based RL algorithms attempt to extend
stochastic control approaches by learning the dynamics and reward function from data. Recall that
stochasticcontrolcallsonstrategiesthatevaluatediﬀerentactionsonacarefullyhandcraftedforward
model of dynamics (i.e., known transition probabilities) to ﬁnally execute the reward-maximising
action. Under this terminology,all active inference agents are model-based.
Modelling exploration. Exploratory behaviour—which can improve reward maximisation in the
long run—is implemented diﬀerently in the two approaches. In most cases, RL implements a simple
form of exploration by incorporating randomness in decision-making (Tokic and Palm, 2011; Wilson
et al., 2014), where the level of randomness may or may not change over time as a function of
uncertainty. In other cases, RL incorporates ad-hoc information bonuses in the reward function
or other decision-making objectives to build in directed exploratory drives (e.g., upper conﬁdence
bound algorithms or Thompson sampling). In contrast, directed exploration emerges naturally
within active inference through interactions between the risk and ambiguity terms in the expected
free energy (Da Costa et al., 2020; Schwartenbeck et al., 2019). This addresses the explore-exploit
dilemma and confers the agent with artiﬁcial curiosity (Friston et al., 2017b; Schmidhuber, 2010;
Schwartenbeck et al., 2019; Still and Precup, 2012), as opposed to the need to add ad-hoc information
bonus terms (Tokic and Palm, 2011). We expand on this relationship further in Appendix A.3.
Controlandlearningasinference. Activeinferenceintegratesstate-estimation, learning, decision-
making, and motor control under the single objective of minimising free energy (Da Costa et al.,
2020). In fact, active inference extends previous work on the duality between inference and con-
trol (Kappen et al., 2012; Rawlik et al., 2013; Todorov, 2008; Toussaint, 2009) to solve motor control
problems via approximate inference (i.e., planning as inference) (Attias, 2003; Botvinick and Tou-
ssaint, 2012; Friston et al., 2012, 2009; Millidge et al., 2020b). Therefore, some of the closest RL
29
methods to active inference are control as inference, also known as maximum entropy RL (Levine,
2018b; Millidge et al., 2020b; Ziebart, 2010), though one major diﬀerence is in the choice of decision-
making objective. Loosely speaking, these aforementioned methods minimise the risk term of the
expected free energy, while active inference also minimises ambiguity.
Useful features of active inference.
1. Active inference allows great ﬂexibility and transparency when modelling behaviour. It aﬀords
explainable decision-making as a mixture of information- and reward-seeking policies that are ex-
plicitly encoded (and evaluated in terms of expected free energy) in the generative model as priors,
which are speciﬁed by the user (Da Costa et al., 2022a). As we have seen, the kind of behaviour
that can be produced includes the optimal solution to the Bellman equation.
2. Active inference accommodates deep hierarchical generative models combining both discrete and
continuous state-spaces (Friston et al., 2017c, 2018; Parr et al., 2021).
3. The expected free energy objective optimised during planning subsumes many approaches used
to describe and simulate decision-making in the physical, engineering, and life sciences, aﬀording
it various interesting properties as an objective (Figure 3 and (Friston et al., 2021)). For exam-
ple, exploratory and exploitative behaviour are canonically integrated, which ﬁnesses the need for
manually incorporating ad-hoc exploration bonuses in the reward function (Da Costa et al., 2022b).
4. Activeinferencegoesbeyondstate-actionpoliciesthatpredominateintraditionalRLtosequential
policy optimisation. In sequential policy optimisation, one relaxes the assumption that the same
action is optimal given a particular state—and acknowledges that the sequential order of actions
may matter. This is similar to the linearly-solvable MDP formulation presented by (Todorov, 2007,
2009), where transition probabilities directly determine actions, and an optimal policy speciﬁes
transitions that minimise some divergence cost. This way of approaching policies is perhaps most
apparent in terms of exploration. Put simply, it is clearly better to explore and then exploit than
the converse. Because expected free energy is a functional of beliefs, exploration becomes an integral
part of decision-making—in contrast with traditional RL approaches that try to optimise a reward
function of states. In other words, active inference agents will explore until enough uncertainty is
resolved for reward maximising, goal-seeking imperatives to start to predominate.
Such advantages should motivate future research to better characterise the environments in which
these properties oﬀer useful advantages—such as where performance beneﬁts from learning and
planning at multiple temporal scales, and from the ability to select policies that resolve both state
and parameter uncertainty.
A.2 Reward learning
Given the focus on relating active inference to the objective of maximising reward, it is worth
brieﬂy illustrating how active inference can learn the reward function from data and its potential
connections to representative RL approaches. One common approach for active inference to learn
a reward function (Smith et al., 2020d, 2022b) is to set preferences over observations rather than
states, which corresponds to assuming that inferences over states given outcomes are accurate
DKL [Q(⃗ s|⃗ a,˜o) |C(⃗ s)]  
Risk (states)
= DKL [Q(⃗ o|⃗ a,˜o) |C(⃗ o)]  
Risk (outcomes)
+ EQ(⃗ o|⃗ a,˜o) [DKL [Q(⃗ s|⃗ o,˜o,⃗ a) |P(⃗ s|⃗ o)]]  
≈0
≈DKL [Q(⃗ o|⃗ a,˜o) |C(⃗ o)]  
Risk (outcomes)
,
i.e., equality holds whenever the free energy minimum is reached (16). Then one sets the prefer-
ence distribution such that the observations designated as rewards are most preferred. In the zero
30
temperature limit (9), preferences only assign mass to reward-maximising observations. When for-
mulated in this way, the reward signal is treated as sensory data, as opposed to a separate signal
from the environment. When one sets allowable actions (controllable state transitions) to be fully
deterministic such that the selection of each action will transition the agent to a given state with
certainty, the emerging dynamics are such that the agent chooses actions to resolve uncertainty
about the probability of observing reward under each state. Thus, learning the reward probabilities
of available actions amounts to learning the likelihood matrixP(⃗ o|⃗ s) := ot ·Ast, where A is a
stochastic matrix. This is done by setting a priora over A, i.e., a matrix of non-negative compo-
nents, the columns of which are Dirichlet priors over the columns ofA. The agent then learns by
accumulating Dirichlet parameters. Explicitly, at the end of a trial or episode, one sets (Da Costa
et al., 2020; Friston et al., 2016)
a ←a +
T∑
τ=0
oτ ⊗Q(sτ |o0:T) (18)
In (18),Q(sτ |o0:T) is seen as a vector of probabilities over the state-spaceS, corresponding to the
probability of having been in one or another state at time theτ after having gathered observations
throughout the trial. This rule simply amounts to counting observed state-outcome pairs, which is
equivalent to state-reward pairs when the observation modalities correspond to reward.
One should not conﬂate this approach with the update rule consisting of accumulating state-
observation counts in the likelihood matrix
A←A+
T∑
τ=0
oτ ⊗Q(sτ |o0:T) (19)
and then normalising its columns to sum to one when computing probabilities. The latter simply
approximates the likelihood matrixAby accumulating the number of observed state-outcome pairs.
This is distinct from the approach outlined above, which encodes uncertainty over the matrixA, as a
probability distribution over possible distributionsP(ot |st). The agent is initially very unconﬁdent
about A, which means that it doesn’t place high probability mass on any speciﬁcation ofP(ot |
st). This uncertainty is gradually resolved by observing state-observation (or state-reward) pairs.
Computationally, it is a general fact of Dirichlet priors that an increase in elements ofa causes the
entropy of P(ot |st) to decrease. As the terms added in (18) are always positive, one choice of
distribution P(ot |st)—which best matches available data and prior beliefs—is ultimately singled
out. In other words, the likelihood mapping is learned.
The update rule consisting of accumulating state-observation counts in the likelihood matrix (19)
(i.e., not incorporating Dirichlet priors) bears some similarity to oﬀ-policy learning algorithms such
as Q-learning. In Q-learning, the objective is to ﬁnd the best action given the current observed state.
For this, the Q-learning agent accumulates values for state-action pairs with repeated observation of
rewarding/punishing action outcomes—much like state-observation counts. This allows it to learn
the Q-value function that deﬁnes a reward maximising policy.
As always in partially observed environments, we cannot guarantee that the true likelihood
mapping will be learned in practice. Please see (Smith et al., 2019) for examples where, although
not in an explicit reward-learning context, learning the likelihood can be more or less successful in
diﬀerent situations. Learning the true likelihood fails when the inference over states is inaccurate,
such as when using too severe of a mean-ﬁeld approximation to the free energy (Blei et al., 2017;
Parr et al., 2019; Tanaka, 1999), which causes the agent to misinfer states and thereby accumulate
Dirichlet parameters in the wrong locations. Intuitively, this amounts to jumping to conclusions too
quickly.
Remark 19. If so desired, reward learning in active inference can also be equivalently formulated
as learning transition probabilitiesP(st+1 |st,at). In this alternative setup (as exempliﬁed in (Sales
31
et al., 2019)), mappings between reward states and reward outcomes inA are set as identity ma-
trices, and the agent instead learns the probability of transitioning to states that deterministically
generate preferred (rewarding) observations given the choice of each action sequence. The transition
probabilities under each action are learned in a similar fashion as above(18), by accumulating counts
on a Dirichlet prior overP(st+1 |st,at). See (Da Costa et al., 2020, Appendix) for details.
Given the model-based Bayesian formulation of active inference, more direct links can be made
between the active inference approach to reward learning described above and other Bayesian model-
based RL approaches. For such links to be realised, the Bayesian RL agent would be required to have
a prior over a prior (e.g., a prior over the reward function prior or transition function prior). One
way to implicitly incorporate this is through Thompson sampling (Ghavamzadeh et al., 2016; Russo
and Van Roy, 2014, 2016; Russo et al., 2017). While not the focus of this paper, future work could
further examine the links between reward learning in active inference and model-based Bayesian RL
schemes.
A.3 Solving the exploration-exploitation dilemma
An important distinction between active inference and reinforcement learning schemes is how they
solve the exploration-exploitation dilemma.
The exploration-exploitation dilemma (Berger-Tal et al., 2014) arises whenever an agent has
incomplete information about its environment, such as when the environment is partially observed,
or the generative model has to be learned. The dilemma is then about deciding whether to execute
actions aiming to collect reward based on imperfect information about the environment, or to execute
actions aiming to gather more information—allowing the agent to reap more reward in the future.
Intuitively, it is always best to explore and then exploit, but optimising this trade-oﬀ can be diﬃcult.
Active inference balances exploration and exploitation through minimising the risk and ambiguity
inherent in the minimisation of expected free energy. This balance is context-sensitive and can be
adjusted by modifying the agent’s preferences (Da Costa et al., 2022a). In turn, the expected free
energy is obtained from a description of agency in biological systems derived from physics (Barp
et al., 2022; Friston et al., 2022).
Modern RL algorithms integrate exploratory and exploitative behaviour in many diﬀerent ways.
One option is curiosity-driven rewards to encourage exploration. Maximum entropy RL and control-
as-inference make decisions by minimising a KL divergence to the target distribution (Eysenbach
and Levine, 2019; Haarnoja et al., 2017, 2018; Levine, 2018a; Todorov, 2008; Ziebart et al., 2008),
which combines reward maximisation with maximum entropy over states. This is similar to active
inference on MDPs (Millidge et al., 2020b). Similarly, the model-free Soft Actor-Critic (Haarnoja
et al., 2018) algorithm maximises both expected reward and entropy. This outperforms other state-
of-the-art algorithms in continuous control environments and has been shown to be more sample
eﬃcient than its reward-maximising counterparts (Haarnoja et al., 2018). Hyper Zintgraf et al.
(2021) proposes reward maximisation alongside minimising uncertainty over both external states
and model parameters. Bayes-adaptive RL (Guez et al., 2013a,b; Ross et al., 2008; Zintgraf et al.,
2020) provides policies that balance exploration and exploitation with the aim of maximising reward.
Thompson sampling provides a way to balance exploiting current knowledge to maximise immediate
performance and accumulating new information to improve future performance (Russo et al., 2017).
This reduces to optimising dual objectives, reward maximisation and information gain, similar to
active inference on POMDPs. Empirically, Sajid et al. (2021a) demonstrated that an active inference
agent and a Bayesian model-based RL agent using Thompson sampling exhibit similar behaviour
when preferences are deﬁned over outcomes. They also highlighted that, when completely removing
the reward signal from the environment, the two agents both select policies that maximise some sort
of information gain.
In general, the way each of these approaches to the exploration-exploitation dilemma diﬀer in
theory and in practice remains largely unexplored.
32
Appendix B. Proofs
B.1 Proof of Proposition 9
Note that a Bellman optimal state-action policyΠ∗ is a maximal element according to the partial
ordering ≤. Existence thus consists of a simple application of Zorn’s lemma. Zorn’s lemma states
that if any increasing chain
Π1 ≤Π2 ≤Π3 ≤... (20)
has an upper bound that is a state-action policy, then there is a maximal elementΠ∗.
Given the chain (20), we construct an upper bound. We enumerateA×S×T by (α1,σ1,t1),...,
(αN,σN,tN). Then the state-action policy sequence
Πn(α1 |σ1,t1), n = 1,2,3,...
is bounded within[0,1]. By the Bolzano-Weierstrass theorem, there exists a subsequenceΠnk(α1 |
σ1,t1), k = 1,2,3,... that converges. Similarly, Πnk(α2 |σ2,t2) is also a bounded sequence, and
by Bolzano-Weierstrass it has a subsequenceΠnkj
(a2 |σ2,t2) that converges. We repeatedly take
subsequences untilN. To ease notation, call the resulting subsequenceΠm, m= 1,2,3,...
With this, we deﬁneˆΠ = limm→∞Πm. It is straightforward to see thatˆΠ is a state-action policy:
ˆΠ(α|σ,t) = lim
m→∞
Πm(α|σ,t) ∈[0,1], ∀(α,σ,t) ∈A ×S ×T,
∑
α∈A
ˆΠ(α|σ,t) = lim
m→∞
∑
α∈A
Πm(α|σ,t) = 1, ∀(σ,t) ∈S ×T.
To show thatˆΠ is an upper bound, take anyΠ in the original chain of state-action policies (20).
Then by the deﬁnition of an increasing subsequence, there exists an indexM ∈N such that∀k≥M:
Πk ≥Π. Since limits commute with ﬁnite sums, we havevˆΠ(s,t) = limm→∞vΠm(s,t) ≥vΠk(s,t) ≥
vΠ(s,t) for any(s,t) ∈S ×T. Thus, by Zorn’s lemma there exists a Bellman optimal state-action
policy Π∗.
B.2 Proof of Proposition 10
1) ⇒2) : We only need to show assertion(b). By contradiction, suppose that∃(s,α) ∈S ×A such
that Π(α|s,0) >0 and
EΠ[R(s1:T) |s0 = s,a0 = α] <max
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a].
We letα′be the Bellman optimal action at states and time0 deﬁned as
α′:= arg max
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a].
Then, we letΠ′be the same state-action policy asΠ except thatΠ′(·| s,0) assigns α′deterministi-
cally. Then,
vΠ(s,0) =
∑
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a]Π(a|s,0)
<max
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a]
= EΠ′[R(s1:T) |s0 = s,a0 = α′]Π′(α′|s,0)
=
∑
a∈A
EΠ′[R(s1:T) |s0 = s,a0 = a]Π′(a|s,0)
= vΠ′(s,0).
33
So Π is not Bellman optimal, which is a contradiction.
1) ⇐2) : We only need to show thatΠ maximises vΠ(s,0),∀s∈S. By contradiction, there exists
a state-action policyΠ′and a states∈S such that
vΠ(s,0) <vΠ′(s,0)
⇐⇒
∑
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a]Π(a|s,0) <
∑
a∈A
EΠ′[R(s1:T) |s0 = s,a0 = a]Π′(a|s,0).
By (a) the left hand side equals
max
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a].
Unpacking the expression on the right-hand side:
∑
a∈A
EΠ′[R(s1:T) |s0 = s,a0 = a]Π′(a|s,0)
=
∑
a∈A
∑
σ∈S
EΠ′[R(s1:T) |s1 = σ]P(s1 = σ|s0 = s,a0 = a)Π′(a|s,0)
=
∑
a∈A
∑
σ∈S
{EΠ′[R(s2:T) |s1 = σ] + R(σ)}P(s1 = σ|s0 = s,a0 = a)Π′(a|s,0)
=
∑
a∈A
∑
σ∈S
{vΠ′(σ,1) + R(σ)] P(s1 = σ|s0 = s,a0 = a)Π′(a|s,0)
(21)
Since Π is Bellman optimal when restricted to{1,...,T }we have vΠ′(σ,1) ≤vΠ(σ,1),∀σ ∈S.
Therefore,
∑
a∈A
∑
σ∈S
{vΠ′(σ,1) + R(σ)] P(s1 = σ|s0 = s,a0 = a)Π′(a|s,0)
≤
∑
a∈A
∑
σ∈S
{vΠ(σ,1) + R(σ)] P(s1 = σ|s0 = s,a0 = a)Π′(a|s,0).
Repeating the steps above (21), but in reverse order, yields
∑
a∈A
EΠ′[R(s1:T) |s0 = s,a0 = a]Π′(a|s,0) ≤
∑
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a]Π′(a|s,0)
However,
∑
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a]Π′(a|s,0) <max
a∈A
EΠ[R(s1:T) |s0 = s,a0 = a]
which is a contradiction.
B.3 Proof of Proposition 11
• We ﬁrst prove that state-action policiesΠ deﬁned as in (2) are Bellman optimal by induction
on T.
T = 1 :
Π(a|s,0) >0 ⇐⇒a∈arg max
a
E[R(s1) |s0 = s,a0 = a], ∀s∈S
is a Bellman optimal state-action policy as it maximises the total reward possible in the MDP.
34
Let T >1 be ﬁnite and suppose that the Proposition holds for MDPs with a temporal horizon
of T −1. This means that
Π(a|s,T −1) >0 ⇐⇒a∈arg max
a
E[R(sT) |sT−1 = s,aT−1 = a], ∀s∈S
Π(a|s,T −2) >0 ⇐⇒a∈arg max
a
EΠ[R(sT−1:T) |sT−2 = s,aT−2 = a], ∀s∈S
...
Π(a|s,1) >0 ⇐⇒a∈arg max
a
EΠ[R(s2:T) |s1 = s,a1 = a], ∀s∈S
is a Bellman optimal state-action policy on the MDP restricted to times1 to T. Therefore,
since
Π(a|s,0) >0 ⇐⇒a∈arg max
a
EΠ[R(s1:T) |s0 = s,a0 = a], ∀s∈S
Proposition 10 allows us to deduce thatΠ is Bellman optimal.
• We now show that any Bellman optimal state-action policy satisﬁes the backward induction
algorithm (2).
Suppose by contradiction that there exists a state-action policyΠ that is Bellman optimal but
does not satisfy (2). Say,∃(a,s,t ) ∈A ×S ×T,t<T , such that
Π(a|s,t) >0 and a /∈arg max
α∈A
EΠ[R(st+1:T) |st = s,at = α].
This implies
EΠ[R(st+1:T) |st = s,at = a] <max
α∈A
EΠ[R(st+1:T) |st = s,at = α].
Let ˜a ∈arg maxαEΠ[R(st+1:T) |st = s,at = α]. Let ˜Π be a state-action policy such that
˜Π(·| s,t) assigns ˜a ∈A deterministically, and such that ˜Π = Π otherwise. Then we can
contradict the Bellman optimality ofΠ as follows
vΠ(s,t) = EΠ[R(st+1:T) |st = s]
=
∑
α∈A
EΠ[R(st+1:T) |st = s,at = α]Π(α|s,t)
<max
α∈A
EΠ[R(st+1:T) |st = s,at = α]
= EΠ[R(st+1:T) |st = s,at = ˜a]
= E˜Π[R(st+1:T) |st = s,at = ˜a]
=
∑
α∈A
E˜Π[R(st+1:T) |st = s,at = α]˜Π(α|s,t)
= v˜Π(s,t).
35
B.4 Proof of Lemma 14
lim
β→+∞
arg min
⃗ a
DKL[Q(⃗ s|⃗ a,st) |Cβ(⃗ s)]
= lim
β→+∞
arg min
⃗ a
−H[Q(⃗ s|⃗ a,st)] + EQ(⃗ s|⃗ a,st)[−log Cβ(⃗ s)]
= lim
β→+∞
arg min
⃗ a
−H[Q(⃗ s|⃗ a,st)] −βEQ(⃗ s|⃗ a,st)[R(⃗ s)]
= lim
β→+∞
arg max
⃗ a
H[Q(⃗ s|⃗ a,st)] + βEQ(⃗ s|⃗ a,st)[R(⃗ s)]
⊆ lim
β→+∞
arg max
⃗ a
βEQ(⃗ s|⃗ a,st)[R(⃗ s)]
= arg max
⃗ a
EQ(⃗ s|⃗ a,st)[R(⃗ s)]
The inclusion follows from the fact that, asβ →+∞, a minimiser of the expected free energy
has to maximiseEQ(⃗ s|⃗ a,st)[R(⃗ s)]. Among such action sequences, the expected free energy minimisers
are those that maximise the entropy of future statesH[Q(⃗ s|⃗ a,st)].
B.5 Proof of Theorem 15
When T = 1 the only action isa0. We ﬁx an arbitrary initial states0 = s∈S. By Proposition 10, a
Bellman optimal state-action policy is fully characterised by an actiona∗
0 that maximises immediate
reward
a∗
0 ∈arg max
a∈A
E[R(s1) |s0 = s,a0 = a].
Recall that by Remark 6, this expectation stands for return under the transition probabilities of the
MDP
a∗
0 ∈arg max
a∈A
EP(s1|a0=a,s0=s)[R(s1)].
Since transition probabilities are assumed to be known (3), this reads
a∗
0 ∈arg max
a∈A
EQ(s1|a0=a,s0=s)[R(s1)].
On the other hand,
a0 ∈ lim
β→+∞
arg max
a∈A
exp(−G(a|st))
= lim
β→+∞
arg min
a∈A
G(a|st).
By Lemma 14, this implies
a0 ∈arg max
a∈A
EQ(s1|a0=a,s0=s)[R(s1)],
which concludes the proof.
B.6 Proof of Theorem 16
We prove this result by induction on the temporal horizonT of the MDP.
The proof of the Theorem whenT = 1 can be seen from the proof of Theorem 15. Now suppose
that T >1 is ﬁnite and that the Theorem holds for MDPs with a temporal horizon ofT −1.
Our induction hypothesis says thatQ(aτ |sτ), as deﬁned in (14), is a Bellman optimal state-
action policy on the MDP restricted to timesτ = 1,...,T . Therefore, by Proposition 10, we only
need to show that the actiona0 selected under active inference satisﬁes
a0 ∈arg max
a∈A
EQ[R(⃗ s) |s0,a0 = a].
36
This is simple to show as
arg max
a∈A
EQ[R(⃗ s) |s0,a0 = a]
= arg max
a∈A
EP(⃗ s|a1:T,a0=a,s0)Q(⃗ a|s1:T)[R(⃗ s)] (by Remark 6)
= arg max
a∈A
EQ(⃗ s,⃗ a|a0=a,s0)[R(⃗ s)] (as the transitions are known)
= lim
β→+∞
arg max
a∈A
EQ(⃗ s,⃗ a|a0=a,s0)[βR(⃗ s)]
⊇ lim
β→+∞
arg max
a∈A
EQ(⃗ s,⃗ a|a0=a,s0)[βR(⃗ s)] −H[Q(⃗ s|⃗ a,a0 = a,s0)]
= lim
β→+∞
arg min
a∈A
EQ(⃗ s,⃗ a|a0=a,s0)[−log Cβ(⃗ s)] −H[Q(⃗ s|⃗ a,a0 = a,s0)] (by (8))
= lim
β→+∞
arg min
a∈A
EQ(⃗ s,⃗ a|a0=a,s0) DKL[Q(⃗ s|⃗ a,a0 = a,s0) |Cβ(⃗ s)]
= lim
β→+∞
arg min
a∈A
G(a0 = a|s0) (by (12)).
Therefore, an actiona0 selected under active inference is a Bellman optimal state-action policy on
ﬁnite temporal horizons. Furthermore, the inclusion follows from the fact that if there are multiple
actions that maximise expected reward, that which is selected under active inference maximises the
entropy of beliefs about future states.
B.7 Proof of Proposition 18
Unpacking the zero temperature limit
lim
β→+∞
arg min
⃗ a
G(⃗ a|˜o)
= lim
β→+∞
arg min
⃗ a
DKL[Q(⃗ s|⃗ a,˜o) |Cβ(⃗ s)] + EQ(⃗ s|⃗ a,˜o) H[P(⃗ o|⃗ s)]
= lim
β→+∞
arg min
⃗ a
−H[Q(⃗ s|⃗ a,˜o)] + EQ(⃗ s|⃗ a,˜o)[−log Cβ(⃗ s)] + EQ(⃗ s|⃗ a,˜o) H[P(⃗ o|⃗ s)]
= lim
β→+∞
arg min
⃗ a
−H[Q(⃗ s|⃗ a,˜o)] −βEQ(⃗ s|⃗ a,˜o)[R(⃗ s)] + EQ(⃗ s|⃗ a,˜o) H[P(⃗ o|⃗ s)] (by (8))
⊆ lim
β→+∞
arg max
⃗ a
βEQ(⃗ s|⃗ a,˜o)[R(⃗ s)]
= arg max
⃗ a
EQ(⃗ s|⃗ a,˜o)[R(⃗ s)]
The inclusion follows from the fact that asβ →+∞a minimiser of the expected free energy
has ﬁrst and foremost to maximiseEQ(⃗ s|⃗ a,˜o)[R(⃗ s)]. Among such action sequences, the expected free
energy minimisers are those that maximise the entropy of (beliefs about) future statesH[Q(⃗ s|⃗ a,˜o)]
and resolve ambiguity about future outcomes by minimisingEQ(⃗ s|⃗ a,˜o) H[P(⃗ o|⃗ s)].
37