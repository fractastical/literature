Biol Cybern (2012) 106:523–541
DOI 10.1007/s00422-012-0512-8
PROSPECTS
Active inference and agency: optimal control without
cost functions
Karl Friston · Spyridon Samothrakis ·
Read Montague
Received: 1 February 2012 / Accepted: 16 July 2012 / Published online: 3 August 2012
© The Author(s) 2012. This article is published with open access at Springerlink.com
Abstract This paper describes a variational free-energy for-
mulation of (partially observable) Markov decision problems
in decision making under uncertainty. We show that optimal
control can be cast as active inference. In active inference,
both action and posterior beliefs about hidden states mini-
mise a free energy bound on the negative log-likelihood of
observed states, under a generative model. In this setting,
reward or cost functions are absorbed into prior beliefs about
state transitions and terminal states. Effectively, this con-
verts optimal control into a pure inference problem, enabling
the application of standard Bayesian ﬁltering techniques. We
then consider optimal trajectories that rest on posterior beliefs
about hidden states in the future. Crucially, this entails mod-
elling control as a hidden state that endows the generative
model with a representation of agency. This leads to a distinc-
tion between models with and without inference on hidden
control states; namely, agency-free and agency-based mod-
els, respectively.
Keywords Partially observable Markov decision
processes · Optimal control · Bayesian · Agency ·
Inference · Action · Free energy
K. Friston ( B)
The Wellcome Trust Centre for Neuroimaging, UCL, Institute
of Neurology, 12 Queen Square, London WC1N 3BG, UK
e-mail: k.friston@ucl.ac.uk
S. Samothrakis
School of Computer Science and Electronic Engineering,
University of Essex, Colchester CO4 3SQ, UK
R. Montague
Department of Physics, Virginia Tech Carilion Research Institute,
Virginia Tech, 2 Riverside Circle, Roanoke, V A 24016, USA
1 Introduction
In this work, we apply variational free-energy minimisa-
tion to a well-studied problem in optimal decision theory,
psychology and machine learning; namely, Markov decision
processes. In brief, we show that the free-energy principle
(active inference) and optimal decision theory provide the
same solutions when the policies from optimal decision the-
ory are replaced by (prior) beliefs about transitions from one
state to another. This is important because specifying behav-
iour in terms of prior beliefs or policies ﬁnesses the difﬁcult
problem of optimising behaviour to access distal rewards.
Furthermore, it enables one to consider more general notions
of optimality in terms of accessing particular states in the
future. Bayes-optimal behaviour then depends upon a repre-
sentation of future behaviours that necessarily entails a model
of agency. We illustrate how agency-based decision making
can solve quite difﬁcult problems and touch on the possible
implications for understanding psychopathology.
This paper considers discrete time (Markov) decision pro-
cesses of the sort found in optimal control theory, models of
behaviour and decision making ( Bellman 1952; Watkins and
Dayan 1992 ; Camerer 2003 ; Daw and Doya 2006 ; Todorov
2006; Dayan and Daw 2008 ). Our aim is to establish a
link between classical approaches to optimising decisions, in
terms of policy optimisation, and the variational free-energy
minimisation that underlies active inference ( Friston et al.
2009; Beal 2003). Here, classical optimal control schemes are
taken to imply that actions (and beliefs about hidden states
of the world) are chosen to maximise the expected reward
of future states. Conversely, in active inference, actions and
beliefs about hidden states minimise a variational free energy
bound on the (negative log) marginal likelihood of observed
states, that is, they maximise the marginal likelihood. Link-
ing the two formulations necessarily requires us to formulate
123
524 Biol Cybern (2012) 106:523–541
free-energy minimisation in discrete time and think about
how reward or cost functions are accommodated.
The key distinction between optimal control and active
inference is that in optimal control, action optimises the
expected cost associated with the hidden states a system or
agent visits. In contrast, active inference requires action to
optimise the marginal likelihood (Bayesian model evidence)
of observed states, under a generative model. This introduces
a distinction between cost-based optimal control and Bayes-
optimal control that eschews cost. The two approaches are
easily reconciled by ensuring the generative model embodies
prior beliefs about state transitions that minimise expected
cost. Our purpose is, therefore, not to propose an alternative
implementation of optimal control but accommodate optimal
control within the larger framework of active inference. In
other words, we consider Bayes-optimal control in systems
(like the brain) that have to optimise their own actions and
beliefs in real-time. This is illustrated by casting terminal cost
(the cost of the ﬁnal state) as prior beliefs about future states
that inform posterior beliefs about future control. Crucially,
this requires (future or ﬁctive) control to be treated as a hid-
den state, which means agents have to make inferences about
their future behaviour. We associate this inference with plan-
ning and a (probabilistic) representation or sense of agency.
Replacing cost functions with prior beliefs allows one to
consider optimality in terms of fulﬁlling prior beliefs about
exchanges with the world. This is the basis of active infer-
ence, in which action minimises surprise, where surprise is
based upon Bayesian predictions about outcomes that are
shaped by prior beliefs. In this view, cost functions are
replaced by (or absorbed into) prior beliefs about state transi-
tions. At ﬁrst glance, this may sound untenable; in the sense
that we entertain beliefs about particular states irrespective
of their value—in the words of one of our reviewers, “how
can I express my values in terms of my beliefs without cat-
astrophically eliding the two?” For example, I can believe I
am being drenched by rain and yet place a high cost on this
state of affairs. However, if I believe that I will seek shelter
when it rains, then I will behave optimality, provided I act
to fulﬁl these beliefs. Note that these prior beliefs are not
about states of the world but transitions among states (i.e., a
policy). So how can one specify optimal behaviour in terms
of prior beliefs?
Imagine a (Bayesian) thermostat that infers the ambient
temperature through noisy thermoreceptors. This thermostat
can position itself in relation to a heat source and is equipped
with reﬂexes that move it towards the source when the pre-
dicted temperature is higher than the sensed temperature,
and away from the source when the predicted temperature
is lower. In the absence of prior beliefs about temperature,
the predictions will be an unbiased estimate of average ther-
moreceptor activity and action (reﬂexive movement) will not
be engaged. However, if the Bayesian thermostat has strong
prior beliefs about a particular temperature (its set point), it
will move towards or away from the heat source, until the
prior predictions and ambient temperature concur. In other
words, its prediction errors will be resolved through action.
This illustrates, heuristically, how optimal behaviour can be
cast as inference. Crucially, both action and perception (esti-
mating the hidden causes of sensory input) are trying to min-
imise the same thing—roughly speaking, prediction error or
the surprise associated with sensations.
This is active inference in its simplest form and has been
considered in the context of reinforcement learning ( Friston
et al. 2009 ), action selection ( Friston et al. 2012 ) optimal
motor control ( Friston 2011 ) and dynamical systems theory
(Friston and Ao 2012 ). However, all of these treatments con-
sider behaviour in continuous time, in contrast to the dis-
crete state space and time formulations that predominate
in the literature on optimal decision problems. The moti-
vation for the current work was to bring active inference
into a discrete framework, so that it could be compared and
contrasted with conventional optimal control and decision
theoretic treatments. This allows us to make two important
points:
• Optimal control problem formulations can be absorbed
into (replaced by) active inference schemes for action
and perception.
• Active inference introduces a distinction between action
and control that leads to a sense of agency.
The second point is particularly important: in active infer-
ence, there is a necessary distinction between action—that
couples the agent to its environment—and control, which is
a random variable that represents action. This distinction is
not usually part of conventional schemes but plays a cru-
cial role in active inference, where agents have to infer their
actions using probabilistic representations over hidden con-
trol states. In what follows, we deﬁne a sense of agency as a
probabilistic representation of control that is distinct from the
action actually emitted. We hope to show that control (ﬁctive
action) plays a key role in realising prior beliefs about the
future, and ﬁnesses the problem of planning and searching
over future options.
It should be noted that this paper is about control not learn-
ing. In other words, it is about the prosecution (and plan-
ning) of a policy through inference, given a prior belief about
desired outcomes—it is not about learning a policy. In active
inference, learning a policy corresponds to acquiring (empiri-
cal) priors through optimising the parameters of a generative
model (with respect to variational free energy). Neurobio-
logically, this generally reduces to some form of associative
plasticity (Friston 2008). One straightforward way to acquire
priors—over state transitions—is to marinate an agent in the
statistics of an optimal world, as illustrated in Friston et al.
123
Biol Cybern (2012) 106:523–541 525
(2009). One might ask where these worlds come from. The
answer is that they are created by teachers, parents and con-
specifics. In robotics and engineering, the equivalent learn-
ing requires the agent to be shown how to perform a task.
This form of learning has been used to produce some com-
pelling and animate behaviours ( Tani 2003; Namikawa et al.
2011).
This paper comprises three sections: the ﬁrst reviews Mar-
kov decision processes (MDPs), their extensions to partially
observable Markov decision processes (POMDPs) and the
problem of ﬁnding an optimal policy using belief MDPs.
We then revisit the problem from the point of view of active
inference and demonstrate their formal relationships, active
inference separates inference about hidden states causing
observations from action. The motivation for this is prag-
matic; in that real agents cannot know how their action
affects hidden states (because hidden states have to be
inferred). This means that action must be based on a func-
tion of observed, as opposed to hidden states. Active infer-
ence assumes that this function is the same variational free
energy used in approximate Bayesian inference ( Hinton and
van Camp 1993 ; MacKay 1995 ; Neal and Hinton 1998 ;
Dayan et al. 1995 ; Beal 2003 ). In other words, active infer-
ence extends the minimisation of variational free energy that
underlies (approximate) Bayesian inference to include action
(Friston et al. 2010 ). However, requiring action to mini-
mise variational free energy appears to contradict optimal
control theory, which requires action to minimise expected
cost.
The purpose of the second section is to resolve this
conﬂict: in brief, we will see that the cost functions that
are used to guide action in optimal control theory can be
absorbed into prior beliefs in active inference. Effectively,
this means that agents expect their state transitions to mini-
mise cost, while action realises these prior beliefs by maxi-
mising the marginal likelihood of observations. Clearly, from
the point of view of classical POMDP treatments this does
not represent a great advance, because it just establishes a
formal equivalence between cost and priors, in terms of
ensuing action; however, this equivalence means we can dis-
pense with cost functions and formulate optimal control in
terms of approximate Bayesian inference on hidden states,
namely Bayes-optimal control. This means one can use stan-
dard Bayesian ﬁltering schemes to solve optimal control
problems.
The third section illustrates this by showing how optimal
policies can be inferred under prior beliefs about future (ter-
minal) states using standard variational Bayesian procedures
(Beal 2003 ). This example leads to a model-based optimi-
sation of behaviour that may provide a useful metaphor for
planning, anticipation and a sense of agency in real-world
agents. We conclude with an example (the mountain car prob-
lem) that illustrates how active inference furnishes online
non-linear optimal control, with partially observed (hidden)
states that are subject to random ﬂuctuations.
2 Markov decision processes
This section provides a brief summary of Markov decision
problems and their solutions based upon cost or reward func-
tions that are an integral part of optimal control theory and
reinforcement learning.
Deﬁnition A Markov decision process is the tuple (S, A,
T,r), where
• S is a ﬁnite set of states.
• A is a ﬁnite set of actions.
• T(s
′|s,a) = Pr({st+1 = s′|st = s,at = a}) is the (tran-
sition) probability that the state s′ ∈ S at time t + 1
follows action a ∈ A in state s ∈ S at time t.
• r(s) is some reward received at state s ∈ S.
Problem The goal is to ﬁnd a policy π : S → A that maxi-
mizes cumulative rewards. This can be expressed in terms of
the sequence of actions a
0:T := {a0,..., aT } that maximises
value or negative cost-to-go:
V (s) = maxa0:T
{
r(s) +
T∑
i=1
∑
s′
Pr({si = s′|s0 = s,a0,..., ai })r(s′)
}
.
(1)
The solution to this equation is a policy or sequence of opti-
mal actions at := π(st ) that maximises expected reward in
the future, given a probabilistic model of state transitions. In
this setting, (T,r) constitutes a model that comprises a tran-
sition matrix and a vector of rewards deﬁned on states. Equa-
tion (1) can be expressed as the Bellman optimality equation
by exploiting the Markovian nature of the problem using
recursive substitution ( Bellman 1952 ):
V (s) = max
a
{
r(s) +
∑
s′
T(s′|s,a)V (s′)
}
. (2)
For simplicity, we have assumed a ﬁnite horizon problem,
in which the reward is maximized from t = 0t o t = T .
This allows us to eschew notions of discounting required in
inﬁnite horizon problems. Solutions to MDPs can be divided
into reinforcement learning schemes that compute the value
function explicitly and direct policy searches that ﬁnd the
optimal policy directly.
In direct policy searches e.g., ( Williams 1992; Baxter et al.
2001), a policy is optimised by mapping each state directly
to an action, without reference to the value of the state. Poli-
cies can also be optimised directly using genetic algorithms
123
526 Biol Cybern (2012) 106:523–541
e.g., ( Gomez and Miikkulainen 2001 ; Gomez et al. 2009 ),
where agents are selected to maximise their expected reward
through successive exposures to environmental contingen-
cies. Agents that perform well are mutated accordingly, and
a new generation of agents are evaluated on the MDP, until the
policy is optimised (i.e., the Bellman error is small). Direct
policy searches are useful when the value function is hard to
learn but the policy is easy to ﬁnd.
In value-based reinforcement learning there are two gen-
eral approaches: The ﬁrst (model based) computes the value
function using a model of state transitions and is usually
considered when the state space is sufﬁciently small. This is
known as dynamic programming and involves iterating the
following two steps ( Bellman 1952 ):
π(s) = arg max
a
{
r(s) +
∑
s′
T(s′|s,a)V (s′)
}
V (s) = r(s) +
∑
s′
T(s′|s,π( s))V (s′) (3)
This scheme is guaranteed to ﬁnd the optimal solution, pro-
vided all states are visited. In value iteration or backwards
induction, the policy is only calculated when needed. This
gives the combined step in ( 1). In policy iteration (Howard
1960), the ﬁrst step is repeated until convergence, thereby
providing a definite stopping condition.
If the transition probabilities or rewards are unknown or
the state space is large (precluding a visit to every state),
the problem is usually solved with model free reinforce-
ment learning. In these schemes ( Rescorla and Wagner 1972;
Sutton and Barto 1981 ; Watkins and Dayan 1992 ; Friston
et al. 1994 ; Montague et al. 1995 ) the value function is
itself learnt; this enables one to solve Markov decision prob-
lems without learning the model (transition probabilities),
because the value function acts as a guidance function for
action.
2.1 Partially observable Markov decision processes
The formulation above assumes that the agent knows what
state it is in. In many scenarios this is unrealistic, in that an
agent cannot know the exact state of the world, given noisy
or partial observations ( Rao 2010). This leads to an extension
of the MDP framework to accommodate partially observed
states ( Kaelbling et al. 1998 ).
Deﬁnition A Partially Observable Markov Decision process
is the tuple (S, A,T,r,/Omega1,O) where
• (S, A,T,r) is the same tuple as in the MDP formulation.
• /Omega1is a ﬁnite set of observations or outcomes.
• O(o|s) = Pr({o
t = o|st = s}) is the (observation) prob-
ability of o ∈ /Omega1given the agent is in state s ∈ S at
time t.
Although it is possible to solve POMDPs using direct pol-
icy searches ( Gomez et al. 2009 ), one cannot perform value
iteration or reinforcement learning directly, as they require
the hidden states. However, a POMDP can be converted to
a MDP using beliefs b(s) about the current state: Beliefs
are sufﬁcient statistics that can be computed recursively
from the observations and actions, where (using Bayes
rule):
b
′(s′) = P(s′|o,a,b) = P(o|s′,a,b)P(s′|a,b)
P(o|a,b)
∝ O(o|s′,a)
∑
s∈S
T(s′|s,a)b(s). (4)
One can then treat the beliefs as states to create a “Belief
MDP”:
Deﬁnition A Belief Markov Decision Process is the tuple
(B, A,T,r) where
• B is the set of belief states over the POMDP states.
• A is a ﬁnite set of actions.
• T(b′|b,a) = Pr({bt+1 = b′|bt = b,at = a}) is the
probability that the belief state b′ ∈ B at time t + 1
follows action a ∈ A in belief state b ∈ B at time t.
• r(b) = ∑
s∈S b(s)r(s) is the reward expected in belief
state b ∈ B.
Remark Note that a belief MDP is deﬁned over a continu-
ous (belief) state space, which can make them hard to solve
using reinforcement learning or dynamic programming (see
Oliehoek et al. 2005 ). However, there are heuristic solu-
tions, which range from ignoring the observation model com-
pletely to using function approximators to encode beliefs.
The difﬁcult problem of solving large POMDPs is central
to Artiﬁcial Intelligence and is an important focus of cur-
rent research ( Silver and Veness 2010 ). See Duff (2002)f o r
a full treatment of POMDPs based on a Bayesian formu-
lation that exploits techniques from reinforcement learning,
such as Monte Carlo simulations and parameterised function
approximators.
In summary, classical approaches to Markov decision pro-
cesses rest on the optimization of future rewards and specify
an optimal policy in terms of an action from any given state.
Note that MDPs appeal to a solipsistic view of the world, in
which an agent tries to maximise its future reward against
a nature that is governed by laws the agent can infer (one
of their key features is the assumption that only the current
state matters, hence the ‘Markov’ label). Partially observed
Markov decision processes make inference explicit by intro-
ducing a probabilistic mapping between hidden states of the
world and observations. Thus, the beliefs that the agent forms
(by observing histories of actions and states) can be exploited
to optimise behaviour.
123
Biol Cybern (2012) 106:523–541 527
2.2 Optimal control as inference
The focus of this paper is an optimal decision making or con-
trol as an inference process. Early work in this area addressed
dual control problems; for example, Feldbaum (1961)d i s -
cussed control in the absence of complete information using
a Bayesian framework: see Filatov and Unbehauen (2004)
for review. The integration of control and inference was pur-
sued by replacing the notion of utility in decision diagrams
with an auxiliary random variable conditioned on desired
observations. This makes maximizing utility equivalent to
maximizing the likelihood of desired observations ( Cooper
1988; Pearl 1988; Shachter 1988). Subsequent work focussed
on efﬁcient methods to solve the ensuing inference problem
(Jensen et al. 1994 ; Zhang 1998 ). Later, Dayan and Hinton
(1997) proposed an expectation maximization algorithm for
reinforcement learning in the case of immediate rewards,
while (Toussaint and Storkey 2006) cast the problem of com-
puting optimal policies as a likelihood maximization prob-
lem. This generalized the work of Cooper and Shachter to the
case of inﬁnite horizons, and cost functions over future states.
More recently, this approach has been pursued by applying
Bayesian procedures (or minimising Kullback–Leibler diver-
gences) to problems of optimal decision making in MDPs
Botvinick and An 2008 ; Hoffman et al. 2009 ; Toussaint et al.
2008).
Related work on stochastic optimal control ( Kappen
2005a,b; van den Broek et al. 2008 ; Rawlik et al. 2010 ),
exploits the reduction of control problems to inference prob-
lems by appealing to variational techniques to provide efﬁ-
cient and computationally tractable solutions. In particular,
formulating the problem in terms of Kullback–Leibler min-
imization ( Kappen 2005a ,b) and path integrals of cost func-
tions using the Feynman–Kac formula ( Theodorou et al.
2010; Braun et al. 2011 ).
In summary, current approaches to partially observed
MDPs and stochastic optimal control minimise cumulative
cost using the same procedures employed by maximum like-
lihood and approximate Bayesian inference schemes. Indeed,
the formal equivalence between optimal control and estima-
tion was acknowledged by Kalman at the inception of Bayes-
ian ﬁltering schemes ( Todorov 2008). In the next section, we
revisit this equivalence and show how any optimal control
problem can be formulated as a Bayesian inference problem,
within the active inference framework. The key aspect of this
formulation is that action does not minimise cumulative cost
but maximises the marginal likelihood of observations under
a generative model that entails an optimal policy.
3 Active inference
This section sets up the formalism of active inference, in
which the optimisation of action and beliefs about hidden
states are treated as two separate processes that both maxi-
mise model evidence or the marginal likelihood of observa-
tions. In brief, in active inference, action elicits observations
that are the most plausible under beliefs about (future) states.
This is in contrast to conventional formulations, in which
actions are chosen to elicit (valuable) states. We will see that
active inference can implement any optimal policy; however,
it does not solve the optimal control problem, because active
inference does not minimise cost-to-go but minimises the self
information of observations (aka surprise). This follows from
the fact that active inference is a corollary of the free-energy
principle:
3.1 The free-energy principle and active inference
The free-energy principle ( Friston et al. 2006 ) tries to explain
how agents occupy a small number of attracting states in
terms of minimising the Shannon entropy of the probabil-
ity distribution over their observed states. Under ergodic
assumptions, this entropy is (almost surely) the long-term
time average of self information or surprise ( Birkhoff 1931).
Surprise, or more precisely surprisal, is a (probability) mea-
sure −ln P(o
t |m) on the states observed by an agent. Min-
imising the long-term average Et [−ln P(ot |m)] is assured
when agents minimise surprise at each time point. Surprise is
just the negative log likelihood of observations, marginalised
over hidden states. This marginal likelihood is also known
as model evidence. This means that surprise is minimised
(approximately or exactly) if agents minimise a variational
free energy bound on surprise ( Feynman 1972 ; Hinton and
van Camp 1993 ), given a generative model m of state transi-
tions ( Dayan et al. 1995 ; Friston 2010 ).
This formulation of behaviour is based on ergodic argu-
ments about the nature of self organising systems ( Ashby
1947)—for a fuller discussion please see Friston and Ao
(2012) and Friston (2010) for their neurobiological impli-
cations. These arguments suggest that the long term aver-
age of variational free energy upper bounds the (Shannon)
entropy of observations over time; which implies that action
must minimise variational free energy to resist the disper-
sion of its states by random ﬂuctuations ( Evans 2003 ). This
is active inference ( Friston et al. 2010 ), which extends the
minimisation of variational free energy implicit in approxi-
mate Bayesian inference on hidden states to include action
per se. There is a fairly developed literature on variational
free-energy minimisation and active inference in the neu-
rosciences; covering things from perceptual categorisation
of bird songs, through to action observation. Table 1 lists
some processes and paradigms we have considered under
this framework. The current paper introduces hidden control
states that allow one to model agency and planning, using
exactly the same principles used previously to explain vari-
ous aspects of self organisation and perception.
123
528 Biol Cybern (2012) 106:523–541
Table 1 Processes and paradigms that have been modelled using vari-
ational free-energy minimisation and active inference
Process or paradigm References
Perceptual categorisation (bird
songs)
Friston and Kiebel (2009b)
Novelty and omission-related
responses
Perceptual inference (speech) Kiebel et al. (2009b)
Pereptual learning (mismatch
negativity)
Friston and Kiebel (2009b)
Attention and the Posner paradigm Feldman and Friston (2010)
Attention and biased competition
Retinal stabilization and
oculomotor reﬂexes
Friston et al. (2010)
Saccadic eye movements and cued
reaching
Bayes-optimal sensorimotor
integration
Heuristics and dynamical systems
theory
Friston (2010)
Action observation and mirror
neurons
Friston et al. (2011)
Motor trajectories and place cells
Goal-directed behaviour Friston et al. (2009)
The Mountain car problem
In the present context, active inference unpacks some of
the implicit assumptions in Markov decision problems. In
particular, it speciﬁes explicitly what the agent knows about
the effects of its actions. It does this through a sampling prob-
ability that replaces the observation probability of partially
observable MDPs. As we will see, this means that probabi-
listic transitions among observations are conditioned upon
action but, in contrast to the MDP formulation, probabilistic
transitions among hidden states are not: action simply serves
to realise posterior beliefs about state transitions. This con-
ditioning of observations on action (as opposed to condition-
ing states on action) is not unrelated to treatments based on
observer operator models and predictive representations of
state: see Jaeger (2000) and Littman et al. (2002).
Deﬁnition The free-energy formulation refers to the tuple
(/Omega1,S, A,ϑ ,P, Q, R) comprising:
• A ﬁnite set of observations /Omega1.
• A ﬁnite set of hidden states S.
• A ﬁnite set of actions A.
• Real valued parameters ϑ ∈ R
d .
• A sampling probability R (o′|o,a) = Pr({ot+1 =
o′|ot = o,at = a}) that observation o′ ∈ /Omega1at time
t + 1 follows action a ∈ A, given observation o′ ∈ /Omega1at
time t.
• A generative probability P(o,s,θ |m) = Pr({o0,..., ot }
= o,{s0,..., sT }= s,ϑ = θ) over observations to time
t, states at all times and parameters
• A recognition probability Q(s,θ |μ)= Pr({s0,..., sT }=
s,ϑ = θ) over states at all times and parameters with
sufﬁcient statistics μ ∈ Rd .
Here, m denotes the form of a generative model or proba-
bility Pm (o,s,θ) := P(o,s,θ |m). For clarity, we will omit
the conditioning on m for all but prior terms in the gener-
ative probability. The sufﬁcient statistics of the recognition
probability Qμ(s,θ) := Q(s,θ |μ) encode a probability dis-
tribution over a sequence of hidden states s ={ s0,..., sT }
and the parameters of the model θ ∈ ϑ. Crucially, the recog-
nition probability and its sufﬁcient statistics encode hidden
states in the future and past, which themselves can change
with time: for example, μ
k ={ μk
0,...,μ k
T }, where μk
t is the
probability over hidden states at time t (in the future or past)
under the recognition probability at time k.
Remark It should be noted that the definitions above do not
describe a process—in the sense that the sampling and gen-
erative probabilities above would not be used to generate
a sequence of observations. These probabilities underwrite
the action and perception of the agent—they correspond to
its formal beliefs about the sensory consequences of action
(sampling probability) and the hidden states causing observa-
tions (generative probability). In other words, the true states
generating observations are unknown and unknowable from
the point of view of the agent. This is important when sim-
ulating active inference, where one has to make a careful
distinction between the (true) states generating observations
and those (hidden) states assumed by the agent. We will see
an example of this later.
There are three important distinctions between this setup
and that used by Markov decision processes. As in partially
observed MDPs, there is a distinction between states and
observations. However, the transition probability over states
has been replaced by a sampling probability over observa-
tions. This means, we can formulate everything in terms
of observed states (observations) and inference on hidden
states. In other words, the agent does not need to know the
effect of its actions on the (true) state of the world. It is
instead equipped with a probabilistic mapping between its
actions and direct sensory consequences—this is the sam-
pling probability. This may sound a bit unusual but is a
central tenet of active inference, which separates knowledge
about the sensory consequences of action from beliefs about
the causes of those consequences. In other words, the agent
knows that if it moves it will sense movement (cf. proprio-
ception); however, beliefs about hidden states in the world
causing movement have to be inferred. These hidden states
may or may not include its own action: the key distinction
between the agency-free and agency-based schemes consid-
ered below depends on whether the agent represents its own
action or not. Our previous illustrations of active inference
123
Biol Cybern (2012) 106:523–541 529
have been agency free; where (in a biological setting) action
corresponds to classical motor reﬂexes, whose set point is
determined by proprioceptive predictions. In this context, the
sampling probability enables action (reﬂexes) to fulﬁl these
predictions.
The second distinction is that we have introduced genera-
tive and recognition probabilities that are used to infer hidden
states. Crucially, these hidden states include future and past
states. In other words, the agent represents a sequence or
trajectory over states, as opposed to just the current state.
The generative probability is over the sequence of sensory
states up until the current time, while the recognition prob-
ability changes with its time-dependent sufﬁcient statistics.
This means that the recognition distribution at any one time
is over the sequence or trajectory of states at all times. This
enables inference about a particular state in the future to
change with time. This will become important later, when
we consider planning and agency.
Finally, there are no reward or cost functions. This is an
important point and illustrates the fact that active inference
does not call upon the notion of reward to optimise behav-
iour—optimal behaviour minimises variational free energy,
which is a functional of observations and the recognition
probability distribution or its sufﬁcient statistics. As we will
see later, cost functions are replaced by priors over hidden
states and transitions, such that costly states are surprising
and are avoided by action.
3.2 Perception and action
The free-energy principle states that the sufﬁcient statistics of
the recognition probability and action minimise free energy
μ
t = arg min
μ
F ({o0,..., ot },μ )
at = arg min
a
∑
/Omega1
R(ot+1|ot ,a)F ({o0,..., ot+1},μt ).
(5)
This dual optimisation is usually portrayed in terms of per-
ception and action, by associating the sufﬁcient statistics with
internal states of the agent (such as neuronal activity or con-
nection strengths) and associating action with the state of
effectors or the motor plant. Equation 5 just says that internal
states minimise the free energy of currently observed states,
while action selects the next observation that, on average, has
the smallest free energy.
By factorising the generative probability P(o,s,θ |m) =
P(o|s,θ) P(s,θ |m) into likelihood and prior probabilities,
one can express the free energy as follows:
F (o,μ )= E
Q[−ln P(o,s,θ |m)]− EQ[−ln Q(s,θ |μ)]
= DKL [Q(s,θ |μ)||P(s,θ |o)]− ln P(o|m). (6)
The ﬁrst equality in ( 6) expresses free energy as a Gibbs
energy (expected under the recognition distribution) minus
the entropy of the recognition distribution. The second shows
that free energy is an upper bound on surprise, because the
ﬁrst (Kullback–Leibler divergence) term is non-negative by
Gibbs inequality (Beal 2003). This also means that when free
energy is minimised, the recognition distribution approxi-
mates the posterior distribution Q(s,θ |μ) ≈ P(s,θ |o) over
hidden states and parameters. This formalises the notion of
unconscious inference in perception ( Helmholtz 1866/1962;
Dayan and Hinton 1997 ; Dayan et al. 1995 ) and, under some
simplifying assumptions, corresponds to predictive coding
(Rao and Ballard 1999 ).
The minimisation of free energy, with respect to action in
(5) is active inference. This formulation highlights the fact
that action selects observable states (not hidden states) that
are the least surprising by virtue of having the smallest free
energy. The free energy is determined by the sufﬁcient statis-
tics of the recognition distribution. The optimisation of these
sufﬁcient statistics—the ﬁrst equality in ( 5)—rests upon the
generative model and therefore depends on prior beliefs. It
is these that specify what is surprising and reproduces the
optimal policies considered above. There are clearly many
ways to specify the generative probability. We will consider
two forms, both of which respect the Markov property of
decision processes. The ﬁrst reproduces the behaviour under
the optimal policy for Markov decision problems and can be
regarded as the corresponding free-energy formulation:
3.3 An agency-free formulation of optimal policies
The natural generative model for a partially observable Mar-
kov decision process can be expressed in terms of a likelihood
plus priors over states and parameters, with the following
forms:
P(o,s,θ |m) = P(o|s,θ) P(s|θ) P(θ
|m)
P({o0,..., ot }|s,θ) = P(o0|s0)P(o1|s1)... P(ot |st )
P(s|θ) = P(s0|m)
T −1∏
t=0
P(st+1|st ,θ)
(7)
This implies that the current observation depends only on
the current hidden state (like a belief MDP), where the hid-
den states are a Markov process, whose transition probabili-
ties depend upon the parameters (unlike a belief MDP). We
will assume that the priors over the parameters P(θ|m) =
δ(θ − θ
π ) make the priors over state transitions equiva-
lent to the optimal policy of the previous section. In other
words, we assume the priors have a point mass over val-
ues that render the transition probabilities P(s
t+1|st ,θπ ) =
T(st+1|st ,π( st )) optimal in the conventional sense (were
the transition probability is deﬁned for Markov decision
123
530 Biol Cybern (2012) 106:523–541
processes above and π(st ) corresponds to action under an
optimal policy).
The second equality in ( 6) shows that minimising the free
energy, with respect to the sufﬁcient statistics of the recog-
nition distribution, renders it the posterior over hidden states
and parameters. This means that the recognition distribution
becomes the posterior distribution, where (noting that the
posterior and prior over parameters are the same Dirac delta
function)
Q(s,θ |μ
t ) ≈ P({s0,..., sT }|{o0,..., ot }, θ)δ(θ − θπ).
(8)
We have used an approximate equality here because we are
assuming approximate Bayesian inference. In this context,
free-energy minimisation with respect to action becomes,
from ( 5) and ( 6):
a
t = arg min
a
∑
/Omega1
R(ot+1|ot ,a)F ({o0,..., ot+1},μt )
= arg max
a
∑
/Omega1
R(ot+1|ot ,a)EQ(st+1)[ln P(ot+1|st+1)]
Q(st+1) ≈
∑
S
P(st+1|st ,π( st ))P(st |{o0,..., ot }) (9)
Note that the free energy of the new observation is just its
improbability, expected under posterior beliefs about the hid-
den states that cause it—these posterior beliefs correspond to
the marginal recognition distribution Q(s
t+1), over the next
hidden state.
It can be seen from ( 9) that action under active inference
is exactly the same as action under the optimal policy. This
is because action selects the observation that is most likely
under the (approximate) posterior distribution. In turn, this
is the hidden state that follows the currently inferred state,
under the optimal policy. This means that active inference can
be considered as a generalisation of optimal control. This is
because there are prior beliefs that can reproduce an optimal
policy to minimise expected cost. However, there are many
other prior beliefs that specify Bayes-optimal control that
do not minimise expected cost—see the handwriting simu-
lations in Friston et al. (2011) or the animate behaviours in
Tani (2003).
3.4 Optimality and complete class theorems
The fact that one can replace cost functions with priors to
produce the same behaviour is related to the complete class
theorem ( Brown 1981 ). The complete class theorem states
that any admissible decision rule (behaviour) is Bayes-opti-
mal for at least one pair of prior beliefs and cost function
(Robert 1992 ). However, this pair is not necessarily unique:
in other words, the same decisions can be reproduced under
different combinations of prior and cost functions. In one
sense, this duality is resolved by replacing the cost functions
of optimal control theory with prior beliefs about state tran-
sitions. Casting Bayes-optimal decisions in this way simply
means that the agent believes it will move through state space
in a way that minimises future costs, while action fulﬁls these
prior beliefs.
Clearly, this does not address the problem of how poli-
cies are learned; however, it shows how active inference can
be used to implement an optimal policy. From the point of
view of active inference, it would be perfectly possible to
use solutions of the appropriate Bellman optimality equation
(i.e., reinforcement learning) to create controlled environ-
ments that enable agents to learn optimal policies: however,
value functions per se are not learned under active inference;
it is the parameters of the prior distributions that are learned.
Conversely in reinforcement learning, it is sufﬁcient to learn
value functions without having to learn transition probabil-
ities: see ( 3). It is in this sense that reinforcement learning
is referred to as model free: see Dayan and Daw (2008) and
Gläscher et al. (2010).
An example of learning policies through priors was pre-
sented in Friston et al. (2009), where an agent was immersed
in a controlled environment that enforced optimal trajec-
tories through state space. In this example, the trajectories
were optimised by minimising the Kullback–Leibler diver-
gence between the ergodic (invariant) probability density
function associated with state transitions and a density that
minimised the expected terminal cost. The ergodic density
was the solution to the appropriate Fokker–Planck or Kol-
mogorov forward equation (a differential equation describ-
ing the evolution of a system’s ensemble density). The agent
then learned the optimal policy by minimising variational
free energy, with respect to posterior beliefs about parame-
ters encoding transition probabilities. In this example, all the
heavy lifting was done prior to learning, in the creation of
the controlled environment—all the agent had to do was learn
optimal state transitions using standard Bayesian learning. In
the next section, we consider how agents infer the optimal
policy online, as opposed to learning optimal prior beliefs
about state transitions.
4 Bayes-optimal control without cost functions
In this section, we consider agency based optimisation, in
which the hidden states are extended to include hidden con-
trol states. This is necessary, when inferring optimal state
transitions, because transitions depend upon action in the
future which is, by definition, hidden from observation. In
what follows, we focus on policies that are speciﬁed by prior
beliefs about speciﬁc states that will be occupied at speciﬁc
times in the future. This corresponds to a ﬁnite horizon con-
trol problem with terminal costs over states and intermediate
123
Biol Cybern (2012) 106:523–541 531
control costs that are speciﬁed through prior beliefs about
control. Our special focus here is the implication for the
timing of optimisation processes—given that real agents have
to rehearse their future options before selecting an action.
4.1 Agency-based optimisation
In what follows, we describe a scheme for partially observ-
able Markov decision processes that optimises action in rela-
tion to prior beliefs about future states. This scheme uses
representations of hidden states in the future to optimise a
sequence of ﬁctive actions (policy) before they are enacted.
Clearly, this requires the agent to infer (future) actions, which
calls for a more sophisticated generative model—a model of
agency or control. In other words, the agent must represent
its future actions. This leads to Bayesian updates of posterior
beliefs about future states that include control. Note that this
is not equivalent to solving the optimal control problem at
each point in time; because the Bayesian updates are them-
selves a Markovian process, in which posterior beliefs about
future states depend on the corresponding beliefs at the pre-
ceding time point. This dependency is exploited to update
posterior beliefs about the future that are held at the current
time.
The heuristic beneﬁt of introducing hidden control states
is that putative actions in the future can be optimised, when
choosing the best current action. The ensuing solutions are
optimal in relation to prior beliefs about states that will be
occupied. These are prior beliefs about the ﬁnal (desired)
hidden state and can be expressed in terms of the following
generative model:
An agency-based model The generative probability used
in this section introduces (a ﬁnite set of) control states u ∈ U
and can be expressed in terms of the following likelihood and
prior distributions:
P(o,s,u,θ |m) = P(o|s,θ) P(s,u|θ) P(θ|m)
P({o0,..., ot }|s,θ) = P(o0|s0,θ) P(o1|s1,θ)... P(ot |st ,θ)
P(s,u|θ) = P(sT |θ)
T∏
t=1
P(st−1|st ,ut ,θ) P(ut |θ)
(10)
Remark There are two important aspects of this generative
model: ﬁrst, control states are not action; they are an inter-
nal representation of action that may or may not be related
to actions emitted by the agent. In the generative model,
control states affect the transitions among hidden states; in
other words, they only affect outcomes vicariously through
changes in hidden states. It is these control states that repre-
sent agency, which may or may not be a veridical represen-
tation of what the agent can actually do (or is doing)—in this
sense, they can be regarded as ﬁctive action that gives the gen-
Fig. 1 Probabilistic graphical model illustrating the Markovian depen-
dencies among hidden states generating sensory data. These hidden
states (s
t ,ut ) are represented explicitly, over all time points: t =
1,..., T . This means there is a representation of the past and future
that includes hidden states mediating control. Note that the dependency
of this hidden Markov model runs backwards in time so that all pre-
ceding hidden states are conditioned recursively on the ﬁnal or terminal
goal state
erative model extra degrees of freedom to model state tran-
sitions under prior beliefs. Recall that action only changes
observations and is selected on the basis of posterior beliefs
about the next observable state. Conversely, control states
are modelled as hidden states over time and are inferred.
This means they only exist in the mind (posterior beliefs) of
the agent.
Second, the priors on the hidden states P(s,u|θ) are for-
mulated in a pullback sense, that is, they run backwards in
time. This preserves the Markov dependencies but allows
us to specify the prior over a sequence of states in terms of
transition probabilities and a prior distribution over the ﬁnal
(terminal) state. Put simply, the parameters of the (transition)
model encode where I came from, not where I am going. See
Fig. 1. This particular form of prior belief is chosen for con-
venience, because it accommodates beliefs about the desired
ﬁnal state—of the sort that would be speciﬁed with a terminal
cost function, r(s
T ).
The generative model in ( 10) is fairly general and makes
no speciﬁc assumptions about the implicit cost of inferred
control (e.g., it does not assume quadratic control costs) or
allowable state transitions. In what follows, we will illus-
trate inference or model inversion using a particular param-
eterisation and variational inversion scheme. This example
is used to illustrate agency based inference, accepting that
there are many different model parameterisations and inver-
sion schemes that could have been used.
Generative probability This model comprises the follow-
ing likelihood and prior distributions:
123
532 Biol Cybern (2012) 106:523–541
P(ot |st ,θ) = A · st
P(st−1|st ,ut ,θ) = (∏
i Buti
i ) · st
P(sT |θ) = c
P(ut |θ) = ∏
i duti
i
(11)
The parameters θ ={ A,B1,B2,..., c,d} of this model
are
A ={ aij }:
∑
j
aij = 1, ∀i
Bk ={ bijk }:
∑
j
bijk = 1, ∀i,k
c ={ ci }:
∑
i
ci = 1
d ={ di }:
∑
i
di = 1
(12)
In this particular model, the parameters in the matrices Bk
encode transition probabilities among hidden states that are
engaged when the control state uk = 1, where the control
states have a multinomial distribution—only one can be ‘on’
at any time. The hidden states cause observed states through
the mapping encoded by A. The vectors c and d encode the
prior distribution over the ﬁnal hidden state and control states
respectively; these specify the goal and prior costs on control.
Recognition probabilityTo exploit the Markovian form of
the generative model we will use an efﬁcient approximate
inference scheme afforded by variational Bayesian learning
(Beal 2003 ); for a tutorial see Fox and Roberts (2011). The
efﬁciency rests on replacing posterior dependencies among
hidden states (over time) with mean ﬁeld effects on the mar-
ginal probabilities at each time point. This is achieved using
the following mean-ﬁeld assumption for the recognition dis-
tribution:
Q(s,u) =
T∏
t=1
Q(st )Q(ut )
Q(st |αt ) = ∏
i
αsi
ti :
∑
i
αti = 1
Q(ut |βt ) = ∏
i
βui
ti :
∑
i
βti = 1
(13)
Standard variational Bayesian learning now provides a recipe
for optimising the sufﬁcient statistics (αt ,βt ) of the recog-
nition probability over hidden and control states in a series
of variational updates. It is fairly straightforward to show
that the marginal recognition distributions that minimise free
energy can be expressed in terms of variational energies
(I (s
t ), I (ut )), where
Q(st |αt ) ∝ exp(I (st ))
Q(ut |βt ) ∝ exp(I (ut )). (14)
The variational energies for the hidden and control states
at each time are just the (negative) Gibbs energies in ( 6)
expected under the Markov blanket of each state.
I (st ) = EQ(st−1)Q(st+1)Q(ut )Q(ut+1)[ln P(ot |st )
+ln P(st |st+1,ut+1) + ln P(st−1|st ,ut )]
=[ ln AT · ot ]+
∑
j
β(t+1)j ln Bj · αt+1
+
∑
j
βtj ln BT
j · αt−1
I (uti ) = EQ(st−1)Q(st )[ln P(st−1|st ,ut ) + ln P(ut |m)]
= αT
t−1 · ln Bi · αt + ln di
(15)
Here, the square brackets in [ln AT ·ot ] indicate that this term
is only used when observations are available. This highlights
an important aspect of the update scheme; namely, the hidden
states at all points during the sequence are updated iteratively
at each time point. Although, hidden states in the future are
not informed by concurrent sensory information, they are still
constrained by prior beliefs about future states. The efﬁciency
of this scheme rests on the fact that the Markov blanket of
any state is limited to immediately preceding and past states.
This simplicity is due to the way Markov decision problems
are set up (see Fig. 1). The ensuing variational updates for
the sufﬁcient statistics μ
k ={ αk
0 ,...,α k
T ,β k
0 ,...,β k
T } at
successive times k are:
for k = 1t o T
until · convergence :
for t = (T − 1) to (k + 1)
α′
t = exp([ln AT · ot ]
+
∑
j
βk
(t+1)j ln Bj · αk
(t+1)
+
∑
j
βk
tj ln BT
j · αk
(t−1))
αk+1
t = α′
t∑
i α′
ti
β′
ti = exp(αkT
t−1 · ln Bi · αk
t + ln di )
βk+1
t = β′
t∑
i β′
ti
(16)
Remark First, note the normalisation of the sufﬁcient sta-
tistics in ( 16). This normalisation is necessary because of
the implicit normalisation term (partition function) in ( 14).
This normalisation is a just a re-scaling (all the hard work is
done in computing the variational energies). The interesting
aspect of these updates is their nested structure over time.
At each time point, the variational updates cycle over repre-
sentations of future states to update the sufﬁcient statistics
encoding posterior beliefs. In ( 16), this cycling continues
until convergence, although a ﬁxed (small) number of cycles
usually sufﬁce (see next section). Furthermore, the order of
the updates can be from the future to the past (cf., backwards
induction) as shown above, from the past to the future or both
(cf., forward-backward schemes). These update cycles are
themselves repeated as time progresses, so that there is con-
vergence both within and between cycles. This means the suf-
ﬁcient statistics change over two timescales; a fast timescale
123
Biol Cybern (2012) 106:523–541 533
that updates posterior beliefs about the future and a slow
timescale that updates posterior beliefs in the future. Pos-
terior beliefs about the trajectory, at both timescales, ensure
that the trajectory convergences on the ﬁnal (desired) loca-
tion, where the anticipated trajectory (and control) is realised
through action. Anticipated control corresponds to posterior
beliefs about future control states that we associate with a
sense of agency. In this nested updating, ﬂuctuations or per-
turbations to the anticipated trajectory are accommodated
easily by the implicit online updating.
It is interesting to speculate about neurophysiologic imple-
mentations of this sort of scheme, particularly in relation to
nested electrophysiological oscillations (Canolty et al. 2006).
The notion here is that the electrophysiological correlates of
updating may show nested oscillations, with fast (gamma)
oscillations reﬂecting updates in a ﬁctive future and slower
(theta) dynamics that reﬂect updates in real time, with time-
scales of 25 and 250 ms, respectively.
The treatment above assumes that the parameters of the
transition probabilities under different controls are known.
If they are not, then it is relatively straightforward to extend
the variational Bayesian scheme above to include variational
updates for unknown parameters, as described in Chapter 3
of ( Beal 2003 ). The only special consideration here is the
use of conjugate (Dirichlet) priors over the parameters, θ ⊃
{A,B
1,B2,... } to ensure the recognition distributions retain
their multinomial form.
In summary, this section has introduced policy optimi-
sation in terms of active inference that realises prior beliefs
about a desired future state. In contrast to agency free models,
the desired state can be changed without relearning an opti-
mal policy. This endows the scheme with a context sensitivity
that may be important in hierarchical generative models, in
which ﬁnal states are themselves speciﬁed by trajectories
over slower timescales ( Kiebel et al. 2009a ). In short, even if
prior beliefs about states change, posterior beliefs about the
parameters do not and they can be used to access a new goal:
this is the essence of agency based control illustrated in the
next section:
5 Simulations: the mountain car problem
In the section, we apply the scheme of the previous section to
a well known problem in optimal control theory that presents
some special challenges: The mountain car problem can be
envisaged as follows; one has to park a mountain car half-
way up the side of a valley. However, the mountain car is not
strong enough to climb directly to the parking place, which
means the only way to access the goal is to ascend the other
side of the valley to acquire sufﬁcient momentum during the
return trip. This represents an interesting problem, when con-
sidered in the state space of position and velocity: the agent
has to move away from its target location to attain the goal
later. In other words, it has to execute a circuitous trajec-
tory through state space (as in avoiding obstacles). We have
used this problem previously to illustrate how Bayes-optimal
control can be learned in terms of the parameters controlling
prior beliefs about trajectories ( Friston et al. 2009 ) and using
heuristic policies ( Gigerenzer and Gaissmaier 2011 ) based
on the destruction of costly ﬁxed point attractors ( Friston
2010).
It should be noted that the mountain car problem is nor-
mally cast as a learning problem—in which an optimal policy
has to be learned. However, here, we are using it to illustrate
optimal behaviour in terms of inference. In other words, we
assume the agent has already learned the constraints afforded
by the world it operates in—and now has to infer an optimal
policy within a single trial. In this setting, the mountain car
problem provides a challenging (non-linear) inference prob-
lem, particularly when we include random ﬂuctuations in
both the states generating observations and the observations
themselves. The mountain car problem can be speciﬁed with
the equations of motion in Fig. 2. Here, we consider a dis-
crete state space and time formulation of this problem and
use it to illustrate agency based control.
5.1 Simulation setup
To create a discrete version of this problem, we ensured that
expected changes in position and velocity match the equa-
tions of motion, when integrated over discrete time intervals
(here /Delta1t = 2 s). The ensuing pullback probabilities for each
level of control satisfy (subject to the constraint that only
the states adjacent to the expected position and velocity are
nonzero)
∑
i
x(si )Bijk = x(sj ) − f (x(s j ),a(uk ))/Delta1t (17)
In practice, we actually compute the equivalent forward
transition probabilities required for the sampling probability
and then normalise their transpose to compute the pullback
probability matrices. Here, x(s
i ) ∈ R2 returns the con-
tinuous position and velocity associated with the i-th hid-
den state si . Similarly, a(uk ) ∈ R returns the real valued
action associated with the k-th control state uk . In these
simulations, we used ﬁve levels of control corresponding
to a(uk ) ∈{ −2,−1,0,1,2}. This means the agent assumes
that strong or intermediate acceleration can be applied in a
right or leftward direction.
To simulate random ﬂuctuations in the motion of the
mountain car, we convolved the parameter matrix encoding
(pullback) probabilities over position and velocity with the
kernel: [1
4 , 1
2 , 1
4 ]. This just smears the probabilities to aug-
ment the uncertainty about the previous states incurred by
123
534 Biol Cybern (2012) 106:523–541
1
8
()
x
f aσϕ
′⎡⎤⎡⎤== ⎢⎥⎢⎥  ′′ () −∂ −⎣⎦ ⎣⎦
xxx xx
Equations of motion
-2 -1 0 2
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
position
height
22 3 / 2 4 1
8
21 : 0() (1 5 ) : 0ϕ −
−− ≤⎧= ⎨−+ − >⎩
xxx xx x x
.
.
(x)ϕ
Fig. 2 Schematic of the mountain car problem: the upper panel (and
associated equations) illustrate the landscape or potential energy func-
tion that deﬁnes the motion of the car. This has a minima at x =− 0.5.
The mountain-car is shown at the desired parking position at the top of
the hill on the right x = 1 (indicated with a red ball). The equations
of motion in the lower panel describe the forces exerted on the car,
which include σ(a), a sigmoid (hyperbolic tangent) function of action,
gravitational forces and friction.
discretising state space. The state space comprised 32 posi-
tion (from -2 to 2) and velocity bins (from -3 to 3), giving
32 × 23 = 1,024 discrete states.
The resulting parameters are illustrated in Fig. 3 in terms of
the probability distributions four and eight time steps before
the ﬁnal position, x = (1,0) in this example. The top row is
for a control state that pushes the car to the left. This means
that preceding states are more likely to be further up the oppo-
site hill, so that the car is accelerating with greater velocity to
the ﬁnal position (the horizontal axis corresponds to position
and the vertical axis to velocity). One can see the expected
differences after a few time steps, reﬂecting the different
directions in which control forces are applied. After eight
time steps, the distributions become increasingly dispersed
due to the uncertainty introduced by smoothing the transi-
tion probabilities and the fact that motion and velocity are
encoded with ﬁnite sized bins.
For simplicity, we assumed a one-to-one mapping between
hidden and observed states; that is A = I and placed uni-
form prior costs over control, such that d =[
1
5 , 1
5 , 1
5 , 1
5 , 1
5 ].
Prior beliefs about the ﬁnal state specify the goal x(si :
i = χ(c)) = (1,0); namely, to maintain a position at the
parking location with zero velocity (see Fig. 2). Finally, the
action-dependent sampling probabilities R(ot+1|ot ,at ) were
the transposed versions of the pullback probabilities in ( 17).
These sampling probabilities were used to select action and
to generate the next sensory input. A subtle point here is that
we do not need to refer to, or enumerate, real states in the
world; everything is cast in terms of quantities that the agent
can access. Action used the same ﬁve levels as the control
states. However, as noted above, there is no requirement that
action and control be related formally in this way.
Figure 4 shows the results of a simulation using T = 16
time steps and a starting position of x = (0,0). In these,
and all subsequent simulations, the variational updates were
repeated eight times and then an action was selected. This is
a fairly arbitrary number of variational cycles but sufﬁcient
for the current problem (in which the updates generally con-
verged after a couple of iterations). We chose eight cycles
in anticipation of future simulations using continuous time
formulations of the scheme in this paper. These simulations
produce dynamics that are not dissimilar to the nested oscil-
lations seen in theta-gamma phase coupling between the pre-
frontal cortex and hippocampal system ( Canolty et al. 2006 ;
Axmacher et al. 2010 ), where there are about eight gamma
cycles for each theta cycle.
The upper panel of Fig. 4 shows the trajectories (real and
anticipated) through state space, while the lower panels show
the inferred control states and action selected as a function of
time. The darker line in the upper panel connects the states
visited over the 16 time steps, while the grey lines report
the anticipated trajectories from the beginning of the trial to
the end. The inferred trajectories are shown as the expected
position and velocity, based on posterior beliefs over discrete
states. One can see that the actual trajectory fulﬁls, fairly
faithfully, the anticipated sequences and that there has been
relatively little updating during execution. As anticipated, the
mountain car moves away from its target to acquire sufﬁcient
momentum to access the goal on the right. Note the similar-
ity between the selected actions (right) and the inferred con-
trol states (left). The interesting thing here is that the agent
was not always sure about which control state was currently
engaged. However, the control state with the highest pos-
terior probability, which corresponds to the action the agent
believes it will emit next, is always selected by active infer-
ence. In other words, even under uncertainty about hidden
and control states, there is sufﬁcient conﬁdence in the next
sensory state to inform action.
One can obtain similar results with different combina-
tions of starting and ﬁnal states (provided the trajecto-
ries can be realised): Fig. 5 shows the same results as in
Fig. 4 but with a prior that compelled the agent to pass
through the parking location with a leftward velocity of one:
x(s
i : i = χ(c)) = (1,−1). The agent solves this prob-
123
Biol Cybern (2012) 106:523–541 535
Fig. 3 Illustration of the
transitional probabilities
describing the discrete
formulation of the mountain car
problem in the previous ﬁgure.
These correspond to the
probability of occupying a
hidden state given a particular
ﬁnal state ( ﬁrst column), after
four time steps ( second column)
and after eight time steps into
the past. The probability
distribution functions are shown
in image format, over position
and velocity. The top row shows
the transition probabilities for a
control that applies leftward
forces to the mountain car, the
middle row shows the
corresponding pullback
probabilities for a control that
exerts no forces and the last row
shows transition probabilities
for control states that accelerate
the car towards the right. Note
the dispersion of these
probability distributions over
time, due to the discretisation of
the dynamics and random
ﬂuctuations on the speed and
position
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
position
velocity
-2 0 2
-2
0
2
0
1 Ts⋅B
4
5 Ts⋅B 8
5 Ts⋅B
0
2 Ts⋅B
0
3 Ts⋅B
0
4 Ts⋅B
0
5 Ts⋅B
lem by rushing past the goal and then allowing itself to fall
downhill, so that it approaches the ﬁnal destination with the
desired velocity. Note that it has to accelerate slightly at the
ﬁnal approach (with a slight leftward acceleration as indi-
cated in the lower panel). As noted above, changing prior
beliefs in this way does not require any further learning
and could even be accommodated during the execution of
a trajectory. This may become important in versions of this
scheme that go beyond ﬁnite horizon problems. In this con-
text, agents maintain posterior beliefs about a ﬁxed number
of hidden states into the future. In other words, they repre-
sent a continually evolving trajectory. We will pursue this
elsewhere.
Finally, Fig. 6 reproduces the simulation in Fig. 4 but
after increasing the number of times steps from T = 16
to T = 32. This illustrates the difference between trajecto-
ries optimised under optimal control theory and Bayes-opti-
mal inference under priors that specify which states will be
123
536 Biol Cybern (2012) 106:523–541
-2 -1.5 -1 -0.5 0 0.5 1 1.5 2
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
Anticipated and actual trajectory
position
velocity
Anticipated control
time
2 4 6 8 10 12 14 16
1
2
3
4
5
Actual action
time
2 4 6 8 10 12 14 16
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
5.5
Fig. 4 This ﬁgure shows the results of a simulated (agency based) tra-
jectory over T = 16 time steps starting at x = (0,0) and ending at the
goal location x = (1,0) (red ball) using active inference and explicit
representations of the future. The upper panel shows the trajectories in
the state space of position and velocity. The grey lines represent antic-
ipated trajectories accumulated during control, while the dark (dotted)
lines show the actual trajectory through state space. The anticipated
trajectories are the expected values based upon posterior expectations
about past and future states. They are therefore continuous functions of
position and velocity. In contrast, the actual trajectory is restricted to
the 1,024 discrete states that can be occupied; these are shown as light
grey dots. The lower panels show the anticipated control and the actual
actions selected under active inference (in image format where lighter
colours mean a higher probability). Note that there is a high degree
of correspondence; however, the posterior beliefs about control are not
always absolutely certain: these are the beliefs at the times each action
is selected
occupied and when. It can be seen from the upper panel of
Fig. 6 that the agent spends the ﬁrst half of the trajectory at
the bottom of the valley before ascending to the target loca-
tion. This trajectory minimises free energy; in other words,
it is the least surprising under the agent’s posterior beliefs.
This example illustrates a key distinction between policies
that are optimal in relation to prior expectations about future
states and those that maximise expected reward. The latter,
guided by value functions, preclude behaviours that access
particular states at particular times (unless the value function
changes with time). In other words, once an optimal policy
has been deﬁned in terms of rewards associated with particu-
lar states; there is no opportunity to specify any constraints on
when those rewards are accessed. Although this is not partic-
-2 -1.5 -1 -0.5 0 0.5 1 1.5 2
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
Anticipated and actual trajectory
position
velocity
Anticipated control
time
2 4 6 8 10 12 14 16
1
2
3
4
5
Actual action
time
2 4 6 8 10 12 14 16
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
5.5
Fig. 5 This ﬁgure uses the same format as the previous ﬁgure. The
only difference here is that we have changed the location of the goal
to x = (1,−1). In other words, we require the mountain car to pass
through the goal location from the right, with unit speed. It can be seen
that this goal has been obtained, with reasonable accuracy
ularly important from an engineering perspective, it becomes
acute in biological systems with hidden states that evolve
over multiple timescales. A simple example here would be
the context and time sensitive nature of motivational and
physiological drives ( Berridge 2004 ) that render the same
states differentially rewarding, depending upon when they
were last visited (for example, eating or drinking). In contin-
uous time formulations of active inference, this dependency
is usually dealt with in the context of dynamical systems
theory, where desired states become attracting sets, which
can either be ﬁxed point attractors or more complicated tra-
jectories on attractor manifolds ( Friston and Ao 2012 ). In
this setting, the representation of a trajectory over succes-
sive states (s
0,s1,s2,... ) is replaced by representations in
generalised coordinates of motion (s,s′,s′′,... ) ;s e e Friston
(2008) for details.
The trajectory in Fig. 6 is the least surprising given the
agent’s prior beliefs. These include prior beliefs about con-
trol which, in this example, were uninformative. A different
trajectory would emerge if, for example, we made accelera-
tion and deceleration more unlikely than doing nothing; e.g.,
d =[
1
8 , 1
8 , 1
2 , 1
8 , 1
8 ] (results not shown). From the perspec-
tive of optimal control theory, this is equivalent to prescribing
123
Biol Cybern (2012) 106:523–541 537
-2 -1.5 -1 -0.5 0 0.5 1 1.5 2
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
Anticipated and actual trajectory
position
velocity
Anticipated control
time
5 10 15 20 25 30
1
2
3
4
5
Actual action
time
5 10 15 20 25 30
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
5.5
Fig. 6 This ﬁgure reports the same results as shown in Fig. 4;h o w -
ever, here we have increased the number of time steps from T = 16 to
T = 32. The optimal (in a Bayesian sense) trajectory now spends its
ﬁrst few steps in the valley before ascending to reach the goal location;
x = (1,0)
differential costs for action that, in the variational free-energy
formulation, are absorbed into priors.
In closing, it is worth noting that the scheme above is
not robust. This is meant in the sense that it is based upon
approximate inference (as opposed to exact inference) that
necessarily follows from the mean ﬁeld approximation that
renders the numerics tractable. Furthermore, because the
probability distributions associated with Markov decision
problems are not convex, the coordinate descent on free
energy in (14) is not guaranteed to converge to its global min-
imum. This means that the example in this section should be
taken as a proof of principle that the scheme can work; not-
ing that it took several hours to conﬁgure the number of time
steps and discretisation of hidden states before the variational
updates gave sensible results. Having said this, the failures
were often more interesting than the successes reported above
(see discussion). Furthermore, the combinatorics the scheme
can contend with is enormous. For example, in the ﬁnal sim-
ulation the scheme was able to select a sequence of actions or
decisions from among 5
32 = 2.32 × 1022 alternatives. This
capacity to deal with high degrees of computational complex-
ity, with approximating assumptions, may help when think-
ing about how real world agents deal with equivalent decision
making problems. The routine Matlab ( spm_MDP.m)u s e d
to generate Figs. 3 through to 3 is available in the DEM Tool-
box of the SPM academic freeware ( http://www.ﬁl.ion.ucl.
ac.uk/spm).
6 Discussion
In summary, we have reviewed classical approaches to (par-
tially observable) Markov decision problems and have recast
reward or cost functions in terms of prior beliefs about state
transitions. This implicitly resolves the redundancy between
cost functions and priors that underlies the complete class
theorem. We then went on to exploit this redundancy by spec-
ifying optimal policies in terms of prior beliefs about future
(terminal) states. The ensuing scheme may provide a met-
aphor for model based decision making in real agents that
has an explicit planning or anticipatory aspect. This solution
was based upon approximate (variational) Bayesian infer-
ence that respects the Markov nature of decision processes.
The aim of this work was to unpack some of the implica-
tions of optimal control for its implementation in real-world
(biological) agents. The most important is the representa-
tion of hidden control states that are required for accessing
distal rewards in the future. This contrasts with the usual
problem formulation of MDPs, which is to deﬁne a process
model and the corresponding notion of optimality, without
reference to the internal (representational) states of the agent.
Our aim was not to ﬁnesse computational problems from a
machine learning perspective. Indeed, it is well known that
the computational complexity of a problem is not changed
when reducing it to an inference problem: see ( Littman et al.
2001) for a treatment of this in the setting of stochastic sat-
isﬁability problems and probabilistic inference. The equiv-
alence in computational complexity is reﬂected in the fact
that many procedures are found in both approximate solu-
tions to optimal control and Bayesian inference. Examples
here include minimisation of Kullback–Leibler divergences
(Todorov 2008; Kappen et al. 2009 ), and expectation maxi-
misation (Toussaint and Storkey 2006 ), both of which can be
formulated as minimising variational free energy ( Neal and
Hinton 1998 ). The main contribution of this paper concerns
the interpretation of optimality, as opposed to an algorith-
mic contribution. Having said that, there is a subtle but fun-
damental difference between classical optimal control and
active inference:
6.1 Optimal control and active inference
One could consider optimal control as a special case of
active inference. This is because specifying optimal poli-
cies directly—in terms of prior beliefs about state transi-
tions—affords a complete speciﬁcation of a policy. In optimal
123
538 Biol Cybern (2012) 106:523–541
control theory, state transitions are speciﬁed in terms of value
functions that are solutions to the appropriate Bellman opti-
mality equations, given a cost function. The notion that the
Bellman optimality principle “can be derived as a limit case”
from the variational principles that underlie active inference
also emerges in recent information theoretic formulations of
bounded rationality ( Braun et al. 2011 ): Braun et al con-
sider control costs in terms of the (cross) entropy of choice
probabilities and augment expected utility to produce a free-
energy optimality criterion. This free-energy functional ( free
utility) captures bounded rationality by ensuring the diver-
gence between optimal and prior choice probabilities is min-
imised. As in the current treatment, the generality of this
approach “relies on the fact that ultimately any real agent
has to be incarnated in a physical system, and the process
of information processing must always be accompanied by a
pertinent physical process”. They show that minimising free
utility includes both discrete and continuous stochastic opti-
mal control as special cases and, crucially, can be derived
“without invoking the Hamilton–Jacobi–Bellman equation
or the Bellman optimality equations”. Their treatment of
stochastic optimal control uses the Feynman–Kac formula
to express the control problem in terms of a Chapman–Kol-
mogorov equation or, when just considering terminal cost,
a Kolmogorov backward equation. They then show that this
is the solution to the Hamilton–Jacobi–Bellman equation,
under quadratic control costs. See also ( Theodorou et al.
2010), who exploit the same formalism but with a more clas-
sical motivation. The generalisation of classical optimal con-
trol using free utility is compelling and uniﬁes approximate
optimal control methods in both the continuous and discrete
domain. However, this use of free utility is fundamentally dif-
ferent from the variational free-energy minimisation implied
by the free-energy principle and active inference:
Free utility is a functional of choice probabilities over
hidden states. In contrast, variational free energy is a func-
tional of the recognition distribution and observed states. Fur-
thermore, free utility depends on a cost function, while free
energy does not. This is because the free-energy principle
is based on the invariant or ergodic solution P(o|m) to the
Kolmogorov forward equation, which speciﬁes the value of
an observed state V (o|m) = ln P(o|m) directly, without ref-
erence to path integrals or cost ( Friston and Ao 2012 ). Con-
versely, free utility is based on the Kolmogorov backward
equation, which can only be solved given terminal costs. In
the free-energy formulation, the value of an observed state
is prescribed by a generative model in terms of the proba-
bility a state will be occupied at (non-equilibrium) steady-
state. It can be seen easily that minimising the entropy of the
invariant probability distribution over observations maximis-
es expected value: E
P [−ln P(o|m)]= EP [V (o|m)].
Minimising the entropy of observed states is the raison
d’êtrefor the free-energy principle, which invokes variational
free energy to ﬁnesse the (generally) intractable problem of
marginalising over hidden states to evaluate value or nega-
tive surprise ( Beal 2003 ). This contrasts with the use of free
utility to ﬁnesse the (generally) intractable problem of solv-
ing Bellman optimality equations ( Braun et al. 2011 ). It can
be seen from ( 6) that free energy F (o,μ )≥− ln P(o|m) =
−V (o|m) bounds surprise and can therefore be minimised to
maximise value.
In summary, active inference goes beyond noting that
there is a formal similarity between cost-based optimal con-
trol and Bayesian inference schemes—it suggests that opti-
mal control is a special case of Bayes-optimal inference and
that inference is the hard problem. In this setting, optimality
reduces to sampling states prescribed by the priors of a gen-
erative model that speciﬁes state transitions. The advantages
of active inference include:
• A tractable approximate solution to any stochastic, non-
linear optimal control problem to the extent that standard
(variational) Bayesian procedures for inference on the
system being controlled exist.
• A distinction between (future) control states that are rep-
resented probabilistically (because they are necessarily
hidden) and action that is a deterministic quantity pro-
duced by the system.
• The opportunity to learn and infer environmental con-
straints; particularly the amplitudes of observation and
hidden state noise, in a Bayes-optimal fashion.
• The formalism to handle system or state noise: currently,
cost based optimal control schemes are restricted to sto-
chastic control (i.e., random ﬂuctuations on control as
opposed to hidden states). One of the practical advanta-
ges of active inference is that ﬂuctuations in hidden states
are modelled explicitly, rendering control robust to exog-
enous perturbations. This is seen most easily in continu-
ous time formulations of active inference, as illustrated
in ( Friston et al. 2009 ).
• The speciﬁcation of control costs in terms of priors on
control, with an arbitrary form: currently, most approxi-
mate stochastic optimal control schemes are restricted to
quadratic control costs. In classical schemes that appeal
to path integral solutions there are additional constraints
that require control costs to be a function of the preci-
sion of control noise; e.g.,( Theodorou et al. 2010 ; Braun
et al. 2011 ). These constraints are not necessary in active
inference.
The disadvantage of active inference is that one cannot pre-
scribe optimality in terms of cost functions, because (Bayes)
optimal behaviour rests on the generative model that is speci-
ﬁed by its likelihood and prior functions. Having said this, for
every Bayes-optimal policy there is an associated cost func-
tion. This cost function is deﬁned in terms of the expected
123
Biol Cybern (2012) 106:523–541 539
change in value, where value is determined uniquely by
the invariant solution to the appropriate Fokker Planck or
Kolmogorov forward equation ( Friston and Ao 2012 ).
6.2 Learning versus inference
The distinction between model free and model based decision
making is based upon the difference between schemes that
learn value functions directly (model free) and those that use
a generative model of transition probabilities (model based).
The active inference formulation makes a similar distinction
between schemes based on generative models that do (agency
based) and do not (agency free) include hidden control states.
Both schemes can exhibit optimal behaviour; however, in
agency free schemes the policy has to be learned or pro-
vided; cf., ( Botvinick and An 2008 ). Agency free policies
constitute prior beliefs about the next state transition, which
are fulﬁlled by action and are the same whenever that state
is visited. Conversely, in agency based schemes the policy
is inferred in terms of posterior beliefs about the future. We
have associated posterior beliefs about control with a sense of
agency to make the treatment a bit more intuitive. However,
there are some interesting issues that attend the perspective
of agency: crucially, the agency implied by inference on con-
trol is not necessarily owned by the agent. In other words,
posterior beliefs do not assign agency to any particular agent.
This raises the interesting question about where a represen-
tation of self agency could arise. One might imagine that a
sense of self would require (hierarchical) generative models
that associate agency with movements of one’s own motor
plant. This speaks to important questions that relate to theory
of mind and the role of things like the mirror neuron system
in active inference ( Friston et al. 2011 ).
6.3 Suboptimal control and psychopathology
In this paper, we have limited ourselves to a brief description
of the formalism implied by free energy treatments of opti-
mal control. In creating the simulations, many of the more
interesting behaviours were failures of optimal behaviour. For
example, the behaviour that emerges when prior beliefs about
future states cannot be fulﬁlled, because the state is unattain-
able over a short sequence of movements. This typically leads
to pathological behaviours that bring to mind the phrase ‘more
haste, less speed’. We hope to present these failures in a sub-
sequent paper and relate them to suboptimal behaviour and
its neurochemical mediation ( Kishida et al. 2010 ; Moutous-
sis et al. 2011 ). The point here is that approximate inference
can fail and the nature of these failures may provide a (prin-
cipled) model for cognitive and motor pathologies. In short,
we are not suggesting that the free-energy formulation will be
useful in an engineering context; however, it may be a useful
way to think about planning and agency in a behavioural or
neuroscience setting. We hope to pursue this in subsequent
work using the formalism introduced in this paper.
Acknowledgments We would like to thank Peter Dayan for invalu-
able comments on this work and also acknowledge the very helpful
comments and guidance from anonymous reviewers of this work.
Open Access This article is distributed under the terms of the Creative
Commons Attribution License which permits any use, distribution, and
reproduction in any medium, provided the original author(s) and the
source are credited.
Glossary
(Variational) free energy—a functional of sensory states and
a probability distribution over hidden states that cause
sensory states. The variational free energy is an upper
bound on the surprise (self information) of sensory
states, under a (generative) model. Surprise is the
negative logarithm of the Bayesian model evidence or
marginal likelihood.
Approximate Bayesian inference —minimisation of var-
iational free energy with respect to a probability
distribution over (ﬁctive) hidden states causing sensory
states (observations). Variational Bayesian inference is
approximate because it minimises a (free energy) bound
approximation to surprise. When free energy equals
surprise, inference is exact.
Free-energy principle —the free energy principle states
that a self organising system—that entails a generative
model— minimises the free energy of its sensory and
internal states; where internal states encode a recogni-
tion probability distribution over (ﬁctive) hidden states
causing sensory states.
Active inference—the minimisation of free energy through
changing internal states (perception) and sensory states
by acting on the world (action).
Action—(real valued) variables – associated with an agent
– that change hidden states in the world. Action is a set
of real states – it is not inferred or represented in the
generative model.
Control (states) —(ﬁctive) hidden states that are used to
explain the consequences of action. Control states are
inferred or represented in the generative model.
123
540 Biol Cybern (2012) 106:523–541
Agency based model —a generative model (probability)
over hidden states that include control states.
Agency free model—a generative model (probability) over
hidden states that preclude control states.
(Sense of) agency—a probabilistic representation of hidden
control states, encoded by the internal states (sufﬁcient
statistics) of an agency based model.
Optimal control—acting to minimise expected cost.
Bayes-optimal control—acting to minimise the free energy
bound on the (negative logarithm) of Bayesian model
evidence – with or without agency.
References
Ashby WR (1947) Principles of the self-organizing dynamic system.
J Gen Psychol 37:125–128
Axmacher N, Henseler MM, Jensen O, Weinreich I, Elger CE,
Fell J (2010) Cross-frequency coupling supports multi-item work-
ing memory in the human hippocampus. Proc Natl Acad
Sci 107(7):3228–3233
Baxter J, Bartlett PL, Weaver L (2001) Experiments with Inﬁnite-
Horizon, Policy-Gradient Estimation. J Artif Intell Res 15:351–
381
Beal MJ (2003) Variational algorithms for approximate bayesian infer-
ence’. PhD. Thesis, University College London, London
Bellman R (1952) On the theory of dynamic programming. Proc Natl
Acad Sci USA 38:716–719
Berridge KC (2004) Motivation concepts in behavioral neuroscience.
Physiol Behav 81(2):179–209
Birkhoff GD (1931) Proof of the ergodic theorem. Proc Natl Acad Sci
USA 17:656–660
Botvinick MM, An J (2008) Goal-directed decision making in prefrontal
cortex: a computational framework. Adv Neural Inf Process Syst
(NIPS) 21
Braun DA, Ortega P, Theodorou E, Schaal S (2011) Path integral control
and bounded rationality. In: ADPRL 2011, Paris
Brown LD (1981) A complete class theorem for statistical problems
with ﬁnite sample spaces. Ann Stat 9(6):1289–1300
Camerer CF (2003) Behavioural studies of strategic thinking in games.
Trends Cogn Sci 7(5):225–231
Canolty RT, Edwards E, Dalal SS, Soltani M, Nagarajan SS, Kirsch HE,
Berger MS, Barbaro NM, Knight R (2006) High gamma power is
phase-locked to theta oscillations in human neocortex. Science
313(5793):1626–1628
Cooper G (1988) A method for using belief networks as inﬂuence dia-
grams. In: Proceedings of the Conference on uncertainty in artiﬁ-
cial intelligence
Daw ND, Doya K (2006) The computational neurobiology of learning
and reward. Curr Opin Neurobiol 16(2):199–204
Dayan P, Daw ND (2008) Decision theory, reinforcement learning, and
the brain. Cogn Affect Behav Neurosci 8(4):429–453
Dayan P, Hinton GE (1997) Using expectation maximization for rein-
forcement learning. Neural Comput 9:271–278
Dayan P, Hinton GE, Neal R (1995) The Helmholtz machine. Neural
Comput 7:889–904
Duff M, (2002) Optimal learning: computational procedure for ba-
yes-adaptive markov decision processes. PhD thesis. University
of Massachusetts, Amherst
Evans DJ (2003) A non-equilibrium free energy theorem for determin-
istic systems. Mol Phys 101:15551–15554
Feldbaum AA (1961) Dual control theory, Part I. Autom Remote Con-
trol 21(9):874–880
Feldman H, Friston KJ (2010) Attention, uncertainty, and free-energy.
Front Hum Neurosci 4:215
Feynman RP (1972) Statistical mechanics. Benjamin, Reading MA
Filatov N, Unbehauen H (2004) Adaptive dual control: theory and
applications (lecture notes in control and information sciences.
Springer, Berlin
Fox C, Roberts S (2011) A tutorial on variational Bayes. In: Artiﬁcial
intelligence review. Spinger, Berlin
Friston K (2008) Hierarchical models in the brain. PLoS Comput
Biol 4(11):e1000211
Friston K (2010) The free-energy principle: a uniﬁed brain theory?. Nat
Rev Neurosci 11(2):127–138
Friston K (2011) What is optimal about motor control?. Neuron
72(3):488–498
Friston K, Ao P (2012) Free-energy, value and attractors. In: Computa-
tional and mathematical methods in medicine, vol 2012
Friston K, Kiebel S (2009) Cortical circuits for perceptual inference.
Neural Netw 22(8):1093–1104
Friston K, Kiebel S (2009) Predictive coding under the free-energy
principle. Philos Trans R Soc Lond B Biol Sci 364(1521):1211–
1221
Friston KJ, Daunizeau J, Kiebel SJ (2009) Active inference or rein-
forcement learning?. PLoS One 4(7):e6421
Friston KJ, Daunizeau J, Kilner J, Kiebel SJ (2010) Action and
behavior: a free-energy formulation. Biol Cybern 102(3):
227–260
Friston KJST, Fitzgerald T, Galea JM, Adams R, Brown H, Dolan RJ,
Moran R, Stephan KE, Bestmann S (2012) Dopamine, affordance
and active inference. PLoS Comput Biol 8(1):e1002327
Friston K, Kilner J, Harrison L (2006) A free energy principle for the
brain. J Physiol Paris 100(1–3):70–87
Friston K, Mattout J, Kilner J (2011) Action understanding and active
inference. Biol Cybern 104:137–160
Friston KJ, Tononi G, Reeke GNJ, Sporns O, Edelman GM
(1994) Value-dependent selection in the brain: simulation in a syn-
thetic neural model. Neuroscience 59(2):229–243
Gigerenzer G, Gaissmaier W (2011) Heuristic decision making. Annu
Rev Psychol 62:451–482
Gläscher J, Daw N, Dayan P, O’Doherty JP (2010) States versus
rewards: dissociable neural prediction error signals underly-
ing model-based and model-free reinforcement learning. Neuron
66(4):585–595
Gomez F, Miikkulainen R (2001) Learning robust nonlinear control
with neuroevolution. Technical Report AI01-292, Department of
Computer Sciences, The University of Texas at Austin
Gomez F, Schmidhuber J, Miikkulainen R (2009) Accelerated neural
evolution through cooperatively coevolved synapses. J Mach Learn
Res 9:937–965
Helmholtz H (1866/1962), Concerning the perceptions in general. In:
Treatise on physiological optics, 3rd edn. Dover, New York
Hinton GE, van Camp D (1993) Keeping neural networks simple by
minimizing the description length of weights. In: Proceedings of
COLT-93,pp 5–13
Hoffman, M, de Freitas, N, Doucet, A, Peters J (2009) An expectation
maximization algorithm for continuous markov decision processes
with arbitrary rewards. In: Twelfth Int. Conf. on artiﬁcial intelli-
gence and statistics (AISTATS 2009)
Howard RA (1960) Dynamic programming and Markov processes. MIT
Press Cambridge, MA
123
Biol Cybern (2012) 106:523–541 541
Jaeger H (2000) Observable operator models for discrete stochastic
time series. Neural Comput 12:1371–1398
Jensen F, Jensen V , Dittmer SL (1994) From inﬂuence diagrams to
junction trees. In: Proc. of the Tenth Conference on uncertainty in
artiﬁcial intelligence. Morgan Kaufmann, San Fransisco
Kaelbling LP, Littman ML, Cassandra AR (1998) Planning and act-
ing in partially observable stochastic domains. Artif Intell 101
(1–2):99–134
Kappen HJ (2005) Linear theory for control of nonlinear stochastic sys-
tems. Phys Rev Lett 95(20):200201
Kappen HJ (2005) Path integrals and symmetry breaking for optimal
control theory. J Stat Mech: Theory Exp 11:P11011
Kappen HJ, Gomez Y , Opper M (2009) Optimal control as a graphical
model inference problem. arXiv:0901.0633v2
Kiebel SJ, Daunizeau J, Friston KJ (2009a) Perception and hierarchical
dynamics. Front Neuroinf 3:20
Kiebel SJ, von Kriegstein K, Daunizeau J, Friston KJ (2009b) Recog-
nizing sequences of sequences. PLoS Comput Biol 5(8):e1000464
Kishida KT, King-Casas B, Montague PR (2010) Neuroeconomic
approaches to mental disorders. Neuron 67(4):543–554
Littman ML, Majercik SM, Pitassi T (2001) Stochastic boolean satisﬁ-
ability. J Autom Reason 27(3):251–296
Littman ML, Sutton RS, Singh S (2002) Predictive Representations of
State. Adv Neural Inf Process Syst 14
MacKay DJ (1995) Free-energy minimisation algorithm for decoding
and cryptoanalysis. Electron Lett 31:445–447
Montague PR, Dayan P, Person C, Sejnowski TJ (1995) Bee foraging in
uncertain environments using predictive Hebbian learning. Nature
377(6551):725–728
Moutoussis M, Bentall RP, El-Deredy W, Dayan P (2011) Bayesian
modelling of Jumping-to-conclusions bias in delusional patients.
Cogn Neuropsychiatry 7:1–26
Namikawa J, Nishimoto R, Tani J (2011) A neurodynamic account of
spontaneous behaviour. PLoS Comput Biol. 7(10):e1002221
Neal RM, Hinton GE (1998) A view of the EM algorithm that justiﬁes
incremental sparse and other variants. In: Jordan M (ed.) Learning
in graphical models. Kluwer Academic, Dordrecht
Oliehoek F, Spaan MTJ, Vlassis N (2005) Best-response play in par-
tially observable card games. In: Proceedings of the 14th Annual
Machine Learning Conference of Belgium and the Netherlands
Pearl J (1988) Probabilistic reasoning in intelligent systems: networks
of plausible inference. Morgan Kaufmann, San Fransisco
Rao RP (2010) Decision making under uncertainty: a neural model
based on partially observable markov decision processes. Front
Comput Neurosci 4:146
Rao RP, Ballard DH (1999) Predictive coding in the visual cortex:
a functional interpretation of some extra-classical receptive-ﬁeld
effects. Nat Neurosci 2(1):79–87
Rawlik K, Toussaint M, Vijayakumar S (2010) Approximate inference
and stochastic optimal control. arXiv:1009.3958
Rescorla RA, Wagner AR (1972) A theory of Pavlovian conditioning:
variations in the effectiveness of reinforcement and nonreinforce-
ment. In: A Black, W Prokasy (eds.) Classical conditioning II:
current research and theory. Appleton Century Crofts, New York
Robert C (1992) L’analyse statistique Bayesienne. In: Economica. Paris,
France
Shachter RD (1988) Probabilistic inference and inﬂuence diagrams.
Operat Res 36:589–605
Silver D, Veness J (2010) Monte-Carlo planning in large POMDPs. In:
Proceedings of the Conference on neural information processing
systems
Sutton RS, Barto AG (1981) Toward a modern theory of adaptive net-
works: expectation and prediction. Psychol Rev 88(2):135–170
Tani J (2003) Learning to generate articulated behavior through the
bottom-up and the top-down interaction processes. Neural Netw
16(1):11–23
Theodorou E, Buchli J, Schaal S (2010) A generalized path integral
control approach to reinforcement learning. J Mach Learn Res
11:3137–3181
Todorov E (2006) Linearly-solvable Markov decision problems. In:
Advances in neural information processing systems. MIT Press,
Boston
Todorov E (2008) General duality between optimal control and estima-
tion. In: IEEE Conference on decision and control
Toussaint M, Charlin L, Poupart P (2008) Hierarchical POMDP con-
troller optimization by likelihood maximization. In: Uncertainty
in artiﬁcial intelligence (UAI 2008), AUAI Press, Menlo Park
Toussaint M, Storkey A (2006) Probabilistic inference for solving dis-
crete and continuous state Markov decision processes. In: Proceed-
ings of the 23nd International Conference on machine learning
van den Broek B, Wiegerinck W, Kappen B (2008) Graphical model
inference in optimal control of stochastic multi-agent systems.
J Artif Int Res 32(1):95–122
Watkins CJ, Dayan P (1992) Q-learning. Mach Learn 8:279–292
Williams RJ (1992) Simple statistical gradient-following algorithms for
connectionist reinforcement learning. Mach Learn 8:229–256
Zhang NL (1998) Probabilistic inference in inﬂuence diagrams. Com-
put Intell 14(4):475–497
123