 
 1 
Evidence of optimal control theory over 1 
active inference in corticospinal 2 
excitability modulations 3 
 4 
 5 
Author list:  6 
Brandt, I.M.1,4, Grünbaum, T.2,3,4, Christensen, M.S.2,4 7 
 8 
Affiliations 9 
1. Department of Neuroscience, University of Copenhagen, Denmark 10 
2. Department of Psychology, University of Copenhagen, Denmark 11 
3. Section for Philosophy, University of Copenhagen, Denmark 12 
4. CoInAct Research Group, University of Copenhagen, Denmark 13 
 14 
Contact information  15 
Ida Marie Brandt* 16 
marie.brandt.93@gmail.com 17 
Department of Neuroscience  18 
University of Copenhagen 19 
Blegdamsvej 3B 20 
2200 Copenhagen N, Denmark 21 
 22 
Associate professor Thor Grünbaum 23 
tgr@samf.ku.dk 24 
Department of Psychology  25 
University of Copenhagen 26 
Øster Farimagsgade 2A 27 
1353 Copenhagen K, Denmark and 28 
Section for Philosophy,  29 
University of Copenhagen,  30 
Karen Blixens Plads 8,  31 
DK-2300 Copenhagen S, Denmark 32 
 33 
Associate professor Mark Schram Christensen  34 
markc@psy.ku.dk 35 
Department of Psychology  36 
University of Copenhagen 37 
Øster Farimagsgade 2A 38 
1353 Copenhagen K, Denmark 39 
 40 
*Please direct correspondence and material requests to this author  41 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 2 
Abstract  42 
Two theories, optimal control theory and active inference, dominate the motor control field. We use 43 
transcranial magnetic stimulation (TMS) in force and angle tasks to examine whether corticospinal 44 
excitability represents a motor command, as proposed by the optimal control theory, or a 45 
proprioceptive prediction, as proposed by active inference. Our results strongly support optimal 46 
control theory. We encourage comparisons of the theories against each other based on empirically 47 
testable predictions. 48 
 49 
Main 50 
Two prominent theories are competing to explain motor control: optimal control theory and active 51 
inference. Both theories are theoretically convincing, but it has proved hard to distinguish them 52 
empirically. Experimentally testable hypotheses comparing the two theories have to our knowledge 53 
not been formulated. Here we present a novel experimental setup with the aim to test these two 54 
leading motor control theories against each other. We encourage proponents of each theory to 55 
formulate experimentally testable hypotheses to allow the field to move forward based on empirical 56 
studies.  57 
 58 
According to optimal control theory, to create movement, the brain uses an inverse model to convert a 59 
desired movement goal into movement signals called motor commands (Fig. 1). Motor commands are 60 
motor signals that descend from the primary motor cortex (M1) propagating via the corticospinal 61 
tract, activating alpha motor neurons (αMN), ultimately innervating target muscles. Shadmehr et al 62 
(2010) present the motor command as a motor signal conveying information that reflects the current 63 
state of the movement1. ‘The current state’ can be interpreted in multiple ways. In this paper we use it 64 
in terms of current parameter measures of either force (normalized to maximal voluntary contraction 65 
(MVC)) or joint angle (e.g. position).  66 
 67 
Active inference builds upon a statistical physics principle of minimizing free energy2,3, which means 68 
minimizing surprise by reducing prediction error. According to active inference, the descending 69 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 3 
signals from M1 are proprioceptive predictions rather than motor commands, i.e. predictions about 70 
which proprioceptive signals the movement should induce (Fig. 1). Thus, according to active 71 
inference, the outputs from M1 are sensory in nature, contrasting with the motor-centric view of 72 
optimal control theory. The proprioceptive predictions descending from M1 are transformed into 73 
proprioceptive prediction errors upon encountering ascending sensory information either in the spinal 74 
cord, in the brain stem, or in the thalamus4. Therefore, the αMN carry a signal that corresponds to the 75 
difference between the predicted proprioceptive feedback and the actual ascending sensory signal, i.e., 76 
the prediction error. According to active inference, as presented by Adams et al (2013), it is this 77 
prediction error that drives the movement4. 78 
 79 
Figure 1. Optimal control theory and active inference. a) shows relevant signals for optimal 80 
control theory, b) shows relevant signals for active inference. For optimal control theory, an intention 81 
is through the inverse model changed into a motor plan that is executed through motor commands 82 
propagating from M1 through the corticospinal tract to the target muscle. In optimal control theory, it 83 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 4 
is thus a motor command that activates the muscle. For active inference, the intention is converted 84 
into proprioceptive predictions. These predictions originate from M1 and meet sensory reafference in 85 
either the spinal dorsal horn, dorsal column nuclei in the brain stem, or in the thalamus. The difference 86 
between proprioceptive predictions and sensory afference is the proprioceptive prediction error, which 87 
propagate through the αMN to the target muscle. According to active inference, it is thus the 88 
prediction error that activates the muscle. Figure modified from23-25. 89 
 90 
To test the theories against each other, we developed a study with force and angle tasks. Thirty-three 91 
participants completed the study and signed written informed consents. The protocol was approved by 92 
the ethics committee of The Capital Region of Denmark (H-21061035) and data collection and 93 
storage was performed following UCPH guidelines (2004334 – 4242). All participants performed both 94 
tasks (Fig. 2). We used transcranial magnetic stimulation (TMS) induced motor evoked potentials 95 
(MEPs) during movements to measure the change in corticospinal excitability (CSE)5,6. MEP 96 
amplitude is modulated by state changes in CSE and can be used as a read-out of the signal 97 
propagating from M1 through the corticospinal pathway to the motoneurons, ultimately innervating 98 
target muscles. In both tasks, participants were sitting in front of a table with the forearm placed in a 99 
semiprone position, palm facing medially and without visual feedback of their movement. In the force 100 
task, participants performed isometric index finger force production at different force levels. They 101 
were stimulated with TMS at different force levels toward the maximal force level in a trial. The angle 102 
task was a planar flexion-extension index finger movement task, moving the metacarpophalangeal 103 
joint. Participants performed different angle levels and were stimulated at different angles (Fig. 2, see 104 
online Methods).  105 
 106 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 5 
 107 
Figure 2. Experimental setup. A) Force task. The blue line signifies the force measured with the force 108 
transducer. The green lines indicate when a TMS stimulation could occur, only one stimulation occurred in each 109 
trial. In the force task, the participant aimed for either force level 1, 3, or 5. When aiming for force level 1 (10% 110 
MVC), the participant was stimulated at 5% MVC. When aiming for force level 3 (30% MVC), the participant 111 
could be stimulated at 5% or 15% MVC. When aiming for force level 5 (50% MVC), the participant could be 112 
stimulated at 5%, 15% or 25% MVC. Force at TMS and difference between force at TMS and max force was 113 
measured. B) Angle task. The blue line signifies the goniometer measure of angle. The green lines indicate when 114 
a TMS stimulation could occur, only one stimulation occurred in each trial. In the angle task, the participant 115 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 6 
aimed for either angle 5 or 7. When aiming for angle 5, the participant could be stimulated at either angle 2 or 4, 116 
when aiming for angle 7, the participant could be stimulated at either angle 2, 4, or 6. In this example, 117 
participant performed angle 7 and was stimulated at angle 2. Angle at TMS and difference between angle at 118 
TMS and max angle was measured. C) Example of raw EMG, smoothed EMG, and smoothed and rectified 119 
EMG. EMG at TMS is the mean smoothed, rectified EMG 55-5ms prior to TMS stimulation. EMG at max force 120 
is the mean smoothed, rectified EMG 50-0ms prior to max force. D) Hand position in the force task. Right index 121 
finger pressed isometrically on force transducer. E) Hand position in the angle task. A goniometer measuring the 122 
angle was attached to the right index finger. F) Example of MEP and MEP amplitude. See online Methods 123 
section for further details. 124 
 125 
According to optimal control theory, without perturbations to the movement, the magnitude of the 126 
motor command should be proportional to the state of the produced movement1. That is, absent 127 
perturbation, the motor command and thus the MEP should reflect the current state. Therefore, the 128 
model representing optimal motor control theory includes the variable force at TMS or angle at TMS. 129 
 130 
According to active inference, the descending signal is a proprioceptive prediction that is turned into a 131 
prediction error. This entails that both prediction and prediction error should be reflected in the MEP 132 
amplitude. Since the prediction should remain constant, our analysis prioritizes the prediction error, 133 
which reflects the difference between the current state and the end-state of a movement. In the model 134 
representing active inference, we therefore include a variable corresponding to the difference in 135 
parameter measure between the current state (angle/force at TMS) and end-state (maximal parameter 136 
measure observed in a trial), i.e. force prediction error or angle prediction error.  137 
 138 
We used Bayesian model comparison to investigate whether MEP amplitude modulation is best 139 
explained by motor commands or proprioceptive prediction errors. We developed four distinct 140 
Bayesian linear mixed models with MEP as the dependent variable. The models were different based 141 
on the inclusion of either force/angle at time of TMS, representing optimal control theory, or 142 
force/angle prediction error, representing active inference. The prediction error is calculated as the 143 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 7 
difference between force/angle at TMS and maximal force/angle in the trial. Importantly, for all 144 
models we included two electromyography (EMG) measures of muscle contraction since increased 145 
EMG facilitates MEP amplitude7. Mean EMG 55-5ms prior to time of TMS stimulation (EMG at 146 
TMS) and 50-50 ms prior to time of maximal parameter measure were included as variables (mean 147 
EMG at max angle/force). We further included subject as a random effect with intercept, since MEP 148 
amplitudes vary between subjects, and all continuous variables were standardized per subject. The 149 
two force models were compared and the two angle models were compared (Table 1). For an 150 
indication of the model fit, we assessed the proportion of MEP amplitude variance explained by the 151 
models by estimating bayesian R-squared. 152 
 153 
 154 
Table 1. Bayesian model comparisons. The force optimal control theory model was compared with 155 
the force active inference model using Bayesian model comparison, angle n MEPs = 8976, force n 156 
MEPs = 3173. See parameter estimates, estimate error and credibility intervals (CI) in Extended data 157 
table 1. 158 
 159 
For both force and angle, we found extreme evidence (Bayes factor > 100) in favor of the optimal 160 
control theory model over the active inference model in explaining MEP amplitude modulations when 161 
correcting for EMG (force BF mean = 5.69*1033, sd = 3.33*1031 (sd is 0.59% of the BF mean), angle 162 
BF mean = 1.41*109, sd = 1.35*107 (sd is 0.96% of the BF mean)). The proportion of MEP amplitude 163 
variance explained by the optimal control theory was R2 force estimate = 0.208 and R2 angle estimate 164 
= 0.0422, indicating that the optimal control theory models do in fact have some predictive power on 165 
MEP variability.  166 
 167 
Our findings support optimal control theory. MEP amplitude modulations reflect a motor command 168 
rather than a proprioceptive prediction error. These conclusions are based on our interpretation of the 169 
Force optimal control theory Subject + EMG at TMS + EMG at max force + force at TMS
Force active inference Subject + EMG at TMS + EMG at max force + force prediction error
Angle optimal control theory Subject + EMG at TMS + EMG at max angle + angle at TMS
Angle active inference Subject + EMG at TMS + EMG at max angle + angle prediction error
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 8 
theories – that the current parameter measure represents a motor command in optimal control theory 170 
and that the difference between the current and maximal parameter measures represents the 171 
proprioceptive prediction error in active inference. There is conceptual and explanatory flexibility in 172 
both theories.  173 
In optimal control theory, the motor command that represents the ‘current state’ could be understood 174 
differently than as movement parameter measures. Our interpretation is in line with Shadmehr (2010, 175 
pp. 93-94): “For example, if the hand is moving and the brain can predict the current location of the 176 
hand and its velocity, then the motor commands should reflect this predicted state”. Here, the 177 
‘predicted state’ is the estimation of the current state created from the inverse model (Fig. 1). The 178 
current parameter measures reflected in the MEP amplitude modulation does not necessarily imply 179 
direct causality between the motor command and the movement parameters. However, it does suggest 180 
a functional linkage between the two. 181 
 182 
We built the active inference model based on Adams et al (2013)4 and Floegel et al (2023) according 183 
to which “The translation from desired perceptions to movements occurs via proprioceptive prediction 184 
errors in the spinal cord or brainstem that are quenched by classic reflex arcs”8, page 316. If the 185 
proprioceptive prediction represents intended perceptual state (max parameter measure) and 186 
ascending sensory reafference reflects current proprioceptive state (parameter measure at TMS), then 187 
the prediction error propagating through αMN must represent the difference between the two (max 188 
parameter measure – parameter measure at TMS). Given this interpretation, the active inference 189 
theory is confronted with the explanatory problem that the current parameter level is reflected in the 190 
MEP amplitude to a higher degree than is proprioceptive prediction error. 191 
 192 
It could be argued that the prediction error does not represent the difference in parameter measures, 193 
but rather the error in muscle length, golgi tendon load, etc. But then, why would the M1 be engaged 194 
in encoding movement parameters if this signal is not used further down? A rich experimental 195 
literature9–14, including our own study15, have already established this claim. 196 
 197 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 9 
We do not expect to settle the discussion with this brief communication, nor do we want to dismiss 198 
active inference. Our results support optimal control theory over active inference in this experiment. 199 
However, there could be other ways to test the theories and indeed other ways to interpret the theories. 200 
We encourage proponents of optimal control theory and active inference to specify how their 201 
respective theories would be reflected in measurable parameters such as CSE, movement related 202 
cortical potentials, motor neuronal firing rate, EMG frequency profile, muscle synergy patterns, state 203 
space manifolds, H-reflex, or any other testable quantity. Finding measurable differences might be a 204 
challenge. The theories seem very different theoretically but peculiarly similar when sketching the 205 
architecture of the testable models.  206 
 207 
Methods 208 
Another manuscript with a different research question and scope is based on the same data15. We also 209 
obtained data from a velocity task, which was only relevant for the prior study and not presented here. 210 
Participants   211 
We included 40 healthy participants the study, of which 33 completed (21 female, mean age 29.12, 212 
age range 20-45) (3 were excluded because of too high distance between coil and head, 2 did not 213 
complete all tasks, 1 terminated the experiment, 1 participant experienced that TMS stimulated their 214 
migraine hotspot). We recruited participants through forsøgsperson.dk and University of Copenhagen. 215 
We obtained written informed consent for participation and for data collection. We performed TMS in 216 
accordance with TMS safety guidelines17, and excluded participants with contraindications to TMS 217 
safety based on a safety questionnaire developed from Rossi 200918. The study was performed in 218 
accordance with the declaration of Helsinki and data was processed and stored according to EU 219 
general data protection regulation and guidelines approved by UCPH (2004334 – 4242). The protocol 220 
was approved by The Capital Region of Denmark (H-21061035). Participants were compensated with 221 
150 DDK/hour. 2 participants were ambidextrous the rest were right-handed when assessed with the 222 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 10 
Edinburgh handedness inventory19 (83 +/- 22 (mean +/- 1 sd)). Other questionnaires were performed, 223 
with relevance to other studies [ref]. 224 
Experimental Design 225 
This study tested the plausibility of two theories, active inference, and predictive coding, by 226 
investigating whether the MEP amplitude best represents a motor command or a prediction error in 227 
angle and force index finger movement TMS tasks. We also performed a velocity task reported 228 
elsewhere15, which did not allow a comparison between current and max velocity and is therefore not 229 
included in this study. 230 
 231 
For both tasks, participants were seated in front of a table with both arms resting horisontally on the 232 
table. The right forearm was in a semiprone position, palm facing medially and index finger straight. 233 
In the force and angle tasks, the participants aim for a parameter level (force level 1, 3 or 5, angle 234 
level 5 or 7). TMS stimulation occurs during the movement at different force/angle levels. This 235 
ensures variability in force/angle levels at time of stimulation, and variability in the distance from 236 
force/angle levels at TMS to the intended force/angle level. This allows us to investigate which the 237 
MEP amplitude reflects to a higher extend: a motor command (force/angle at TMS stimulation) or a 238 
prediction error (the difference between current force/angle and intended force/angle). Taken together, 239 
for each trial we obtained an MEP amplitude and measures of the parameter (force/angle): 1) the 240 
parameter level at time of TMS stimulation, and 2) the difference between the parameter level at time 241 
of TMS stimulation and the max parameter level during the trial. Task order was randomized between 242 
participants. 243 
 244 
Preparations 245 
Participants performed the experiment in a 6-7 hour visit over one day (two days for one participant). 246 
We obtained informed consents and carried out the TMS safety questionnaire and other questionnaires 247 
relevant to another study [ref]. Electromyography (EMG) electrodes were applied over flexor 248 
digitorum profundus (FDP), first dorsal interosseous muscle FDI, and extensor digitorum communis 249 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 11 
(EDC). Maximal voluntary contraction (MVC) of the right-hand index finger and the maximal 250 
compound muscle potential (Mmax) from FDP were measured. Participants had their arm in a 251 
semiprone position, palm facing medially and index finger straight at MVC measurement. They 252 
pressed three seconds with max force two times, with a 90 second interval between presses. The 253 
maximally produced force level in either press was defined as their MVC. We identified TMS 254 
stimulation hotspot and motor threshold (MT). During both tasks, visual feedback was prevented by a 255 
cloth (force) or box (velocity). Breaks were given when asked for. 256 
 257 
Force task 258 
In the force task, participants pressed the right index finger isometrically against a force transducer in 259 
the horizontal direction (Fig. 2). Participants' fingers were oriented straight ahead, with their position 260 
maintained by two supporting sticks, allowing for lean support (Fig. 1). The task required participants 261 
to exert force at designated levels—1, 3, or 5—on a 1-10 scale, where 10 represents their maximum 262 
voluntary contraction (MVC). These levels correspond to 10%, 30%, and 50% of their MVC, 263 
respectively. To minimize fatigue, level 5 was the highest level. Following MVC determination, 264 
participants received verbal guidance on achieving force levels 1, 3, and 5, 2-3 times. After this initial 265 
guidance, participants had to depend solely on their sensorimotor perception, as no further external 266 
feedback was provided. 267 
 268 
Importantly, TMS stimulations were applied at force levels relative to participants’ MVC. For force 269 
level 1, we expected participants to perform approximately 10% of MVC. Thus, we stimulated half of 270 
10% MVC (5% MVC). For force level 3, we expected participants to perform approximately 30% 271 
MVC. We stimulated at either 5% or 15% MVC. For force level 5, we expected participants to 272 
perform approximately 50% MVC. During this condition, we stimulated at either 5%, 15%, or 25% 273 
MVC. This setup allowed us to obtain MEP measures while we vary force level at TMS stimulation, 274 
and the difference between force level at TMS stimulation and max force level in that trial. 275 
 276 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 12 
During each trial, participants were presented with two distinct auditory tones. The pitch of the initial 277 
tone served as an indicator of the target force level: a low, middle, or high pitch corresponded to force 278 
levels 1, 3, and 5, respectively. This was followed by a 'go-tone', signaling the commencement of the 279 
action, which occurred after a variable inter-tone interval. On average, the interval between single 280 
TMS stimuli in the force task was 6.0 seconds. Participants completed 5-7 blocks, each lasting 6 281 
minutes (the final block was sham condition), with an average of 90 force trials and 59 sham trials per 282 
participant. During sham trials, the TMS coil was positioned such that one wing was perpendicular to 283 
the participant's head. 284 
 285 
Angle task 286 
In the angle task, the right arm and hand were positioned as in the force task, but without the force 287 
transducer. Movements of the right index finger were measured using a fiber optic goniometer (Model 288 
S720, Measurand Inc., New Brunswick, Canada). The starting position was defined as the index 289 
finger pointing directly ahead, designated as angle 0. Participants were trained to consistently return 290 
to this initial position. Maximum flexion at the metacarpophalangeal (MCP) joint was identified as 291 
angle 9, ensuring no bending occurred at the proximal interphalangeal joint. Within this framework, 292 
participants were instructed to move their fingers to either level 5 or 7 in each trial. Prior to the start of 293 
the task, levels 5 and 7 were guided 2-3 times using verbal feedback, after which participants received 294 
no further external guidance. 295 
 296 
Importantly, TMS stimulations were applied at angle levels relative to participants’ angle 9. Angle 0 297 
and 9 were measured, from which a 0-9 scale was calculated. For angle level 5, TMS stimulations 298 
were applied at angle 2 or 4. For angle 7, TMS stimulations were applied at angle 2, 4, or 6. This 299 
setup allowed us to obtain MEP measures while we vary angle at TMS stimulation, and the difference 300 
between angle at TMS stimulation and max angle in that trial.  301 
As in the force task, each trial involved the presentation of two auditory tones. The initial tone, 302 
varying in pitch between low and high, signified the target angle level 5 or 7, which was then 303 
succeeded by a 'go-tone'. Participants completed 5-7 blocks, each lasting 6 minutes, with the final 304 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 13 
block serving as a sham condition. On average, each participant undertook 272 TMS trials and 66 305 
sham trials. The average TMS inter-stimulus-interval during the experiment was 5.3 seconds. Notably, 306 
the force task involved an isometric contraction, whereas the angle task required a concentric 307 
contraction and hence dynamic movements. 308 
 309 
Data acquisition 310 
The experimental setup was controlled by Spike2 (version 7.10, CED, Cambridge, UK) controlling 311 
both the transcranial magnetic stimulation (TMS) and auditory signals via a 1401 Micro Mk II analog-312 
to-digital (AD) converter (Cambridge Electronic Design (CED), Cambridge, UK). Data from the 313 
electromyography (EMG), fiber optic goniometer, and force transducer (UU2 load cell, DN-AM310 314 
amplifier, Dacell, Seoul, Korea) were acquired at a sampling rate of 2000 Hz using the CED system. 315 
EMG signals were amplified 20 to 100 times (accounted for in the analysis) by a custom-built 316 
differential amplifier, developed in the Panum Institute electronics lab, Copenhagen, DK, and were 317 
band-pass filtered within a range of 5-1000Hz. All collected data was securely stored on a protected 318 
drive. 319 
 320 
Surface EMG recordings were obtained from the FDP, FDI, and EDC. This was achieved using 321 
Ag/AgCl surface electrodes (22 x 30 mm, Ambu A/S BlueSensor N-10-A/25 ECG electrodes, 322 
Ballerup, Denmark) arranged in a belly-tendon montage. The active and reference electrodes were 323 
positioned next to each other on the muscle belly, while the ground electrode was secured on the 324 
olecranon of the right ulnar bone. To enhance conductivity, electrode gel (Signa Gel, Parker 325 
Laboratories, Inc., Fairfield, New Jersey 07004, USA) was applied. Prior to electrode placement, 326 
participants' skin was prepared using fine sandpaper and sanitizer 20. 327 
 328 
Mmax was elicited through stimulation of the median nerve proximal to the elbow, with recordings 329 
from the FDP muscle using a DS7A stimulator (Digitimer Ltd, Welwyn Garden City, England). 330 
Although Mmax was recorded, we opted to normalize EMG data relative to the MVC. This approach 331 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 14 
was chosen because it has been argued that it more accurately reflects voluntary muscle activation21, 332 
and because Mmax measurements in some participants were not reliable. 333 
 334 
TMS stimulation and MEP measurements 335 
Participants underwent one single-pulse TMS stimulation over the hand-M1 per trial, using a Magstim 336 
Rapid2 stimulator (The Magstim Company, Whitland, Dyfed, UK) and a custom-made batwing 337 
figure-of-8 shaped coil (biphasic, initial AP direction followed by PA direction, external coil diameter 338 
115 mm). The coil, positioned horizontally over M1, was angled at 45° to the coronal and sagittal 339 
planes. Resting motor threshold (rMT) was determined by gradually increasing intensity of stimulator 340 
output until TMS induced MEPs (>50μV) in 5 out of 10 trials 20. Stimulation intensity in experiments 341 
was 120% of rMT with an eight second inter-stimulus interval. The FDP motor hotspot was located 342 
lateral to the medial fissure, with the hotspot identified as the point of largest and most consistent 343 
MEPs in the FDP. Precision in coil placement (below ~3 mm from the identified hotspot) was ensured 344 
by experimenter, using a BrainSight® neuronavigational system (Rogue Research Inc, Montreal, 345 
Canada), and a mechanical holder maintained coil position and thus stimulation of the hotspot. For 346 
sham trials, the coil was positioned with one wing perpendicular to the participant's head. 347 
 348 
Data analysis and statistics  349 
EMG analysis 350 
Raw EMG data was corrected for amplification (x20-100), zero-mean centered, smoothed across 80 351 
samples (40ms), normalized to EMG at MVC, and rectified. MEP amplitude, derived from zero-mean 352 
centered raw EMG, was normalized against maximum EMG during MVC. MEPs with amplitude 353 
below three standard deviations (sd) from background EMG levels were excluded. Analysis was 354 
confined to FDP MEPs although we also have FDI and EDC measures. EMG at TMS stimulation is 355 
mean smoothed, normalized, and rectified EMG 55-5ms pre-TMS. EMG at max force/angle is mean 356 
smoothed, normalized, and rectified EMG 50-0ms pre-max force/angle. 357 
 358 
Testing which model best explains FDP MEP amplitude using Bayesian model comparison 359 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 15 
We performed data analysis in MATLAB (version 9.13 (R2022b), The MathWorks Inc, Natick, MA, 360 
USA) and statistical analysis was in R (version 2022.12.0, https://www.r-project.org). Models were 361 
compared using Bayes factors, we used the bayes_factor function from the ‘brms’22 library (version 362 
2.18.0, https://cran.r-project.org/web/packages/brms/index.html) using STAN23 in R. The Bayes factor 363 
(BF) is the ratio of the probabilities of the data under two competing models. Samples were collected 364 
using Markov Chain Monte Carlo (MCMC) sampling, comprising 4000 iterations, including 2000 365 
warm-up phases, across 7 chains, resulting in a total of 14,000 posterior samples. Chain convergence 366 
was evaluated using the Rhat statistic, consistently achieving a value of 1.00. One thousand BFs were 367 
computed per test to gain a mean and standard deviation of the BF. 368 
 369 
For each parameter force and angle, we computed an active inference model and a predictive coding 370 
model. The active inference models included the variable angle/force at TMS, and the predictive 371 
coding models included the variable error in angle/force (Table 1). All models included subject as a 372 
random effect with intercept, EMG at TMS and EMG at objective force/angle. MEP amplitude and 373 
other continuous variables were standardized per participant by subtracting participant mean and 374 
dividing with sd. This standardization facilitated the centering of priors around 0, with a sd of 1. The 375 
choice of non-conservative priors is to minimize their influence since there are no previous studies to 376 
base the priors on. 377 
 378 
Testing how much variability the variables in the models explain of the data 379 
To assess the proportion of variance in the MEP amplitude that is explained by the models, we 380 
estimated Bayesian R-squared for posterior distributions using the bayes_R2 function from the ‘brms’ 381 
package in R (Extended data table 2). 382 
 383 
 384 
 385 
 386 
 387 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 16 
Additional information 388 
Data availability 389 
The data supporting the findings in this study are available upon reasonable request from the 390 
corresponding author IMB. The data are not publicly available yet since the data are currently pseudo-391 
anonymized. We will fully anonymize the data and make it available with Open Access at Open 392 
Science Foundation in case of manuscript acceptance.  393 
 394 
Code availability 395 
The code supporting the findings in this study is available upon reasonable request from the 396 
corresponding author IMB. We will make it available with Open Access at Open Science Foundation 397 
in case of manuscript acceptance.  398 
 399 
Competing interests 400 
The authors declare no competing interests. 401 
 402 
Author contributions 403 
Ida Marie Brandt: Conceptualized and designed the study, data collection, data analysis, discussed 404 
results.  Writing: original draft. 405 
Thor Grünbaum: Obtained funding, conceptualized the study, provided feedback on experimental 406 
setup, discussed results. Writing: Review and editing.  407 
Mark Schram Christensen: Obtained funding, conceptualized, and designed the study, supervised data 408 
analysis, discussed results. Writing: Review and editing.  409 
 410 
Funding 411 
Funding for this study was provided by the Independent Research Fund Denmark, Humanities, 412 
funding number 0132-00141B, Carlsberg Foundation, funding number CF22-1111, and Carlsberg 413 
Foundation, funding number CF22-0941. 414 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 17 
 415 
Acknowledgements 416 
The authors would like to thank Mark Wulf Carstensen and Iva Svecová for helping during data 417 
collection, Jesper Lundbye-Jensen for contributing to obtain funding, and Jesper Lundbye-Jensen and 418 
Anke Ninija Karabanov and Victor Lange for theoretical contributions to experimental setup and Iva 419 
Svecová and V aleria Simonelli for contributing feedback during piloting. 420 
 421 
Keywords 422 
Active inference, optimal control theory, motor command, proprioceptive prediction error, motor 423 
evoked potential (MEP). 424 
 425 
  426 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 18 
References 427 
 428 
1. Shadmehr, R., Smith, M. A. & Krakauer, J. W. Error correction, sensory prediction, and adaptation in 429 
motor control. Annual Review of Neuroscience vol. 33 89–108. https://doi.org/10.1146/annurev-430 
neuro-060909-153135 (2010). 431 
2. Friston, K. The free-energy principle: A unified brain theory? Nature Reviews Neuroscience vol. 11 432 
127–138. https://doi.org/10.1038/nrn2787 (2010). 433 
3. Friston, K., Kilner, J. & Harrison, L. A free energy principle for the brain. J Physiol Paris 100, 70–434 
87. https://doi.org/10.1016/j.jphysparis.2006.10.001 (2006). 435 
4. Adams, R. A., Shipp, S. & Friston, K. J. Predictions not commands: active inference in the motor 436 
system. Brain Structure and Function vol. 218 611–643 https://doi.org/10.1007/s00429-012-0475-5 437 
(2013). 438 
5. Bestmann, S. & Krakauer, J. W. The uses and interpretations of the motor-evoked potential for 439 
understanding behaviour. Exp Brain Res vol. 233 679–689. https://doi.org/10.1007/s00221-014-440 
4183-7 (2015). 441 
6. Day, B. L. et al. MOTOR CORTEX STIMULATION IN INTACT MAN 2. MULTIPLE 442 
DESCENDING VOLLEYS. Brain 110, 1191–1209. https://doi.org/10.1093/brain/110.5.1191 (1987). 443 
7. Hess, C. W., Mills, K. R. , & Murray, N. M. F. Responses in small hand muscles from magnetic 444 
stimulation of the human brain. J Physiol 388, 397–419. 445 
https://doi.org/10.1113/jphysiol.1987.sp016621 (1987). 446 
8. Floegel, M., Kasper, J., Perrier, P. & Kell, C. A. How the conception of control influences our 447 
understanding of actions. Nat Rev Neurosci 24, 313–329. https://doi.org/ 10.1038/s41583-023-00691-448 
z (2023). 449 
9. Kalaska, J. F., Cohen, D. A., Hyde, M. L. & Prud’hommel, M. A Comparison of movement direction-450 
related versus load direction-related activity in primate motor cortex, using a two-dimensional 451 
reaching task. The Journal of Neuroscience 9, 2080–2102 https://doi.org/10.1523/JNEUROSCI.09-452 
06-02080.1989 (1989)  453 
10. Georgopoulos, A. P., Schwartz, A. B. & Kettner, R. E. Neuronal Population Coding of Movement 454 
Direction. Science 233, 1416–1419. https://doi.org/10.1126/science.3749885 (1986). 455 
11. Georgopoulos, A. P. & Carpenter, A. F. Coding of movements in the motor cortex. Current Opinion 456 
in Neurobiology 33, 34–39. https://doi.org/10.1016/j.conb.2015.01.012 (2015). 457 
12. Reina, A. G., Moran, D. W. & Schwartz A. B. On the Relationship Between Joint Angular V elocity 458 
and Motor Cortical Discharge During Reaching. Journal of Neurophysiology 85, 2576-2589 459 
https://doi.org/10.1152/jn.2001.85.6.2576 (2001). 460 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 19 
13. Aflalo, T. N. & Graziano, M. S. A. Partial Tuning of Motor Cortex Neurons to Final Posture in a 461 
Free-Moving Paradigm. PNAS 103, 2909-2014 https://doi.org/10.1073/pnas.0511139103 (2006). 462 
14. Stark, E., Drori, R., Asher, I., Ben-Shaul, Y . & Abeles, M. Distinct movement parameters are 463 
represented by different neurons in the motor cortex. European Journal of Neuroscience 26, 1055–464 
1066 10.1111/j.1460-9568.2007.05711.x (2007). 465 
15. Brandt, I. M., Lundbye-Jensen, J., Grünbaum, T. & Christensen, M. S. Force, angle, and velocity 466 
parameters of finger movements are reflected in corticospinal excitability.  Preprint at 467 
https://doi.org/10.1101/2024.02.28.582459 (2024). 468 
16. Gelman, A., Goodrich, B., Gabry, J. & Vehtari, A. R-squared for Bayesian Regression Models. The 469 
American Statistician 73, 307–309 https://doi.org/10.1080/00031305.2018.1549100 (2019). 470 
17. Rossi, S. et al. Safety and recommendations for TMS use in healthy subjects and patient populations, 471 
with updates on training, ethical and regulatory issues: Expert Guidelines. Clinical Neurophysiology 472 
132, 269–306 https://doi.org/10.1016/j.clinph.2020.10.003 (2021). 473 
18. Rossi, S., Hallett, M., Rossini, P. M., Pascual-Leone, A. & The Safety of TMS Consensus Group. 474 
Safety, ethical considerations, and application guidelines for the use of transcranial magnetic 475 
stimulation in clinical practice and research. Clinical Neurophysiology 120, 2008–2039 476 
https://doi.org/10.1016/j.clinph.2009.08.016 (2009). 477 
19. Oldfield, R. C. The assessment and analysis of handedness: The Edinburgh inventory. 478 
Neuropsychologia 9, 97–113 https://doi.org/10.1016/0028-3932(71)90067-4 (1971). 479 
20. Hupfeld, K. E., Swanson, C. W., Fling, B. W. & Seidler, R. D. TMS-induced silent periods: A review 480 
of methods and call for consistency. Journal of Neuroscience Methods 346 481 
https://doi.org/10.1016/j.jneumeth.2020.108950 (2020). 482 
21. Diong, J., Kishimoto, K. C., Butler, J. E. & Héroux, M. E. Muscle electromyographic activity 483 
normalized to maximal muscle activity, not to Mmax, better represents voluntary activation. PLoS 484 
One 17 https://doi.org/10.1371/journal.pone.0277947 (2022). 485 
22. Bürkner, P. C. brms: An R package for Bayesian multilevel models using Stan. Journal of Statistical 486 
Software 80, 1–28 https://doi.org/10.18637/jss.v080.i01 (2017) 487 
23. Carpenter, B. et al. Stan: A probabilistic programming language. Journal of Statistical Software 76, 488 
1–32 https://doi.org/10.18637/jss.v076.i01 (2017). 489 
24. Nervous system – Spinal cord section 3 – Smart-Servier by Laboratoires Servier,    Wikimedia 490 
Commons, Creative Commons Attribution-Share Alike 3.0, Modified by inclusion in figure 491 
containing other elements, Accessed February 27, 2024, 492 
https://commons.wikimedia.org/wiki/File:Nervous_system_-_Spinal_cord_section_3_--_Smart-493 
Servier.png 494 
25. Brain Surface by Wilfredor, Wikimedia Commons, Creative Commons Attribution-Share Alike 4.0, 495 
Modified by inclusion in figure containing other elements and attributed text-boxes, Accessed 496 
February 27, 2024, https://commons.wikimedia.org/wiki/File:Brain_Surface.SVG 497 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 20 
26. 1119 Muscles that Move the Humerus d by OpenStax College, Wikimedia Commons, Creative 498 
Commons Attribution 3.0, Modified by cropping to view Triceps brachii, removing black lines and 499 
inclusion in a figure containing othe relements. Accessed February 27, 2024, 500 
https://commons.wikimedia.org/wiki/File:1119_Muscles_that_Move_the_Humerus_d.png 501 
 502 
 503 
  504 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 21 
Supplementary Data 505 
 506 
 507 
Extended data figure 1. Plot of the conditional effects of the models on standardized MEP 508 
amplitude from flexor digitorum profundus. A)-C) Force optimal control theory conditional 509 
effects, MEP n = 3173. D)-F) Force active inference conditional effects, MEP n = 3173. G)-I) Angle 510 
optimal control theory conditional effects, MEP n = 8976. J)-L) Angle active inference conditional 511 
effects, MEP n = 8976. A) Conditional effect of standardized EMG at TMS on standardized MEP 512 
from the force optimal control theory model. B) Conditional effect of standardized EMG at max force 513 
on standardized MEP from the force optimal control theory model. C) Conditional effect of 514 
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 22 
standardized force level at TMS on standardized MEP from the force optimal control theory model. 515 
D) Conditional effect of standardized EMG at TMS on standardized MEP from the force active 516 
inference model. E) Conditional effect of standardized EMG at max force on standardized MEP from 517 
the force active inference model. F) Conditional effect of standardized force error on standardized 518 
MEP from the force active inference model. G) Conditional effect of standardized EMG at TMS on 519 
standardized MEP from the angle optimal control theory model. H) Conditional effect of standardized 520 
EMG at max angle on standardized MEP from the angle optimal control theory model. I) Conditional 521 
effect of standardized angle level at TMS on standardized MEP from the angle optimal control theory 522 
model. J) Conditional effect of standardized EMG at TMS on standardized MEP from the angle active 523 
inference model. K) Conditional effect of standardized EMG at max angle on standardized MEP from 524 
the angle active inference model. L) Conditional effect of standardized angle error on standardized 525 
MEP from the angle active inference model. 526 
 527 
 528 
Extended data table 1. Bayesian model estimates of optimal control theory models and active 529 
inference models. Variable estimates, estimate error and credibility intervals of the Bayesian linear 530 
mixed models from Main table 1. 531 
 532 
Estimate Est. Error CI
Force motor command Intercept 0.00 0.02 [-0.03; 0.03]
EMG at TMS 0.26 0.02 [0.23; 0.29]
EMG at max force 0.12 0.02 [0.08; 0.15]
Force at TMS 0.22 0.02 [0.19; 0.26]
Force active inference Intercept 0.00 0.02 [-0.03; 0.03]
EMG at TMS 0.32 0.02 [0.29; 0.35]
EMG at max force 0.19 0.02 [0.16; 0.22]
Force prediction error 0.05 0.02 [0.02; 0.08]
Angle motor command Intercept 0.02 0.02 [-0.02; 0.06]
EMG at TMS 0.14 0.01 [0.12; 0.15]
EMG at max angle 0.07 0.01 [0.06; 0.09]
Angle at TMS 0.05 0.01 [0.04; 0.07]
Angle active inference Intercept 0.02 0.02 [-0.02; 0.06]
EMG at TMS 0.15 0.01 [0.13; 0.16]
EMG at max angle 0.07 0.01 [0.06; 0.09]
Angle prediction error -0.00 0.01 [-0.02; 0.01]
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 23 
 533 
 534 
Extended data table 2. Estimation of MEP variance explained by the models. In the main text we 535 
show evidence for optimal control theory over active inference. To assess the proportion of variance 536 
in the MEP amplitude that is explained by the models, we estimated Bayesian R-squared for posterior 537 
distributions using the bayes_R2 function from the ‘brms’ package in R. The force optimal motor 538 
control model estimate = 0.208 and the angle optimal motor control model estimate = 0.0422. We 539 
found that the model fit estimates for force models are higher than for the angle models. The Bayesian 540 
R2 is a measure of the proportion of variance in the observed data that is explained by the model. 541 
Note that the R2 estimates cannot be compared between models within the same dataset. An increase 542 
R2 can therefore not be interpreted as an improved fit16.  543 
 544 
Bayesian model comparison of active inference models against a model without prediction error 545 
To investigate whether the proprioceptive prediction error does have some explanatory power on MEP 546 
amplitude, we tested the active inference force/angle models against a simpler model containing only 547 
subject and the two EMG measures (See Extended data table 3). BF active inference force = 8.1 and 548 
BF active inference angle = 0.0089. For angle, not only is the model with the prediction error not as 549 
good at explaining MEP amplitude as the model with current force/angle measure, it does not add any 550 
explanatory power to the MEP amplitude modulations. For force, there was stronger evidence for the 551 
active inference model compared to the simple model (BF = 8.1), and the proprioceptive prediction 552 
error does thus seem to offer a bit of explanatory power to the MEP amplitude. 553 
 554 
Estimate Estimate error Q2.5 Q97.5
Force simple 0.167 0.0103 0.147 0.188
Force optimal control theory 0.208 0.0108 0.187 0.229
Force active inference 0.171 0.0105 0.151 0.192
Angle simple 0.0396 0.00292 0.0340 0.0454
Angle optimal control theory 0.0422 0.00299 0.0366 0.0484
Angle active inference 0.0396 0.00294 0.0340 0.0454
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 
 
 24 
 555 
Extended data table 3. Bayesian model comparisons. The force active inference models and the 556 
simple models they are tested against to test whether proprioceptive prediction error offers a degree of 557 
explanatory power. 558 
 559 
 560 
Force simple Subject + EMG at TMS + EMG at max force
Force active inference Subject + EMG at TMS + EMG at max force + force prediction error
Angle simple Subject + EMG at TMS + EMG at max angle
Angle active inference Subject + EMG at TMS + EMG at max angle + angle prediction error
.CC-BY 4.0 International licensemade available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprintthis version posted May 8, 2024. ; https://doi.org/10.1101/2024.05.06.592675doi: bioRxiv preprint 