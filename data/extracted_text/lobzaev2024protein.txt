Article https://doi.org/10.1038/s41467-024-54814-w
Protein engineering using variational free
energy approximation
Evgenii Lobzaev 1,2, Michael A. Herrera1,M a r t y n aK a s p r z y k1 &
Giovanni Stracquadanio 1
E n g i n e e r i n gp r o t e i n si sac h a l l e n g i n gtask requiring the exploration of a vast
design space. Traditionally, this is achieved using Directed Evolution (DE),
which is a laborious process. Generative deep learning, instead, can learn
biological features of functional proteins from sequence and structural data-
sets and return novel variants. However, most models do not generate ther-
modynamically stable proteins, thus leading to many non-functional variants.
Here we propose a model called PRotein Engineering by Variational frEe
eNergy approximaTion (PREVENT), which generates stable and functional
variants by learning the sequence andthermodynamic landscape of a protein.
We evaluate PREVENT by designing 40 variants of the conditionally essentialE.
coli phosphotransferase N-acetyl-L-glutamate kinase (EcNAGK). Weﬁnd 85% of
the variants to be functional, with 55% of them showing similar growth rate
compared to the wildtype enzyme, despite harbouring up to 9 mutations. Our
results support a new approach that can signiﬁcantly accelerate protein
engineering.
Designing a new protein entails the search for novel, stable and func-
tional amino acid sequences that integrate seamlessly with an existing
protein fold, while minimizing the associated free energy of the new
conﬁguration
1. In practice, this requires evaluating thousands of
sequence variants2, derived from a suitable protein template, for both
their thermodynamic and operationalﬁtness, often with respect to a
desired downstream application, e.g., biocatalysis or enzyme repla-
cement therapy. This is conventionally achieved experimentally using
Directed Evolution (DE)
3, where thousands of protein variants are
synthesised, screened and selected through a selection process that
can converge to a sequence optimum that meets speciﬁco p e r a t i o n a l
requirements. However, DE is a laborious and expensive process,
which requires a high degree of laboratory automation to achieve the
throughput required by the industrial biotechnology sector.
Computational methods instead hold the promise to speed up
protein engineering by providing a way to screen in silico favourable
mutations by biophysically modelling thermodynamic changes by
amino acid changes
4,5. While a plethora of biophysical methods have
been developed to facilitate the process of protein engineering, they
are often constrained by the computational cost of free energy cal-
culations, which in turn limits the exploration of the protein design
space. Recently, generative deep learning has emerged as a promising
tool for protein engineering, as it can learn the biological properties
associated with functional proteins using large sequence and struc-
tural datasets
6–10. Nonetheless, while the generated sequences broadly
resemble those observed in Nature, it remains challenging to obtain
functional designs, since most methods cannot condition the
sequence generation process towards thermodynamically stable
variants.
Here we hypothesised that we could overcome current limitations
of generative protein engineering models by learning the sequence-to-
free-energy relationship from a small set of biophysical simulations
over a library of computationally designed variants using a Variational
Autoencoder (VAE)
11. To this end, we developed the PRotein Engi-
neering by Variational frEe eNergy approximaTion (PREVENT) model,
which allows both the controlled generation of variants with minimal
free energy as well as the prediction of the free energy associated with
generated variants for downstream experimental prioritization.
Received: 21 February 2024
Accepted: 20 November 2024
Check for updates
1School of Biological Sciences, The University of Edinburgh, Edinburgh, United Kingdom.2chool of Informatics, The University of Edinburgh,
Edinburgh, United Kingdom. e-mail: giovanni.stracquadanio@ed.ac.uk
Nature Communications|        (2024) 15:10447 1
1234567890():,;
1234567890():,;
We evaluated PREVENT by designing and experimentally testing
variants of the archetypal E. coli phosphotransferase N-acetyl-L-
glutamate kinase (EcNAGK)12. EcNAGK is a small, 258 amino acid long
conformationally dynamic homodimer, comprising a bi-domain
architecture organised in a Rossmann-like (α/β/α)s a n d w i c h .I nN a t -
ure, it is primarily responsible for ATP-dependent phosphorylation of
N-acetyl-L-glutamate (NAG) in the L-arginine biosynthesis pathway.
The intrinsic ﬂexibility of EcNAGK, as evidenced by several crystal
structures (PDB: 1GS5, 2WXB, 1OHA, 1OHB, 1OH9), is hypothesised to
be crucial for catalysis and hints towards a complex thermodynamical
landscape. Using our model, we designed a library of 40 newEcNAGK
variants and observed that 85% of the transformed variants could
substitute for the wildtype enzymedespite harbouring up to 9 muta-
tions compared to the wildtype.
Taken together, our results support a new approach to generative
protein design that can dramatically accelerate engineering of novel,
functional proteins.
Results
L-arginine is a ubiquitous proteinogenic amino acid necessary for the
basic physiological function of all organisms. De novo L-arginine bio-
synthesis proceeds via a critical L-ornithine precursor in both animals
and bacteria. Distinctly from animals, however, bacterial L-ornithine is
generated from a cascade of N-acetylated, rather than non-acetylated,
intermediate (see Supplementary Fig. 1)
13.
The ﬁrst committed step inE. coliL-ornithine biosynthesis is the
transacetylation of L-glutamate using acetyl-CoA to yield NAG, cat-
alysed by N-acetyl-L-glutamate synthase (NAGS). In the second bio-
synthetic step, the nascent NAG is phosphorylated to furnish
N-acetyl-L-glutamyl 5-phosphate (NAGP); this ATP-dependent con-
version is catalysed by aforementionedEcNAGK, encoded inE. coliby
the argB gene. Importantly, the binding of ATP toEcNAGK triggers a
major inter-domain conformational shift that greatly tightens the
active site, thereby permitting the facile phosphoryl transfer from
ATP to NAG. This reaction is further facilitated by invariant residues
Lys8, Gly11, Gly44, Gly45 and Lys217, which work to correctly orient
the substrates and stabilise the transition state. Following phos-
phoryl transfer, the enzyme relaxes into an open conformation and
liberates the products NAGP and ADP in preparation for the next
catalytic cycle.
Here we used our PREVENT model (see Supplementary Fig. 2) to
replace the wildtype EcNAGK enzyme with new, unseen variants
thereof. To do that, we began by performing in silico mutagenesis of
the EcNAGK wildtype sequence (Uniprot id: P0A6C8; PDB id: 1GS5) to
build the input dataset required to approximate the sequence-to-
energy relationship for this enzyme (see“Methods”). With our proce-
dure, we generated 117,387 unique variants, with each variant har-
bouring up to 38 mutations (≈ 15% of the residues), and then computed
the associated free energy,ΔG, using FOLDX
14.E a c hp o s i t i o no ft h e
wildtype enzyme, except theﬁrst one, is mutated on average in 6.58%
of the variants; as expected, most of the introduced mutations are
destabilizing, with a signiﬁcant positive correlation between number
of mutations and free energy.
We then split the dataset into a training and validation sets (90%,
106,238 variants) (see Fig.1A, B) and a held-out test set (10%, 11,149
variants) (see Supplementary Fig. 3) to evaluate the performance of
our model. We maintained a similarΔG distribution in the training and
test sets for a fair comparison.
In order to study how PREVENT performances depend on the size
of the input mutagenesis dataset, we further subsampled the initial
training dataset by selecting 25K, 50K and 75K sequences at random,
albeit maintaining aΔG distribution similar to the original dataset.
Using these datasets, we then trained our default transformer
VAE model (see“Methods”) with 128-dimensional latent space for
1400 epochs using mini batches of 256 sequences, and by setting the
learning rate to 10
−4 and the dropout probability to 0.2 for regular-
ization. Moreover, to learn effective latent space encodings,
we masked 25% of each sequence residues at random. With
this experimental setup, we tested our model on 4 different
conﬁgurations.
We ﬁrst assessed model performances using a held-out test set
by looking both at the sequence reconstruction error and the Root
Mean Square Error (RMSE) of the free energy across the 4 experi-
ments. After attaining the preﬁxed number of epochs, the recon-
struction error was 114.80 (perplexity: 0.66) for the full dataset,
suggesting that our model is able to effectively reconstruct
sequences from the latent space, a trend that was consistent
regardless of the size of the training dataset (see Supplementary
Table 1). We then looked at the accuracy of the predicted free energy,
and obtained the best results when using the full dataset (RMSE
= 9.27); nonetheless, even when using only 25K sequences, the model
achieves comparable performances (RMSE = 12.12). Importantly,
while the predicted energy values might differ from those estimated
by FOLDX, they are strongly correlated, with Spearman correlation
ranging from ρ = 0.96 when training on the full dataset and only
dropping toρ = 0.92 when using only 25K sequences, suggesting that
predicted values are a robust metric for variants ranking. This is
further conﬁrmed by the concordance at the top (CAT) analysis of
variants ranked by free energy values; in particular, we found a
concordance higher than 80% when looking at the top 1000 ranked
sequences, a trend observed regardless of the size of the mutagen-
esis dataset used (see Fig.1C, D).
We then analyzed theEcNAGK encodings to check whether PRE-
VENT would map different variants to different regions of the latent
space. To achieve this, we computed the empirical variance of each
latent component, deﬁned as diagðcov
xEqϕðzjxÞ½z/C138Þ 15, and considering a
component as being active if its standard deviation was greater than
0.1. Here we found that the vast majority (126) of the 128 components
to be active, albeit to a different level, suggesting that our model maps
variants to different regions of the latent space. We then proceeded
with the analysis of the latent space organization by performing Prin-
cipal Component Analysis (PCA) of the expected value of the varia-
tional posterior distribution q
ϕ(z∣x) for the sequences in the
mutagenesis dataset, which revealed a structural organization, where
sequences with lower free energy were located in the central part of
the latent space, whereas sequences with higherΔG values were
located in the periphery, remotely resembling a folding funnel
(see Fig.2).
Taken together, we found that PREVENT is able to effectively
reconstructEcNAGK sequences and the expected free energy from the
latent space.
Hyperparameter analysis
We also performed a hyperparameter analysis to understand how the
choice of the latent dimension, the transformer size and the number of
training epochs affect the performance of PREVENT on the held-out
test set. We used our original transformer model conﬁguration as well
as another, twice as small, conﬁguration with 4 encoder layers, 2
decoder layers, 256 embedding size and 4 heads. First, we noticed that
training for 500 epochs is usually sufﬁcient to obtain a minimal vali-
dation loss, as most models converge between 100 and 200 epochs.
Then, we conﬁrmed that the choice of the latent dimension does not
affect sequence reconstruction error, regardless of the size of the
model and latent space. However, the model size and the latent
dimension do affect the RMSE of the free energy, with the smaller
model with 128-dimensional latent space achieving the lowest RMSE of
6.84 across all experiments. Nevertheless, the Spearman correlation
remained high across all models, ranging from 0.97 to 0.98, which is
comparable to the original model results, used in all downstream tasks
(see Supplementary Table 2).
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 2
Sequence analysis of theEcNAGK variants generated by
PREVENT
We then proceeded to perform sequence analysis of variants gener-
ated by the two PREVENT strategies, namely prior optimization of free
energy (POE) and seeded non optimal free energy ranking (SNE). We
generated 2000 variants using POE and 30,000 samples for SNE, and
then removed those sequences that were i) present in the training set,
ii) have mutations in the binding site, or iii) are duplicated.
With this criteria, we obtained 1282 new variants (66%) for POE
and 13,323 variants for SNE (44%), which is expected given that theﬁrst
strategy freely explores the free energy landscape ofEcNAGK, whereas
the second generates sequences within the region of the wildtype
sequence. Importantly, POE variants are more diverse (see Fig.3A)
than SNE, with an average of 7.09 and 3.57 mutations respectively.
Surprisingly, we observed that only≈ 25% of mutations were con-
servative, as measured by BLOSUM62 substitution matrix; this result
suggests that PREVENT might select energetically favorable mutations
regardless of evolutionary information (see Fig.3B). Finally, while the
type of mutations was highly similar across strategies, they are located
differently across the wildtypeEcNAGK sequence (see Fig.3C); in
particular, POE predominantly mutates the C-terminus harboring the
ATP-binding domain of the protein, which harbours highly non
conservative mutations, such as the tryptophan introduced at position
212 in place of the aspartic acid residue (see Fig.3D), whereas SNE
introduced mutations almost uniformly across the wildtype sequence
(see Fig.3E).
Taken together, we found that PREVENT can generate highly
diverse protein variants, which carry not only conservative mutations
but also non conservative ones, which would not be selected by using
homology information alone.
Design of a library ofEcNAGK variants
We then built a library ofEcNAGK variants for experimental validation,
in order to estimate the expected fraction of functional variants gen-
erated by PREVENT.
To do that, we took the 10 variants with lowest free energy
obtained with the POE strategy and the 10 variants with the lowest free
energy generated with the SNE strategy. We further augmented this
library by adding 10 variants with the highest ELBO, denoted as SNL,
and 10 with the highest identity with respect to the wildtype, hereby
denoted as SNI, in order to compare our energy-driven design against
common generative strategies for protein engineering (see Fig.4A).
Variants in the library have an average free energy ranging from -29.8
kcal/mol for the SNE group, to -18 kcal/mol for the SNL group, with a
10
20
30
−50 −30 −10 10 30 50 70 90 110 130 150
/g39G (kcal/mol)
Number of mutations
N. of variants 2500 7500
A
0.0
0.2
0.4
0.6
01 0 0 2 0 0
Residue
Entropy (bits)
B
25K 50K 75K 100K
− 5 0 − 3 0 − 1 0 1 03 05 07 09 0 1 1 0 1 3 0 1 5 0 − 5 0 − 3 0 − 1 0 1 03 05 07 09 0 1 1 0 1 3 0 1 5 0 −50 −30 −10 10 30 50 70 90 110 130 150 −50 −30 −10 10 30 50 70 90 110 130 150
−50
−30
−10
10
30
50
70
90
110
130
150
Simulated/g3/g39G (kcal/mol)
Predicted/g3/g39G (kcal/mol)
N. variants 500 1000
C
25K 50K 75K 100K
100 1000 100 1000 100 1000 100 1000
0.0
0.2
0.4
0.6
0.8
Rank
Concordance
D
Fig. 1 | PREVENT performance analysis. AThermodynamic landscape approx-
imation (ΔG) as a function of the number of mutations inEcNAGK variants in the
training dataset. Black dashed line denotes the free energy of the wildtypeEcNAGK.
B Amino acid entropy ofEcNAGK variants in the training dataset. Every position,
except theﬁrst methionine, is mutated in 6.58% of the generated variants.
C PREVENT estimates ofΔG values against free energy estimates simulated using
FOLDX for different training set sizes. RMSE is 9.28 for 100K training set, 9.74 for
75K training set, 11.24 for 50K training set and 12.12 for 25K training set. Spearman
correlation coefﬁcient is 95.53% for 100K training set, 95.25% for 75K training set,
93.58% for 50K training set and 91.79% for 25K training set.D concordance at the
top (CAT) analysis of sequences ranked using free energy information. PREVENT
achieves a concordance 75% with FOLDX simulations regardless of the size of the
training set, albeit moderate differences in ranking top sequences are observed
when considering the top 100 and 1000 variants.
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 3
−2.5
0.0
2.5
5.0
−5.0 −2.5 0.0 2.5 5.0
PC1 (25.1%)
PC2 (24.2%)
/g39G
−42
50
150
A
0.00
0.25
0.50
0.75
1.00
11 02 03 04 05 06 07 08 09 0 1 0 0 1 1 0 1 2 0 1 2 8
Latent space components
Standard deviation
B
Fig. 2 | PREVENT latent space analysis. APrincipal component analysis of the
EqϕðzjxÞ½z/C138 embeddings generated by PREVENT for the sequences in the training set
and color coded according to the corresponding free energyΔG values.
B Activation plot for the 128-dimensional latent space learned. The x-axis
represents each latent component and y-axis the standard deviation of the corre-
sponding value learned during training; the dashed line represents the expected
value of each component under a null model of random value assignment.
0.0
0.1
0.2
01 0 2 0 3 0
Number of mutations
Density
POE SNEA
0.0
0.1
0.2
−4 −3 −2 −1 0 1 2 3
BLOSUM62 score
Density
POE SNEB
01 0 0 2 0 0
0
1
2
0
1
2
Residue
Entropy (bits)
POE SNEC
M2Y I7K
V12K
D187Y
D212ED212W
D223Y
A224G
V232K D233T
I234M
M252A
G253T
0.0
0.2
0.4
0 100 200
Residue
Mutation frequency
D
0.000
0.005
0.010
0.015
0.020
0.025
0 100 200
Residue
Mutation frequency
E
Fig. 3 | Sequence analysis of PREVENT generated variants. ADistribution of the
number of mutations in variants generated using the POE and SNE strategies; the
POE strategy generates more diverse variants compared to SNE.B Distribution of
the BLOSUM62 substitution matrix scores for the 9083 mutations introduced by
the POE strategy and for the 47,573 mutations introduced by the SNE strategy; the
vast majority of the mutations are non-conservative.C Residue level entropy for
variants obtained using POE and SNE strategies; POE preferentially adds mutations
at the C-terminus of the protein. Most frequent mutations in variants generated by
the POE strategy (D) and the SNE strategy (E). While SNE variants have a similar
mutational proﬁle to the training set, POE variants have a vastly different muta-
tional proﬁle, with surprisingly non-conservative mutations highly represented in
all variants.
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 4
number of mutations ranging from 6.8 for the SNE group to 1 for the
SNL group, mostly located in the C-terminus of the protein for the
variants generated by energy-driven strategies (see Fig.4B). Taken
together, we screened a library of 40 new and diverse variants with a
signiﬁcant variability in free energy.
Before proceeding with experimental work, we performed a series
of quality control steps,ﬁrst, by comparing the predicted free energy
values of each variant to the FOLDX estimates where, as expected, we
found a strong correlation between the two estimates (Spearman
correlation; ρ =0 . 7 7 ,p-value: 5.7 × 10
−9). We additionally checked
whether the correlation changes a lot when using various model and
latent space sizes and found that the correlation remains high across
all models, ranging from 0.87 to 0.93 (see Supplementary Table 3).
We then assessed the structural properties of the variants by
predicting their three dimensional structure using ESMFOLD, per-
forming inverse folding sequence scoring using the wildtypeEcNAGK
structure and then downstream dynamics analyses using ensemble
Normal Mode Analysis (eNMA). The predicted structures have an
average pLDDT of 89.64 (see Fig.5A), which conﬁrms high accuracy of
the predictions, closely resembling the structure of the wildtype
enzyme (average RMSD: 1.70Å). This result was further conﬁrmed
when scoring our variants against the wildtypeEcNAGK structure,
where the average inverse folding score of -0.077 (see Fig.5B, C),
suggesting that variants are highly consistent with the wildtype
fold albeit to a lesser extent than the wildtype sequence (wildtype
log-likelihood: -0.991; average variants log-likelihood: -1.069). We then
looked at the dynamics of each variant and, in general, we found strong
agreement with the wildtype dynamics (average RMSF: 0.15, (see
Fig. 6A)). Nonetheless, we found that the region spanning residues 58
and 65, and 211 and 216, showed increasedﬂexibility, which could
potentially lead to phenotypic differences (see Fig.6B).
Taken together, the overall dynamics of the protein is preserved
despite the introduced mutations.
Establishing the auxotrophic screen forEcNAGK
The EcNAGK encoded by theargB gene is conditionally essential for
protein synthesis in the absence of exogenous L-arginine (or a suitable
precursor). In this context, we hypothesised thatargBknockouts could
be rescued by expressingEcNAGK (or functional variants) via an aux-
iliary plasmid, which is supplemented by DNA transformation. Without
access to such a plasmid, we reasoned that the auxotroph will not
survive in L-arginine-deﬁcient media. Therefore, by using a simple
viability screen, it becomes possible to identify functionalEcNAGK
variants in a manner amenable to high-throughput screening.
To test this hypothesis, we cured (see Supplementary Fig. 4) and
transformed commercial BW25113ΔargB using a bespoke constitutive
expression vector encoding the wildtypeE. coli argBgene (pKCHU-argB)
and the production ofEcNAGK was subsequently conﬁrmed by SDS-
PAGE (see Supplementary Fig. 5A–C). As anticipated, L-arginine auxo-
trophy could be remedied in M9 minimal salts media by either the
supplementation of L-arginine or by complementation with pKCHU-
argB (see Supplementary Fig. 5D). However, using this plasmid-based
expression system, we observed thatargBknockouts required over 24 h
of incubation to emerge from lag phase. Based on our SDS-PAGE ana-
lysis, we hypothesised that the strongEcNAGK overexpression was
severely penalising cell growth in minimal media. By recoding theargB
coding sequence usingE. colicodon usage bias data (see Supplementary
Fig. 6)
16, we measured an average 25-fold reduction in gene expression
by RT-qPCR, which was associated with a drastic improvement in
growth rate using both solid and liquid minimal media (see Supple-
mentary Fig. 7). Given the clear beneﬁt to cell viability, we decided to
backtranslate all our variants using the same codon usage bias strategy.
Screening theEcNAGK variant library
A sequence-perfect library of 40EcNAGK variants (Neochromosome,
Inc.) cloned into our pKCHU expression vector was used to transform
BW25113 ΔargB. To this end, we developed a robust and high-
throughput heat-shock transformation protocol using an Opentrons
OT-2 robot, which allowed us to reliably and reproducibly transformE.
coli using both pET23b-EFGP and pKCHU-argB with minimal user input
(see Supplementary Fig. 8). Whilst manyEcNAGK variants yielded
colonies overnight following heat-shock transformation, several more
variants exhibited poorer transformation efﬁciency and required up to
2 consecutive nights of incubation to develop colonies (see Supple-
mentary Fig. 9). Despite numerous attempts, 7 EcNAGK variants
(namely poe4, snl3, snl6, snl7, sni10, sne1, sne3) did not produce viable
transformants. The observed array of cell viability suggests that the
EcNAGK variants are not tolerated equally, and some variants may
considerably affect cellﬁtness.
The remaining 33 viable variants were studied by auxotrophic
selection, as previously outlined. Remarkably, 22 of the 33 viable
EcNAGK variants could quickly recover the BW25113ΔargB phenotype
in standard M9 minimal salts solid media without L-arginine supple-
mentation. Interestingly, these variants include the top-ranked viable
candidates in each model category (poe1, snl1, sni1, sne2). Further 6
variants (poe5, sni9, sne5, sne7, sne8, sne9) facilitated slow-to-
intermediate recovery, thus bringing the total count of active var-
iants to 28. The remainder (poe2, poe3, poe8, snl5, snl10) did not
5
10
−30 −28 −26 −24
/g39G (kcal/mol)
Number of mutations
poe snl sni sneA
50 100 150 200 250
0.00
0.25
0.50
0.75
1.00
0.00
0.25
0.50
0.75
1.00
0.00
0.25
0.50
0.75
1.00
0.00
0.25
0.50
0.75
1.00
Residue
Entropy
poe snl sni sneB
Fig. 4 | Design of a library of 40EcNAGK variants using PREVENT. AFree energy
and number of mutations of each variant colored by design strategy.B Normalized
sequence entropy of variants generated using different design strategies; energy-
based strategies (POE, SNE) introduce mutation preferably in the C-terminus of the
wildtype protein.
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 5
rescue the phenotype after 48 hours. Conversely, all cells carrying our
variants could proliferate readily and rapidly by supplementing the
minimal media with L-arginine (see Fig.7A).
We then checked whether using the predicted energy information
for designing or prioritizing variants was associated with either a
higher number of functional variants or more diverse sequences. 14
out of the 28 viable variants were obtained by using either POE (6
variants) or SNE (8 variants); as expected, since they carry only 1
mutation, 9 out of 10 SNI variants recovered the phenotype, whereas
only 5 out of the 10 SNL variants were functional.
It is interesting to note that prioritizing variants by ELBO did yield
the lowest number of viable variants, suggesting that it might not be
the most effective strategy. Interestingly, functional variants designed
using free energy information (POE, SNE) harbour, on average, sig-
niﬁcantly more mutations (5.64) compared to the 1.64 mutations
found on variants selected by sequence only information (Student
t-test; t: 4.9173, df: 22.177, p-value = 3.151 × 10
−5), suggesting that
exploiting free energy information could yield more diverse library
with minimal impact on the overall number of functional proteins
obtained in a screen.
We subsequently quantiﬁe dt h eg r o w t hs u p p o r t e db yt h et o p
candidates for each design strategy (namely poe1, snl1, sni1, and sne2) in
a cell density time-course assay. Weobserved that variants poe1, sni1,
and sne2 enabled similar rates of exponential growth compared to the
wildtypeEcNAGK (see Fig.7B, C), albeit cells expressing sne2 exhibited a
23−34% shorter lag time compared to all other experiments (see Sup-
plementary Table 7). Conversely, cells expressing variant snl1 doubled
39% slower on average than those expressing the wildtype enzyme.
We then analyzed whether the introduced mutations in the top
candidates are located at more buried or more accessible sites in the
protein structure. We computed the smoothed hydropathy index
17 for
each residue in the wildtype and checked the location of the mutations
in the top candidates. Around 33% of the mutations are located in the
most hydrophobic regions of the protein, which suggests that the
mutations are not biased towards the surface of the protein (see
Supplementary Fig. 10).
Notably, variant snl1 features a radical and sterically-intrusive
Gly123Trp mutation in an otherwise highly-conserved position onβ7,
which likely destabilizes theβ6-β7 hairpin in the NAG-binding sub-
domain (see Supplementary Fig. 11)
18. Furthermore, the expression of
variant snl1 was discovered to be 5-fold greater than the wildtype by
RT-qPCR analysis (see Supplementary Fig. 12). Therefore, we propose
that the observed growth penalty may be attributed to the divergent
nature of the Gly123Trp mutation and/or less favorable transcription
regulation, which is mediated by our gene re-coding strategy.
In conclusion, 85% of the designed and transformedEcNAGK
variants enabled survival on auxotrophic media, with 67% permitting
similar recovery levels to the wild-type sequence.
Discussion
Computational protein engineering has been limited by the com-
plexity and poor understanding of the function driving the folding of a
polypeptide chain into a thermodynamically stable structure.
Here we addressed these problems by building a generative deep
learning model, called PREVENT, which uses variational inference to
approximate the free energy landscape of a target protein by learning
favorable mutations from a small number of biophysical simulations.
Our method enables generation of new protein sequences and simul-
taneous prediction of the associated free energy and, more impor-
tantly, enables free energy minimization over a mathematically
tractable thermodynamic space, which enables the rapid identiﬁcation
of diverse putatively functional variants. Importantly, PREVENT
enables large scale protein re-engineering, since the cost of predicting
the free energy function remains constant with respect to the number
50 100 150 200 250
60
80
100
60
80
100
60
80
100
60
80
100
Residue
pLDDT
poe snl sni sneA
0
2
4
6
8
10
12
−0.3 −0.2 −0.1 0.0
IF Score (/g16Lmut /g14Lwt)
Number of variants
B
POE1 SNE1 SNL1 SNI1
C
Fig. 5 | Structural analysis of theEcNAGK variants library designed by PRE-
VENT. AAccuracy of theEcNAGK variants structures predicted by ESMFOLD
reported as predicted local distance difference test (pLDDT) at the residue level;
regions with pLDDT > 70 are expected to be accurately modelled.B Inverse folding
scores of the variants library.C Structure of the top variant for each design strategy,
with mutations color coded based on the BLOSUM90 substitution matrix scores.
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 6
of mutations, whereas even simple random search using directly
FOLDX is computationally intractable beyond a handful of mutations.
We used our model to redesign theE. coli phosphotransferase
N-acetyl-L-glutamate kinase (EcNAGK), a key enzyme of the L-arginine
pathway characterized by a highly dynamic structure, which is likely to
be associated with multiple stable thermodynamic states. Computa-
tional results showed that PREVENT can accurately approximate the
free energy landscape of this protein and generate new and diverse
variants, which retain wildtype structural features, irrespective of
the size of the training set used. We then built a library ofEcNAGK
variants and experimentally shown that 85% of the generated variants
were functional, albeit not all variants could completely recover the
wildtype growth phenotype. Importantly, design or selection of var-
iants using predicted free energy information allowed us to obtain a
signiﬁcantly more diverse set of functional proteins compared to
sequence only selection criteria, further validating our approach. This
is particularly interesting for drug discovery, especially with the advent
of noninferiority trials to assess bioequivalence of a new formulation
to an established drug
19; in fact, drugs can be approved even if mar-
ginally inferior, when other aspects of the treatment, such as its cost,
are important. A method like PREVENT can signiﬁcantly speedup the
engineering of these bioequivalent molecules.
While PREVENT allowed redesigning a complex enzyme, we are
also aware of its limitations. Currently, our free energy estimates are
obtained by FOLDX, a well-known and validated tool, which has been
shown to be reliable mostly for small and medium size proteins, mostly
due to the intrinsic difﬁculty of modeling proteins in unfolded state
20.
Understanding how the accuracy of the free energy calculations will
impact our model will require further analysis using different bio-
physical engines, including neural network potentials
21, and proteins
from different families. Moreover, while the use of free energy infor-
mation for protein engineering is reasonable, the limited accuracy of
current estimation methods suggests that relative changes,ΔΔG,i n
free energy compared to the wildtype protein could be a more robust
and accurate way to exploit energy information, especially for large
proteins. Finally, we also recognize that models like PREVENT could
help unveil general design rules associated with stabilizing mutations,
albeit identifying the best framework to make our model explainable
will require further investigation.
Taken together, our work provides a new framework to integrate
generative deep learning with biophysical information, which can
substantially improve both the number and diversity of functional
proteins obtained compared to more lengthy and expensive molecular
biology approaches. It is also important to note that while PREVENT
learns the sequence-to-free-energy relationship of a protein, it can
learn relationships with any other biochemical property, thus repre-
senting a generic framework for phenotype-driven protein design.
Methods
In silico mutagenesis and free energy estimation
In order to approximate theE. coli phosphotransferase N-acetyl-L-
glutamate kinase (EcNAGK) free energy landscape, we generated
variants by mutating the wildtype protein uniformly at random,
except for the methionine in theﬁrst position, and allowing up to 15%
of the residues to be mutated, while discarding any duplicated
sequences.
We then estimated Gibbs free energy of each variant using the
FoldX empirical forceﬁeld, which has been shown to be a robust tool
to estimate the stability of protein and protein complexes
14,20. Speci-
ﬁcally, we used standard FOLDX best practice14,w h e r ew eﬁrst
50 100 150 200 250
0.25
0.75
0.25
0.75
0.25
0.75
0.25
0.75
0.25
0.75
Residue
RMSF( A/g113)
wildtype poe snl sni sneA
B
Fig. 6 | ensemble Normal Mode Analysis (eNMA) of theEcNAGK variants library
designed by PREVENT. AResidue level Root Mean Square Fluctuation (RMSF) of
EcNAGK variants compared to wildtype. The most signiﬁcant changes with respect
to the wildtype are in the regions comprising residues 58 and 65, and 211 and 216.
B Dimer structure ofEcNAGK with region of increasedﬂexibility compared to the
wildtype colored in red.
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 7
performed structural relaxation of the wildtype structure, using the
REPAIRPDB command, which was then used to estimate the Gibbs free
energy (ΔG) of the variants using the BUILDMODEL command using
default parameters and averaging the value across 2 runs.
Joint variational inference of protein sequences and free energy
We hypothesised that a generative model could approximate the
sequence-to-free-energy function byﬁtting a latent, multivariate sta-
tistical distribution, whose parameters are unknown but can be
A
0
1
2
3
0 2 4 6 8 10 12
Time (hours)
OD600nm
B
0.0
0.1
0.2
0.3
0.4
WT poe1 sne2 snl1 sni1
Exp. Growth Rate/OD600nm h/g161
C
Variant
/g39argB
WT
poe1
sne2
snl1
sni1
Fig. 7 | Functional analysis of theEcNAGK variants designed by PREVENT. ATop
plate: perfect recovery of transformedEcNAGK variants, including wildtype and
ΔargB, in L-arginine rich media. Bottom plate: different recovery rates of trans-
formed EcNAGK variants in the minimal media.B Average growth curves of
BW25113 (argB)a n dEcNAGK transformants grown in auxotrophic M9 minimal salts
media. Optical density (OD) measurements were recorded every 2 h for up to 12 h.
Error bars represent the standard error of three biological replicates.C The average
rate of exponential growth supported by wildtype (EcNAGK) and variants. Error
bars represent the standard error of three biological replicates.
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 8
estimated from the data. Speciﬁcally, we assume that samples of the
latent distributions encode both sequence and free energy informa-
tion, which allows us to explore the protein design space either with
respect to the sequence properties or to free energy states.
To do that, we built a new generative protein engineering model,
called PRotein Engineering by Variational frEe eNergy approximaTion
(PREVENT), by extending the classical Variational Autoencoder (VAE)
framework
11, which has been shown to be effective in designing new,
functional proteins6,22,23. In a classical VAE model, the objective is to
m a x i m i z et h eE v i d e n c eL o w e rB O u n d( E L B O ) :
Lðϕ, θÞ = EqϕðzjxÞ½logpθðxjzÞ/C138 /C0 KLðqϕðzjxÞjjpθðzÞÞ ! max
θ, ϕ ð1Þ
where x is an observed random variable (i.e. a protein sequence) andz
is latent variable (or encoding) and KL is the Kullback-Leibler
divergence. Our model, instead, takes into account two observed
variables, that is a sequencex and its associatedΔG value g,w h i c hw e
assume to be conditioned on the latent variablez.S i n c ex and g are
conditionally independent givenz, the entire probability distribution
is factorized as p(x, g, z)= p(z)p(x∣z)p(g∣z). By assuming that the
variational distributionq
ϕ(z∣x, g)= qϕ(z∣x), since we only model the
latent variable dependency on the sequence information, our model
can be trained end-to-end by maximizing the ELBO deﬁned as follows:
Lðϕ, θ
1, θ2Þ = EqϕðzjxÞ½log pθ1
ðxjzÞ/C138 + EqϕðzjxÞ½logpθ2
ðgjzÞ/C138
/C0 KLðqϕðzjxÞjjpðzÞÞ ! max
θ1, θ2, ϕ
ð2Þ
whereEqϕðzjxÞ½logpθ2
ðgjzÞ/C138 corresponds to the reconstruction error for
ΔG.S p e c iﬁcally, by assuming thatpðgjzÞ = Nðgjμθ2
ðzÞ,1 =
ﬃﬃﬃ
2
p
Þ,t h i st e r m
is proportional toEqϕðzjxÞ½/C0ð g /C0 μθ2
ðzÞÞ2/C138 , which is equivalent to the
Mean Squared Error (MSE).
To approximatepθ1
ðxjzÞ and qϕ(z∣x), we used a standard Trans-
former architecture, a widely used neural network architecture for
language processing
24; here we hypothesized that an attention
mechanism could better assist in the prediction ofΔG values from a
variant than any other architecture, given the high sequence homology
in the training set. PREVENT uses 6 layers for the transformer encoder
and 4 layers for the decoder with 512 embedding size split across 8
heads. To approximatep
θ2
ðgjzÞ, instead, we used a Fully connected
Neural Network (FCNN) with 5 layers of progressively decreasing size
(from 64 to 1 nodes) and RELU as non-linear activation function, except
for the linear transformation in the last layer.
Finally, since the variance of the free energy can be extremely
large between batches and higher free energy values are more likely to
appear as most mutations are destabilizing, we developed a weighted
random sampler to ensure a uniform coverage of the sequence and
free energy space during training. Speciﬁcally, a histogram of free
energy values wasﬁrst constructed and then sequences were included
in a mini-batch probabilistically at random, with a probability inversely
proportional to the number of sequences in their corresponding free
energy bin.
Protein engineering using variational energy approximation
Our generative model allows to learn a robust approximation of the
sequence-to-free-energy function, which can then be exploited to
generate more stable proteins. Speciﬁcally, PREVENT implements two
free energy based design procedures, namely the seeded non optimal
energy ranking (SNE) and the prior optimization of free energy (POE).
T h eS N Ep r o c e d u r ef o l l o w st h ec l a s s i c a lV A Ea p p r o a c h ,w h e r ea
seed sequence is passed as input to the encoder to obtain an embed-
ding z, which in turn is passed in input both to the sequence decoder,
to obtain an amino acid sequence, and the energy decoder to estimate
the predicted free energy. Speciﬁcally, while sequences can be
generated using categorical sampling, the expected free energy esti-
mate associated with each generated sequence, instead, is obtained by
ﬁrst passing a generated sequencex in input to the encoder to obtain
q(z∣x), and then the resulting encoding to the free energy decoder to
obtain E½gjx/C138 , that is the expected value of the energy givenx,a s
shown in Eq. (3). In practice, we estimate the variational posterior free
energy distribution ofE½gjx/C138 as follows:
E½gjx/C138 = E
qðzjxÞ∣EpðgjzÞ½g/C138 ∣ = EqðzjxÞ½μθ2
ðzÞ/C138 /C25 1
N
XN
n =1
μθ2
ð ~znÞ ~zn /C24 qðzjxÞ
ð3Þ
where N = 300 samples in our experiments.
While the energy ranking strategy enables the prioritization of
variants based on their predicted free energy, it does not inform the
sequence generation process. However, since PREVENT also maps free
energy information to the latent space, we can perform free energy
optimisation over the latent space and then use the resulting encoding
to sample new sequences; speciﬁcally, we hypothesized that this
approach would allow us to more efﬁciently navigate the protein
design space and to generate more diverse proteins. To do that, we
used a constrained trust region method
25 to minimize the predicted
free energyf θ2
ðzÞ, while constrainingz within 3 standard deviations
from the mean to control sequence diversity. Once an embeddingzopt
associated with a minimal free energy is found, it is used as input to the
sequence decoder to generate new variants, which are then ranked by
their expected energy values.
Computational structural analysis of generated proteins
To characterise the structural and dynamic properties of the gener-
ated variants, we developed a standardized analytical workﬂow.
First, we obtained structure prediction for each variant using
ESMFOLD26 with default parameters and then performed potential
energy minimization to relax the predicted structure as implemented
in the OPENMM package
27 using the Amber14 forceﬁeld, while adding
an harmonic potential energy term to restrain Cα atoms position.
ensemble Normal Mode Analysis (eNMA) was performed using the
BIO3D package
28, using the calpha force ﬁeld and by setting the
temperature to T = 300K. Downstreamﬂuctuation analysis was con-
ducted by generating trajectory using the 7th mode. Finally, we eval-
uated the likelihood of the variants to be compatible with the known
wildtype structure. To do that, we used the ESM inverse folding model
(ESM-IF)
29 using the wildtype (EcNAGK) structure, and scoring variants
using the score IF ðsmut, swtÞ = LðsmutÞ/C0 LðswtÞ,w h e r eL is the log
likelihood of a sequence given the input structure. IF values greater or
equal to 0 are indicative of highly structurally compatible variants.
Experimental materials
BW25113 ΔargB Keio knockout strain was purchased from Horizon
Discovery Ltd. Basic parts for plasmid creation were kindly supplied by
Dr. Marcos Valenzuela-Ortega. Polymerases, RNA miniprep kits,
restriction enzymes and master mixes for cloning were purchased
from New England Biolabs. Invitrogen E-Gel (1%, with SYBR Safe)
agarose gels were used for DNA electrophoresis. Invitrogen NuPAGE
(4−12% Bis-Tris) gels and 1X MES NuPAGE SDS Running buffer were
used for SDS-PAGE (see Supplementary Fig. 14). 5X M9 minimal salts
base was purchased from Formedium. All other chemical reagents
were purchased from Merck or Fisher Scientiﬁc. TheEcNAGK variant
library was assembled and prepared by Neochromosome Inc. The
High-throughput transformations and agar plate spotting were
achieved using an Opentrons OT-2 robot equipped with a thermo-
cycler module, a single channel p20 pipette and a multi-channel p300
pipette. Where stated, the working concentration of kanamycin or
carbenicillin in selective media was 50μ gm L
−1 and 100μ g mL −1,
respectively.
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 9
Construction of the pKCHU-argB vector
pKCHU-argB was assembled via the Joint Universal Modular Plasmids
(JUMP) method using pre-domesticated parts and destination vector
(see Supplementary Table 4)
30. In brief, the basic parts (2fmol μL−1
each) and destination vector (2fmol μL−1)w e r ec o m b i n e dw i t hB s a I( 1 U )
and NEBuilder Master Mix (1X) in a total reaction volume of 15μL.T h e
parts were assembled using the reported thermocycler parameters for
al e v e l0J U M Pa s s e m b l y
31. The reaction mixture was used to transform
commercial NEB5-alpha cells (New England Biolabs) using the heat-
shock method. Transformants were selected overnight at 37 °C on
Yeast Extract-Peptone (YEP) agar plates supplemented with kanamy-
cin. Potential constructs were identiﬁed by colony PCR (see Supple-
mentary Fig. 13), propagated in YEP-kanamycin medium (10 mL),
isolated using a GeneJET Plasmid Miniprep kit (Thermo) and conﬁrmed
by Sanger sequencing.
Puriﬁcation ofEcNAGK variant DNA library
The EcNAGK variant DNA library was assembled and prepared com-
mercially using the same basic parts as pKCHU-argB. DriedE. coliTop
10 cells, harbouring sequence-perfect clones, were individually
reconstituted in yeast-extract-peptone (YEP) medium (200μL)a t3 7
°C for 6 h. The reconstituted cells were propagated in fresh YEP
medium (10 mL) for a further 18 hours at 37 °C. Following biomass
harvest by centrifugation (4000 rcf, 15 minutes), the plasmids
encoding the (EcNAGK) variants were isolated using a GeneJET Plas-
mid Miniprep kit (Thermo). The plasmids were stored at−20 °C in
Tris-HCl buffer (0.1 M, pH 8) until required.
Curing, preparation and transformation of chemically-
competentE. coliBW25113 ΔargB
Commercial E. coliBW25113 ΔargB was cured by Flp-FRT recombina-
tion using the curing plasmid pCP20, as per literature protocol32.T h e
loss of bothkanRand ampRfrom BW25113ΔargB was conﬁrmed by the
restored susceptibility to kanamycin and carbenicillin. Cured BW25113
ΔargB was sub-cultured in YEP media (20 mL, 37 °C) until mid-log
phase. The biomass was harvested by centrifugation (3000 rcf,
10 minutes, 4C) and washed thrice with sterile, ice-cold CaCl2 (100
mM, 20 mL). The washed cells were resuspended in ice-cold CaCl
2 (100
mM, 2 mL), sub-aliquoted as required and transformed fresh using the
heat-shock method. pKCHU-argB transformants were selected on YEP-
agar (37 °C, 18 h) laced with kanamycin.
Auxotrophic screen on solid minimal media
BW25113 ΔargB transformants (harbouring pKCHU-argB or variants
thereof) were propagated in YEP-kanamycin medium (10 mL)
overnight with agitation (37 °C, 18 h). Culture samples (4.8 × 10
8
cells) were diluted in PBS (500μL, 0.1 mM, pH 7.4), gently harvested
and washed a further two times in PBS (200μL) to remove residual
rich media. The washed cells were resuspended in PBS (100μL)a n d
spotted (5μL) on solid minimal media containing bacto-agar (1% w/
v), M9 minimal salts base (1X), MgSO4 (2 mM), CaCl2 (0.1 mM) and
D-glucose (0.4% w/v). Positive control media was prepared by
supplementing with L-arginine (100 μgmL
−1). The minimal media
plates were incubated (37 °C) and visually inspected for growth
over 48 h.
Auxotrophic selection on liquid minimal media
BW25113 ΔargB transformants (harbouring pKCHU-argB or variants
thereof) were propagated in YEP-kanamycin medium (10 mL) over-
night with agitation (37 °C, 18 h). The washed cells were resuspended in
PBS (10 mL) and sampled for back-dilution in minimal media (25 mL,
OD600 = 0.1) containing M9 minimal salts base (1X), MgSO
4 (2 mM),
CaCl2 (0.1 mM) and D-glucose (0.4% w/v). The cultures were incubated
(37 °C) with vigorous shaking for 12–48 h. OD
600 measurements were
recorded periodically.
Reverse Transcriptase Quantitative PCR (RT-qPCR) of wildtype
constructs
BW25113 ΔargB transformants (harbouring pKCHU-argB) were propa-
gated in YEP-kanamycin medium (10 mL) overnight with agitation (37
°C, 18 h). Untransformed BW25113ΔargB was similarly propagated in
antibiotic-free YEP. The cells were sub-cultured (OD600= 0.1) in fresh
YEP media and harvested by centrifugation (3000 rcf, 12 minutes) at
mid-log phase. The cells were resuspended in PBS (1 mL) and pelleted
again by microcentrifugation (3000 rcf, 5 min). Total RNA was
extracted from the pelleted biomass using a Monarch Total RNA
Miniprep kit (New England Biolabs). Per RT-qPCR reaction (20μL),
cDNA was synthesised and ampliﬁed from total RNA (500 ng) with
target-speciﬁc primers (400 nM) using a Luna Universal One-Step RT-
qPCR kit (New England Biolabs), according to manufacturer protocol.
The reactions were performed and analysed in a StepOnePlus RT-qPCR
system (Thermo) conﬁgured for SYBR Greenﬂuorescence detection.
Reverse transcriptase-free and template RNA-free controls were per-
formed in parallel. Relative fold-expression was calculated via the Livak
method usingE. coli16S rRNA (rrsA) as the reference gene.
Reporting summary
Further information on research design is available in the Nature
Portfolio Reporting Summary linked to this article.
Data availability
The data used and generated in this study have been deposited in
Zenodo at underhttps://doi.org/10.5281/zenodo.13763481. Details for
reproducing theﬁgures, plots and tables are provided in the source
data ﬁle. Source data are provided in this paper.
Code availability
The software is available at the following https://github.com/
stracquadaniolab/prevent-nf33.
References
1. Fleishman, S. & Baker, D. Role of the biomolecular energy gap in
protein design, structure, and evolution.Cell 149,2 6 2– 273 (2012).
2. Maynard Smith, J. Natural selection and the concept of a protein
space. Nature 225,5 6 3– 564 (1970).
3. Arnold, F. Directed evolution: bringing new chemistry to life.
Angew. Chem. (Int. Ed. Engl.)57, 4143 (2018).
4. Huang, P., Boyken, S. & Baker, D. The coming of age of de novo
protein design.Nature 537,3 2 0– 327 (2016).
5. Kuhlman, B. & Bradley, P. Advances in protein structure prediction
and design.Nat. Rev. Mol. Cell Biol.20,6 8 1– 697 (2019).
6. Shin, J. et al. Protein design and variant prediction using auto-
regressive generative models.Nat. Commun.12, 2403 (2021).
7. Anishchenko, I. et al. De novo protein design by deep network
hallucination.Nature 600,5 4 7– 552 (2021).
8. Wu, Z., Johnston, K., Arnold, F. & Yang, K. Protein sequence design
with deep generative models.C u r r .O p i n .C h e m .B i o l .65,1 8– 27
(2021).
9. Dauparas, J. et al. Robust deep learning-based protein sequence
design using ProteinMPNN.Science 378,4 9– 56 (2022).
10. Repecka, D. et al. Expanding functional protein sequence spaces
using generative adversarial networks.Nat. Mach. Intell.3,
324– 333 (2021).
11. Kingma, D. Auto-encoding variational bayes.ArXiv Preprinthttps://
doi.org/10.48550/arXiv.1312.6114(2013).
12. Marco-Marin, C., Ramon-Maiques, S., Tavarez, S. & Rubio, V. Site-
directed mutagenesis of Escherichia coli acetylglutamate kinase
and aspartokinase III probes the catalytic and substrate-binding
mechanisms of these amino acid kinase family enzymes and allows
three-dimensional modelling of aspartokinase.J. Mol. Biol.334,
459– 476 (2003).
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 10
13. Cunin, R., Glansdorff, N., Piérard, A. & Stalon, V. Biosynthesis and
metabolism of arginine in bacteria.Microbiological Rev.50,
314– 352 (1986).
14. Guerois, R., Nielsen, J. & Serrano, L. Predicting changes in the sta-
bility of proteins and protein complexes: a study of more than 1000
mutations.J. Mol. Biol.320,3 6 9– 387 (2002).
15. Burda, Y., Grosse, R. & Salakhutdinov, R. Importance weighted
autoencoders.ArXiv Preprinthttps://doi.org/10.48550/arXiv.1509.
00519 (2015).
16. Sharp, P. et al. Codon usage patterns in Escherichia coli, Bacillus
subtilis, Saccharomyces cerevisiae, Schizosaccharomyces pombe,
Drosophila melanogaster and Homo sapiens; a review of the con-
siderable within-species diversity.Nucleic Acids Res.16,
8207– 8211 (1988).
17. Kyte, J. & Doolittle, R. A simple method for displaying the hydro-
pathic character of a protein.J. Mol. Biol.157,1 0 5– 132 (1982).
18. Ben Chorin, A. et al. ConSurf-DB: An accessible repository for the
evolutionary conservation patterns of the majority of PDB proteins.
Protein Sci.29,2 5 8– 267 (2020).
19. Cuzick, J. & Sasieni, P. Interpreting the results of noninferiority
trials– ar e v i e w .B r .J .C a n c e r127,1 7 5 5– 1759 (2022).
20. Schymkowitz, J. et al. The FoldX web server: an online forceﬁeld.
Nucleic Acids Res.33,W 3 8 2– W388 (2005).
21. Maksymenko, K. et al. The design of functional proteins using ten-
sorized energy calculations.Cell Reports Methods. 3 (2023).
22. Hawkins-Hooker, A. et al. Generating functional protein variants
with variational autoencoders.PLoS Computational Biology.
17 (2021).
23. Hsu, C., Nisonoff, H., Fannjiang, C. & Listgarten, J. Learning protein
ﬁtness models from evolutionary and assay-labeled data.Nat. Bio-
technol. 40, 1114– 1122 (2022).
24. Vaswani, A. et al. Attention is all you need.ArXiv Preprinthttps://doi.
org/10.48550/arXiv.1706.03762(2017).
25. Byrd, R., Hribar, M. & Nocedal, J. An interior point algorithm for
large-scale nonlinear programming.SIAM J. Optim.9,
877– 900 (1999).
26. Lin, Z. et al. Evolutionary-scale prediction of atomic-level
protein structure with a language model.Science 379,
1123– 1130 (2023).
27. Eastman, P. Eastman OpenMM 7: Rapid development of high per-
formance algorithms for molecular dynamics.PLOS Computational
Biol. 13,1 – 17 (2017).
28. Grant, B. J., Rodrigues, A. P., ElSawy, K. M., McCammon, J. A. &
Caves, L. S. Bio3D: an R package for the comparative analysis of
protein structures.Bioinformatics22,2 6 9 5– 2696 (2006).
29. Hsu, C. et al. Learning inverse folding from millions of predicted
structures.International Conference On Machine Learning. 162,
8946– 8970 (2022).
30. Valenzuela-Ortega, M. & French, C. Joint universal modular plas-
mids (JUMP): aﬂexible vector platform for synthetic biology.Synth.
Biol. 6, ysab003 (2021).
31. Valenzuela-Ortega, M. & French, C. Joint universal modular plas-
mids: aﬂexible platform for golden gate assembly in any microbial
host. DNA Cloning And Assembly: Methods And Protocols. 2020,
255– 273 (2020).
32. Datsenko, K. & Barry, L. Wanner One-step inactivation of chromo-
somal genes in Escherichia coli K-12 using PCR products.Proc. Natl
Acad. Sci.97,6 6 4 0– 6645 (2000).
3 3 . L o b z a e v ,E . ,H e r r e r a ,M .A . ,K a s p r z y k ,M .&S t r a c q u a d a n i o ,G .P r o t e i n
engineering using variational free energy approximation.https://
github.com/stracquadaniolab/prevent-nf, https://doi.org/10.5281/
zenodo.13880396, (2024).
Acknowledgements
This work was supported by the UKRI EPSRC Fellowship (EP/V033794/1),
the UKRI EPSRC grant (EP/Y01913X/1) and the IBioIC feasibility funding
(FF-2022-04) to G.S. The UKRI Centre for Doctoral Training in Biomedical
AI (grant EP/S02431X/1) for E.L. and the UKRI Biotechnology and Biolo-
gical Sciences Research Council (BBSRC) grant number BB/T00875X/1
for M.K. Computational experiments were performed using resources
provided by the Cambridge Service for Data Driven Discovery (CSD3)
operated by the University of Cambridge Research Computing Service
(www.csd3.cam.ac.uk), provided by Dell EMC and Intel using Tier-2
funding from the Engineering and Physical Sciences Research Council
(capital grant EP/P020259/1), and DiRAC funding from the Science and
Technology Facilities Council (www.dirac.ac.uk).
Author contributions
G.S. conceived the study. G.S. and E.L. formulated and developed the
PREVENT model. E.L. implemented and tested the model and performed
sequence analysis. M.K. developeda transformation protocol for the
Opentrons OT-2 robot. M.H. and M.K. performed lab experiments. G.S.
supervised all experimental work. G.S., E.L., and M.H. wrote the
manuscript.
Competing interests
Giovanni Stracquadanio is Co-Founder of ZYTHERA, a startup of the
University of Edinburgh using AI and engineering biology to develop
enzyme replacement therapies. Theother authors declare no competing
interests.
Additional information
Supplementary informationThe online version contains
supplementary material available at
https://doi.org/10.1038/s41467-024-54814-w.
Correspondenceand requests for materials should be addressed to
Giovanni Stracquadanio.
Peer review informationNature Communicationsthanks Hahnbeom
Park, Yu Guang Wang and the other, anonymous, reviewer(s) for their
contribution to the peer review of this work. A peer reviewﬁle is
available.
Reprints and permissions informationis available at
http://www.nature.com/reprints
Publisher’sn o t eSpringer Nature remains neutral with regard to jur-
isdictional claims in published maps and institutional afﬁliations.
Open AccessThis article is licensed under a Creative Commons
Attribution 4.0 International License, which permits use, sharing,
adaptation, distribution and reproduction in any medium or format, as
long as you give appropriate credit to the original author(s) and the
source, provide a link to the Creative Commons licence, and indicate if
changes were made. The images or other third party material in this
article are included in the article’s Creative Commons licence, unless
indicated otherwise in a credit line to the material. If material is not
included in the article’s Creative Commons licence and your intended
use is not permitted by statutory regulation or exceeds the permitted
use, you will need to obtain permission directly from the copyright
holder. To view a copy of this licence, visithttp://creativecommons.org/
licenses/by/4.0/.
© The Author(s) 2024
Article https://doi.org/10.1038/s41467-024-54814-w
Nature Communications|        (2024) 15:10447 11