A MATHEMATICAL WALKTHROUGH AND DISCUSSION OF THE
FREE ENERGY PRINCIPLE
BerenMillidge AnilKSeth
SchoolofInformatics SacklerCenterforConsciousnessScience
UniversityofEdinburgh EvolutionaryandAdaptiveSystemsResearchGroup
beren@millidge.name SchoolofEngineeringandInformatics
UniversityofSussex
A.K.Seth@sussex.ac.uk
ChristopherLBuckley
EvolutionaryandAdaptiveSystemsResearchGroup
SchoolofEngineeringandInformatics
UniversityofSussex
C.L.Buckley@sussex.ac.uk
5thOctober,2021
ABSTRACT
TheFree-Energy-Principle(FEP)isaninfluentialandcontroversialtheorywhichpostulatesadeep
connectionbetweenthestochasticthermodynamicsofself-organizationandlearningthroughvari-
ationalinference. Specifically,itclaimsthatanyself-organizingsystemwhichcanbestatistically
separatedfromitsenvironment,andwhichmaintainsitselfatanon-equilibriumsteadystate,canbe
construedasminimizinganinformation-theoreticfunctional‚Äìthevariationalfreeenergy‚Äìandthus
performingvariationalBayesianinferencetoinferthehiddenstateofitsenvironment. Thisprinciple
has also been applied extensively in neuroscience, and is beginning to make inroads in machine
learningbyspurringtheconstructionofnovelalgorithmsbywhichaction,perception,andlearning
can all be unified under a single objective. While its expansive and often grandiose claims have
spurredsignificantdebatesinbothphilosophyandtheoreticalneuroscience,themathematicaldepth
andlackofaccessibleintroductionsandtutorialsforthecoreclaimsofthetheoryhaveoftenmade
productivediscussionchallenging. Here,weaimtoprovideamathematicallydetailed,yetintuitive
walk-throughoftheformulationandcentralclaimsoftheFEPwhilealsoprovidingadiscussion
oftheassumptionsnecessaryandpotentiallimitationsofthetheory. Additionally,sincetheFEP
isalivingtheory,subjecttointernalcontroversy,change,andrevision,wealsopresentadetailed
appendixhighlightingandcondensingcurrentperspectivesaswellascontroversiesaboutthenature,
applicability,andthemathematicalassumptionsandformalismsunderlyingtheFEP.
1202
tcO
1
]IA.sc[
2v34331.8012:viXra
APREPRINT-5THOCTOBER,2021
1 Introduction
TheFree-energyprinciple(FEP)isagrandtheory, arisingoutoftheoreticalneuroscience, withdeepambitionsto
provideaunifiedunderstandingofthenatureofselforganisationundertherubricofBayesianinference(K.Friston,
2010,2019a;K.Friston&Ao,2012a;K.Friston, Kilner,&Harrison,2006). Perhapsthecentralpostulateofthis
theoryisthe‚ÄòFreeEnergyLemma‚Äôwhichstatesthatonecaninterprettheinternaldynamicsofanyselforganizing
systemwithaMarkovBlanket(tobedefinedlater),ofanytypeandonanyscale,asperforming,onaverage,akind
ofelementalBayesianinferenceupontheexternalenvironmentthatsurroundsit(K.Friston,2013,2019b;K.Friston
&Ao,2012b). Moregenerally,itclaimstoprovidearecipe,intermsofthestatisticaldependencieswhichunderpin
a Markov Blanket, to define precisely and mathematically what it means to be a system at all (K. Friston, 2019b).
Understandingself-organizationthroughthelensofinferenceprovidesapowerfulperspectiveforunderstandingthe
natureofself-organizingsystems,asitallowsonetoimmediatelygraspthenatureofthedynamicswhichundergird
self-organization, aswellasapplytheextremelylargeandpowerfulliteratureonBayesianinferencemethodsand
algorithmstounderstandingthedynamicsofself-organizingsystems(Parr,DaCosta,&Friston,2020;Parr,Sajid,
& Friston, 2020; Yedidia, 2011). Moreover, by framing everything in statistical terms ‚Äì in terms of conditional
independence,generativemodels,andapproximateposteriordistributions‚Äìthefree-energyprincipleprovidesanovel
andpowerfulvocabularytotalkaboutsuchsystems,aswellastoaskquestionssuchas‚Äòwhatkindofgenerativemodel
doesthissystemembody?‚Äô. Ultimately,thisnewstatisticalandinferentialperspectiveupondynamicsmayleadto
significantadvancesinourunderstandingofcomplexsystems,bothbioticandabiotic.
Historically,thisperspectivehascloserelationshipswithearlycyberneticviewsofcontrolandregulation(Conant&
RossAshby,1970;Kalman,1960;Wiener,2019). Philosophically,theFEPcanbeseenasanextensiontoAshby‚Äôs
notionthateverygoodregulatorofasystemmustalsobecomeamodelofthesystem(Conant&RossAshby,1970).
The FEP nuances this notion slightly by instead stating that every system that regulates itself against the external
environment,mustinsomesenseembodyagenerativemodeloftheenvironment,andalsothatthedynamicsofthe
internalstatesofthesystemnecessarilycanbeinterpretedasperformingapproximatevariationalinferenceupona
distributionoverexternalvariablesoftheirlocalenvironment-inotherwords,suchsystemsappeartoform‚Äòbeliefs‚Äô
abouttheexternalsourcesofincomingfluctuations.
Thefree-energyprincipleoriginatedintheoreticalneuroscience,asanattempttounderstandthemathematicalproperties
thataself-organisingliving,bioticsystem,mustpossessinordertosustainitselfagainstthermodynamicequilibrium. It
wasfirstandespeciallyappliedtounderstandingthefunctionofthebrain(K.Friston,2012;K.Fristonetal.,2006;
K.J.Friston,Daunizeau,Kilner,&Kiebel,2010),andhasbeendevelopedintotwomainprocesstheories‚Äìpredictive
coding1(K.Friston,2003,2005,2008;Rao&Ballard,1999)andactiveinference(DaCostaetal.,2020;K.Friston,
FitzGerald, Rigoli, Schwartenbeck,&Pezzulo,2017a;K.Friston, Rigoli,etal.,2015;K.Friston, Samothrakis,&
Montague, 2012; K. J. Friston, Daunizeau, & Kiebel, 2009; K. J. Friston, Rosch, Parr, Price, & Bowman, 2018)
whichhavebeeninvestigatedinawidevarietyofparadigms,whereithasbeenusedtoinvestigateawidevarietyof
phenomenafrom(K.Friston,Levin,Sengupta,&Pezzulo,2015;K.Friston,Rigoli,etal.,2015;K.Fristonetal.,2014),
informationforagingandsaccades(Parr,2019;Parr&Friston,2017,2018)exploratorybehaviour(K.Friston,DaCosta,
Hafner, Hesp,& Parr,2020; K.Friston, Rigoli, etal., 2015;K. J.Friston etal.,2017; Schwartenbeck, FitzGerald,
Dolan,&Friston,2013),conceptlearning(Schwartenbecketal.,2019),andavarietyofneuropsychiatricdisorders
(Benrimoh,Parr,Adams,&Friston,2019;Cullen,Davey,Friston,&Moran,2018;Lawson,Rees,&Friston,2014).
TheseprocesstheoriestranslatetheabstractformulationoftheFEPintoconcreteandpracticalalgorithmsbyspecifying
certaingenerativemodels,variationaldistributions,andinferenceprocedures,andhavebeenshowntobeusefulbothin
providingbiologicallyplausibletheoriesoflearningandinferenceinthebrain,andalsoindevelopinghighlyeffective
1Predictivecodingasatheoryhasalonghistory,originatingasamethodfortime-seriescompression(Spratling,2017)then
beingappliedtoprocessinginthebrainfirstbySrinivasan,Laughlin,andDubs(1982)andMumford(1992)andwasrelatedformally
tovariationalinferenceandthefreeenergyprincipleby(K.Friston,2003).Forarecentreviewofpredictivecodingsee(Millidge,
Seth,&Buckley,2021).
2
APREPRINT-5THOCTOBER,2021
inferencealgorithmswhichhaveadvancedthestateoftheartinmachinelearning(Millidge,2019;Millidge,Tschantz,
Seth,&Buckley,2020;Parr,Markovic,Kiebel,&Friston,2019;Tschantz,Millidge,Seth,&Buckley,2020).
TheFEPis(in)famouslymathematicallydeepandbroad,incorporatingconceptsandtechniquesfromawiderangeof
disciplinessuchasadvancedstatisticalmethodsforBayesianinference,stochasticthermodynamics,classicalphysics,
anddifferentialgeometry. Thelevelofmathematicalsophisticationrequired,aswellassometimesdenseexpositionsof
thetheoryinkeyworks,hasmadefullcomprehensionofthecoreargumentsandcentralresultsofthetheorydifficultto
achieve,andhasoftenresultedinconfusionintheliterature. Inthistutorial,weaimtoprovideaself-containedand
intuitivewalk-throughofthekeymathematicalresultsunderpinningtheFEP,relyingonafairlyminimalamountof
prerequisiteknowledge‚Äìspecifically,linearalgebra,probabilitytheoryandstatistics,andbasicconceptsofdifferential
equations. We also aim to derive all results in a fully explicit way, with substantial commentary to aid intuitive
understandingandtomakeclearallassumptionsandmajorlogicalmovesintheargument. Finally,weprovideafairly
detaileddiscussiononthenatureandmeaningofthecoreresultsoftheFEPaswellasthepotentiallimitationsofthe
theory.
Additionally, we also offer a substantive appendix which includes in-depth discussions of all the assumptions and
potentiallimitationshighlightedinthemaintext,aswellascurrenttheoreticaldebateswithinthefreeenergycommunity
overthemathematicalformalismandgeneralapplicabilityoftheFEP.Thus,themaintextpresentstheFEPinitsbest
possiblelight,whilethepotentialcontroversialassumptionsandothermathematicaldifficulties,whicharesubstantial
andstillundersignificantdiscussionwithinthecommunity,arepresentedinthefootnotestothemaintextandthen
discussedindetailintheappendix. Assuch,criticalreadersshouldmakesuretoconsulttheappendixindetailfora
balancedunderstandingofboththeclaims,andthepotentiallimitationsofthefreeenergyprinciple
1.1 RelatedWork
Whiletherehavebeenmanyexcellenttutorialsontheprocesstheoriesarisingfromthefree-energyprinciple,suchas
predictivecoding(Bogacz,2017;Buckley,Kim,McGregor,&Seth,2017;Millidgeetal.,2021),andactiveinference
(DaCostaetal.,2020;K.Fristonetal.,2017a),thereisagenerallackintheliteratureofmathematicallydetailed
tutorialstacklingthecentralclaimsoftheFEP,especiallyinitsmostrecentformulationintheK.Friston(2019b). This
monographcurrentlyrepresentsthetheoreticalstateoftheartoftheFree-Energy-Principle2,andweaimtorecapitulate
itsmainresultsinamoredirectandaccessiblemannerinthispaper.
TheFEPalsoinvolvesdeepknowledgefromavarietyofdisciplines. ForthoroughtutorialsonvariationalBayesian
inference,werecommend(Beal,2003;Blei,Kucukelbir,&McAuliffe,2017;Fox&Roberts,2012). Foranexcellent
walk through of differential geometry, information-geometry, and the role of the Fisher Information matrix, we
recommendCaticha(2015). Foradetailedtreatmentoftheprinciplesofstochasticthermodynamicswhichunderlie
muchoftheFEP,werecommendEspositoandVandenBroeck(2010);Seifert(2008,2012);VandenBroeckand
Esposito(2010). Finally,sincethepublicationoftheparticularphysicsmonograph(K.Friston,2019b),thetheoryofthe
FEPhasbeendevelopedinnumerousfurtherpublications. AconciseoverviewofthetheoryisgiveninParr,DaCosta,
andFriston(2020),andlaterdevelopmentshavebeensurveyedinDaCostaetal.(2021). Furtherdevelopmentofthe
operationalizationofMarkovBlanketsisgiveninParr,Sajid,andFriston(2020). Discussionupondifferentinference
algorithmsanddivergenceshasbeengiveninBleietal.(2017);Yedidia(2011). Somefurthertheoreticalrefinementsto
variousaspectsofthetheorycanbefoundin(K.J.Friston,Wiese,&Hobson,2020;Ramsteadetal.,2020).
ForadetailedmathematicalcritiquetomanyoftheargumentsandclaimsoftheFEP,especiallyregardingthetechnical
conditionsrequiredforthefreeenergylemma, pleaseseeBiehl, Pollock,andKanai(2020), andalsotheresponse
K.Friston, DaCosta,andParr(2020), aswellasAguilera, Millidge, Tschantz,andBuckley(2021)foradditional
2ManyofthekeyresultsarealsoreprisedmoreconciselyinDaCosta,Friston,Heins,andPavliotis(2021);Parr,DaCosta,and
Friston(2020)
3
APREPRINT-5THOCTOBER,2021
Langevin Dynamics Non-Equilibrium Steady State
p*(x)
x¬∑=f(x,t)+œâ
Ao Decomposition
x¬∑=(Œì‚àíQ)‚àáxlnp*(x)
Marginal Flow Lemma Markov Blanket Condition
f Œº(œÄ)=ùîºp(œÄÀú|œÄ) [f Œº(x)]=(Œì‚àíQ)‚àáŒºlnp*(œÄ)
p(x)=p(Œ∑|b)p(Œº|b)p(b)
Identical true and variational posterior Particular Free Energy Parametrisation by argmax
q(Œ∑;Œ∑)=p(Œ∑|b) Œº(b)=argmaxp(Œº|b)
f Œº(œÄ)=(Œì‚àíQ)‚àáŒº‚Ñ±particular(Œº,s,a) Œ∑(b)=argmaxp(Œ∑|b)
Œ∑(b)=œÉ(Œº(b))
Free Energy Lemma
Laplace Approximation
(Approximate Bayesian Inference)
q(Œ∑;Œº)=ùí©(œÉ(Œº),Œ£(Œ∑))
Œº¬∑=(Œì‚àíQ)‚àáŒº‚Ñ±(Œº,s,a)
Figure1: ThelogicalflowoftheargumentoftheFEPfromtheinitialformulationtothecrucialapproximateBayesian
inferencelemma. Webeginwithasettingofarandomlangevinstochasticdynamicalsystem,whichpossessanon-
equilibrium-steadystate. ByapplyingtheAodecomposition,wecanunderstanditsdynamicsintermsofagradient
descentuponthesurprisal. UpontheadditionofaMarkovBlanketpartition,wecanexpresssubsetsintermsoftheir
ownmarginalflowsviathemarginalflowlemma. Ifwethenidentifytheinternalstatesasparametrizingavariational
distributionovertheexternalstates,wecaninterpretthemarginalflowonthesurprisalasaflowonthevariationalfree
energy,undertheLaplaceapproximation,andthusinterprettheinternalstatesofthesystemasawholeasperforminga
simplekindofvariationalinferenceupontheexternalstates.
critiquesofthemarkovblanketcondition,assumptionsaroundthesolenoidalflows,andthesomeofthetechnicalsteps
andassumptionsofthefreeenergylemma.
1.2 HistoryandLogicalStructure
Historically,thefreeenergyprinciplehasevolvedoverthecourseofaboutfifteenyears. Itsintellectualdevelopment
canbestbeseenintwophases. Inthefirstphase,anintuitiveandheuristictreatmentemergedwithK.Fristonetal.
(2006)whichstatedthattheimperativetominimizevariationalfreeenergyemergedfromanecessaryimperativeof
minimizingthesystem‚Äôsentropy, orlogmodelevidence, whichisupperboundedbyvariationalfreeenergy. This
imperativeemergesduetotheself-sustainingnatureofbiologicalsystemssuchasbrains,inthattheymaintainaset
distributionagainsttheinexorablyincreasingentropicnatureofthermodynamicreality(K.Friston,2009). Inorderto
doso,systemsmustconstantlyseektoreduceandmaintaintheirentropyacrosstheirstatespace. SincetheVFEis
computationallytractablewhiletheentropyitselfisnot,itwaspostulatedthatneuralsystemsmaintainthemselvesby
implicitlyminimizingthisproxyratherthantheactualentropyitself(K.Friston,2010).
Later, in the second phase (K. Friston, 2013), this heuristic argument and intuition was related more formally to
conceptsinstochasticthermodynamicsbeginningwith(K.Friston&Ao,2012a,2012b). Specifically,theframework
developedmathematicallyintoadescriptionofstochasticdynamics(asstochasticdifferentialequations)separatedinto
‚Äòexternal,internal,andblanket‚ÄôstatesbyastatisticalconstructcalledaMarkovBlanket. Thisblanketmakesprecisethe
statisticalindependenceconditionsrequiredtomakesenseoftalkingabouta‚Äòsystem‚Äôasdistinctfromits‚Äòenvironment‚Äô.
Moreover,byseparatingthe‚Äòblanket‚Äôinto‚Äòsensory‚Äôand‚Äòactive‚Äôstates,onecanobtainastatisticaldescriptionofthe
coreelementsofaperception-action-loop,acentralconceptincybernetics,controltheory,andreinforcementlearning.
4
APREPRINT-5THOCTOBER,2021
Secondly,thetheorydevelopedaprecisenotionofwhatitmeanstomaintainastable‚Äòphenotype‚Äôwhichisinterpreted
mathematicallyasanon-equilibriumsteady-statedensityoverthestate-space. Thissteadystateisnon-equilibriumdue
tothepresenceof‚Äòsolenoidalflows‚ÄôwhichareflowsorthogonaltothegradientoftheNESSdensity. Mathematically,
such flows do not increase or decrease the entropy of the steady-state-density, but do, however, in contrast to an
equilibriumsteadystate(ESS),provideacleararrowoftime. Giventhis,itisclaimed,thatundercertainconditions,
onecandrawarelationshipbetweentheflowdynamicsandtheprocessofvariationalBayesianinferencethroughthe
minimizationofthevariationalfreeenergy‚Äìspecifically,thatthedynamicsthatresultfromthisspecifickindofflow
underaMarkovblanketattheNESSdensitycanbeseenasapproximatingagradientdescentupontheVFE,thus
licensingtheinterpretationofthesystemasperformingabasickindofBayesianinferenceor,‚Äòself-evidencing‚Äô(Clark,
2015;Hohwy,Roepstorff,&Friston,2008)
WhiletheintuitionsandbasiclogicalstructureofthetheoryhasremainedroughlyconstantsinceK.Friston(2013),
the mathematical formulation and some of the arguments have been refined in the most recent K. Friston (2019b)
monographandrelatedpapers(DaCostaetal.,2021;K.Friston,DaCosta,&Parr,2020;Parr,DaCosta,&Friston,
2020). Thesepapershavedrawncloseconnectionsbetweentheformulationoffreeenergyprinciple,andmanyaspects
ofphysicsincludingtheprincipleofleastactioninclassicalmechanics,andnotionsofinformationlengthandthearrow
oftimeinstochasticthermodynamics. Additionally,recentworkcontainsanovelinformation-geometricglossonthe
natureoftheBayesianinferenceoccurringinthesystem. Specifically,itarguesthattheinternalstatesofthesystem
canbeseenaspointsonanstatisticalmanifoldthatparametrizedistributionsovertheexternalstates,andthatthus
theinternalstatescanbedescribedusinga‚Äòdual-aspectinformationgeometry.‚Äô Accordingtothisperspective,internal
statesevolveinboththe‚Äòintrinsic‚Äôstatespaceofthesystem‚Äôsphysicaldynamics,whilesimultaneouslyparameterising
amanifoldofstatisticalbeliefsaboutexternalstates-theso-called‚Äòextrinsic‚Äôinformationgeometry.
While the mathematical depths of the FEP often appears formidably complex to the uninitiated, the actual logical
structureofthetheoryisrelativelystraightforward. First,wewanttodefinewhatitmeanstobe‚Äòasystem‚Äôthatkeeps
itselfapartfromtheoutside‚Äòenvironment‚Äôoveraperiodoftime. TheFEPanswersthisquestioninitsownway. We
definea‚Äòsystem‚Äô(accordingtotheFEP)asadynamicalsystemwhichhasanon-equilibriumsteadystate(NESS)which
itmaintainsoveranappreciablelengthoftime,andthatthedynamicsarestructuredinsuchawaythattheyobeythe
‚ÄòMarkovBlanketCondition‚Äô. Specifically,havingaNESScanbeintuitivelythoughtofasdefiningdynamicswhich
producesomethinglikeaphenotype‚Äìi.e. arecognizablepatternofstateswhichpersistsrelativelyunchangedforsome
periodoftime. Forinstance,wecanthinkofthebiologicalsystemsinsuchamanner. Biologicalorganismsmaintain
relativelysteadystates,againstconstantentropicdissipation,forrelativelylong(bythermodynamicstandards)periods
oftime. Ofcourse,fromapurelythermodynamicalperspective,inresistingentropythemselves,biologicalorganisms
arenotcounteringthelawofthermodynamics. Toachievetheirsteadystaterequiresaconstantinfluxofenergy‚Äì
henceitisanon-equilibriumsteadystate(NESS).Fromthisperspective,wecanunderstandbiologicalorganisationto
betheprocessofcreating‚Äòdissipativestructures‚Äô(Kondepudi&Prigogine,2014;Prigogine&Lefever,1973)which
onlymanagetomaintainthemselvesatsteadystateandreducetheirownentropyattheexpenseofconsumingenergy
andincreasingtheentropyproductionrateoftheirenvironment(Prigogine,2017). Illustrativephysicalexamplesof
similarNESSstatesareBenardconvectioncells,andtheBelousov-Zhabotinskyreaction(Zwanzig,2001). Inpractical
terms,wecanconsidertheNESSdensitytobethe‚Äòphenotype‚Äôofthesystem. FromtheperspectiveoftheFEP,weare
notusuallyconcernedwithwhetherasetofdynamicspossessesaNESSdensity,orhowconvergencetotheNESS
densityworks. InsteadwetakeitasanaxiomthatwepossessasystemwithaNESSdensitywhichthesystemcan
convergeto,andareinsteadconcernedwiththedynamicalbehaviourofthesystemattheNESSdensity. Whilethisis
clearlyaspecialcase,neverthelessdynamicalsystemsatNESSalreadyexhibitrichbehaviourstoeffectivelymaintain
themselvesthere. Itistheseproperties,whichanysystemwhichmaintainsitselfatNESSmustpossess,thatarethe
fundamentalobjectofstudyfortheFEP.
Secondly,nowthatwehaveasetofdynamicswhichhasaNESSdensity,andthusexhibitssomestabilitythroughtime,
wealsorequireastatisticalwaytoseparatethe‚Äòsystem‚Äôfromthe‚Äòenvironment‚Äô. TheFEPhandlesthisbystipulating
5
APREPRINT-5THOCTOBER,2021
thatanysystemitconsidersmustfulfilasetofcriteriawhichwecalltheMarkovBlanketconditions. Theseconditions,
derivingfromtheideaofMarkovblanketsinBayesiannetworks(Pearl,2011,2014),setforthasetofconditional
independencerequirementsthatallowasystemtobestatisticallyseparatedfromitsenvironment3. Specifically,we
requirethatthedynamicsofthesystemcanbemeaningfullypartitionedintothreesetsofstates‚Äì‚Äòinternal‚Äôstates
whichbelongtothesystemofstudy,‚Äòexternal‚Äôstateswhichcorrespondtotheenvironment,and‚Äòblanketstates‚Äôwhich
correspondtotheboundarybetweenthesystemanditsenvironment. Specifically,werequiretheinternalstatestobe
conditionallyindependentoftheexternalstatesgiventheblanketstates,andviceversa. Thusall‚Äòinfluence‚Äôofthe
environmentmusttravelthroughtheblanket,andcannotdirectlyinteractwiththeinternalstatesofthesystemwhich
are‚Äòshielded‚Äôbehindtheblanket4
NowthatwehaveasystemwithaNESSdensitywhichobeystheMarkovBlanketconditions,sothatwecanpartitionit
intoexternal,internal,andblanketstates,wethenwishtounderstandthedynamicsofthesystemattheNESSdensity,
sowecanunderstandthenecessarybehavioursofthesystemtoallowtheNESStobemaintained. Hereweusethe
Helmholtz(Ao)decomposition(Yuan&Ao,2012;Yuan,Ma,Yuan,&Ao,2011;Yuan,Tang,&Ao,2017)torepresent
thedynamicsasagradientflowonthelogoftheNESSdensity(whichiscalledthesurprisal)withbothdissipative
(inthedirectionofthegradient)andsolenoidal(orthogonaltothegradient)components. Nowthatwecanexpress
thedynamicsofthesystemintermsofgradientsofthelogNESSdensity,wetheninvoketheMarginalFlowLemma
towriteoutthedynamicsofeachcomponentofthepartitioneddynamics(i.e. external,internal,andblanketstates)
solelyintermsofagradientflowonitsownmarginalNESSdensity. Thismeansthatwecanexpress,forinstance,the
dynamicsoftheinternalstatessolelyintermsofgradientflowsonthemarginalNESSdensityovertheinternaland
blanketstates.
Giventhismarginalpartition,wecananalyzeandunderstandeachoftheflowsineachpartitionofthesystemseparately.
Specifically,tounderstandtheAshbyannotionthat‚Äòeverygoodregulatorofasystemisamodelofthesystem‚Äô,wewish
tounderstandtherelationshipbetweentheflowsoftheinternalandexternalstates,whicharestatisticallyseparated
fromtheblanket. Despitethisseparation, itispossibletodefineamappingbetweenthemostlikelyinternalstate,
givenaspecificconfigurationoftheblanketstates,andthedistributionoverthemostlikelyexternalstateofthesystem.
Wecanusethismappingtointerpretinternalstatesasparametrizingavariationalorapproximatedistributionover
theexternalstates. Thisinterpretationsetsupthe‚Äòdual-aspect‚Äôinformationgeometryoftheinternalstates,sincethe
internaldynamicssimultaneouslyrepresentchangesintheparametersofthedistributionoverinternalstates(which
canpotentiallybenon-parametric),andchangestotheparametersofthevariationaldistributionoverexternalstates.
Thislatterinterpretationmeansthattheinternalstatescanbedirectlymappedtoparametersofadistributionover
externalstates,andthusthattheseparametersformastatisticalmanifoldequippedwithaFisherinformationmetric
(ifthevariationaldistributionisintheexponentialfamily), andingeneralbecomesamenabletothetechniquesof
informationgeometry(Amari,1995;Ollivier,Arnold,Auger,&Hansen,2017)Finally,giventhatwecaninterpretthe
internalstatesasparametrisingadistributionoverexternalstates,wecanreconsiderthegradientflowuponthelog
NESSdensitywithanewlight. Specifically,oncetheidentificationofthedynamicsoftheinternalmodetovariational
inferenceisrecognised,wecanunderstandtheNESSdensitytorepresenttheimplicitgenerativemodelofthesystem
(sinceitisajointdensityoverallvariablesofthedynamicalsystemmodelled),andthegradientflowdynamicsas
adescentuponthefree-energy,withaperfectBayes-optimalposterior. Alternatively,ifweinvokeanapproximate
posteriordistributionoverexternalstates,wecanrepresentthegradientflowasanapproximateminimizationofthe
variationalfreeenergy(VFE),andthustheinternalstatesofthesystemcanbeinterpretedasperformingapproximate
3WheneverwesayMarkovBlanket,followingstandarduseintheliterature,wemeantheminimalMarkovblanket‚Äìi.e. the
MarkovBlanketwhichrequiresthefewestnumberofblanketstatestoachievetherequiredconditionalindependencies.
4Interestingly,mathematically,theMBconditionandalloftheFEPiscompletelysymmetricalbetween‚Äòinternal‚Äôand‚Äòexternal‚Äô
states.Thusfromtheperspectiveofthesystem,the‚Äòexternalstates‚Äôareitsenvironment,butfromtheperspectiveoftheenvironment,
the‚Äòexternalstates‚Äôarethesystem.Thismeansthattheenvironmentmodelsandperformsinferenceaboutthesystemjustasthe
systemmodelsandperformsinferenceontheenvironment.Wecanthusthinkoftheenvironment-systeminteractionasadualityof
inference,whereeachtriestomodelandinfertheotherinaloop.
6
APREPRINT-5THOCTOBER,2021
variationalBayes. Thisisthekeyresult oftheFEP.Itstates,simply,thattheinternaldynamicsofanysystemthat
maintainsitselfatanon-equilibriumsteadystate,andpossessesaMarkovBlanket,canbeinterpretedasmodelling,
andperformingapproximatevariationalinferenceupontheexternalstatesbeyonditsownMarkovBlanket. Itthus
generalizesandmakespreciseAshby‚Äôsnotionthateverygoodregulatormustinsomesensebeamodelofthesystem
(Conant&RossAshby,1970). Hereweseethatinordertomaintainanon-equilibriumsteadystate,tocounteractthe
dissipativeforcesinherentinthermodynamics,itisnecessarytoperformsomekindofinferenceabouttheenvironment
beyondthesystemitself.
2 Formulation
HerewebegintheprecisemathematicaldescriptionoftheFEP.Weaimtoprovideaconsistentnotation,andmore
detailedderivationsofkeyresultsthanareoftenpresented. Thepresentationinthistutorialmostlyfollowstheorderof
presentationinK.Friston(2019b),althoughmanycircumstantialtopicsareomittedtofocusonthemainflowofthe
argument. Webeginwiththebasicmathematicalsettingandformulationofthetheory. Weassumethatthedynamics
wewishtodescribecanbeexpressedintermsofaLangevinstochasticdifferentialequation(Jaswinski,1970),
dx
=f(x)+œâ (1)
dt
wherex=[x ...x ]isavectorofstatesofsomedimensionality,andf(x)isanarbitrarynonlinearbutdifferentiable
0 N
functionofthestatevector.Specifically,hereweassumealreadythatthisprocessisnothistorydependent.Thedynamics
onlydependontheinstantaneousvaluesofthestates. Inpractice,historydependentsystemscanberepresentedinthis
fashion,albeitsomewhatunintuitivelybyaddingsufficientstatisticsofthehistorytothestateitself. œâisassumedtobe
white(zeroautocorrelation)Gaussiannoisewithzeromeansuchthatœâ=N(x;0,2Œì)whereŒìisthevarianceofthe
noise. Zeroautocorrelationmeansthatthecovariancebetweenthenoiseatanytwotimeinstants,eveninfintesimally
closetogether,is0‚ÄìE[œâ œâT ]=0. Weassumethatthisnoiseisaddedadditivelytothedynamics. Afulllistofthe
t t+Œ¥
assumptionsrequiredintheformulationareoutlinedanddiscussedintheAppendix(section10).
Thisstochasticdifferentialequationcanalsoberepresentednotintermsofdynamicallychangingstates,butintermsof
adynamicallychangingprobabilitydistributionoverstates. ThistransformationisachievedthroughtheFokker-Planck
equation,bywhichwecanderivethatthechangeinthedistributionoverstatescanbewrittenas,
dp(x,t)
=‚àí‚àá f(x)p(x,t)+Œì‚àá2p(x,t) (2)
dt x x
Wherep(x,t)istheinstantaneousdistributionoverthestatesatagiventimet. p(x,t)beginswiththedistribution
p(x ,0) = N(f(x ,0),Œì)duetotheinitialnoisetermœâ andthestartingstatex . Here‚àá f(x,t)isthegradient
0 0 0 x
functionandsimplydenotesthevectorofpartialderivativesofthefunctionf withrespecttoeachelementofthevector
x. ‚àá f(x)=[‚àÇf(x,t),‚àÇf(x,t),...,‚àÇf(x,t)]. ‚àá2f(x)representsthevectorofsecondpartialderivativesofthefunction.
x ‚àÇx0 ‚àÇxN ‚àÇxN x
Next, we presuppose that the dynamics expressed in Equation 1 tend towards a non-equilibrium steady state
lim p(x,t) = p‚àó(x) where we represent the steady state distribution as p‚àó(x). Note that this distribution no
t‚Üí‚àû
longerdependsontime,sinceitisbydefinitionatasteadystate. Weusep‚àó tomakeclearthatthisdistributionisat
steadystate. Bydefinitionasteadystatedistributiondoesnotchangewithtime,sothat
dp‚àó(x)
=0.
dt
Thedistinctionbetweenanequilibriumsteadystateandanon-equilibriumsteadystate(NESS)distributionissubtleand
important. Anequilibriumsteadystate,mathematically,isonewherethepropertyofdetailedbalanceholds. Thismeans
thatanytransitionbetweenstatesatequilibriumisjustaslikelytogointhe‚Äòforwards‚Äôdirectionasitistogointhe
‚Äòbackwards‚Äôdirection. Ineffect,thedynamicsarecompletelysymmetrictotime,andthusthereisnonotionofanarrow
oftimeinsuchsystems. Conversely,anon-equilibriumsteadystateisonewheredetailedbalancedoesnothold,sothere
isadirectionalitytothedynamics,andthusanarrowoftime,eventhoughtheactualdistributionoverstatesremains
constant. Fromathermodynamicperspective,theequilibrium-steady-stateistheinexorableendpointofthesecondlaw
7
APREPRINT-5THOCTOBER,2021
ofthermodynamics,sinceitisthemaximumentropystate. Conversely,aNESSisnotamaximumentropysolution,
sincethedirectionalityofthedynamicsmeansthatthereisadegreeofpredictabilityinthesystemwhichcouldintheory
beexploitedtoproducework. Non-equilibriumsteadystatescanariseinthermodynamicsystemsbutrequireanexternal
sourceofdrivingenergyasaconstantinputtothesystem,whichisthendissipatedtotheexternalsurroundingsand
givestheNESSapositiveentropyproductionrate. Totakeanintuitiveexample,wecanthinkaboutthethermodynamic
equilibriumofacupofcoffeewithcreamadded. Theequilibriumsteadystate(ESS)iswhenthecoffeeandcreamhave
completelydiffusedintooneanother,sothatthecreammaintainsaconstantproportionthroughouttheentirecoffee
cup. Thiswillbetheinevitableresult(bythesecondlawofthermodynamics)ofaddinganinitiallylowentropyhighly
concentratedcreamscoopintothecoffee. Ontheotherhand,wecanthinkofthenon-equilibriumsteadystate(NESS)
astobewhenthecreamandcoffeeareequallydiffusedthroughout,butsomebodyisconstantlystirringthecoffeein
aspecificdirection. Here,weareatsteadystatebecausetheconcentrationsofcreamandcoffeedon‚Äôtchangeover
time,butneverthelessthereisadirectionalitytothedynamicsinthedirectionofthestirring. Thisdirectionalityisonly
maintainedduetoaconstantinputofenergy5tothesystem(thestirring)6. Theflowcausedbythestirringisreferred
toasthe‚Äòsolenoidalflow‚Äôandmathematicallyisnecessarilyorthogonaltothegradientofthesteadystatedistribution.
Thisisnecessarysothatthesolenoidalflowdoesnotascendordescentthegradientofthedensity,andthuschangethe
steadystatedistributionwhich,asasteadystate,bydefinitioncannotchange. Biologicalselforganizingsystemsare
oftenconsideredtobe‚Äòdissipativestructures‚Äô,ornon-equilibriumsteadystatesfromtheperspectiveofthermodynamics,
sincetheymaintainarelativelysteadystateovertimewhichrequiresaconstantinfluxofenergytomaintain.
GiventhatwepresupposeasystemwithaNESSdensity,wewishtounderstandthedynamicsattheNESSdensity‚Äì
specifically,howdoesthesolenoidalflowhelppreventthesystemfromrelaxingintoanequilibrium-steady-state(ESS)?
Tounderstandthis,weutilizetheHelmholtzdecomposition(K.Friston&Ao,2012b;Yuan&Ao,2012;Yuanetal.,
2017)torewritethedynamicsattheNESSintoaformofadissipativeandsolenoidaldescentuponthegradientof
thelogNESSdensity. TheHelmhotlz(orAo)decompositionisamatheamticaltoolwhichletsusexpressthe‚Äòflow‚Äô
‚Äìi.e. dynamicsfunctionf ‚Äìofadynamicalsystemintoseparable‚Äòdissipative‚Äô(noise)and‚Äòsolenoidal‚Äôcomponents
whichperformagradientdescentonascalarpotentialfunctionwhichweidentifywiththeNESS.Mathematically,the
Helmholtzdecompositioncanbewrittenas,
f(x)=(Œì(x)‚àíQ(x))‚àá lnp‚àó(x) (3)
x
WhereŒì(x)isadissipativecomponentoftheflowwhichtriestodescendthelogdensity. Itistheamplitudeofthe
randomfluctuationsintheoriginalSDEformulation(R.Jordan,Kinderlehrer,&Otto,1998;Yuan,Ma,Yuan,&Ao,
2010;Yuanetal.,2011),whichineffectareconstantlytryingto‚Äòsmoothout‚ÄôtheNESSdensityandincreaseitsentropy.
Conversely,theQ(x)representsthesolenoidalportionoftheflowwhich,althoughorthogonaltothegradientofthe
logpotential,successfullycounteractsthedissipativeeffectsoftheŒì(x)termstomaintainthedynamicsatasteady
state. WhileŒì(x)andQ(x)canintheorybestate-dependent,fromhereonoutwetypicallyassumethattheyarenot‚Äì
Œì(x)=Œì;Q(x)=Q7WeverifythattheHelmholtzdecompositionissatisfiedatsteadystateinAppendix11.1.
5It‚Äôsimportanttonotethathereweareusingphysicalintuitionandconceptslike‚Äòenergy‚Äôinapurelymetaphoricalsense.
AllresultshereapplytoarbitrarySDEswhichdonotnecessarilyfollowthesameconstraintsasphysicalsystems‚Äìi.e. respect
conservationofenergy
6Interestingly,physicalexperiencewiththisanalogywouldsuggestthatthesolenoidaldynamicsleadingtoNESSwouldleadto
fasterconvergencetotheNESSdensitycomparedtothestrictlydissipativedynamicsleadingtoESS‚Äìeffectively,stirringhelpsthe
creamdiffusefaster.ThisinsighthasbeenappliedtothedesignofhighlyefficientMarkov-Chain-Monte-Carlosamplersinmachine
learning(M.J.Betancourt,2013;Metropolis,Rosenbluth,Rosenbluth,Teller,&Teller,1953;Nealetal.,2011)
7Specifically,theintroductionofstate-dependentŒìandQmatricesleadstotherebeinganadditional‚Äòhousekeeping‚Äôterminthe
Helmholtzfreeenergyasdiscussedin(K.Friston,Heins,Ueltzh√∂ffer,DaCosta,&Parr,2021).
8
APREPRINT-5THOCTOBER,2021
Figure2: TheintuitionbehindtheMarkovBlanketpartition. Thebrain(orbacillus)consistsofinternalstates¬µwhich
areseparatedfromtheoutsideworld(externalstatesŒ∑ bytheblanketstatesb,whichcanthemselvesbepartitioned
intosensorystatess,representingthesensoryepithelia,andwhicharedirectlyinfluencedbyexternalstates,andactive
statesarepresentingtheorganismseffectorsandwhicharedirectlyinfluencedbyinternalstates,andactonexternal
states. Weseethatperceptionconcernstheminimizationoffreeenergyoftheinternalstates,whileactionconcernsthe
minimizationoftheexpectedfreeenergyoftheactivestates. FigureoriginallyappearedinK.Friston(2019b)
3 MarkovBlankets
Fromthesepreliminaries,wehaveasetofdynamicsofstatesx,whichpossessaNESSdensity,and,byusingtheAo
decomposition,wecanexpressthedynamicsattheNESSdensityintermsofdissipativeŒìandasolenoidalQflows
onthegradientofthelogdensity. Now,webegintoexplorethestatisticalstructureofthesedynamicsintermsofa
MarkovBlanket. Specifically,wenextrequirethatwecanpartitionthestatesxofthedynamicsintothreeseparateunits.
Externalstatese,internalstatesi,andblanketstatesbsuchthatx=[e,i,b]. Intuitively,theexternalstatesrepresent
the‚Äòenvironment‚Äô;theinternalstatesrepresentthe‚Äòsystem‚Äôwewishtodescribe,andtheblanketstatesrepresentthe
statisticalbarrierbetweenthesystemanditsenvironment. Forinstance, wemightwishtodescribethedynamical
evolutionofasimplebiologicalsystemsuchasabacteriuminsuchamanner. Here,theinternalstateswoulddescribe
theinternalcellularenvironmentofthebacterium‚Äìthecytoplasm,thenucleus,theribosomesetc. Theexternalstates
wouldbetheenvironmentoutsidethebacterium,whiletheblanketstateswouldrepresentthecellmembrane,sensory
epithelia,andpotentiallyactiveinstrumentssuchastheflagellawhichsenseandinteractwiththeexternalenvironment.
ThekeyintuitionbehindtheFEPisthatalthoughallinfluencebetweenexternalandinternalstatesismediatedbythe
blanketstates,simplymaintainingthenon-equilibriumsteadystateagainstenvironmentalperturbationsrequiresthat
theinternalstatesinsomesensemodelandperform(variational)Bayesianinferenceontheexternalstates. TheMarkov
Blanketconditionisstraightforward. Itsimplystatesthattheinternalandexternalstatesmustbeindependentgiventhe
blanketstates,
p‚àó(x)=p‚àó(e,i,b)=p‚àó(e|b)p‚àó(i|b)p‚àó(b) (4)
Whileinprobabilistictermsthisfactorisationisstraightforward,ithasmorecomplexconsequencesforthedynamical
flowofthesystem. Firstly,weadditionallydecomposetheblanketstatesintosensorysandactiveastatessuchthat
9
APREPRINT-5THOCTOBER,2021
b=[s,a]andthus,ultimatelyx=[e,i,s,a]. Sensorystatesareblanketstatesthatarecausalchildrenoftheexternal
states‚Äìi.e. thestatesthattheenvironmentactsondirectly. Activestatesarethoseblanketstatesthatarenotcausal
childrenoftheexternalstates. Essentially,externalstatesinfluencesensorystates,whichinfluenceinternalstates,which
influenceactivestates,whichinfluenceexternalstates. Thecircularcausalityimplicitinthisloopiswhatallowsthe
MarkovBlanketconditiontorepresenttheperception-actionloop8.
ThenextstepistounderstandwhattheconditionalindependencerequirementsputforthinEquation4implyforthe
dynamicsoftheflow. Specifically,weobtainthemarginalflowlemma(seeK.Friston(2019b)forafullderivation),
whichstatesthattheflowofasubsetofvariablesaveragedundertherestofthevariables, isequaltoasolenoidal
gradientflowonlyonthegradientofthepotentialofmarginalNESSdensityofthatsubsetofvariablesplusasolenoidal
couplingterm. Forinstance,wecanexpresstheflowofjusttheexternalstatese,averagedundertheblanketandinternal
states,assimplyasolenoidalgradientdescentflowonthemarginalNESSdensitiesplusatermdependentuponthe
solenoidalcouplingoftheexternalandblanketstates
f (x)=E (cid:2) f (x)]=(Œì ‚àíQ )‚àá lnp‚àó(e)‚àíQ ‚àá p(e,b)
e p(e|b) e e,e e,e e e,b b
If we then assume a lack of solenoidal coupling so that Q = 0 then we can neglect this solenoidal coupling
e,b
term and treat the marginal flow as completely independent gradient descent. This lets us investigate in detail the
information-theoreticinteractionsofonesetofstateswithanother,andgainintuitionandunderstandingofthecore
information-theoreticpropertiesoftheperception-actionloop. Similarly,usingthemarginalflowlemmawecanexpress
theflowofautonomous(activeandinternal)Œ±=(a,i)as,
f (x)=(Œì ‚àíQ )‚àá lnp‚àó(i,s,a) (5)
Œ± Œ±Œ± Œ±Œ± Œ±
SoweseethatautonomousstatesfollowagradientdescentonthemarginalNESSdensityoftheinternal,sensory,and
activestates,andattempttosuppresstheirsurprisalor,onaverage,theirentropy. Wecanuseaseriesofmathematical
‚Äòinflationarydevices‚Äô(addingandsubtractingthesamequantity,sothetotalis0,inordertointroduceittotheequation)
toexpressthissurprisalintermsofitsinteractionwiththeexternalstatesbeyondtheblanket.
‚àílnp‚àó(i,s,a)=E (cid:2) ‚àílnp‚àó(i,s,a) (cid:3)
p‚àó(e|i,s,a)
=E (cid:2) lnp‚àó(e|i,s,a)‚àílnp‚àó(e,i,s,a) (cid:3)
p‚àó(e|i,s,a)
=E (cid:2) lnp‚àó(e|i,s,a)‚àílnp‚àó(i,s,a|e)‚àílnp‚àó(e) (cid:3)
p‚àó(e|i,s,a)
=E (cid:2) ‚àílnp‚àó(i,s,a|e) (cid:3) +D (cid:2) p‚àó(e|i,s,a)||p(e) (cid:3) (6)
p‚àó(e|i,s,a) KL
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
Inaccuracy Complexity
Thuswecanseethattheflowofautonomousstatesactstominimizetheinaccuracy(maximizeaccuracy)andminimize
thecomplexityoftheexternalstateswithrespecttothe‚Äòparticularstates‚Äôofthesysteminquestion. Theparticular
statesconsistofthesensory,active,andinternalstates‚Äìi.e. everythingexcepttheexternalstates. Parsedintomore
intuitiveterms,wecanthusseethattheflowof‚Äòsystem‚Äôstates(i,s,a)aimtomaximizethe‚Äòlikelihood‚Äôoftheinternal
states given the external states ‚Äì i.e. perform maximum likelihood inference on themselves (c.f. ‚Äòself evidencing‚Äô
(Hohwy,2016))‚Äìwhilesimultaneouslyminimizingthecomplexity‚Äìorthedivergencebetweentheexternalstates
given the internal states, and the ‚Äòprior‚Äô distribution over the external states. In short, by re-expressing the flow
in information-theoretic terms, we can obtain a decomposition of the entropy term into intuitive and interpretable
sub-componentswhichcanhelpusreasonaboutthekindsofbehavioursthesesystemsmustexhibit.
FurtherdiscussionofthenatureandnecessityoftheMarkovBlanketconditions,andthevariousadditionalconstraints
onsolenoidalcouplingarediscussedindetailintheappendix(section10.3.2)
8TherehasbeensomerecentcontroversyintheliteratureaboutthemeaningandimplicationsofthestatisticalMarkovblanket
conditionintermsofwhatitdoesordoesnotimplyaboutthedynamical‚Äòreal‚Äôconnectivity.Formorediscussiononthispleasesee
theAppendixsection10.3.1orAguileraetal.(2021)
10
APREPRINT-5THOCTOBER,2021
4 VariationalInference
VariationalinferenceisamethodforapproximatingintractableintegralsinBayesianstatistics(Feynman,1998;Fox&
Roberts,2012;Ghahramani&Beal,2001;M.I.Jordan,Ghahramani,Jaakkola,&Saul,1998,1999;Neal&Hinton,
1998). Typically, a direct application of Bayes-rule to compute posteriors in complicated systems fails due to the
intractabilityofthelogmodelevidence,whichappearsinthedenominatorofBayes‚Äôrule. Whilethereexistnumerical
orsampling-basedmethodstopreciselycomputethisintegral,theytypicallyscalepoorlywiththedimensionofthe
problem‚Äìaphenomenonwhichisknownasthecurseofdimensionality(Goodfellow,Bengio,&Courville,2016).
Variationaltechniquesoriginatedfrommethodsinstatisticalphysicsinthe1970sand1980s(Feynman,1998),and
werethentakenupinmainstreamstatisticsandmachinelearninginthe1990s(Beal,2003;Ghahramani&Beal,2001;
M.I.Jordanetal.,1998)wheretheyhavebecomeaninfluential,oftendominantapproachforapproximatingposteriors
andfittingcomplexhigh-dimensionalBayesianmodelstodata(Beal,2003;Bleietal.,2017;Dayan,Hinton,Neal,&
Zemel,1995;Feynman,1998;Ghahramani,Beal,etal.,2000;M.I.Jordanetal.,1999;Kingma&Welling,2013).
Thecoreideaofvariationalinferenceistoapproximateanintractableinferenceproblemwithatractableoptimization
problem. Thus,insteadofdirectlycomputingaposteriordistributionp(H|D)whereH issomesetofhypothesesand
Disthedata,weinsteadpostulateanapproximateorvariationaldistributionq(H|D;Œ∏)whichisoften,althoughnot
always,parametrizedwithsomefixednumberofparametersŒ∏. WethenseektooptimizetheparametersŒ∏tominimize
thedivergencebetweentheapproximateandtrueposterior,
Œ∏‚àó =argminD [q(H|D;Œ∏)||p(H|D)] (7)
KL
Œ∏
Unfortunately,thisoptimizationproblemisitselfintractablesinceitcontainstheintractableposteriorasanelement.
Instead,weminimizeatractableboundonthisquantitycalledthevariationalfreeenergy(VFE)F(D,Œ∏),
F(D,Œ∏)=E [lnq(H|D;Œ∏)‚àílnp(H,D)]
q(H|D)
=D [q(H|D;Œ∏)||p(H|D)]‚àílnp(D)
KL
‚â•D [q(H|D;Œ∏)||p(H|D)] (8)
KL
SincetheVFEissimplyadivergencebetweenthevariationaldistributionandthegenerativemodelp(D,H), itis
tractableasweassumeweknowthegenerativemodelthatgaverisetothedata. ByminimizingtheVFE,therefore,we
reducethedivergencebetweenthetrueandapproximateposteriors,andthusimproveourestimateoftheposterior.
Secondly,thevariationalfreeenergyissimultaneouslyabounduponthelogmodelevidencelnp(D),whichisprecisely
thequantitywhichwasintractabletocomputeduetotheimplicitintegrationoverallpossiblehypotheses(orparameters)
(cid:82)
p(D)= dHp(D|H)p(H). However,ifweperfectlysucceedinmatchingthevariationalandtrueposteriors,thenthe
freeenergysimplyconvergestopreciselythelogmodelevidence. Itisthenpossibletousethisestimateformodel
comparisonandselection(K.Friston,Parr,&Zeidman,2018;Geweke,2007)sinceitprovidesametrictoscorethefit
ofamodelonthedata.
lnp(D)=E [lnq(H|D;Œ∏)‚àílnp(H,D)]‚àíF(D,Œ∏)
q(H|D;Œ∏)
‚â•‚àíF(D,Œ∏) (9)
Thesecondlinefollowsduetothenon-negativityoftheKLdivergence. TheVFEisthefoundationoftheFree-energy
principleas,weshallshow,wecaninterpretself-organizingsystemswhichmaintainthemselvesatanon-equilibrium-
steadystatetobeimplicitlyminimizingtheVFE,andthusperformingvariationalBayesianinference.
11
APREPRINT-5THOCTOBER,2021
WecangainsomeintuitionfortheeffectsofminimizingtheVFEbydecomposingitintovariousconstituentterms.
Hereweshowcasetwodifferentdecompositionswhicheachgivelighttocertainfacetsoftheobjectivefunction,
F(D,Œ∏)=E [q(H|D;Œ∏)||p(H,D)]
q(H|D;Œ∏)
=E [lnp(H,D)]‚àíH[q(H|D;Œ∏)] (10)
q(H|D;Œ∏)
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
Energy Entropy
=E [lnp(D|H)]+D [q(H|D;Œ∏)||p(H)] (11)
q(H|D;Œ∏) KL
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
Accuracy Complexity
Hereweseethatwecandecomposethevariationalfreeenergyintotwoseparatedecompositions,eachconsistingof
twoterms. ThefirstdecompositionsplitstheVFEintoan‚Äòenergy‚Äôterm,whicheffectivelyscoresthelikelihoodof
thegenerativemodelunderthevariationaldistribution,whiletheentropytermencouragesthevariationaldistribution
to become maximally entropic. Essentially, this decomposition can be interpreted as requiring that the variational
distribution maximize the joint probability of the generative model (energy), while simultaneously remaining as
uncertainaspossible(entropy)9. Theseconddecomposition‚Äìintoan‚Äòaccuracy‚Äôanda‚Äòcomplexity‚Äôterm‚Äìspeaks
moretotheroleoftheVFEininference. Heretheaccuracytermcanbeinterpretedasdrivingthevariationaldensity
toproduceamaximumlikelihoodfitofthedata,bymaximizingtheirlikelihoodunderthevariationaldensity. The
complexitytermcanbeseenasaregularizer,whichtriestokeepthevariationaldistributionclosetothepriordistribution,
andthusrestrainsvariationalinferencefrompuremaximum-likelihoodfitting.
5 IntrinsicandExtrinsicinformationgeometries
Now,wewishtounderstandtherelationshipbetweentheinternalstatesandtheexternalstates,whichareseparated
bytheblanketstates. Giventheexistenceofablanket,thenextmoveistodefineamapping,denotedœÉbetweenthe
mostlikelyinternalstateandthemostlikelyexternalstate,givenaspecificblanketstate. Whilesuchamappingisnot
guaranteedtoexistingeneral,itdoesundercertainconditions‚Äìnamelyifweassumeinjectivitybetweenthemost
likelyinternalandblanketstates(Parr,DaCosta,&Friston,2020). ForlinearOUprocesses,theœÉmappingalways
existsandcanbeanalyticallyderivedrelativelystraightforwardly(Aguileraetal.,2021;DaCostaetal.,2021).
Wedefinethemostlikelyinternalandexternalstatesgivenablanketstateas10,
e(b)=argmaxp(e|b)
e
i(b)=argmaxp(i|b) (12)
i
Fromthis,wecandefineœÉtobethemappingthatfulfilsthefollowingequation,
e(b)=œÉ(i(b)) (13)
Importantly, wecaninterprettheoutputofthisfunction‚Äìthemostlikelyexternalstatesgiventheblanketstates‚Äì
asparametrizingthemeanofadistributionovertheexternalstates,asafunctionoftheinternalstatesq(e;e(b)) =
q(e;œÉ(i(b))). Thisallowsustointerprettheflowofthemeanofinternalstatesasparametrisingachangingdistribution
overtheexternalstates.
Crucially,wecansaythatifanygivensetofinternalstatesparametrizesadistributionoverexternalstates,thenthespace
ofinternalstateseffectivelyrepresentsaspaceofdistributionsoverexternalstates,parametrizedbyinternalstates. This
9Interestingly,thisenergy-entropydecompositionispreciselywhythisinformation-theoreticquantityisnamedthevariational
freeenergy.Thethermodynamicfreeenergy,acentralquantityinstatisticalphysics,hasanidenticaldecompositionintotheenergy
andtheentropy.
10Asmallassumptionintroducedhereisthattheargmaxforthedistributionofexternalorinternalstatesgivenablanketstateis
unique.
12
APREPRINT-5THOCTOBER,2021
spaceofdistributionsmaybe,andusuallyis,curvedandnon-euclideaninnature. Thefieldofinformationgeometry
providesmanymathematicaltoolstoallowustodescribeandmathematicallycharacterisesuchspacescorrectly(Amari,
1995;Caticha,2015). Akeyresultininformationgeometryisthatthespaceofparametersoffamiliesofexponential
distributionsisanon-euclideanspacewiththeFisherInformationasitsmetric. Ametricissimplyanotionofdistance
(cid:113)
foragivenspace. Forinstance,inEuclideanspace,themetricis
(cid:80)Nx2whereN
isthedimensionalityofthespace
i i
andthex sarethecoordinatevectorsofthespace. Wecanrepresentgeneralcoordinatetransformersonspaceswith
i
anymetricthroughtheuseofametrictensorG. Essentially,wemeasuredifferencesbetweendistributionsintermsof
theKLdivergence,andthusifwewanttoseehowaninfinitesimalchangeintheparametersofadistributionresultsin
changestothedistributionitself,wecanmeasureaninfinitesimalchangeintheirKLdivergenceasafunctionofthe
infinitesimalchangeintheparameters. i.e.
‚àÇp(x;Œ∏)
= lim D [p(x;Œ∏)||p(x;Œ∏+Œ¥Œ∏)] (14)
‚àÇŒ∏ Œ¥Œ∏‚Üí0 KL
Inthecaseofthespaceofparametersofexponentialdistributions,themetrictensoristheFisherinformation,which
arises as from the Taylor expansion of the infinitesimal KL divergence between the two distributions. We define
Œ∏(cid:48) =Œ∏+Œ¥Œ∏. Specifically,sincethereisonlyaninfintesimalchange,wecanTaylor-expandaroundŒ∏(cid:48) =Œ∏toobtain,
‚àÇD [p(x;Œ∏)||p(x;Œ∏(cid:48))] ‚àÇ2D [p(x;Œ∏)||p(x;Œ∏(cid:48))]
D [p(x;Œ∏)||p(x;Œ∏(cid:48))]‚âàD [p(x;Œ∏)||p(x;Œ∏)]+ KL | (Œ∏‚àíŒ∏(cid:48))+ KL | (Œ∏‚àíŒ∏(cid:48))2
KL KL ‚àÇŒ∏ Œ∏=Œ∏(cid:48) ‚àÇŒ∏2 Œ∏=Œ∏(cid:48)
(cid:124) (cid:123)(cid:122) (cid:125)
(cid:124) (cid:123)(cid:122) (cid:125)
=0
=0
(15)
‚ÄòWherethefirsttwotermsvanish,soweneedonlyhandlethesecondterm,
‚àÇ2D [p(x;Œ∏)||p(x;Œ∏(cid:48))]
D [p(x;Œ∏)||p(x;Œ∏(cid:48))]‚âà KL | (Œ∏‚àíŒ∏(cid:48))2
KL ‚àÇŒ∏2 Œ∏=Œ∏(cid:48)
(cid:90) ‚àÇlnp(x;Œ∏)‚àÇlnp(x;Œ∏)
= p(x;Œ∏) dŒ∏
‚àÇŒ∏ ‚àÇŒ∏
=I (16)
where I is the Fisher information. Since the internal states can be interpreted as parametrizing distributions over
externalstates,asparameters,theylieonaninformation-geometricmanifoldwithaFisherinformationmetric. Thisis
theextrinsicinformationgeometry. Simultaneously,theinternalstatesalsoparametrize(implicitly)asecond(empirical)
distributionovertheinternalstates. Thisparametrizationgivesrisetoasecondinformationgeometry‚Äìtheintrinsic
geometry,sinceitrepresentstherelationshiptheinternalstateshavetothedistributionoverthemselves. Specifically,
suppose i define the sufficient statistics of a density over internal states p(i;i), and e = œÉ(i) define the sufficient
statisticsofthevariationaldensityoverexternalstatesq(e;e),thenwecanseethattheinternalstatesinfactparametrize
twodensitiesandthuspartakeintwosimultaneousinformationgeometries. First,thereisametricdefinedoverthe
spaceofinternaldensities,
‚àÇ2D [p(i;i)||p(i;i+Œ¥i)]
I(i)= KL | (17)
‚àÇi2 i+Œ¥i=i
whichiscalledtheintrinsicinformationgeometry. Andsecondly,ametricdefinedoverthespaceofexternaldensities,
parametrizedbyinternalstates,
‚àÇ2D [q(e;e)||q(e;e+Œ¥e)]
I(e)= KL | (18)
‚àÇe2 e+Œ¥e=e
whichiscalledtheextrinsicinformationgeometry. Thesewell-definedintrinsicandextrinsicinformationgeometries,
allowustointerpretthemotionoftheinternalasalsorepresentingmotionontheintrinsicandextrinsicstatistical
manifolds. Crucially,enablingustomakemathematicallyprecisethelinkbetweentwoconceptuallydistinctideas‚Äì
dynamicalmotioninspace,andvariationalinferenceonparametersofdistributions. Usingthisunderlyinginformation-
geometricframework,inthenextsectionweshallgoontoseehowwecaninterpretthedynamicsofanon-equilibrium
systematNESSasperformingapproximatevariationalBayesianinferenceonitsexternalenvironment.
13
APREPRINT-5THOCTOBER,2021
6 Self-OrganizationandVariationalInference
HerewepresentthekeyresultsoftheFree-energyprincipleviatheFree-Energylemma. Specifically,thissays,firstly,
thatthedynamicsoftheautonomousstatescanbeinterpretedasminimizingafreeenergyfunctionalovertheexternal
states, andthuscanbeconstruedasperformingakindofelementalBayesian(variational)inference. Thissection
reliesonafairnumberofassumptionswhicharecontroversialwithintheFEPcommunity. Herewepresentthe‚Äòideal
narrative‚Äôwheretheseassumptionsaretakenasfact. Foramorecriticaldiscussionofthestepsandassumptionsinthis
section,pleaseseetheappendix.
Wewillfirstconsiderthegeneralcaseintermsofthe‚Äòparticular‚Äôfreeenergy,whichstipulativelyassumesthatthe
systemobtainsthecorrectposteriorateverytime-point,renderingthetraditionalvariationalboundsuperfluous,andthus
demonstratingthatinawayself-organizingsystemsmaintainingthemselvesatNESScanbeconstruedasperforming
exactBayesianinferenceonthegenerativemodeltheyembodythroughtheirNESSdensity. Wethusreachafirstdraft
ofthekeystatementoftheFEP‚Äìthatthedynamicsself-organizingsystemsthatmaintainthemselvesatNESScanbe
interpretedasperformingexactBayesianinferenceontheexternalstatesbeyondtheirblanketor,alternatively,theycan
beinterpretedasapproximatingapproximate(variational)Bayesianinference.
Wethenintroducethegeneralcaseofthevariationalfreeenergy,whichisingeneralabounduponthemarginalNESS
density, andweshowinthespecialcaseofassumingthatthevariationaldistributionoverexternalstateswhichis
parametrizedbytheinternalstatescanbeapproximatedbytheLaplaceapproximation,thatwecaninterprettheflow
ofautonomousstatesasdirectlyperformingadescentuponthevariationalfreeenergyandthusdirectlyperforming
variationalBayesianinference. Sincewe,asthemodeller,canspecifythevariationaldistributioninanydesiredway,
thenthismeansthatthisinterpretationispotentiallytenableforawiderangeofsystems. TheLaplaceapproximation
approximatesthevariationaldistributionasaGaussianwherethevarianceisafunctionofthecurvatureatthemean.
Intuitively, this assumption is that the Gaussian is tightly peaked around the mean value. In linear systems, this
approximationistheoreticallywell-justified,duetotheunderlyingGaussianityofthestochasticnoiseinthesystem,
andthelikelyconcentrationoftheprobabilitymassaroundthemean,sincethenoiedistributionisunimodal. However,
innonlinearsystemscomplexmultimodaldistributionsmayemerge,evenwithpurelyGaussiannoiseduetointrinsic
nonlinearities of the dynamics, and so this approximation may perform poorly. On the other hand, the Gaussian
distributionarisesregularlyinnaturewheneveraveragesoverlargenumbersofindependenteventsaretakenc.f. the
CentralLimitTheorem(CLT),andcanthusbeconsideredanaturalmodellingchoicefordistributionofthemodeofthe
externalstatesgiventheblanket,whichlikelyiscomposedofcontributionsfromalargenumberofspecificexternal
states.
Torecall,wecanwritetheflowofautonomousstatesŒ±=(i,a)intermsofagradientdescentonthelogNESSdensity
oftheparticularstateslnp(s,i,a)withbothdissipativeandsolenoidalcomponentsviatheHelmholtzdecomposition.
f =(Œì‚àíQ)‚àá lnp‚àó(s,Œ±) (19)
Œ± Œ±
Thenwecandefinetheparticularfreeenergyasthevariationalfreeenergy,wherethevariationaldistributionover
externalstates, isstipulativelydefinedtobeequaltothe‚Äòtrue‚Äôposteriordistributionoverexternalstatesgiventhe
particularstatesq(e|s,i,a)=p‚àó(e|s,i,a)11. Withthisassumption,wecandefinetheparticularfreeenergyusingthe
11Weimplicitlyassumeherethatthevariationaldistributioncanbestipulatedtobeofthesamefamilyofthetrueposterior,sothat
theycanmatchoneanother
14
APREPRINT-5THOCTOBER,2021
standardformforthevariationalfree-energy
F =D [q(e|i,s,a)||p‚àó(e,i,s,a)]
particular KL
=E [lnp‚àó(i,s,a|e)]+D [q(e|i,s,a)||p‚àó(e)]
q(e|i,s,a) KL
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
Accuracy Complexity
=lnp‚àó(i,s,a)+D [q(e|i,s,a)||p‚àó(e|i,s,a)]
KL
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
Evidence Bound=0
=lnp‚àó(i,s,a) (20)
wherethelastlinefollowsbecausetheboundisalways0sincewehavedefinedthevariationalandtrueposteriorsto
bethesame. Importantly,weseethattheparticularfreeenergyisthenequaltothelogoftheNESSdensityoverthe
sensory,internal,andactivestates. Assuch,wecanrewritethedynamicsoftheautonomousstatesdirectlyintermsof
theparticularfreeenergy,
dŒ±
=(Œì‚àíQ)‚àá F (s,Œ±) (21)
dt Œ± particular
Whilethismayseemlikejustamathematicalsleightofhand,itdemonstrateshowsystemswhichmaintainthestatistical
structureofaMarkovBlanketatequilibriumcaninfactbeinterpretedasperformingvariationalBayesianinferencewith
acorrectposteriordistribution. If,conversely,werelaxthisassumptionsomewhat,sothat,asistypicalforvariational
inferencewhentheclassofdistributionsrepresentedunderthevariationaldensitydoesnotincludethetrueposterior,
thenweretainanapproximaterelationship. Thatis,whenq(e|i,s,a;Œ∏)‚âàp(e|i,s,a),weobtain,
F =D [q(e|i,s,a)||p‚àó(e,i,s,a)]
KL
=lnp‚àó(i,s,a)+D [q(e|is,a)||p‚àó(e|i,s,a)]
KL
‚âàlnp‚àó(i,s,a)
dŒ±
=‚áí ‚âà(Œì‚àíQ)‚àá F(s,Œ±)
dt Œ±
Sowecanseethatinthiscase,wecaninterpretthedynamicsoftheautonomousstatesasapproximatingapproximate
Bayesianinference. ThisisperhapsthemostgeneralstatementoftheFEP‚Äìthatthedynamicsofasystemwhich
maintains the statistical structure of a Markov Blanket at NESS against external dissipative perturbations, can be
interpreted as performing approximate variational Bayesian inference to optimize a distribution over the external
statesoftheenvironment,parametrizedbyitsowninternalstates. Thedistinctionbetweenvariationalandparticular
freeenergy,withtheparticularfreeenergyalwaysusingthestipulativelycorrectposterior,whilebeingsomewhata
mathematicaltrick,isalsoausefulphilosophicaldistinctiontodraw. Ineffect,wecanthinkofthesystemasalways
performingcorrectBayesianinference,simplybecausetheinferenceisoverthesystemitself,wherethegenerative
modelofthesystemissimplyitsNESSdensity. Conversely,wecanseetheapproximationarisingfromtheapproximate
variationaldistributionasbeingrelatedtotheimperfectionofourownunderstandingofthesystemasanexogenous
modeller. ThesystemisperfectlyhappyusingitsBayes-optimalposterioratalltimes. Avariationaldistributiondistinct
fromthisposteriormustbe,insomesense,thecreatureandcreationofthemodeller,notofthesystem,andassuchthe
approximationstothedynamicsthatarisefromthisapproximationisduetotheapproximationsimplicitinmodelling
ratherthaninthedynamicsofthesystemper-se. Itisalsoimportanttonotethatwhilewehaveusedanapproximation
sign,inrealitythevariationalfreeenergyisanupperbounduponthelogmodelevidenceortheparticularfreeenergy‚Äì
i.e. F ‚â•F andtheapproximatedynamicscanbeinterpretedasdrivingthesystemtowardstheminimization
particular
ofthisbound,andthusincreasingtheaccuracyoftheapproximationinamanneranalogoustothesimilarprocess
inherentinvariationalinference.
Whileinthegeneralcaseabove,therelationshipbetweenthedynamicsofthesystemandvariationalinferenceisonly
approximate,ifweareonlyinterestedinthedistributionoverthemodeoftheexternalstates‚Äìi.e. themostlikely
externalstateconfiguration‚Äìinsteadofthefulldistribution,thentheapproximationbecomesexactandwecandirectly
15
APREPRINT-5THOCTOBER,2021
seethatthedynamicsofthesystemdoperformvariationalinferenceuponthemodeoftheexternalstates. Herewecan
seethat,inasense,themaximum-a-posteriori(MAP)modesfortheinternalstatespreciselytracktheMAPmodesfor
theexternalstatesandthus,undertheLaplaceapproximation,canbeseenasdirectlyperformingaminimizationofthe
variationalfreeenergy.
Firstly,recallfrompreviouslythatwehaddefinedthesmoothmappingbetweenthemodesoftheexternalandinternal
statesgiventheblanketstate,e(b)=œÉ(i(b)). Byapplyingthechainruletothisfunction,itisstraightforwardtoderive
thedynamicsoftheexternalmodewithrespecttotheinternalmode,
de(b) ‚àÇœÉ(i(b))di(b)
= (22)
dt ‚àÇi(b) dt
Then, assuming that the mapping is invertible (requiring that the internal states and external states have the same
dimensionality),orratherinthegeneralcasethatithasaMoore-Penrosepseudoinverse,wecanexpressthedynamics
oftheinternalmodeintermsofthedynamicsoftheexternalmode,
di(b) ‚àÇœÉ(i(b))‚àí1de(b)
= (23)
dt ‚àÇi(b) dt
Similarly,wecanderivetheexpressionNESSdensityovertheexternalmodeintermsofthemodeoftheinternalstates,
whichprovidesaprecisemapping,calledthesynchronizationmanifold,betweenthetwodensities,eventhoughtheyare
infactseparatedbytheMarkovBlanket,
‚àÇlnp(e(b)|b) ‚àÇlnp(e(b)|b)‚àÇœÉ(i(b))
= (24)
‚àÇi ‚àÇe(b) ‚àÇi
CombiningEquations24and23andusingthefactthatthedynamicsoftheexternalmode,bythemarginalflowlemma
are, de(b) = (Œì ‚àíQ )‚àá lnp(e(b)|b),wecanexpressthedynamicsoftheinternalmodeintermsofthemarginal
dt e e e
NESSdensityovertheexternalstates,thusunderstandinghowtheinternalstatesprobabilisticallytrackchangesintheir
environment,
di(b) ‚àÇœÉ(i(b))‚àí1de(b)
=
dt ‚àÇi(b) dt
‚àÇœÉ(i(b))‚àí1
= (Œì ‚àíQ )‚àá lnp(e(b)|b)
‚àÇi(b) e e e
‚àÇœÉ(i(b))‚àí1 ‚àÇœÉ(i(b))‚àí1‚àÇœÉ(i(b))
= (Œì ‚àíQ ) ‚àá lnp(e(b)|b)
‚àÇi(b) e e ‚àÇi(b) ‚àÇi(b) e
=(Œì ‚àíQ )‚àá lnp(œÉ(i(b))) (25)
œÉ œÉ i
where(Œì ‚àíQ )=
‚àÇœÉ(i(b))‚àí1
(Œì ‚àíQ
)‚àÇœÉ(i(b))‚àí1
. Crucially,thisexpressionallowsustoexpressthedynamicsof
œÉ œÉ ‚àÇi(b) e e ‚àÇi(b)
theinternalmodeasagradientdescentontheNESSdensityoftheexternalmodegiventheblanket,withrespecttothe
modeoftheinternalstates. Fascinatingly,thisrelationshiptakesthesamegeneralformoftheHelmholtzdecomposition
withseparatedissipativeŒì andsolenoidalQ componentswhicharesimplytheoriginaldissipativeandsolenoidal
œÉ œÉ
components with respect to the internal states modulated by the inverse of the mapping function œÉ. In effect, this
implementsacoordinatetransformbetweenthecoordinatesofthedynamicsoftheexternalstatestothecoordinatesof
thedynamicsofthemodeoftheexternalstates,asafunctionofinternalstates.
NowwedemonstratehowwecaninterpretthisgradientdescentontheNESSdensityofthemodeoverexternalstatesin
termsofadirectdescentonthevariationalfreeenergy,andthusasdirectlyandexactlyperformingvariationalinference.
First,wemustdefineourvariationaldistributionq(e|b;i)whichisadistributionoverthemodesofexternalstates,given
theblanketstates,parametrizedbythemodeoftheinternalstates. Sinceweareonlyinterestednowindistributions
overthemodeoftheexternalstates,areasonableassumptionisthatitisapproximatelyGaussiandistributeddueto
thecentrallimittheorem. ThismeansthataLaplaceapproximation,whichisaGaussianapproximationwherethe
16
APREPRINT-5THOCTOBER,2021
covarianceissimplyafunctionofthemean,derivedviaasecondorderTaylor-expansionofthedensityatthemode,is
agoodapproximationtousehere. Wethusdefinethevariationaldensityas,
q(e|b;i)=N(e;i,Œ£(i))
‚àÇ2œÉ(i) ‚àí1
where Œ£(i)= (26)
‚àÇi2
Importantly,ifwesubstitutethisdefinitionofq intothevariationalfreeenergyanddropconstantsunrelatedtothe
variationalparametersi,weobtain,
1 ‚àÇ2œÉ(i) ‚àí1
F =lnp(i,b)+ tr(Œ£(i)) +ln|Œ£(i)|
2 ‚àÇœÉ2
‚àÇF ‚àÇlnp(i,b)
=‚áí =
‚àÇi ‚àÇi
Thesecondlinefollowssincethisistheonlytermwhereiisdirectlyutilized. Then,fromthisdefinition,wecansee
thatthevariationalfreeenergyisactuallypreciselythegradienttermweseeintheexpressionforthedynamicsofthe
internalstatemode,thusallowingustorewriteitas,
di
=(Œì ‚àíQ )‚àá F (27)
dt œÉ œÉ i
Afterthisthicketofmathematics,wethusseeacrucialresultfortheFEP.That,withaLaplace-encodedvariational
density,wecanseethatthemodeoftheinternalstatespreciselytracksthemodeoftheexternalstates,andthedynamics
thatallowsittodosoarepreciselythoseofagradientdescentonthevariationalfreeenergy,thusenablinganexact
interpretationofthedynamicsoftheinternalstatesasperformingBayesianinferenceontheexternalstates. Thisproof
demonstratesthefundamentallyAshbyannatureofself-organizationatnon-equilibriumsteadystate,wheresystems,in
ordertomaintaintheirsteadystate,andthusexistenceasdistinctsystems,arenecessarilyforcedtoengageinsome
degreeofmodellingortrackingexternalstatesoftheenvironment,inordertocountertheirdissipativeperturbations.
Interestingly,thisexactrelationshiptovariationalinferenceonlyemergeswhenconsideringthemodesofthesystem,
notthefulldistributionoverenvironmentalandinternalstatesaswasdonepreviously, whereweonlyobtainedan
approximationtovariationalinference. Perhapsthisisbecause,insomesense,thesystemneednotperforminferenceon
fulldistributions,butonlyonmodes. ThisperhapsmakesmoreintuitivesensewithinthecyberneticAshbyanparadigm
where,ingeneral,thesystemisseenassignificantlysmallerthantheenvironment,andthussimplycannotbeexpected
toencodeafullyaccuratemodeloftheentireenvironmentwhich,intheextremecase,includestheentirerestofthe
universe. Instead,thesystemsimplymodelsandtrackscoarse-grainedenvironmentalvariablessuchasthemode.
AnimportantadditionalnoteisthatthegradientdescentalsocontainssolenoidaltermsbaseduponQ . Sincethese
œÉ
termsareorthogonaltothegradientofthefree-energy,theydonotaffecttheultimateminimumofthedescent,however
theymayalteritsrateofconvergence,sincesolenoidaltermsencourageadditionalexplorationofthestate-spacethan
asimplegradientdescentdoes. Thisresultalsomeansthatstrictlyspeaking,ablockdiagonalQmatrix,orevena
state independent Q matrix is not necessary for this derivation as relaxing these assumptions will simply result in
additionalsolenoidalcouplingtermsinequation27butwillnotchangetheultimateminimumofthedescentsolongas
thesolenoidalcouplingtermsremainorthogonaltothegradientofthefreeenergy.
7 TheExpectedFreeEnergyandActiveInference
Sofar,wehaveonlyconsideredtherelationshipbetweeninternalandexternalstates,andobservedthatthedynamicsof
theinternalstatecanbeconsideredtobeperformingavariationalgradientdescentontheparametersofthevariational
densityoverexternalstates. Theinternalstatedynamicsexactlyfollowavariationalgradientdescentifweassumethat
theinternalstatesparametrizeaLaplacianapproximateposterior,ortheyapproximatelyfollowavariationalgradient
descentifweassumeabroaderclassofvariationalposteriors. Fromthis,wecaninterpretthedynamicsoftheinternal
statesasperformingsomekindof‚Äòperceptual‚Äôinferenceaboutthecausesoffluctuationsintheblanketstates‚Äìnamely,
theexternalstates. Butwhatabouttheactivestates? Howdotheyfitintothispicture?
17
APREPRINT-5THOCTOBER,2021
Figure 3: Active Inference and Free Energy Minimization. Top: We see that discrete state space active inference
requirestwoseparateminimizations‚Äìoneofvariationalfreeenergyforperception,andoneofexpectedfreeenergy
foractionselection. Bottom: WeseethattheEFEfunctionalcanbedecomposedinvariouswaystoyieldavarietyof
influentialobjectiveswhichhavepreviouslybeenproposedintheliterature. FigureoriginallyinDaCostaetal.(2020)
First,werecallfromtheapproximateBayesianinferencelemmathatwecanexpressthedynamicsoftheautonomous
states(activeandinternal)intermsofanapproximategradientdescentonthevariationalfreeenergy(Equation27). By
themarginalflowlemma,ifweignoresolenoidalcouplingbetweeninternalandactivestates,wecanpartitionthis
descentintoseparate(marginal)descentsontheinternalandtheactivestates,allowingustowritethedynamicsofthe
activestatesas
da
‚âà(Œì ‚àíQ )‚àá F(s,Œ±) (28)
dt aa aa a
whereŒì andQ aretheblockmatricescorrespondingsolelytotheinteractionsbetweenactivestatesinthelargerŒì
aa aa
andQmatrices. Crucially,ifwerecallthedefinitionofthevariationalfreeenergy,
F(i,s,a)=E [lnq(e;¬µ)‚àílnp‚àó(e,i,s,a)]
q(e;¬µ)
=E [‚àílnp‚àó(i,s,a|e)]+D [q(e;¬µ)||p‚àó(e)] (29)
q(e|¬µ) KL
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
Inaccuracy Complexity
Crucially,theonlyterminthisdecompositionthatdependsontheactivestatesaisthefirstinaccuracyterm. Thus,we
canstraightforwardlywritedownthedynamicsoftheactivestatesas,
da
‚âà(Œì ‚àíQ )‚àá E [‚àílnp‚àó(i,s,a|e)] (30)
dt aa aa a q(e|¬µ)
Where we can intuitively see that the dynamics of the active states effectively minimize inaccuracy (or maximize
accuracy). Ineffect,wecaninterpretthedynamicsoftheactivestatesattheNESSdensitytotrytoensurethatthe
variational‚Äôbeliefs‚Äôencodedbytheblanketandinternalstatesofthesystemareasaccurateaspossible. Sinceactive
18
APREPRINT-5THOCTOBER,2021
statescanonlyinfluenceexternalstatesandnotinternalstates,thewaythisisachievedisbyactingupontheexternal
statestobringthemintoalignmentwiththebeliefsrepresentedbytheinternalstates‚Äìhenceactiveinference.
Whilethisprovidesagoodcharacterisationofthedynamicsofthesystematequilibrium,weareoftenalsointerestedin
thepropertiesofdynamicalsystemsastheself-organizetowardsequilibrium. Specifically,wewishtocharacterisethe
natureoftheactivestatesduringthisprocessofself-organization,sothatwecanunderstandthenecessarykindsof
activebehaviouranyself-organizingsystemmustevince. Tobegintounderstandthenatureofthisself-organizationwe
firstdefineanotherinformationtheoreticquantity,theExpectedFreeEnergy(EFE)whichservesasanupper-bound
onsurprisalthroughouttheentireprocessofself-organization,withequalityonlyattheequilibriumitself. Sincewe
havethisupper-bound,wecaninterpretself-organizingsystemsawayfromequilibrium,byfollowingtheirsurprisal
dynamics as approximating expected free energy minimization, using logic directly analogous to the approximate
Bayesianinferencelemma. Conversely,turningthislogicaroundletsusconstructself-organizingsystemsbydefining
somedesiredNESSdensity,andthenprescribingdynamicswhichsimplyminimizetheEFE.
Tohandlesystemsawayfromequilibrium,wedefinesomenewterminology. Wedefinep(e ,i ,s ,a |e ,i ,s ,a )
t t t t 0 0 0 0
tobetheprobabilitydensityoverthevariablesofthesystematsometimet, whichdependsonsomesetofinitial
conditionse ,i ,s ,a . Tosimplify,weaverageovertheexternalinitialconditionandonlyrepresenttheparticular
0 0 0 0
initialconditionœÄ =(i ,s ,a ). NextwedefinetheexpectedfreeenergyG(œÄ)similarlytothevariationalfreeenergy,
0 0 0 0
butwiththecurrent-timepredictivedensitytakingtheplaceoftheapproximatevariationalposterior,andtheNESS
densitytakingtheplaceofthegenerativemodel.
G(œÄ)=E [lnp(e |œÄ ,œÄ )‚àílnp‚àó(e,œÄ)]
p(et,œÄt)|œÄt) t t 0
=E [‚àílnp‚àó(œÄ|e)]+D [p(e |œÄ ,œÄ )||p‚àó(e)] (31)
p(et,œÄt)|œÄt) KL t t 0
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
Ambiguity Risk
WeseethattheEFEmandatestheminimizationofbothambiguity(i.e. avoidingsituationswhichareheavilyuncertain)
andrisk(avoidinglargedivergencesbetweenthecurrentstatedensityandtheequilibriumstate. Itisstraightforwardto
seethattheEFEisanupperboundontheexpectedpredictivesurprisalatanytime-point,byusingthefactthatthe
KL-divergenceisalwaysgreaterthanorequalto0,
D [p(e ,œÄ |œÄ )||p‚àó(e,œÄ)]‚â•0
KL t t 0
=‚áí G(œÄ )+E lnp(œÄ |œÄ )]‚â•0
t p(et,œÄt)|œÄt) t 0
=‚áí G(œÄ )‚â•‚àíE [lnp(œÄ |œÄ )]
t p(et,œÄt)|œÄt) t 0
Similarly,itisstraightforwardtoseethatatequilibriumtheEFEsimplybecomesthesurprisal.
D [p(e ,œÄ |œÄ )||p‚àó(e,œÄ)]=G(œÄ )+E [lnp(œÄ |œÄ )]=0
KL t t 0 t p(et,œÄt)|œÄt) t 0
=‚áí G(œÄ )=‚àíE [lnp(œÄ |œÄ )] (32)
t p(et,œÄt)|œÄt) t 0
Since this is the case, we can understand the EFE as effectively quantifying the discrepancy between the current
predictivedensityandtheequilibrium. Becauseofthis,wecanseethattheEFEisnecessarilyaLyapunovfunction
of self-organizing dynamics, and it makes sense to interpret self-organizing dynamics under a Markov blanket as
minimizingtheEFE.Conversely,ifonewantstodefineasetofdynamicsthatself-organizetosomegivenattractor
p‚àó(e,i,s,a)thenonesimplyneedstodefinedynamicsthatminimizetheEFEtoachieveconvergencetotheequilibrium
(whichmaybealocalminimum).
Takingthisconverseapproachallowsustomovefromsimplyprovidinganinterpretativecharacterisationofgiven
dynamicsintermsofinference,andmoveinsteadtoconstructingordefiningsystems,oragents,whichcanachieve
specific goals. This approach is taken in the literature on active inference process theories (Da Costa et al., 2020;
K.Friston,FitzGerald,Rigoli,Schwartenbeck,&Pezzulo,2017b;K.Friston,Rigoli,etal.,2015;K.Fristonetal.,
2012)whereinsteadofsimplydescribingagivenstochasticdifferentialequation,weinsteadconsidertheNESSdensity
tobethepreferencesordesiresoftheagentoftenrepresentedasaBoltzmanndistributionoverenvironmentalrewards
19
APREPRINT-5THOCTOBER,2021
p‚àó(e,i,s,a)=exp(‚àír(e))andtheactivestates(theagent‚Äôsactions)beingcomputedthroughaminimizationofthe
EFE,withthisminimizationeithertakingplacedirectlyasagradientdescentincontinuoustimeandspace(K.J.Friston
etal.,2009)orelseasanexplicitmodel-basedplanningalgorithmasinthediscrete-timeanddiscrete-spaceformulation
(K.Fristonetal.,2017a;Millidge,2019;Millidgeetal.,2020;Tschantzetal.,2020).
8 PhilosophicalStatusoftheFEP
It is worth stepping back from the mathematical morass at this point to try to define at a high level what kind of
theory, philosophically speaking, the FEP is, and what kind of claims about the world it makes. There have been
numerousdebatesintheliteratureaboutwhethertheFEPis‚Äòfalsifiable‚Äô,orwhetheritis‚Äòcorrect‚Äô,andwhetherornot
itmakesanyspecific,empiricalclaims(Andrews,2020;Williams,2020). Howeveroftendebatesonthismatterare
obscuredorconfusedbythechallenginganddeepmathematicalbackgroundrequiredforafullunderstandingofthe
specificsoftheFEP.ItisclearfromthemathematicsthatthemainstrandoftheFEPoffersonlyan‚Äòinterpretation‚Äô
of already extant dynamics. In short, FEP presupposes the existence of the kinds of dynamics it wishes to make
senseof‚Äìdynamicalsystemswhichorganizethemselvesintoanon-equilibriumsteadystate,andwhichmaintainthe
requisitestatisticalindependencystructureoftheMarkovBlanketcondition. Oncetheseconditionsaresatisfied,the
FEPgivesaninterpretationofthedynamicalevolutionofsuchasystemasperformingankindofvariationalBayesian
inferencewherebytheinternalstatesofthesystem(definedbytheMarkovBlanketpartition)canbeseenasinferring
orrepresentingexternalstateswhichareotherwisestatisticallyisolatedbehindtheMarkovBlanket. Crucially,the
FEP,initsmostgeneralformulationdoesnotmakeanyspecificpredictionsaboutthedynamicsofthesystem. Itoffers
aninterpretationonly. WhilesystemsthatimplementtheFEPcanbederived,andseveralprocesstheorieshavebeen
explicitlyderivedfromwithintheFEPframework(K.Friston,2005;K.Friston,Rigoli,etal.,2015),allsuchtheories
necessitatemakingspecificandultimatelyarbitrarymodellingchoices,suchasofthegenerativemodelandvariational
density. SuchchoicessitbelowthelevelofabstractionthatthemathematicaltheoryoftheFEPexistsat. TheFEP,atits
core,onlyoffersamathematicalinterpretationofcertaindynamicalstructures.
TheFEPisoftencomparedandanalogisedtotheprincipleofleastactioninphysics(Lanczos,2012)whichallows
one to describe many physical processes (although not all) as minimizing the path integral of a functional called
the ‚Äòaction‚Äô over a trajectory of motion (Sussman & Wisdom, 2015). This argument is often used to claim, in my
opinion correctly, that the FEP is a mathematical ‚Äòprinciple‚Äô or interpretation and therefore cannot be falsified or
empiricallytested. Inmyopinion, however, theprincipleofleastactionis, initsphilosophicalstatus, notdirectly
analogous to the FEP. While the relationship between the path integral of the action and the dynamics prescribed
by the Euler-Lagrange equations is simply a mathematical truth, the principle of least action itself, as applied to
physicsiscontainsafundamentallyempiricalandfalsifiableclaim‚Äìthatphysicalsystemsintherealworldcanbe
welldescribedthroughitsownmathematicalapparatus‚Äìthatisofdynamicsderivedfromminimizinganaction. This
claimisinprinciplefalsifiable. Notalldynamicalsystemscanbederivedfromleastactionprinciples. Ifphysical
systemspredominantlycamefromtheclassthatcannotbesoderived,theprincipleofleastactioninphysicswouldbe
effectivelyfalsified,andthemathematicalapparatusunderlyingitwouldhavebecomenothingmorethananarcane
mathematicalcuriosity. Sofarasweknow,thereisnoa-priorireasonwhymuchofphysicscanbesowellunderstood
throughactionprinciples,andindeedthereareareasofphysics‚Äìsuchasstatisticalmechanicsandthermodynamics,
anddissipativenon-conservativesystemsingeneral‚Äìwhichcannot(sofar)bedescribedintheseterms.
ItappearsacloserphysicsanalogytotheFEPmightbeonedirectionofNoether‚Äôstheorem. Noether‚Äôstheoremproves
adirectcorrespondencesbetweensymmetriesorinvariancesinagivensystem,andconservationlaws. Forinstance,
inphysicalsystems,time-translationsymmetryimpliestheconservationofenergy,androtationalsymmetry(ofthe
underlyingeuclideanspace,notanygivenobjectwithinit)impliestheconservationofangularmomentum. TheFEP,
similarly,triestoshowacorrespondencebetweenthedynamicsofacertainkindofsystem(NESSdensity,Markov
Blanketconditions)andthedynamicsofvariationalBayesianinference. Interestingly,whilethe‚Äòforward‚Äôdirection
20
APREPRINT-5THOCTOBER,2021
fromtheNESSdensityandMarkovBlanketconditionshandledbytheFEP,thereversedirection‚Äìi.e. whetherthe
presenceofBayesianinferencedynamicsimpliesanykindofstatisticalstructureuponthedynamicsofthesystem
remains unclear, and this is likely a fruitful direction for further theoretical work. Noether‚Äôs theorem, unlike the
principleofleastaction,matchesmorecloselythantheprincipleofleastactionsinceitonlyspecifiescorrespondences
betweencertainkindsofmathematicalobjects(symmetriesandconservationlaws)justastheFEPonlyspecifiesa
correspondencebetweendynamicalflowsatNESSofasystemwithaMarkovBlanket,andthegradientflowsonthe
variationalfreeenergy.
While its status as a mathematical principle and interpretation only can shield the FEP from the possibility of an
empirical‚Äòfalsification‚Äô,thisdoesnotmeanthatthetheoryisnotsubjecttosomekindofimplicitintellectualreview.
MuchofthecoremotivationbehindtheFEPhasbeentotrytoderiveuniversalpropertiesofthekindofbiological
self-organizing systems which give rise to structured behaviour including relatively ‚Äòhigh level‚Äô processes such as
theperception-action-loop,explicitperceptionandinferenceaboutthecausesoftheexternalworldand,ultimately,
prospective inference and planning. For instance, much of the FEP literature has been focused on and applied to
understandingbrainfunction(K.Friston,2008;K.Fristonetal.,2017a;K.Friston,Rigoli,etal.,2015). Thisambition
renderstheFEPopentoquestionsaboutits‚Äòapplicability‚Äô,ifnotitsfalsifiability. TheFEPimposesrelativelystringent
conditionsthatdynamicalsystemsmustsatisfyforthelogicalstepsintheFEPmusthold. Althoughthepreciselistof
assumptionsrequiredisnotentirelyclear,sofarintheliteraturethisappearstoincludeatleast:
‚Ä¢ thatthesysteminquestioncanbeadequatelyrepresentedasaLangevinequation(i.e. thesystemisMarkov
anddoesnotdependonhistory)withadditivewhiteGaussiannoise.
‚Ä¢ thatthedynamicalsystemasawholehaveawell-definedNESSdensity(includingovertheexternalstates)
‚Ä¢ thatthesystemobeytheMarkovBlanketconditions,whichare,ingeneral,relativelyrestrictiveaboutthe
kindsofflowsthatarepossible,andappeartohavebecomemorerestrictiveinK.Friston,DaCosta,andParr
(2020),whichprecludesanysolenoidalcouplingbetweenactiveandsensorystates
‚Ä¢ thatthereisaninjectivemappingbetweenthemost-likelyinternalstategiventheblanketandthemodeofthe
distributionofexternalstatesgiventheblanketstates,whichisadditionallysmoothanddifferentiable(thisis
requiredforthedual-aspectinformationgeometry,andthustheidentificationwithBayesianinference)
TheseconditionsarequitestrictabouttheclassofsystemsthattheFEPcanapplyto,anditisunclearif‚Äòrealsystems‚Äô
ofthekindoftheFEPdesirestoexplain‚Äìsuchasbiologicalself-organization,andespeciallybrains,canfulfilthem. If
itturnsoutthatsuchsystemsflagrantlyviolatetheconditionsfortheFEP,thentheFEPcannotbesaidtoapplytothem
andthuscannotbeofuseinunderstandingthem,evenasaninterpretatorydevice. Inthiscase,theFEPwouldfailthe
applicabilitycriterion,andwouldceasetobeparticularlyusefulforitsoriginalgoalsofneuroscience,evenifitremains
nottechnicallyfalsifiedanddoes,infact,applytosomeobscuremathematicalclassofdynamicalsystems. Importantly,
manyoftheassumptionsoftheFEP,wheninterpretedstrictly,donotappeartoholdingeneralforcomplexbiological
systemssuchasbrains. Forinstance,totakeextremebutillustrativeexamples,itisclearthatnobiologicalsystem
iseverinatruenon-equilibriumsteadystate, sinceeventuallyallsuchorganismswilleventuallyageanddie, and
indeedeventuallytheentireuniversewilllikelyeventuallydecaytoathermodynamicequilibriumstate. Additionally,
theMarkovBlanketassumptionisdirectlyviolatedbythingssuchasx-rays(andindeedgravity)whichcandirectly
interactwith‚Äòinternalstates‚Äôofthebrain,suchasneurons,withoutfirstpassingthroughtheMarkovBlanketofthe
physicalboundariesofthebrainandthesensoryepithelium. Assuch,forarealphysicalsystem,wemusttakethe
assumptionsoftheFEPtobeonlyapproximations,whichholdlocally,orapproximately,butnotforalltimeandwith
completeperfection. Itremainstobeseen,andempiricallyinvestigatedifpossible,theextenttowhichthemathematical
interpretationsandlogicalstatementsoftheFEPremainrobusttosuchslightrelaxationsofitscoreassumptions.
While the FEP provides a mathematical interpretation of certain kinds of dynamics in terms of inference, it also,
largely,remainstobeseenwhethersuchaninterpretationisusefulforspurringnewideas,questions,anddevelopments
withinthefieldstheFEPhopestoinfluence‚Äìsuchasneuroscience,cognitivescience,anddynamicalsystemstheory.
21
APREPRINT-5THOCTOBER,2021
ReturningtoouranaologiesoftheleastactionprincipleandNoether‚Äôstheorem, whilebothofthesemathematical
results only provides interpretations of known dynamics, by operating at a high level of abstraction they provide
powerfulcapabilitiesforgeneralization. Forinstancetheprincipleofleastactionallowsfordynamicstobederived,
viatheEuler-Lagrangeequations, directlyfromthehighlevelspecificationoftheaction. Forinstance,potentially
neworcounterfactuallawsofphysicscanbederivedsimplybypostulatingagivenLagrangianorHamiltonianand
then working through the mathematical machinery of the principle of least action to derive the ensuing dynamics.
Additionally,byinvestigatingequivariancesintheaction,onecanoftenunderstandthekindsofinvariancesanddegrees
offreedomthatexistintheactuallyrealizeddynamics. Similarly,Noether‚Äôstheoremallowsonetoplaywithsettingup
certainconservedquantitiesorsymmetriesa-priori,andthenworkoutpreciselytheconsequencesthattheseentailfor
thedynamics.
ItiscurrentlyuncleartowhatextenttheFEPofferssuchpowerfuladvantagesofabstractionandgeneralization. Thisis
largelyduetotheFEPbeingimmatureasafieldcomparedtothecornerstonesofclassicalphysics,andthemajorityof
theresearcheffortsofarhasgoneintomakingthetheorypreciseratherthanderivingconsequencesandgeneralizations
fromit,buttherearesomepromisinginitialsignswhichhavejustbeguntoemergeintheliteratureofthepowerthe
FEPperspectiveoffers. Fromapracticalperspective,theFEPappearstoofferanumberofnoveltechniques. Firstly,
givenadesiredNESSdensity, thefreeenergylemmaprovidesastraightforwardwayofderivingdynamicswhich
willnecessarilyreachthatdensity,duetothefactthatthevariationalfreeenergybecomesaLyapunovfunctionof
thesystemasawhole. ThisapproachhasstrongpotentiallinkstoMarkov-Chain-Monte-Carlomethodsinmachine
learningandstatistics,whichaimtoapproximateanintractableposteriordistributionbythetimeevolutionofaMarkov
process(M.Betancourt,2017;Brooks,Gelman,Jones,&Meng,2011;Chen,Fox,&Guestrin,2014;Metropolisetal.,
1953;Nealetal.,2011). TheFEPprovidesanewperspectiveonsuchsystemsasfundamentallyperformingvariational
Bayesianinference,andmayinfuturebeusedtodevelopimprovedalgorithmsinthisdomain,akintothedevelopments
of Hamiltonian (M. J. Betancourt, 2013) and Riemannian MCMC (Girolami & Calderhead, 2011) methods. For
instance,thereismuchpotentialintheideaofsolenoidalflowspeedingupconvergencetothedesiredequilibrium
density(Ma,Chen,&Fox,2015). Conversely,theFEP,throughtheHelmholtzdecomposition,mayadditionallyprovide
toolsforinferringtheeventualNESSdensitygivenaspecificsetofdynamics(K.Friston,2019b;Maetal.,2015). This
wouldallowforananalyticalorempiricalcharacterisationoftheultimatefateofasystem,andallowforcharacterising
differentkindsofsystemspurely,suchaswhetherequilibriumornon-equilibriumpurelybytheirdynamicsfarfrom
equilibrium.
A second strand of potentially directly useful research which has begun to arise from the FEP is empirical and
statisticalmethodologiesfordefining,computing,andapproximatingMarkovBlankets. Thisimpliestheabilityto
inferthestatisticalindependencystructureofthedynamicseitherfromanalyticalknowledgeofthedynamicsorfrom
observedtrajectories. Therearealreadytwoapproachestoachievethisintheliterature. Onewhichutilizesgraph
theoryintheformofthegraphLaplaciantoinfernodesoftheMarkovblanketbasedontheparents,andchildrenof
parentsofthelargesteigenstatesoftheJacobian(K.Friston,2013;Palacios,Razi,Parr,Kirchhoff,&Friston,2017).
A second approach directly uses the Hessian of the dynamics to attempt to read off the conditional independency
requirements it implies (K. J. Friston, Fagerholm, et al., 2020). These approaches may have substantial merit and
utilityinunderstandingtheeffectivestatisticalindependencystructureofcomplexdynamicalprocesses,especially
questionsregardingfunctionalindependenceinthebrain. Thisstrandofresearchheavilyrelatestothequestionof
abstractionindynamicalsystems‚Äìnamely,whethercomplexsystemscanorcannotbestraightforwardlypartitioned
intoindependent‚Äòsubsystems‚Äôwhichcanthenbeabstractedover. Forinstance,theidealwouldbetheabilityto,givena
complexhigh-dimensionaldynamicalsystem,parsethissystemintoindividual‚Äòentities‚Äô(separatedbyMarkovblankets)
whichinteractwitheachotheraccordingtoanothersetof(hopefullysimpler)dynamicalrules. Thiswouldallowforan
automaticproceduretotransformahighdimensionalcomplexsystemintoasimpler,low-dimensionalapproximate
systemmoreamenableforanalysisand,ultimatelyunderstanding.
22
APREPRINT-5THOCTOBER,2021
Finally,itisclearthattheprocesstheoriesinspiredbytheFEP,althoughepistemologicallytheystandapartfromtheFEP,
neitherrequiringnotsupportingitsvalidity,havehadsubstantialinfluenceandimpactwithintheoreticalneuroscience,
wheretheyhavebeenproductivelyappliedtounderstandingawiderangeofbehaviouralandneuronalphenomena.
9 Discussion
In this paper, we have aimed to clarify the core logical steps of the FEP, and explain the mathematical apparatus
underlying it. At its core, the FEP is a simple theory, which relates the dynamics of a dynamical system with a
non-equilibriumsteadystate,tothedynamicsofavariationalBayesianinferenceprocesswhichminimizesavariational
freeenergyfunctional. ThekeylogicrequiredforthisidentificationissimplytheHelmholtzdecompositionofthe
dynamicsintoagradientdescentonapotentialfunction,andthentheLaplaceapproximationofthevariationaldensity
whichenablestheidentificationofthepotentialwiththevariationalfreeenergy. However,itisimportanttorealize
thattheFEPprescribesaninterpretationofcertainkindsofsystembehaviouronly‚Äìitcannotnaturallybeusedina
forwarddirectiontomakecausalpredictionsabouttheevolutionofasystem,sincethedynamicsofthesystemwhich
wouldbeusedtomakesuchapredictionmustintrinsicallybeknownbeforethevariationalfreeenergyfunctionalcan
beidentified. However,theFEPdoesprovideastraightforwardmathematicalmachineryforthedesignandcreationof
systemswhichfulfillitspostulates,byprovidingamathematicalmechanismtotranslateadesiredstationarydensity
withaMarkovBlanketconditionalindependencestructuretoasetofdynamicswhichwillmaintainit.
WhilethroughoutthemainbodyofthispaperwehavelargelyendeavouredtopresenttheFEPinthemostcharitable
light,thereisstillasubstantialamountofcontroversyoverthecorrectnessandinterpretationoftheFEPsmathematical
claims‚ÄìseeBiehletal.(2020)andAguileraetal.(2021). AcruciallimitationoftheFEPisthatmanyoftheconditions
requiredforitsderivationsarequiterestrictiveandmaysignificantlylimitthekindsofsystemtheFEPcanreasonably
be applied to. Additionally, many of the claims made in the literature about the power and generality of the FEP
aresomewhatoverstatedgiventheseconditions,aswellastheFEPsentirelyinterpretationaltheoreticalstatus. An
importantquestionremainsastothedegreetowhichtheassumptionsrequiredbytheFEPcanbeslightlyrelaxed,soas
toadmitasignificantlylargerclassofpotentialsystemsintoconsideration,withouttotallydestroyingthecoreclaimsof
theFEPastosystemsbeingabletobeinterpretedasperformingvariationalinference. Bypresentingthereaderwitha
mathematicallydetailed,yetideallyintuitiveandfairlystraightforwardpresentationofthekeyconceptsoftheFEP,we
hopetoenablethemtoengagemoredeeplywiththetechnicalliteraturediscussinganddebatingthesequestions,as
wellastounderstandonadeeplevelsimplywhattheFEPdoesanddoesnotdo.
References
Aguilera,M.,Millidge,B.,Tschantz,A.,&Buckley,C.L. (2021). Howparticularisthephysicsofthefreeenergy
principle? arXivpreprintarXiv:2105.11203.
Amari,S.-I. (1995). Informationgeometryoftheemandemalgorithmsforneuralnetworks. Neuralnetworks,8(9),
1379‚Äì1408.
Andrews,M. (2020). Themathisnottheterritory: Navigatingthefreeenergyprinciple.
Beal,M.J. (2003). Variationalalgorithmsforapproximatebayesianinference(Unpublisheddoctoraldissertation).
UCL(UniversityCollegeLondon).
Benrimoh, D., Parr, T., Adams, R. A., & Friston, K. (2019). Hallucinations both in and out of context: an active
inferenceaccount. PloSone,14(8),e0212379.
Betancourt,M. (2017). Aconceptualintroductiontohamiltonianmontecarlo. arXivpreprintarXiv:1701.02434.
Betancourt,M.J.(2013).Generalizingtheno-u-turnsamplertoriemannianmanifolds.arXivpreprintarXiv:1304.1920.
Biehl,M.,Pollock,F.A.,&Kanai,R. (2020). Atechnicalcritiqueofthefreeenergyprincipleaspresentedin"lifeas
weknowit"andrelatedworks. arXivpreprintarXiv:2001.06408.
23
APREPRINT-5THOCTOBER,2021
Blei,D.M.,Kucukelbir,A.,&McAuliffe,J.D. (2017). Variationalinference: Areviewforstatisticians. Journalofthe
AmericanstatisticalAssociation,112(518),859‚Äì877.
Bogacz, R. (2017). A tutorial on the free-energy framework for modelling perception and learning. Journal
of mathematical psychology, 76, 198‚Äì211. Retrieved from https://www.sciencedirect.com/science/
article/pii/S0022249615000759
Brooks,S.,Gelman,A.,Jones,G.,&Meng,X.-L. (2011). Handbookofmarkovchainmontecarlo. CRCpress.
Buckley,C.L.,Kim,C.S.,McGregor,S.,&Seth,A.K. (2017). Thefreeenergyprincipleforactionandperception: A
mathematicalreview. JournalofMathematicalPsychology,81,55‚Äì79.
Caticha,A. (2015). Thebasicsofinformationgeometry. InAipconferenceproceedings(Vol.1641,pp.15‚Äì26).
Chen,T.,Fox,E.,&Guestrin,C. (2014). Stochasticgradienthamiltonianmontecarlo. InInternationalconferenceon
machinelearning(pp.1683‚Äì1691).
Clark,A. (2015). Surfinguncertainty: Prediction,action,andtheembodiedmind. OxfordUniversityPress. Retrieved
from https://books.google.co.uk/books?hl=en&lr=&id=TnqECgAAQBAJ&oi=fnd&pg=PP1&dq=
andy+clark+surfing+uncertainty&ots=aurm4jE3NO&sig=KxeHGJ6YJJdN9tKyr6snwDyBBKg&redir
_esc=y#v=onepage&q=andy%20clark%20surfing%20uncertainty&f=false
Conant,R.C.,&RossAshby,W.(1970).Everygoodregulatorofasystemmustbeamodelofthatsystem.International
journalofsystemsscience,1(2),89‚Äì97.
Cullen,M.,Davey,B.,Friston,K.J.,&Moran,R.J. (2018). Activeinferenceinopenaigym: Aparadigmforcomputa-
tionalinvestigationsintopsychiatricillness. Biologicalpsychiatry: cognitiveneuroscienceandneuroimaging,
3(9),809‚Äì818.
DaCosta,L.,Friston,K.,Heins,C.,&Pavliotis,G.A. (2021). Bayesianmechanicsforstationaryprocesses. arXiv
preprintarXiv:2106.13830.
DaCosta,L.,Parr,T.,Sajid,N.,Veselic,S.,Neacsu,V.,&Friston,K. (2020). Activeinferenceondiscretestate-spaces:
asynthesis. arXivpreprintarXiv:2001.07203.
Dayan,P.,Hinton,G.E.,Neal,R.M.,&Zemel,R.S. (1995). Thehelmholtzmachine. Neuralcomputation,7(5),
889‚Äì904.
Esposito,M.,&VandenBroeck,C. (2010). Threefacesofthesecondlaw.i.masterequationformulation. Physical
ReviewE,82(1),011143.
Feynman,R. (1998). Statisticalmechanics: asetoflectures(advancedbookclassics).
Fox,C.W.,&Roberts,S.J. (2012). Atutorialonvariationalbayesianinference. Artificialintelligencereview,38(2),
85‚Äì95.
Friston,K. (2003). Learningandinferenceinthebrain. NeuralNetworks,16(9),1325‚Äì1352.
Friston, K. (2005). Atheoryofcorticalresponses. PhilosophicaltransactionsoftheRoyalSocietyB:Biological
sciences,360(1456),815‚Äì836.
Friston,K. (2008). Hierarchicalmodelsinthebrain. PLoScomputationalbiology,4(11).
Friston,K. (2009). Thefree-energyprinciple:aroughguidetothebrain? Trendsincognitivesciences,13(7),293‚Äì301.
Friston,K. (2010). Thefree-energyprinciple: aunifiedbraintheory? Naturereviewsneuroscience,11(2),127‚Äì138.
Friston,K. (2012). Thehistoryofthefutureofthebayesianbrain. NeuroImage,62(2),1230‚Äì1233. Retrievedfrom
https://www.sciencedirect.com/science/article/pii/S1053811911011657
Friston,K. (2013). Lifeasweknowit. JournaloftheRoyalSocietyInterface,10(86),20130475.
Friston,K. (2019a). Afreeenergyprincipleforaparticularphysics.
Friston,K. (2019b). Afreeenergyprincipleforaparticularphysics. arXivpreprintarXiv:1906.10184.
Friston,K.,&Ao,P. (2012a). Freeenergy,value,andattractors. Computationalandmathematicalmethodsinmedicine,
2012.
Friston,K.,&Ao,P. (2012b). Freeenergy,value,andattractors. Computationalandmathematicalmethodsinmedicine,
2012.
Friston, K., Da Costa, L., Hafner, D., Hesp, C., & Parr, T. (2020). Sophisticated inference. arXiv preprint
24
APREPRINT-5THOCTOBER,2021
arXiv:2006.04120. Retrievedfromhttps://arxiv.org/abs/2006.04120
Friston,K.,DaCosta,L.,&Parr,T. (2020). Someinterestingobservationsonthefreeenergyprinciple. arXivpreprint
arXiv:2002.04501.
Friston,K.,FitzGerald,T.,Rigoli,F.,Schwartenbeck,P.,&Pezzulo,G. (2017a). Activeinference: aprocesstheory.
Neuralcomputation,29(1),1‚Äì49.
Friston,K.,FitzGerald,T.,Rigoli,F.,Schwartenbeck,P.,&Pezzulo,G. (2017b). Activeinference: aprocesstheory.
Neuralcomputation,29(1),1‚Äì49.
Friston,K.,Heins,C.,Ueltzh√∂ffer,K.,DaCosta,L.,&Parr,T. (2021). Stochasticchaosandmarkovblankets. Entropy,
23(9),1220.
Friston, K., Kilner, J.,&Harrison, L. (2006). Afreeenergyprincipleforthebrain. JournalofPhysiology-Paris,
100(1-3),70‚Äì87.
Friston, K., Levin, M., Sengupta, B., & Pezzulo, G. (2015). Knowing one‚Äôs place: a free-energy approach to
pattern regulation. Journal of the Royal Society Interface, 12(105), 20141383. Retrieved from https://
royalsocietypublishing.org/doi/full/10.1098/rsif.2014.1383
Friston,K.,Parr,T.,&Zeidman,P. (2018). Bayesianmodelreduction. arXivpreprintarXiv:1805.07092.
Friston,K.,Rigoli,F.,Ognibene,D.,Mathys,C.,Fitzgerald,T.,&Pezzulo,G. (2015). Activeinferenceandepistemic
value. Cognitiveneuroscience,6(4),187‚Äì214.
Friston, K., Samothrakis, S., & Montague, R. (2012). Active inference and agency: optimal control without cost
functions. Biologicalcybernetics,106(8-9),523‚Äì541.
Friston,K.,Schwartenbeck,P.,FitzGerald,T.,Moutoussis,M.,Behrens,T.,&Dolan,R.J. (2014). Theanatomyof
choice: dopamineanddecision-making. PhilosophicalTransactionsoftheRoyalSocietyB:BiologicalSciences,
369(1655),20130481.
Friston,K.J.,Daunizeau,J.,&Kiebel,S.J. (2009). Reinforcementlearningoractiveinference? PloSone,4(7).
Friston, K. J., Daunizeau, J., Kilner, J., & Kiebel, S. J. (2010). Action and behavior: a free-energy formulation.
Biologicalcybernetics,102(3),227‚Äì260. Retrievedfromhttps://link.springer.com/article/10.1007/
s00422-010-0364-z
Friston,K.J.,Fagerholm,E.D.,Zarghami,T.S.,Parr,T.,Hip√≥lito,I.,Magrou,L.,&Razi,A. (2020). Parcelsand
particles:Markovblanketsinthebrain.arXivpreprintarXiv:2007.09704.Retrievedfromhttps://arxiv.org/
abs/2007.09704
Friston,K.J.,Lin,M.,Frith,C.D.,Pezzulo,G.,Hobson,J.A.,&Ondobaka,S. (2017). Activeinference,curiosityand
insight. Neuralcomputation,29(10),2633‚Äì2683.
Friston, K. J., Rosch, R., Parr, T., Price, C., & Bowman, H. (2018). Deep temporal models and active inference.
Neuroscience&BiobehavioralReviews,90,486‚Äì501.
Friston,K.J.,Wiese,W.,&Hobson,J.A. (2020). Sentienceandtheoriginsofconsciousness: Fromcartesianduality
tomarkovianmonism. Entropy,22(5),516.
Geweke,J. (2007). Bayesianmodelcomparisonandvalidation. AmericanEconomicReview,97(2),60‚Äì64.
Ghahramani,Z.,&Beal,M.J. (2001). Propagationalgorithmsforvariationalbayesianlearning. InAdvancesinneural
informationprocessingsystems(pp.507‚Äì513).
Ghahramani, Z., Beal, M. J., et al. (2000). Graphical models and variational methods. Advanced mean field
methods-theoryandpractice.MITPress.
Girolami,M.,&Calderhead,B. (2011). Riemannmanifoldlangevinandhamiltonianmontecarlomethods. Journalof
theRoyalStatisticalSociety: SeriesB(StatisticalMethodology),73(2),123‚Äì214.
Goodfellow,I.,Bengio,Y.,&Courville,A. (2016). Deeplearning. MITpress.
Hohwy,J. (2016). Theself-evidencingbrain. No√ªs,50(2),259‚Äì285.
Hohwy,J.,Roepstorff,A.,&Friston,K. (2008). Predictivecodingexplainsbinocularrivalry: Anepistemological
review. Cognition,108(3),687‚Äì701.
Jaswinski,A. (1970). Stochasticprocessesandfilteringtheory,1970. AcademicPress.
25
APREPRINT-5THOCTOBER,2021
Jordan, M. I., Ghahramani, Z., Jaakkola, T. S., & Saul, L. K. (1998). An introduction to variational methods for
graphicalmodels. InLearningingraphicalmodels(pp.105‚Äì161). Springer.
Jordan, M. I., Ghahramani, Z., Jaakkola, T. S., & Saul, L. K. (1999). An introduction to variational methods for
graphicalmodels. Machinelearning,37(2),183‚Äì233.
Jordan,R.,Kinderlehrer,D.,&Otto,F. (1998). Thevariationalformulationofthefokker‚Äìplanckequation. SIAM
journalonmathematicalanalysis,29(1),1‚Äì17.
Kalman,R.E. (1960). Anewapproachtolinearfilteringandpredictionproblems.
Kingma,D.P.,&Welling,M. (2013). Auto-encodingvariationalbayes.
Kondepudi,D.,&Prigogine,I. (2014). Modernthermodynamics: fromheatenginestodissipativestructures. John
Wiley&Sons.
Lanczos,C. (2012). Thevariationalprinciplesofmechanics. CourierCorporation.
Lawson, R. P., Rees, G., & Friston, K. J. (2014). An aberrant precision account of autism. Frontiers in human
neuroscience,8,302. Retrievedfromhttps://www.frontiersin.org/articles/10.3389/fnhum.2014
.00302/full
Ma, Y.-A., Chen, T., & Fox, E. B. (2015). A complete recipe for stochastic gradient mcmc. arXiv preprint
arXiv:1506.04696.
Metropolis,N.,Rosenbluth,A.W.,Rosenbluth,M.N.,Teller,A.H.,&Teller,E. (1953). Equationofstatecalculations
byfastcomputingmachines. Thejournalofchemicalphysics,21(6),1087‚Äì1092.
Millidge,B. (2019). Deepactiveinferenceasvariationalpolicygradients.
Millidge, B., Seth, A., & Buckley, C. L. (2021). Predictive coding: a theoreticaland experimental review. arXiv
preprintarXiv:2107.12979.
Millidge,B.,Tschantz,A.,Seth,A.K.,&Buckley,C.L. (2020). Ontherelationshipbetweenactiveinferenceand
controlasinference. arXivpreprintarXiv:2006.12964.
Mumford,D. (1992). Onthecomputationalarchitectureoftheneocortex. Biologicalcybernetics,66(3),241‚Äì251.
Neal,R.M.,&Hinton,G.E. (1998). Aviewoftheemalgorithmthatjustifiesincremental,sparse,andothervariants.
InLearningingraphicalmodels(pp.355‚Äì368). Springer.
Neal,R.M.,etal. (2011). Mcmcusinghamiltoniandynamics. Handbookofmarkovchainmontecarlo,2(11),2.
Ollivier,Y.,Arnold,L.,Auger,A.,&Hansen,N. (2017). Information-geometricoptimizationalgorithms: Aunifying
pictureviainvarianceprinciples. JournalofMachineLearningResearch,18(18),1‚Äì65.
Ovchinnikov,I.V. (2016). Introductiontosupersymmetrictheoryofstochastics. Entropy,18(4),108.
Palacios,E.R.,Razi,A.,Parr,T.,Kirchhoff,M.,&Friston,K. (2017). Biologicalself-organisationandmarkovblankets.
BioRxiv,227181. Retrievedfromhttps://www.biorxiv.org/content/10.1101/227181v1.abstract
Parr,T. (2019). Thecomputationalneurologyofactivevision(Unpublisheddoctoraldissertation). UCL(University
CollegeLondon).
Parr,T.,DaCosta,L.,&Friston,K. (2020). Markovblankets,informationgeometryandstochasticthermodynamics.
PhilosophicalTransactionsoftheRoyalSocietyA,378(2164),20190159.
Parr,T.,&Friston,K.J. (2017). Uncertainty,epistemicsandactiveinference. JournalofTheRoyalSocietyInterface,
14(136),20170376.
Parr,T.,&Friston,K.J. (2018). Activeinferenceandtheanatomyofoculomotion. Neuropsychologia,111,334‚Äì343.
Parr,T.,Markovic,D.,Kiebel,S.J.,&Friston,K.J. (2019). Neuronalmessagepassingusingmean-field,bethe,and
marginalapproximations. Scientificreports,9(1),1‚Äì18.
Parr, T., Sajid, N., & Friston, K. J. (2020). Modules or mean-fields? Entropy, 22(5), 552. Retrieved from
https://www.mdpi.com/1099-4300/22/5/552
Pearl,J. (2011). Bayesiannetworks.
Pearl,J. (2014). Probabilisticreasoninginintelligentsystems: networksofplausibleinference. Elsevier.
Prigogine,I. (2017). Non-equilibriumstatisticalmechanics. CourierDoverPublications.
Prigogine,I.,&Lefever,R. (1973). Theoryofdissipativestructures. InSynergetics(pp.124‚Äì135). Springer.
26
APREPRINT-5THOCTOBER,2021
Ramstead,M.J.,Hesp,C.,Tschantz,A.,Smith,R.,Constant,A.,&Friston,K. (2020). Neuralandphenotypicrepre-
sentationunderthefree-energyprinciple. Neuroscience&BiobehavioralReviews. Retrievedfromhttps://www
.sciencedirect.com/science/article/pii/S0149763420306643?casa_token=16rC0ManFBUAAAAA:
3mbntn5I7fObnA_Y397rvZbWrnUzkqmALD1LtS88tGrIRxbw9RQvU55XJuH-zKdBi6tPaN9faDM
Rao, R. P., & Ballard, D. H. (1999). Predictive coding in the visual cortex: a functional interpretation of some
extra-classicalreceptive-fieldeffects. Natureneuroscience,2(1),79‚Äì87.
Schwartenbeck,P.,FitzGerald,T.,Dolan,R.,&Friston,K. (2013). Exploration,novelty,surprise,andfreeenergy
minimization. Frontiersinpsychology,4,710.
Schwartenbeck,P.,Passecker,J.,Hauser,T.U.,FitzGerald,T.H.,Kronbichler,M.,&Friston,K.J. (2019). Com-
putational mechanisms of curiosity and goal-directed exploration. , 8, e41703. Retrieved 2019-11-15, from
https://doi.org/10.7554/eLife.41703 doi: 10.7554/eLife.41703
Seifert,U. (2008). Stochasticthermodynamics: principlesandperspectives. TheEuropeanPhysicalJournalB,64(3),
423‚Äì431.
Seifert,U. (2012). Stochasticthermodynamics,fluctuationtheoremsandmolecularmachines. Reportsonprogressin
physics,75(12),126001.
Spratling, M. W. (2017). A review of predictive coding algorithms. Brain and cognition, 112, 92‚Äì97. Retrieved
from https://www.sciencedirect.com/science/article/pii/S027826261530035X?casa_token=
zzTchZsrFesAAAAA:5bJNguAnRfn4BOjlCtmGvjiQT0Mkk3CE1By9JsrGrDIT0qY-CUKLUwVROkHB9S
_kUx6mtH-nc74
Srinivasan, M. V., Laughlin, S. B., & Dubs, A. (1982). Predictive coding: a fresh view of in-
hibition in the retina. Proceedings of the Royal Society of London. Series B. Biological
Sciences, 216(1205), 427‚Äì459. Retrieved from https://royalsocietypublishing.org/
doi/abs/10.1098/rspb.1982.0085?casa_token=gdNrGbAlmC8AAAAA%3Ac1xArFgNym4QLB0vI
-dDd0ywIS0ozVZjzjnhogf4CVpFZi2zIW8cMU3OIZwvV8cFCoVqAaDOFo_IFDY
Sussman,G.J.,&Wisdom,J. (2015). Structureandinterpretationofclassicalmechanics. TheMITPress.
Tschantz,A.,Millidge,B.,Seth,A.K.,&Buckley,C.L. (2020). Reinforcementlearningthroughactiveinference.
arXivpreprintarXiv:2002.12636.
VandenBroeck,C.,&Esposito,M. (2010). Threefacesofthesecondlaw.ii.fokker-planckformulation. Physical
ReviewE,82(1),011144.
Wiener,N. (2019). Cyberneticsorcontrolandcommunicationintheanimalandthemachine. MITpress.
Williams,D. (2020). Isthebrainanorganforpredictionerrorminimization?
Yedidia,J.S. (2011). Message-passingalgorithmsforinferenceandoptimization. JournalofStatisticalPhysics,145(4),
860‚Äì890.
Yuan,R.,&Ao,P. (2012). Beyondit√¥versusstratonovich. JournalofStatisticalMechanics: TheoryandExperiment,
2012(07),P07010.
Yuan,R.,Ma,Y.,Yuan,B.,&Ao,P. (2010). Constructiveproofofgloballyapunovfunctionaspotentialfunction.
arXivpreprintarXiv:1012.2721.
Yuan,R.,Ma,Y.,Yuan,B.,&Ao,P. (2011). Potentialfunctionindynamicalsystemsandtherelationwithlyapunov
function. InProceedingsofthe30thchinesecontrolconference(pp.6573‚Äì6580).
Yuan,R.,Tang,Y.,&Ao,P.(2017).Sdedecompositionanda-typestochasticinterpretationinnonequilibriumprocesses.
FrontiersofPhysics,12(6),1‚Äì9.
Zwanzig,R. (2001). Nonequilibriumstatisticalmechanics. OxfordUniversityPress.
27
APREPRINT-5THOCTOBER,2021
10 Appendix
10.1 GeneralReviewofAssumptionsRequiredfortheFEP
HereweprovideageneraloverviewandshortdiscussionofeveryassumptionrequiredateachstageoftheFEP.Many
oftheseassumptionshavemoredetaileddiscussionsinsubsectionsofthisappendix. Ultimately,theoverallpicture
thatemergesisthattheFEPrequiresmanyassumptionstowork,anditisunlikelythatallofthemcanbefulfilled
bythekindsofcomplexself-organizingsystemsthattheFEPultimately‚Äòwants‚Äôtobeabout‚Äìsuchasbiologicalself
organizationand,ultimately,brains. However,thisdoesnotmeantheFEPisuselessasmanyofitsassumptionsmaybe
‚Äòapproximately‚Äô,or‚Äòlocally‚Äôtrueoversmallenoughtimeperiods. Thisisnotnecessarilyabadthing‚Äìalmostallofthe
sciencesultimatelyusesimplifiedmodelstotrytounderstandtheirultimateobjectsofstudyinamoretractableway.
TheFEPissimplycontinuingthattradition,butifwedothis,weneedtomakeexplicitthekeydistinctionbetweenthe
modelandtherealityor,morememorably,themapandtheterritory.
ThefirstsetofkeyassumptionsthattheFEPmakescomesthroughthedefinitionofthekindsofstochasticdynamical
systemsthatitworkswith. Specifically,wemakethefollowingassumptionsabouttheformofthedynamicswedeal
with,
‚Ä¢ ThesystemasawholecanbemodelledasaLangevinSDEoftheform dx =f(x)+œâ
dt
‚Ä¢ ThenoiseœâisGaussianwith0meanandacovariancematrix2Œì.
‚Ä¢ Thenoiseisadditivetothedynamics
‚Ä¢ Œìdoesnotchangewithtime
‚Ä¢ Œìhasnostatedependence(noheteroscedasticnoise)
‚Ä¢ Œìisadiagonalmatrix(eachstatedimensionhasindependentnoise)
‚Ä¢ Thedynamicsf(x)donotthemselveschangewithtime.
Wealsomustmakethefollowingassumptionsaboutthesystemasawhole,
‚Ä¢ Thesystemisergodic,whichmeansthatstateandtimeaveragescoincideor,alternatively,thattheremustbe
someprobabilityofultimatelyreachingeverypartofthesystemfromeveryotherpart.
‚Ä¢ The system possesses a well characterized non-equilibrium-steady state density (NESS), which does not
changeovertime
‚Ä¢ OncethesystemreachesthisNESSdensityitcannotescapeit‚Äìthereisnometastabilityormultiplecompeting
attractors. Thisdoesnotmean,however,thattheNESSattractorcannotbecomplexitselfandcancontain
limitcycles.
Theseassumptionssetupthebasicformalismwewishtoconsider. Fromhere,wethenapplytheAodecompositionto
rewritethedynamicsintheformofagradientdescentonthelogofthepotentialfunctionwithdissipativeandsolenoidal
componentsf(x)=(Œì‚àíQ)‚àá lnp‚àó(x). Tobeabletoimplementthisdecompositionrequires,
x
‚Ä¢ Thedynamicsfunctionf besmoothanddifferentiable,
‚Ä¢ Thereexistsasteadystatedistributionp‚àó(x)toserveasthepotentialfunction.
Now,weapplytheMarkovBlanketconditionsattheNESSdensity,
‚Ä¢ The state space x can be partitioned into a set of four states ‚Äì internal i, external e, active a and sen-
sory s which, at the NESS density fulfill the following conditional independence relationships: p‚àó(x) =
p‚àó(e|s,a)p‚àó(i|s,a)p‚àó(s,a).
28
APREPRINT-5THOCTOBER,2021
‚Ä¢ WethusrequireallpartitionstobeatNESS,includingtheexternalstates. Thismeansthattheenvironment
alsohastobeatsteadystate,notjustthesystem.
‚Ä¢ Weoftenassumenosolenoidalcouplingbetweeninternalandsensorystates(internalstatesdonotdirectlyact
onsensorystates‚Äìonlytheexternalstatesdo),norbetweenactiveandexternalstates(activestatesdrivethe
externalstatebutarenotdrivenbyit). MathematicallythiscorrespondstoQ =0,Q =0.
s,i e,a
GiventheMarkovBlanketconditionshold,wecanthenbegintomovetowardsthefreeenergylemma. Tobeginwith,
wemustfirstassume,
‚Ä¢ Thereisauniqueargmaxe,iexistsforbothinternalandexternalstatesforeveryblanketstateb.
‚Ä¢ ThatthereexistsafunctionœÉwhichmapsfromitoe
‚Ä¢ ThatœÉisinvertible
‚Ä¢ ThatœÉisdifferentiable
‚Ä¢ Fortheparticularfreeenergy,weassumethatthevariationalposteriorq(e;e)isequaltothetrueposterior,
andthusthatthetrueposteriorcanberepresentedbyonesufficientstatistic(e).
TheseassumptionsonœÉ arequiterestrictive. Amoredetaileddiscussionofwhattheseassumptionsrequirecanbe
foundinAppendix10.4.1.
Finally,toreachthefreeenergylemma,wemustmakethefollowingassumptions,
‚Ä¢ Thedynamicsofthesufficientstatisticofexternalstatesefollowsthesame(Ao-decomposition)dynamicsas
theexternalstatesthemselves
‚Ä¢ Thevariationaldistributionq(e;e)isaLaplacedistribution(Gaussian)withafixedcovarianceŒ£asafunction
ofe.
‚Ä¢ ThevariationalcovarianceŒ£isnotanimplicitfunctionoftheblanketstates
Thisfirstassumptionhascomeunderheavycontroversy. TheseadditionalassumptionspertaintotheLaplaceapproxi-
mation,butthefinalassumptionhereappearstogobeyondwhatistypicallyrequiredbyvariationalLaplace.
10.2 AssumptionsontheFormoftheLangevinDynamics
TheFEPformulationmakesreasonablystrongassumptionsaboutthenatureofthedynamicsthatitmodels‚Äìrestricting
themtotheformofstochasticdynamicswhichcanbewrittenasaLangevinequationwithadditiveGaussiannoise.While
theassumptionsonthedynamicsfunctionarenotthatstrong,onlyrequiringdifferentiabilityandtime-independence,
therestrictionsonthenoiseinthesystemarequitesevere.
Firstly, it is important to note that using additive white noise, while a common modelling assumption due to its
mathematicalsimplicity,neverthelessimposessomerestrictionsonthekindofsystemsthatcanbemodelled‚Äìespecially
ascomplexselforganizingsystemstypicallyevincesomekindofcoloredsmoothnoise,aswellasoftenpower-law
noisedistributionswhichareassociatedwithself-organizedcriticality(Ovchinnikov,2016).
However, the further assumptions on the Œì covariance matrix ‚Äì that it is diagonal, state-independent, and time-
independent‚Äìarealsostrongadditionalrestrictions. Specifically,thismeansthatthenoisetoeverydimensioninthe
systemiscompletelyindependentofanyotherdimension,andthatthenoiseisconstantateverypointthroughoutthe
statespaceandthroughouttime.
10.2.1 ItovsAovsA-typeinterpretation
A subtle point raised by Manuel Baltieri (private correspondence) is that the formulation of the FEP in K. Friston
(2019b)isinconsistentbetweenaStratonovichandanItointerpretationoftherelevantSDEs. Thishasnoimpactinthe
29
APREPRINT-5THOCTOBER,2021
caseofnon-state-dependentnoise,whenthetwointerpretationscoincide,butcouldpotentiallyimpactgeneralizations
ofthetheorytoincludestatedependentnoise.
10.2.2 ErgodicityandtheAoDecomposition
The Ao decomposition requires both that the dynamics possess a consistent non-equilibrium steady state density
(whichformsthepotentialfunction)andalsothatthedynamicsareergodic. Additionally,thisergodicityassumption
isimplicitlyusedintheBayesianmechanics,whichallowsexpectationsofthesurprisaltobetakenandinterpreted
asentropies,andthustoultimatelyderiveaninterpretationofthedynamicsintermsofaccuracyandcomplexity. In
general,formanybiologicalandself-organizingsystems,ergodicitydoesnotholdandsuchsystemstypicallyexhibit
substantialamountsofpathdependenceandirreversibility. Thismeansthatonastrictreading,formostsystemsthe
FEPdesirestomodel,theergodicityassumptiondoesnothold. However,itmaystillbepossibletodescribeergodicity
as holding ‚Äôlocally‚Äô in the small region of the state space around the NESS density and this may be sufficient for
approximateversionoftheFEPtohold,althoughtheresistanceoftheFEPtoslightperturbationsofitsassumptions
remainsunclear.
10.3 TheMarkovBlanketCondition
10.3.1 FunctionalvsStatisticalConnectivityandtheMarkovBlanketCondition
AsubtleconceptualissuehasbeenrecentlyraisedbyAguileraetal.(2021)astotheprecisemeaningoftheMarkov
blanketconditionforrealsystems. Specifically,intuitivelytheMarkovblanketispresentedasbeingakindofboundary
betweentheinternalandexternalstates,andisoftenpresentedasaliteralboundary‚Äìforinstancethecellwalland
sensoryepitheliaofabacterium,orthesensoryepitheliaofabrainasopposedtoitsexternalenvironment(DaCosta
etal.,2021;K.Friston,2019b;Parr,DaCosta,&Friston,2020). However,thisintuitionsubtlyconflatestwotypes
of connectivity ‚Äì functional connectivity and statistical connectivity. Functional connectivity is the literal causal
connectivityintheworld. Forinstance,toreachtheinsideofabacterialcell,amoleculeontheoutsidemustpass
throughthecellwall. Thisfunctionalindependenceinthiswaycanberepresentedbysparsity(zeroes)inthedynamics
matrix f. of the whole system. Statistical connectivity, on the other hand, is concerned only with the statistical
independenciesbetweenvariablesgiventheblanketstatesandisrepresentedbysparsityintheHessianoftheNESS
density. Importantly,exceptunderveryrestrictiveconditions,ithasbeendemonstratedbyAguileraetal.(2021)that
these two senses of connectivity are independent of one another ‚Äì in that statistical independence does not imply
functionalseparationandviceversa.
Toseewhythisisthecase,imaginethecaseofwatermoleculesosmosingintothebacterialcell. Here,weassume,
there is no functional direct functional connection between inside and outside the cell wall ‚Äì i.e. water molecules
cannot‚Äòteleport‚Äôfromoutsidethebacteriumdirectlyintoit. However,throughthisprocessofosmosis,theinternaland
externalstatesslowlybecomecorrelatedwitheachother,astheconcentrationsofwatermoleculesonbothsidesof
theboundaryequalize,thusimplyinginthiscasethatafunctionalseparationdoesnotnecessarilyimplyastatistical
separation. Conversely, imaginetakingthedensitiesoftwoadjacentpatchesofgasasourvariables. Ifthisgasis
atthermodynamicequilibrium,thenthedensityinthetwopatcheswillbe,onaveragethesame,howeveranytiny
fluctuations in density will be purely random and uncorrelated. Thus, even though these adjacent patches have a
functionalconnection(moleculescandirectlymovefromonepatchtoanother),theylackastatisticalconnection.
AnimportantnoteisthatwhiletheFEPgenerallybasesitsintuitionsabouttheMarkovBlanketinfunctionalterms,the
actualmathematicaldefinitionispurelystatistical. Thiscanleadtoconfusionaboutwhatarethekindsofsystemsthat
theFEPactuallymodelsandthedynamicstheyhave.
Ingeneralfunctionalconnectivityexpresslyprecludesstatisticalindependencebecause,foranynoiseinthesystem,
aslongasthereissomecausalpathbetweentwoelements,eveniftheyareseparatedbyablanketstates,noisewill
propagatethroughthesystemandthusinternalandexternalwilltendtobecomecorrelatedwithoneanother. Indeed,
30
APREPRINT-5THOCTOBER,2021
thisdevelopmentofcorrelationsovertimebetweeninternalandexternalstatesintheabsenceoffunctionalconnectivity
ispreciselywhatweintuitivelymeanwhenwethinkaboutsystems‚Äòaccumulatingknowledge‚Äôabouttheirenvironments,
andthusseemsimportantforquestionsabouthowsystemscanlearntomodel,predict,andinfervariousfactsaboutthe
externalworld.
However,asoriginallynotedbyMartinBiehlinprivatediscussion,theMarkovBlanketconditionappearstoexplicitly
precludethiskindofknowledgeaccumulationinsidetheinternalstates,requiringthatallknowledgebeheldinthe
blanketstates. ItmayindeedturnouttobethecasethatdefiningMarkovBlanketsintheintuitivesenseintermsof
functionalindependenciesinsteadofstatisticalindependenciesmayleadtoabetterdescriptionofpreciselythekindsof
knowledgeaccumulatingprocessesthatappeartobeimportantinperforminginference.
10.3.2 TheRealConstraintsonSolenoidalCoupling?
WhiletheMarkovblanketconditionsonlyexplicitlydisallowsolenoidalcouplingdirectlybetweentheinternaland
externalstates‚ÄìQ = 0,thefreeenergylemmaasstatedinEquation27appearstorequireasignificantlygreater
i,e
reductionofsolenoidalcoupling. Specifically,thefreeenergylemmarequiresthat,forastraightforwardidentification
ofthesurprisalwiththefreeenergy,thattheformofthedynamicsforeachmarginalsubsetofstatesinthepartition
takethesameformasthedynamicsofthefullsetofstatesx. Specifically,thismeansthatallsolenoidalcoupling
betweenthesubsetsmustbesuppressed, sinceiftheywerenotthen, bythemarginalflowlemma, therewouldbe
additionalsolenoidalcouplingtermsinEquation27,whichwouldcomplicatetherelationtoFree-energyminimization
withadditionalsolenoidalterms. Assuch,forthefreeenergylemma,ascurrentlypresented,weappeartohavethe
extremelystrongconditionofthediagonalityofQ,whereeachsubsetintheMarkovBlanketisonlyallowedsolenoidal
interactionswithitself.
It is important to note that this restriction is significantly stronger than those required just by the Markov Blanket
condition,andindeedisstrongereventhantheflowconstraintsproposedinK.Friston,DaCosta,andParr(2020).
WhilethisdoesnotentirelyruleoutanyinteractionsbetweendifferentsubsetsoftheMarkovblanket,itdoesmean
thatallinteractionshavetobemediatedthroughthegradientterm,sinceboththeŒìandQmatricesareassumedtobe
diagonal.
However,itisimportanttonotethatifthesestringentimplicitassumptionsonsolenoidalcouplinginEquation27were
relaxed,therewouldbeadditionalsolenoidalcouplingtermsintheequation. However,thesetermswouldbeorthogonal
tothegradientofthefreeenergy,andthusnotmateriallyimpacttheultimateminimumofthedescent,althoughthey
wouldalterthedynamicsofactuallyreachingtheminimumsignificantly. Specifically,thismeansthattheFEPwould
insteadpredictasolenoidal‚Äòswirling‚Äôkindofgradientdescentinsteadofadirectsteepestdescentforsystemswith
significantsolenoidalcouplings.
10.4 AssumptionsoftheFree-EnergyLemma
10.4.1 TheœÉfunction
TheexistenceandgeneralpropertiesoftheœÉfunctionhavealsodrawnmuchcontroversyfromwithinthecommunity.
Specifically,itisnotatallclearthatthisfunctionexistsinthegeneralcase,forarbitrarydynamicsfunctionsf and
conditional NESS distributions p‚àó(e|b) and p‚àó(i|b). In later papers it is assumed to exist under the condition of
injectivitybetweeneandi. Ineffect,thismeansthattheremustbeauniquemappingbetweeneandiforallblanket
states‚Äìi.e. thatforeveryblanketstate,iftheargmaxoftheinternalstatesisi,thentheargmaxoftheexternalstates
mustbee. Additionally,theremustbeacorresponding(andseparate)externalargmaxforeveryinternalargmax. There
may,however,besomeexternalargmaxeswithnocorrespondinginternalargmaxes(althoughtheconversecondition
doesnothold). Thisrequiresthatthedimensionalityoftheexternalstatesbutgreaterthanorequaltothedimensinoality
oftheinternalstates‚Äìwhichshouldgenerallyholdformostreasonablesystemswherewecansafelyassumethatthe
environmentislargerthanthesystemitself. hisinjectivityconditionalsoguaranteesinvertibilityinthecasethatthe
31
APREPRINT-5THOCTOBER,2021
internalandexternalstatespacesareofthesamedimension. ItisalsopossibletousetheMoore-Penrosepseudoinverse
forthecasewheretheexternalstatespaceislarger,atthecostofthefreeenergylemmabecomingapproximateinstead
ofexact.
ThedifferentiabilityoftheœÉfunctionisamorestringentcondition. Inmanycasesthisisunlikelytobemet,sincethe
argmaxfunctionswhichtheœÉfunctionmapsbetweenaregenerallynondifferentiable. Itremainsuncleartowhatextent
differentiableœÉfunctionscanexistinsystemsofinterest.
However,itcanbestraightforwardlyshownthatinthesimplecaseoflinearOUprocesses,thatboththeœÉfunction
existsandthatitisanalyticallycalculable(Aguileraetal.,2021;DaCostaetal.,2021). Moreover,inthegeneralcase,it
ispossibletoobtainanapproximateœÉfunctionbyrunningaregressionbetweentheinternalandexternalmodeswhich
isoftenwhatisdoneinpracticefornonlinearsystems(K.Friston,2013).
10.4.2 TheDynamicsoftheSufficientStatisticse
Anadditionalimportantassumptionnecessaryforthefreeenergylemma,isthatthedynamicsofthesufficientstatistics
oftheexternalmodefollowthesamedynamicsastheexternalstatesgenerally‚ÄìseeEquation25. Thisassumptionturns
outtobecrucialtothefreeenergylemmawhichreliesheavilyinthefactthatthedynamicsofthesufficientstatistice
canbewrittenasagradientdescentonthelogsurprisal‚Äìwhichcanthenbeexpressedintermsofafreeenergyunder
theLaplaceapproximation.
Thisassumptionisalsoproblematicandhasbeenthesourceofcontroversywithinthecommunity. Theextenttowhich
thisassumptionisjustifiedremainsunclear. Specifically,itappearstoruleouttheuseofarbitraryfunctionsŒæ(tobe
discussedinthenextsection)toparametrizetheexternalsufficientstatistic(althoughnottheinternalsufficientstatistic).
Theassumptioneffectivelyholdstotheextenttowhichonecandescribethesufficientstatisticasequaltosomeexternal
statee(b)‚âàe,whichmayoccuroftenfortheargmaxbutnotnecessarilyalways. Itremainstobeseenwhetherthe
argmaxisinfacttheoptimalsuchfunction‚Äìwhichisdependentontheblanket,butwhichcanidentifyaconsistenteto
identifywithandthuspartakeinthesamedynamics.
Interestingly,onecanalsodirectlycomputethedynamicsofthesufficientstatisticethroughthechainruleintermsof
thedynamicsoftheblanketstates,whichdofollowtheAodecomposition. Ifwedothis,weobtain,
‚àÇe(b)db
eÀô(b)=
‚àÇb dt
‚àÇe(b)
= (Q ‚àíŒì )‚àá lnp‚àó(i,s,a)
‚àÇb bb bb b
whichissignificantlydifferentfromtherequireddynamicsasitisagradientdescentontheblanketstatesbratherthan
themostlikelyexternalstate. Itisunclearunderwhatconditionsweshouldexpectthesedynamicstocoincide.
10.4.3 InterpretationofBayesianInferenceLemmaintermsofAverageFlows
AnalternativeinterpretationoftheBayesianinferencelemma,whichsolvessomeoftheissuesraisedintheprevious
section,whilecreatingothers,isthatinsteadofinterpretingtheFEPasastatementaboutthedynamicsoftheaverage
(sinceforGaussiansystemsthemodeandtheaveragecoincide)butratherasastatementabouttheaverageofthe
dynamics. Onthisview,themostlikelystatedoesperformagradientdescentonthefreeenergy,butratherthestatesof
thesystem,onaverage,performagradientdescent,oratleastthattheinstantaneousflowofthesysteis,onaverage,
pointedinthedirectionofthefreeenergygradient. Thissecondinterpretationishintedatin(K.Friston,DaCosta,&
Parr,2020)andhasbeendevelopedmoreformallyinprivatecorrespondence,aswellasanalysedindetailinAguilera
etal.(2021). Thegeneralresultisthatwhilethisnewinterpretationsolvestheissueofassumingunrealisticdynamics
fore,itraisestwonewissues.
Thefirst,moretechnical,concernstheœÉfunctionwhichmustnowberedefinedtobeamappingbetweentheaverage
flows,ratherthanbetweenthemodesoftheinternalandexternalstates. Again,thiscanbeachievedinlinearGaussian
32
APREPRINT-5THOCTOBER,2021
systemswhereananalyticalsolutioncanbefound,butinmorecomplexscenariostheexistenceanduniquenessofsuch
amappingcannotbeguaranteed. Asecond,morephilosophicalissueconcernswhatthisstatementabouttheaverage
dynamicsmeans. Specifically,theFEPcannolongerbetakentoofferevenaninterpretationofthedynamicsofany
specificsystem. Itcaninsteadonlyofferaninterpretationoftheaveragebehaviouroversomecounterfactualensemble
ofpossiblesystems. Moreover,theaveragedynamicsandtheactuallyrealizeddynamicscandivergequitestronglyin
realsystems,andcanevendivergeforGaussianlinearsystems,asdemonstratedby(Aguileraetal.,2021). Sometimes,
evenifatheoryonlydealsinstatisticalaverages,itcanbehighlyfruitfulscientifically. Forinstance,thetheoryof
evolutiononlyevermakesstatementsabouttheaveragechangesinpopulations,notaboutthebehaviourofanyspecific
individual. However,itisunclearatpresentwhethertherevisedFEPsstatementthat,onaverage,thedynamicsof
asystemtendtowardsasolenoidalgradientflowontheNESSdensityforthatsystemandthus,onaverage,tendto
minimizevariationalfreeenergy,issimilarlyscientificallyfruitful.
10.4.4 PotentialandOptimalŒæFunctions
A further interesting question concerns the degree to which it is necessary to define the sufficient statistics e and
ithroughtheargmaxovertheconditionaldistributionovertheexternalorinternalstatesgiventheblanket. While
theassumptionthatthedynamicsofeequalthedyanmicsofemayimposesomeconstraintsforthisfunctionfore,
there areno suchconstraints inthe definition of i(b), so wecould, intheory usean arbitrary functioni(b) = Œæ(b)
insteadoftheargmax. Indeed,wemightdesiretomakethisfunctioncontainasmuchinformationaspossibleabout
thetrueconditionaldistributionoftheinternalstatesgiventheexternalstates,sothatwhentheœÉfunctionmapsthis
to the sufficient statistic of the external density it can be seen as performing inference with the most information
possiblebetweentheexternalandinternalstates. AnadditionalbenefitofdefininganarbitraryfunctionforŒæinsteadof
usingŒæ(b)=argmaxp(i|b)isthatwecanmakeŒædifferentiable,whichalleviatesmuchofthedifficultyofmakingœÉ
differentiableaswell.
Whilethisapproachbringsmanybenefits,italsohasthedrawbackofthenecessitytochooseasuitablefunctionŒæ
whichintroducesanotherdegreeoffreedomintothemodellingprocess. Onepossibleconditionisthatwecouldchose
theoptimalŒætobetheonethatcontainsthemostinformationabouttheinternalstateor,alternativelyminimizestheKL
betweentheapproximateconditionaldistributionovertheinternalstatesparametrizedvyŒæandthetrueconditional
overtheblanketstates. Thatis,wecoulddefine,
Œæ‚àó =argminD [q(i;Œæ(b))||p(i|b)]
KL
Œæ
ThiswouldreducethenumberofdegreesoffreedomofŒæ andprovideavalidmodellingtarget,althoughtheactual
computabilityofthisminimizationprocessispotentiallyaproblem,asiswhetherthisobjectiveisactuallyoptimal.
Nevertheless, theuseofanarbitraryŒæ functionforthesufficientstatisticsoftheinternalstatesmayyetresolveor
amelioratesomeofthedifficultieswiththefreeenergylemma,andisaninterestinginroadtobeginunderstanding
variousrelaxationsorextensionstothecurrentincarnationofthefreeenergyprinciple.
10.4.5 FEPasalocallyvalidtheory
Overall,wehaveseenthatthederivationoftheFEPrequiresmanyfairlyrestrictiveassumptions‚Äìfirstintheformulation
of the kinds of systems that the FEP applies to (autonomous Langevin equations with state-independent diagonal
additivewhiteGaussiannoise), andsecondlyintheformulationofthefreeenergylemma(nosolenoidalcoupling
betweensubsets,existenceanddifferentiabilityoftheœÉfunction,thedynamicsofebeingthesameasthedynamicsof
e),aswellas
Beyondthepurelytechnicalconsiderationsoutlinedabove,therearealsocrucial,andmoreintuitiveissueswhicharise
inthemodellingofbiologicalsystemsorindeedcomplexself-organizingsystemsaretheassumptionsofergodicity
andtheNESSdensityincludingtheenvironmentalstates. Bothoftheseassumptions,whentakenliterally,arealmost
33
APREPRINT-5THOCTOBER,2021
alwaysfalse. Mostinterestingsystemswhichself-organizeare,almosttautologically,non-ergodic,inthattheyexhibita
highdegreeofpath-dependenceandnevercomeclosetoexploringtheirfullstatespace. Secondly,therequirementthat
allsubsetsofthemarkovblanketandthesystembeatnon-equilibriumsteadystaterequiresthattheexternalstates,
whicharetypicallytakentobetheenvironmentalsobeatsteadystatefortheFEPtoapply. Thisconditionintuitively
doesnotintuitivelyholdforgeneralcasesofbioticselforganization. Forinstance,wetypicallyconsiderthesystemas
maintainingitselfinsteadystateagainstenvironmentalfluctuations,notthattheenvironmentitselfisdefinedtobein
steadystatewithus. Inthemostobviouscasewherewedefinetheenvironmenttobethewholeuniverseoutsideofthe
system,thisisdefinitelyfalse. Ifwetakeamorelocalapproachanddefinetheenvironmenttobesomesmall‚Äòbubble‚Äô
aroundthesystem,andthensimplymodeltherestoftheuniverseasGaussianfluctuationsimpingingonthisbubble,
thenthisassumptionmaybetenableinsomecases,butitneverthelessfailstomatchourintuitionsaboutrealbiological
systems‚Äìsuchasanimals. Forinstance,itmaybethecasethatmy(human)bodylargelymaintainsitsownhomeostatic
steadystateagainstexternalfluctuations,howeveritisdefinitelynotthecasethatmyenvironmentitselfisatsteady
stateatalltimes‚ÄìforinstanceIcangetupandgoforawalk,orflyaroundtheworldforaconference‚Äìandnoneofthis
shoulddisrupttheinternalhomeostaticsteadystateofmybody. ThisistherealquestionwhichiswhattheFEPtries(at
leastinitsintuitivesalespitch)toanswer‚ÄìhowcanImaintainaninternalsteadystateagainstanenvironmentwhichis
notatsteadystate. Byassumingthattheexternalstatesarealsoatthesteadystate,itmaybethattheFEPis,insome
sense,answeringthewrongquestionandis,intheprocess,assumingawaythetruedifficultyinansweringtherightone.
Ingeneral,oneresponsetothesegeneralissuesistoarguethattheassumptionsoftheFEPdonotneedtoholdglobally
onlylocallyoversomerelevanttimescale,whichisafairpoint. ThisideaoftheFEPasatheorywhichonlyholds
locallyisvalid(althoughitstillneedstobeempiricallyormathematicallyshownwhethersuchassumptionssuchas
environmentalsteadystateandergodicitydoinfactholdlocallyoverrelevanttimescales),andhascloseanalogies
in mathematics and physics where, for instance, linearity assumptions are often used which are only actually true
intheinfintesimallimit. Ingeneral,itislikelythat,infact,theFEPis,inthissense,alocaltheory,andshouldbe
thoughtofassuch. Thislocalityshouldtheninformmodellingwork,aswellasspurnewtheoreticaladvancesastothe
rangeofconditionsoverwhichtheFEPisvalid. Understandingandpreciselyquantifyingthelimitationsandregionof
applicabilityofthetheoryisultimatelyvitalforobtainingtrueunderstanding,andisaveryimportantareaforfuture
empiricalworkwithintheFEPparadigm.
11 MathematicalAppendices
11.1 HelmholtzDecompositionatSteadyState
ItisstraightforwardtoverifythattheHelmholtzdecompositionofthedynamicssatisfiesthesteadystatecondition
dp‚àó(X)
=0bypluggingthisformintotheFokker-Planckequation(Equation2),
dt
dp‚àó(x)
=‚àí‚àá (cid:2) (Œì‚àíQ)‚àá lnp‚àó(x) (cid:3) p‚àó(x)+Œì‚àá2p‚àó(x)
dt x x x
=‚àí‚àá (cid:2) (Œì‚àíQ) ‚àá x p‚àó(x)(cid:3) p‚àó(x)+Œì‚àá2p‚àó(x)
x p‚àó(x) x
=‚àí‚àá (cid:2) (Œì‚àíQ)‚àá p‚àó(x) (cid:3) +Œì‚àá2p‚àó(x)
x x x
=‚àíŒì‚àá2p‚àó(x)+‚àá Q‚àá p‚àó(x)+Œì‚àá2p‚àó(x)
x x x x
=‚àá Q‚àá p‚àó(x)=0 (33)
x x
Wherethelastlinefollowsbecause,bydefinition,thegradientofthesolenoidalflowwithrespecttothegradientofthe
logdensityis0,sincethesolenoidalflowmustbeorthogonaltothegradientofthedensity,whichisrepresentedbythe
solenoidalQmatrixbeingantisymmetricQ=‚àíQT.
34