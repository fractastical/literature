SOME MINIMAL NOTES ON NOTATION AND MINIMA:
A COMMENT ON “HOW PARTICULAR IS THE PHYSICS OF THE
FREE ENERGY PRINCIPLE?” BY AGUILERA, MILLIDGE,
TSCHANTZ, AND BUCKLEY
MAXWELL J D RAMSTEAD AND DALTON A R SAKTHIVADIVEL
Abstract. We comment on a technical critique of the free energy principle in linear
systems by Aguilera, Millidge, Tschantz, and Buckley, entitled “How Particular is the
Physics of the Free Energy Principle?” Aguilera and colleagues identify an ambiguity in
theflowofthemodeofasystem,andwediscussthecontextforthisambiguityinearlier
papers,andtheirproposalofamoreadequateinterpretationoftheseequations. Following
that, we discuss a misinterpretation in their treatment of surprisal and variational free
energy, especially with respect to their gradients and their minima. In sum, we argue
that the results in the target paper are accurate and stand up to rigorous scrutiny; we
also highlight that they, nonetheless, do not undermine the FEP.
1. Preliminary remarks
We are delighted to comment on the interesting technical critique of the free energy
principle (FEP) by Aguilera, Millidge, Tschantz, and Buckley. This critique is noteworthy
for several reasons. Amongst them are the technical rigour and astuteness of the work
done, for which [AMTB22] is distinct in the literature. We are especially pleased to see
that the paper has provoked a dialogue which is both friendly and productive. Indeed,
although we disagree with some aspects of the critique, we contend that, in the years
since the paper was originally circulated as a preprint, our collective understanding of the
core formalism and scope of the FEP has increased significantly—in no small part due to
the conversations fostered by this critique. The community as a whole has undoubtedly
benefited from this exchange, and we are grateful to have been part of it.
In [AMTB22], the authors present a detailed and rigorous analysis of the free energy
principle. Inthiscomment,wefocusontwoofthepointsmadein[AMTB22]: oneregarding
marginal flows and their average, the other, regarding surprisal and variational free energy
gradients, and their minima. We argue that, whilst the results in the target paper are
accurate and stand up to rigorous scrutiny, they do not undermine the FEP. Lastly, we
note that this was clearly by design: the work in the target paper was never meant to
undermine the FEP. Rather, it was meant to test its applicability to—and informativeness
about—linear systems.
2. Flows of averages and averages of flows
Many of the core papers in the FEP literature (seem to) equate the average flow of a
system to the flow of the average. It is certainly true that the average of the flow does not
Date: 29th April 2022.
1
2202
rpA
82
]hcem-tats.tam-dnoc[
1v67531.4022:viXra
2 MAXWELLJDRAMSTEADANDDALTONARSAKTHIVADIVEL
equal the flow of the average in general; nor even is this true generically. The authors are
absolutely correct when they make this point. It is likely this error can be traced back to
an unfortunate notational choice in [PDCF20], where equation 3.5 therein reads
η˙(b) = (Q−Γ)∇I(η,b).
This equation ought to have been written
(1) (cid:104)η˙(b )(cid:105) = (Q−Γ)∇I(η ,b ),
t t t
with (cid:104)···(cid:105) denoting an expectation. The given decomposition of the flow is the determ-
inistic component of a stochastic differential equation, arising from an averaging over the
randomfluctuationsintheSDEperturbingitsflow. Thatis, ourequation(1)expresses(in
clearer notation) the observation that the flow of the expected external state is predicated
on the current blanket state and expected external state at a given time-point, and drifts
based on the gradient of the surprisal of those variables, as calculated at that time point.
Thatispreciselywhatis claimedintheFEP:thattheflowofthemodeisonaveragethe
drift component of an SDE for that flow. What is labelled as Assumption 3* in the target
paper is not assumed by the FEP. Our equation (1), which denotes equation 3.5 (ibid.)
more properly, makes it apparent that one cannot read the flow operator as commuting
with the expectation operator, which undermines Assumption 3* as a valid interpretation
of the FEP.
This should not, however, be construed as a mistake on the part of the authors. On
the contrary, the authors reproduce the intended definition of marginal flow in [PDCF20],
which they label Assumption 3**. The point of critique raised here is only that their
initial claim about the flow of the average and average of the flow in Assumption 3* is a
non sequitur.
To summarise, the results of the target paper show that it would be nonsensical to
interprettheFEPasassertingAssumption3*,asitwouldleadtoincorrectresults. Luckily,
theFEPdoesnotdependonthisassumption—despite,perhaps,beingmisleadinglywritten
in some places. This is a purpose the critique serves decidedly well. It demonstrates rather
clearly some pitfalls in the FEP literature, especially in the way it has been written in
some core papers, and thus, the way it must not be read.
Finally, since their analysis is predicated on Assumption 3** as though in retrospect,
other results are independent of these statements.
3. Gradients of surprisal and gradients of free energy
The mishandling the definition of marginal flows in [PDCF20] touches indirectly on a
second issue in the claims of the target paper, which we do take to be mistaken—namely,
that the gradient of free energy ought to be informative about the average flow of external
states, present in equation A9 of [AMTB22].
It is obvious that these gradients exist in different spaces—hence the dual information
geometry spoken of in [Fri19]—but to the authors’ credit, their argument is more subtle:
the two gradients are linearly related when σ is a linear function. However, here we note
that linear transformations do not in general preserve the shape of a vector field, nor the
shape of flows in that field. They simply map an identity element to an identity element.
In particular, it is claimed in the target paper that when σ acts linearly on the gradient of
surprisal, it maps this vector field to the gradient of free energy linearly, and so we should
be able to understand external states as flowing along the gradient of free energy just as
SOME MINIMAL NOTES ON NOTATION AND MINIMA 3
well as along the gradient of surprisal. In fact, it is only the case that these vector fields
share a minimum given by σ, and not that they reach those minima at the same time, nor
for the same states.
One can imagine a relatively simple counterexample to the foregoing statement that the
gradient flow of one quantity is meaningful to a quantity which exhibits a linearly related
gradient flow. Take, for instance, the planar vector fields X = (−x,−y) and Y = (y,−x),
and the following linear transformation T relating them:
(cid:34) cos 1π −sin 1π (cid:35)(cid:34) −x (cid:35) (cid:34) y (cid:35)
2 2
= .
sin 1π cos 1π −y −x
2 2
We certainly have X = (0,0) and Y = (0,0), and indeed, T(0,0) = (0,0). Hence,
(0,0) (0,0)
the zero point of Y is the zero point of Y. However, the two gradients are very different,
and their integral curves—the flows in that gradient—will also be quite different. This is
not even to mention that when T is non-linear—even an affine map, a linear map with a
constant shift, will do—their minima will often occur at different states.
In point of fact, exactly one such counterexample appears in the target paper: it is
demonstrated that the gradient of F(η,b) does not resemble the gradient of I(η,b). Once
again the authors are absolutely correct, but do not adequately connect their objection to
the FEP. It is true, as they claim, that equating the two cannot be done; but nowhere does
the FEP claim it can be done, nor does the FEP expect to draw insights from doing so.
What the line of reasoning that the authors took would allow us to say is that η flows
on ∇ I(η,b) whilst the linear transformation of the flow of η, here ∇σ−1(η), flows on
η
∇ I(σ(µ),b). This is equivalent to the existence of a relation
µ
(2) (∇ σ)−1∇ I(σ(µ),b) = ∇ I(η,b)
µ µ η
between the two flows, which can indeed be produced by a simple application of the chain
rule and σ(µ) = η. Equation (2) tells us that the flows in these vector fields are linearly
related, but are emphatically not identical. Respecting (2), the relation between flows
holds in the same general sense as T(x,y) = (x(cid:48),y(cid:48)) for arbitrary pairs of vectors—not just
zero points—but, it is concomitant on not equating one to the other at any point other
than the zero point. Correspondingly, we note that η under the linear transformation σ−1
is µ, and that
∇ I(σ(µ),b) = ∇ F(µ,b),
µ µ
recovering the equations in [PDCF20] and illuminating the claim that
∇ F(µ,b) (cid:54)= ∇ I(η,b)
µ η
in [AMTB22]. The proper application of the synchronisation map σ is known to generate
the desired vector fields and flows, and in particular, relates the flow of µ on the surprisal
∇ I(σ(µ),b) to a flow on the particular free energy ∇ F(µ,b), seen in [DCFHP21].
µ µ
As such, the FEP says nothing of free energy over external states, and avoids doing
so by design. Here we arrive at an important critical remark: more generally, the FEP
says nothing about whether systems actually do really minimise free energy gradients, or
whether we can merely describe them as such; nor whether systems minimise their free
energy, as opposed to merely tending towards a free energy minimum, and thus admitting
an equivalent model of minimal free energy.
In closing, we are grateful to have been able to comment on this paper. We believe that
the ensuing exchange will be part of a new, productive phase of development for the FEP.
4 MAXWELLJDRAMSTEADANDDALTONARSAKTHIVADIVEL
Consistent with the aim of the target paper, asking difficult technical questions of the FEP
and searching for the answers is always a fruitful scientific exchange.
References
[AMTB22] Miguel Aguilera, Beren Millidge, Alexander Tschantz, and Christopher L Buckley. How par-
ticular is the physics of the free energy principle? Physics of Life Reviews, 40:24–50, 2022.
[DCFHP21] LancelotDaCosta,KarlJFriston,ConorHeins,andGrigoriosAPavliotis.Bayesianmechanics
for stationary processes. Proceedings of the Royal Society A, 477(2256):20210518, 2021.
[Fri19] KarlJFriston.Afreeenergyprincipleforaparticularphysics.2019.PreprintarXiv:1906.10184.
[PDCF20] Thomas Parr, Lancelot Da Costa, and Karl J Friston. Markov blankets, information geo-
metry and stochastic thermodynamics. Philosophical Transactions of the Royal Society A,
378(2164):20190159, 2020.
Wellcome Centre for Human Neuroimaging, University College London, London WC1N
3AR, UK
VERSES Research Lab and Spatial Web Foundation, Los Angeles, CA, USA, 90016
Email address: maxwell.ramstead@verses.io
Department of Mathematics, Department of Physics and Astronomy, Stony Brook Uni-
versity, Stony Brook, NY, USA, 11794-3651
VERSES Research Lab and Spatial Web Foundation, Los Angeles, CA, USA, 90016
Email address: dalton.sakthivadivel@stonybrook.edu
URL: https://darsakthi.github.io