Hamilton's Principle for a Hydromagnetic 
Fluid with a Free Boundary 
by 
R. L. Dewar 
Plasma Physics Laboratory, Princeton University 
Princeton, New Jersey 08540 
ABST ACT 
Newcomb's nonlinear fo mulation of Hamilton's 
principle for an ideal hydromagnetic fluid sur­
rounded by a wall is generalized to allow vacuum 
and ferromagnetic regions, anc to include the 
effects of external conductors and circuits. The 
linear approximation is recovered by expanding to 
second order in the plasma displacement, when the 
accumulated charge flowing in each conductor is 
treated as a generalized variable, the vacuum energy 
appears as a kinetic energy, with the inductance matrix 
appearing in the role of a mass tensor. A subsidiary 
variational principle is used to determine the 
inductance matrix, thus providing an alternative to 
the Green's function method. 
& 
DISTRIBUTION Or THIS OOCUMENT IS UNLIMITED 
i _ - NOTICE-
| Hili npon toj onotirA . I 
Ulttd feu ».,™t i^"™"™"'^"*' 
a»», w v crSL^', s'"" l*i»™»™ rf 
-2-
1. INTRODUCTION 
The analytic theory of hydromagnetic stability is largely 
based on the energy principle of Bernstein, et al., [1] which 
uses the potential energy functional <5W . Recently, [2,3] 
considerable success has also been had in finding the spectrum 
of small oscillations of a toroidal plasma numerically, using 
the Rayleigh-Ritz-Galerkin method [4j. These codes also use 
the potential energy 6W , but combined with the kinetic energy 
to form the Lagrangian for the system. The Lagrangian formula­
tion is also useful for the general proof of self adjointness 
of the force operator in SW , C5] and for nonlinear problems 
116,7]. 
In practice C2], it has been found inconvenient to use 
the vector potential form CI] for the perturbed magnetic field 
b in the vacuum region. Rather, a formulation of 6W due to 
Lust and Martenson [8], based on work by Blank, Friedrichs, 
and Crad C9] has been used instead. In this formulation, b is 
represented as the gradient of a single-valued scalar potential 
X , plus subsidiary fields proportional to the perturbed currents 
ik in the various conductors. Both X and the i^ are constrained 
to be unique functionals of the displacement of the plasma-
vacuum interface, and are typically C2] constructed by Green's 
function techniques. 
A problem with the Green's function method is that the 
singular nature of the Green's function makes the required 
-3-
numerical integrations rather difficult. In this paper we 
present an alternative, fully variational method, which allows 
a Galerkin method to be used to calculate the vacuum contribu­
tions, thus avoiding the integrals over singular functions 
encountered in the Green's function method. 
A second advantage of the new formulation is that the 
currents ik are generalized variables in their own right, and 
can be constrained or subjected to generalized forces. That is, 
we can incorporate constraints carded by the interconnection of 
the field coils, and include the effect of external circuits. 
To commence with maximum generality we proceed from Newcomb's 
fully nonlinear IT 113 Lagrangian for the ideal hydromagnetic 
equations, extending it to include a nonconducting region sur­
rounding the plasma. This can include a ferromagnetic region, 
(u >> u ) but no specific consideration will be given to the 
effect of such a region and we shall refer to the whole region 
as the vacuum. We assume the plasma to be topologically 
toroidal wherever the specific geometry is important. A "general 
purpose" toroidal configuration is depicted in Fig. 1, which 
shows a plasma and an arbitrary number of poloidal field coils 
enclosed within a conducting "wall." To consider the behavior 
of a plasma in the absence of a stabilizing shell we can remove 
three sides of our "wall" to infinity, leaving just a rod 
running down the major toroidal axis. Such a conductor is 
always necessary to maintain the toroidal field, so there is 
always a notional wall present. 
_4-
The extension of Newcomb's variational principle [11] is 
done thiough two devices. One is the addition of a new kinetic 
energy term corresponding to the energy in the various electrical 
circuits contributing to the vscuun field, while the second is 
the adjoining of a subsidiary variational principle to calculate 
the inductance matrix as a functional of the positions of the 
external conductors and of the plasma. 
In Section 2 we review the basic equations for the plasma 
J 
and magnetic field as discussed by previous authors, whereas in 
Section 3 we discuss the role of the electric fields associated 
with insulating gaps in the conductors in more detail than has 
previously been done in the magnetohydrodynamic literature. 
The electric circuit equations involve an inductance matrix, 
a fully nonlinear variational principle for which is given in 
Section 4. In Section 5 this principle is used to expand the 
inductance matrix in powers of the displacement of the plasma-
vacuum interface. The fully nonlinear Lagrangian including the 
electrical kinetic energy is presented in Section 6, and expanded 
in powers of the plasma displacement in Section 7. 
The perturbation expansions in Sections 5 and 7 are performed 
using a novel technique, involving differentiation with respect 
to the expansion parameter, which allows us to retain familiar 
Eulerian expressions. 
In Section 8, we indicate how the new methods avoid the 
singularity problems encountered in the Green's function method. 
-5-
Finally, in Section 9 we sketch out the types of problems 
which can be treated using the flexibility inherent in the new 
approach to the vacuum Lagrangian. 
2. BASIC EQUATIONS (PLASMA AND MAGNETIC) 
The ideal hydromagnetic equations for the IT ass density p , 
pressure p , magnetic induction B , and velocity v are [1,11] 
It = ~p!'Y ' (1) 
a? - -™i-i > (2) 
dB 
ar = 5'!Y - ?Y*Y » (3) 
dv / 2 \ B'VB 
(4) 
where u is the permeability of free space (SI units). We 
have assumed the gravitational potential to be negligible. 
These equations apply within the region P occupied by plasma. 
On the plasma-vacuum interface S , the physical require­
ment that all. accelerations be finite gives the dynamical 
-6-
boundary condition that the component of the stress tensor in 
the direction normal to S must be continuous. That is, [1] 
P 
Bf/2nQ + p = B^/2po ; xeSp , (5) 
where B_ and B+ are respectively the field values measured just 
inside and just outside the plasma. The magnetic field in the 
plasma, B_ , is assumed to be tangential to the interface 
initially, and therefore at all later times because of Eq. (3). 
Because n«B is continuous across any surface, B must also be 
tangential to S . The equation 
V«B = 0 (6) 
applies everywhere. Within the nonconducting region V surround­
ing the plasma the low-frequency equation 
V x H = 0 ; xeV , (7) 
must also apply, where H is the magnetic intensity. Assuming 
linearity, B and H are related by 
B = pH , (8) 
where y(x) is the permeability of the insulating medium. This 
formulation allows for the possibility of including the effect 
of an iron-cored transformer in a shell-less tokamak, modeling 
the iron as a linear magnetic medium with y >> y 
In order to determine B in V we must also give boundary 
conditions on the surfaces of any conductors external to the 
plasma (see Fig. 1). In the spirit of ideal hydromagnetics 
we take these conductors to be perfectly conducting, so that an 
appropriate boundary condition on S. , the surface of the k'th 
conductor, is 
n«B = 0 ; xeS, , (9) 
where n is the unit normal at x , directed into V . As mentioned 
previously, Eq. (9) applies also on the plasma surface (k = p) , 
and also on the "wall" (k = w) . 
Because V is not a simply connected region Q?,9D, we must 
supplement the boundary condition, Eq. (9), with the line 
integral conditions 
/ R'&l = Ik ; k = 1, 2, 3, ... N + 2 , (10) 
(Ampere's law) where N is the number of conductors external 
to the plasma, excluding the wall. Thus, k = N + 1 is 
-8-
eguivalent to k = w and k = N + 2 is equivalent to k = p . The 
line integral in Eq. (10) is taken around a path C. , enclosing 
only the k'th conductor, and running in the right hand sense 
with respect to the direction in which the current I. in that 
conductor is measured. The plasma is here regarded as a 
toroidal conductor; that is, I is the toroidal plasma current. 
On the other hand, I denotes the total poloidal current flow­
ing on the wall. The contour C for the wall is a loop 
encircling the major axis between the plasma and the wall. These 
contours are illustrated in Fig. 1. 
Equations (6) - (10) specify B throughout V f uniquely as a 
functional of the position of the plasma-vacuum interface S and 
the currents I. . There is, of course, a net poloidal current in 
the plasma and also generally a toroidal current on the wall. How­
ever, these currents do not contribute to the magnetic field in 
V , so that the total number of contributing currents is N + 2 . 
3. BASIC EQUATIONS (ELECTRICAL) 
in V the electric field E obeys 
V x E = -3B/3t . dl> 
On S , Faraday's law may be used to show Cl] 
n x E = n*YB+ '* (12) 
-9-
while on a fixed surface S^ we have 
n x E = 0 ; x£Sk , MP I (13) 
almost everywhere. However, in order to model the connections 
to external circuits, we must cut the conductors with thin 
insulating gaps across which potentials Vk (e.m.f.'s) can be 
applied. The wall may be cut both toroidally and poloidally. 
We denote the e.m.f. across the toroidal cut by V. and that 
across the poloidal cut by V (by analogy with 9 and z pinches 
in cylindrical geometry). We assume the contacts to be arranged 
so as not to disturb the axisymmetry of the current distribution 
(if any). If the cuts are represented by the intersections of 
the S with the surfaces a. (x) = 0 , such that n-Va = 0 , then 
the generalization of Eq. (13) to include the gaps is 
n x E = -Vk6(ak)n x Vak ; xeSk , k f p . (14) 
The cuts are illustrated in Fig. 2, and the electric field 
E is sketched in Fig. 3. Note that, even though the currents 
and magnetic field may be axisymmetric, this does not imply 
that the electric field is axisymmetric. However, we can elimi­
nate the electric field from the problem by integrating Eq. (11) 
across annular surfaces Li. bounded by the conductor k and the 
wall (Fig. 4). There is also a surface 5Z9 cutting the vacuum 
region poloidally. 
-10 
Stokes' theorem then reduces the left hand side to a line 
integral over the contours rfc (Fig. 4). Using Eqs. (12) and 
(14), we find the set of equations 
N+2 
Vv ~ V = E_ £ (L. ,1,) ; k < N , (15) "k V2 ft-y dt l"fetii' 
N+2 
-v, = E A- (L ,i.) ;i6) 'z ^x dt VJJp^x£' 
N+2 
E 
£=1 
ve = E JE (LwA) (17) 
where L. „ is the mutual inductance between conductor k and 
conductor £ (or self-inductance if k = £). Note that the 
boundary condition (12) has been absorbed into the total time 
derivatives on the right hand sides of Eqs. (16) and (17). 
Equations (15) - (17) have a very simple interpretation in 
terms of flux conservation: The flux is frozen-in between 
the conductors, the plasma, and the wall, except that flux can 
enter through the cuts, where it flows in or out at a rate 
equal to the voltage drop across the cut. 
The inductance matrix Lfc^ can be represented [8] in terms 
of the magnetic intensity fields Yfc produced by unit currents 
in each conductor. That is, 
-11-
-JC 
Lw = / MY,-*, dT (18) k£ " /„ |Jik U 
where dr is an element of volume, and Y. is defined through 
the equations 
J' (MY. ) = 0 , xeV (19) 
V x Y, = 0 , xeV (20) 
~k ~ 
n«Y. = 0 , xeS» , all I , (21) 
L Yk-d£ = 6k t , all I . (22) 
4. VARIATIONAL PRINCIPLE FOR INDUCTANCE MATRIX 
One of the purposes of this paper is to formulate the 
vacuum part of the Lagrangian in a purely variational way. 
This we do in two steps, the first being to establish a varia­
tional principle for the inductance matrix, which, when solved, 
gives the inductance matrix as a purely geometric functional 
of the plasma displacement £ on the surface of the plasma. This 
inductance matrix functional appears as one ingredient of 
Hamilton's principle, which constitutes the second step of the 
variational formulation. 
-12-
This section concerns the first step, which commences with 
the expression Eq. (18) giving Lfe^ as the interaction energy 
between unit currents in conductors k and I . We assert that 
this energy is stationary against arbitrary variations <$Y , 
which obey Eqs. (20) arid n(22) as constraints, if and only if 
Y£ obeys the Eqs.M19) and (21) (both for k = I and k ? I). 
That is, Eqs. (19) and (21) are to follow as the Euler equation 
and natural boundary condition for the variational principle 
6Lk£ = 0 . (23) 
To prove that this is true we introduce a representation 
for Y. which satisfies the constraints, Eqs. (20) and (22). 
?k - 5k + !xk (24> 
where K. is a f:'. ed, curl-free field in V , obeying Eq. (22). 
For example, K. can be the field of a fixed wire; carrying unit 
current and entirely enclosed by the surface of conductor k . 
Equation (22) implies that X. is an arbitrary single-valued 
function. It is now a simple matter to verify that requiring 
that Eq. (23) be satisfied for arbitrary 8Xfc leads to Eqs. (19) 
and (21) as required. Since Eqs. (19) - (22) completely specify 
the inductance matrix, the variational principle provides a self-
contained procedure for constructing this matrix. 
-13-
5. EXPANSION OF INDUCTANCE MATRIX 
Supposing that Egs. (19) - (22) have been solved, the 
inductance matrix is a functional of the plasma displacement 
field £ at the plasma-vacuum interface. Thus we can expand 
L. „ as a functional Taylor series in £ 
Lk£^-Lk^+/<0) dS' $'-§-kl 
2 
I / (0) dS / (0) dS * T-^T'5 + ... (25) 
^ JslV) ^S[U) AE A£ 
+ 
where the use of A rather than the conventional 5 in the 
functional derivatives is to emphasize that these are all 
Lagrangian derivatives. That is, £ , etc., are expressed as 
t 
functions of the unperturbed positions x , and the surface 
integrals are over the unperturbed surface S . 
The functional derivatives can be evaluated with the aid 
of the variational principle, Eq. (23) . To this end we replace 
E by e£ , where e is a dummy parameter which will be allowed to 
run from 0 to 1 . We expand Y. in powers of e 
= Y,(.0) + evxil) + (1/2) Ax^ (26) 
-14-
We also assume that £(x) can be analytically continued into V , 
so that we can make a change of variable from the "perturbed" 
. . * 
position, which we denote by x , to the "unperturbed" position 
x . That is, we make the transformation 
* x = x + e£(x,t) (27) 
to put L.„ in the form 
X(° 
Lv„(£) = / ,M dT J*(X) H{X*)Y.(XVY,(X*)L* Mcr r (28) k£ ' ~X(0) "' " K~' M,C ;ikle > UKt "x =x+e? ' 
* where J is the Jacobian of the transformation 
J*(x) 3 det{I + EVE) , 
I being the unit dyadic- The advantage of this representation 
is that the integration is now over the unperturbed region V 
We now differentiate with respect to s to find 
* 
de J
C * */ * 8Yk * <*Yj> \ 
""oX 
* * * * 
rs(0) dS J VV •? (29) 
p 
-15-
where 
v* = (I + eVe)_:L-n(0) , (30) 
n being the unit normal to S , directed into V , and the 
* 
asterisks denote evaluation at x = x + e£ (after any differentia­
tion with respect to e). We have usod the following identities 
to integrate the last term to a surface integral. 
OJ*/9E) = J*(I + eVC) 1:VC , (31) 
V-[J*(I + eV£)"1T] = 0 , (32) 
where the double dot product is such that (ab):(cd) is equal to 
(a«d)(b*c) , and superscript T denotes the transposed dyadic. 
Writing 
Lk£(e) = Lj[°} + ELjJJ1 + (1/2) e2!^5 + . . . , (33) 
expanding the right hand side of Eq. (29) in powers of e , and 
equating coefficients we find the first order correction to 
L. £ from the zeroth order approximation to the right hand side 
-16-
plus a term which vanishes because of the stationarity of L^V 
with respect to variations of Y* ' . Comparing Eqs. \25) and 
(34) we see that 
AL^/AS =-n<Vk0)'?r • (35) 
As Yj|. is fixed at this order, jj_.' is trivially extremal. 
(2) To obtain L|!» we need to linearize the right hand side of 
Eq. (29). It will later be found convenient to tag the small 
variables with respect to which this linearization is performed 
with the superscript + . After some integration by parts we 
find 
•<./. 
^dstCn^V.f-V^.n^^^.yW 
SP 
+ n(0'? + .VCYi;0).YJ0)3}.? . (36) 
-17-
Extremizing L^» with respect to variations in Xfc yields the 
Euler equation 
V-CyVx]15] = 0 (37) 
and the boundary condition on S 
.(O).uv(D = v<0>.Wrr.™,<°H (38a) v^u'-vx^' = ?| ;-vC?-v^u'] 
where if> is a scalar field with a level surface coinciding 
with S(0) , so that n{0) = Vi|> (0)/l ?*t0) I . This was introduced 
to allow integration by parts in the middle term of Eq. (36) , 
using the fact that Y) ' is tangential to the surface. We also 
find the boundary condition on the fixed conductors 
n^VX^1' = 0 ; xeSk , k f p . (38b) 
Equations (37) and (38) are just the equations normally 
solved by Green's function techniques, [2,3,101] and the Green's 
function solution gives an explicit expression for the second 
functional derivative when x} and X^ are eliminated in favor 
of n*? . However, one of the advantages of the variational 
formulation of the inductance matrix is that this provides an 
alternative procedure for its calculation which avoids the use 
of Green's functions. This will be discussed in Section 8. 
-18-
The higher order var-f.dticnal derivatives can be evaluated 
by continuing the expansion in powers of e and extremizing order 
by order, but for linear problems we need go no higher than 
0(e2) . 
6. HAMILTON'S PRINCIPLE 
As the second step in the variational formulation, we seek 
a Lagrangian L such that Eqs. (4), (5), (15) - (17) follow from 
the variational principle 
SJ 2 L dt = 0 . (33) 
fcl 
Following Nswcomb [11] we integrate Eqs. (1) - (3) so 
that p, p, and B within P are holonomically constrained to vary 
with the plasma displacement field C(x,t) [6D. In this section 
we need only the Eulerian variations CllD 
<Sp = -V- (p<S£) 
<5p = -YpV'SS - 6£«Vp (40) 
5B = V x (<$£ x B) 
-19-
corresponding to virtual displacements 6£ . All quantities in 
this section are taken to be functions of the perturbed posi­
tion x = x + £ . We also need the Eulerian variation in the 
velocity Cll] 
<5v = (86?/3t) + vV6£ - &Z>Vv . (41) 
With Eqs. (40) and (41) it can easily be shown that Eq. (4) 
follows from the plasma Lagrangian 
L P = X-(!-2-^r-£) 
when Hamilton's principle Eq. (39) is invokejd for variations 
<S£ vanishing on S P 
In order to derive the circuit equations (15) - (17) 
from Hamilton's principle we need the electrical analogue of 
the position coordinate x . As suggested by Maxwell C12], 
the appropriate generalized coordinate is the charge 
J t. 
Qk 5 A zk dt ' (43) 
and the corresponding kinetic energy is 
N+2 
T = (1/2) £ Q LklLa QZ (44) 
-20-
where Qk - lfc is the analogue of the velocity. Note that T 
is the magnetic energy in the insulating region V 
T = (1/2) / K-B dr , (45) e X 
but, because it is a kinetic energy involving the generalized 
velocities Q^ , it must appear with the opposite sign to the 
magnetic energy appearing in i . The circuit equations (15) -
(17) follow from the Lagrangian for the electricl subsyst em 
L* = Te + El Q*(V* " V " Vz + QwVC • (46) 
Here the V. are regarded as externally imposed e.m.f.'s . It 
will be shown later how to eliminate the V. by adding on addi­
tional contributions to the Lagrangian to represent external 
circuits. 
We now propose that the total Lagrangian of the system is 
simply the sum of those of the electrical and plasma subsystems 
1=1+1 . (47) 
e p 
The test of this conjecture is to verify that the dynamical 
boundary condition Eq. (5) is recovered when we allow virtual 
displacements 6? not vanishing on S . Tor Hamilton's 
-21-
principle to hold under such displacements, the natural boundary 
condition 
must be satisfied. By a method similar to that used in deriving 
Eq. (35), we can show that the Eulerian functional derivative 
of L. „ is given by 
6Lk£ 
-5TT = -nyV?£ ' <49) 
Also, in V , we have 
N+2 
H = E=i Qk Yk ; XSV , (5Q) 
so that Eq. (48) does indeed reproduce Eq. (5). 
7. EXPANSION OF THE LAGRANGIAN 
Having established the fully nonlinear form of the 
Lagrangian we must now expand it in powers of the perturbation 
parameter e . The most straightforward method of expansion 
[11] leads to a form of the potential energy not involving 
-22-
gradients of p or B , similar to that found by Hain, Lust, and 
Schluter C13]. However, it takes a "long and tedious calcula­
tion" CllD to prove the equivalence of this form to that of 
Bernstein, et al., [13. In this section we show that the 
expansion method developed in Section 4 leads naturally to the 
Bernstein et al. form. 
To avoid proliferation of superscripts, we shall omit the 
(0) superscript from the unperturbed quantities. As in Eq. (27) , 
* 
x denotes the perturbed position of a fluid element after a 
displacement e£(x,t) from its unperturbed position x . 
We must also allow perturbations in the electrical 
variables Ccf., 2q. (27)1 
Qk = Qk + e% ' 
\ = \ + ev* 
(51) 
Using the integral constraint equations C9H 
p* = p/J* (52) 
*Y (53) P = P/J 
B* = B- (I + ZU)/J* (54) 
-23-
and the same methods as were used to derive Eq. (29) we find 
on differentiating Eq. (42) with respect to e 
£./>«J-(|pV..b'-?^T-g).-.s 
* _*2 
3S J*|i p"(y + e'p* - ^1 
"P 
,*2 
f^ ax J* i (| P*(v + e|)2 - JIT - %;) <55> 
where \ = 8?/8t + vV? , and the Eulerian derivative D/DE is 
defined ty 
-P_ = _L_ r.V* 
V* 5 (I + eV£)-1'V 
Using the identities 
* 
D.T *2 * * 
^ = J V • (?/J ) r (56) 
Do * * 
|-=-?M»P ' (57) 
DD * * * * 
-$T = -5"? P - YP V «| , (58) 
-24-
and 
DB * * 
"Be- = I * (§ x ? > ' <59> 
we can express Eq. (55) in the form 
de = / dS J Ip + !^-j v* + P*n«vy* -| 
>/. 
A * * * * 1 
+ / dx {pv •£ - [V*(pvv ) + J V p 
P ~ ~ 
-1 ****_, - \lQ J (V x B ) x B >£} (60) 
* . where v = v + e? , and £. denotes 3?/3t . 
This is a completely general result, meting no assumptions 
about the unperturbed background state, which need not even be 
in equilibrium. For the present purposes we take the unperturbed 
state to be stationary (v = 0) and in equilibrium 
Vp = u (V x B) x B , xeP , 
p + (Bf/2jiQ) = (B|/2PO) , xesp , 
V, = 0 , all k . <61) 
k 
-25-
Differentiating Eg. (46) with respect to e we find 
^e ^2 •* * • 1 ^+2 •* dLL •* 
k,£=l "• k,l=l 
^ * * * * 
+ £iqk(Vk"Vz)" v-+ qwVe (62) 
N * * * + _£. Qk(vk - vz) - Qpvz + Qwve . 
k=l 
* Here L. -, denotes the exact inductance matrix, Eq. (33) , 
because L. » is now being used to denote Ljl» . Since Eqs. (37) 
and (38) are here assumed to be solved to give X.* as a 
functional of E, on S , we can use integration by parts to 
cancel the .rst two terms of Eq. (36). Using Eq. (50) we 
have 
N+2 
+ f M \ 4V *i - -2I "•"'»•! k,£=l **<-•<• Js 
P (63) 
-VZ1 I dS CB2(nV-5'' - vef-n) + n£ + -VB2> 
SP 
-26-
wftere x is the functional of £ defined by 
N+2 ... 
E Ik ^ • (64) 
k=l K K 
From Eqs. (37) and (38a) we see that x obeys the equations 
V-(uVx) = 0 , xev , (65) 
VijeVx = V!~1B-V(C'V*) , xeSp , (66) 
and also Eq. (38b). 
As in Section 5, we need only to linearize the right hand 
sides of Eqs. (60) and (62) in order to calculate the second 
order term in che Lagrangian. As the right hand side of Eq. 
(60) is in Eulerian form, we can recover the usual form of the 
plasma potential energy with little effort. Using the equilib­
rium relations Eq. (61) we find the total second order 
Lagrangian 
-27-
,-, N+2 . . N , + + 
L(2) = E£=i qjl^ +gx^(vk - vz) + (vj - v^)gk] 
t t f f -q v - v q + q'v. + v a ^p z Z^r> W 6 9 -*W 
N+2 >. , + 
gi yg as (q^+-?k5*! + »•! ?+'?kV 
f dS CB+-VXf + f1"'^/2^^"! J S s p 
•/. 
+ / dS <-YpV-£f + B 'QVU + C't*VB2/2u0)n'C 
SP 
/ dx {p?"f-C. - [Vp+ - (V x Q+) x B/v - (VxB) XQVUJ'U + 
*P 
(67) 
where p is the first order Eulerian pressure change 
p = -ypV-| - |-Vp , (68) 
and Q is the first order Eulerian change in the magnetic field 
Q = V x <£ x B) . (69) 
-28-
Because Eq. (67) has been derived by a rigorous expansion 
method applied to the exact nonlinear Lagrangian, we know that 
Hamilton's principle must yield the correct linearized equations 
when g, £ , q. , q. are varied subject to the physical can­
't + 
stramts £, = £, , q. = q. . If, however, we vary £ and qv 
t t 
independently of £ and q. and suppose that Hamilton's principle 
still applies we find the following equations 
p§tt = ~7p + yo1(~ * 9* x ? + yo1(v x §5 x 9 (70) 
2 
-YpV«£ + B_*Q + §'^B_/2yo 
/ N+2 . \ 2 
= B • vX + £ Vk + e*vV2^ 
X~ k=l ' 
N+2 r 
where (£+,q+) has been equated to (5,q) only after the 
variation. 
(71) 
v, - v , k < N 
k z -
*k = \ -Vz , k = p (72) 
ve , k = t , 
-29-
Eguation (70) is obviously correct, being simply the 
linearized equation of motion. Also, Bernstein et al. ClU 
showed Eg. (71) to be the correct linearized dynamical boundary 
condition, and it can also be shown £83 that Eq. (72) is 
correct. Thus, it is permissible either to vary <£ ,q. ) and 
(£,q. ) together or to vary (?,q. ) independently. These two 
alternatives are compatible only if we also get the correct 
a. a. 
equations when we vary (£',q,) independently. Thus, the 
derivation from a Lagrangian constitutes a proof of the self-
t 1° adjointness of the operator linking (5 ,q ) and (?,q) C5H. 
To summarize the complete variational formulation of the 
linear eigenmode problem, we set forth the three variational 
problems which must be solved. First, to construct the Y. ' s 
we require that 
be stationary under variations of the X. defined by the curl-
free representation, Eg. (24). 
Second, to construct the functional xCCH we require that 
(1/2) ¥,i Vit?1* -£ dT ^*+\?x -/s dsr?+?'!x 
- I dS B-Vx n-£ + const. (74) 
P 
-30-
be stationary under variations of x or x , 
Finally, we apply Hamilton's principle: that 
L 
H L{2) dt (75) 
*1 
t f be stationary with respect to variations of £ or % , q. 
or g. , with Lv • given by Eq- (67)-
8. VACUUM WITHOUT GREEN'S FUNCTIONS 
An immediate benefit of the variational formulation of the 
vacuum is that it suggests a method for calculating x and the 
Y, 's without encountering the singularity problems inherent in 
the Green's function method. 
We take as a starting point Eqs. (24), (73), and (74). The 
choice of the current distribution to produce Kk is somewhat 
arbitrary, and should be made in such a way that the field K. 
is approximately tangential to the surface of the conductor k . 
This can be done if necessary by a combination of several line 
currents. For simplicity, we consider the case u = vQ every­
where in V . The choice of K. as a superposition of vacuum 
H-fields then ensures that the K^ satisfy Eg. (19). If we 
expand X. in a finite set of functions ua obeying Laplace's 
equation and analytic everywhere in V and on the surfaces Sk , 
Xk^=^Xku« ' (76) 
-31-
we can automatically satisfy Eq. (19). The boundary conditions 
Eqs. (21) and (22) remain to be approximated variationally. A 
suitable choice for the u would be toroidal harmonics with 
a 
toroidal axes coinciding with the line currents used to produce 
the K 's . 
Inserting the Ansatz, Eg. (76) into Eq. (73) and integrating 
by parts we find 
- -. L \l - V'v dT S*'?i 
Ttl ' Iff 
m 
where Y" sums over all N + 2 surfaces, and A . is the matrix 
A«e E ' £ / ds V?'?ue • <78> 
m 
Requiring that L. » be stationary with respect to arbitrary 
variations in the coefficients X? yields the equation 
-32-
? A«e x*= 5 k ds u<*~'* K„ . (79) 
m 
Inversion of A „ yields the required coefficients X? , from 
which can be constructed the Y ' s and L.„ . 
Similarly, to construct an approximate solution for x • we 
expand x in the same representation 
X = L X u . (80) 
a a a 
insert this in Eg. (74), and integrate by parts to find 
(V2) kU Ik ^)llL = ^ <S ** A«B *E 
' ? x3 1 dS ~^+~*~ue 
- E Xf / <3S r.-£B-Vu„ + const. (81) 
a -Sp 
Variation of xa yields the equation 
-33-
^o ?AaB *6 = L dS ?•!!'% ' (82) 
P 
Thus to solve for the coefficients v0 we need only the inverse 
of A . , which must already have been calculated to obtain L. » . 
9. CIRCUIT EQUATIONS 
In this section we sketch out the types of problems which 
can be treated using the freedom inherent in our formulation. 
First, we suppose all the insulating gaps to be shorted 
out, we can set ail the v, to zero. Then q. does not appear in 
the Lagrangian and we can use the currents i = q as generalized 
coordinates. The Euler equation corresponding to variation of 
i. is the time integrated form of Eg. (72) with the right hand 
side set to zero. Thus, by inverting the inductance matrix, we 
can find the i, 's as functionals of k 
the Lagrangian. Using the identity 
can find the i, 's as functionals of £ and eliminate them from k ~ 
I dS n-EB .VX+ = / dr uVX+-VX , (83) 
we can then put Eq. (67) in the form 
(84) L(2) = f dT pgj.£t - 26W , 
-34-
where 6W is the potential energy functional found by Bernstein 
et al. Cl3, with the vacuum energy in the scalar potential 
form [8] 
N+2 
26W 
2 2 
+ I dTCYp(V.Cf)V.C + (?t-Vp)V.? + Q+-Q/2u 
- (V x B) x Q*'Z/vol . (85) 
Thus we have proved that the previous forms of the varia­
tional principle can be recovered as a special case of the 
present one. It is now of interest to explore the types of 
problems which can be attacked using the extra freedom obtained 
by treating the currents or charges as generalized coordinates. 
-35-
The first problem which can be treated is the effect of 
passive feedback on stability. Suppose, for instance, that all 
gaps are shorted out except for two (k = 1 and 2, say), which 
are instead connected so that the conductors are in series 
(see Fig. 5). Then 
v1 = v = v , say, (86) 
and we also have the charge conservation constraint 
qx = -q2 . (87) 
Inspecting Eq. (67) we see that v acts as a Lagrange multiplier 
with respect to the constraint Eq. (87). That is, by adjoining 
Eq. (87) to Eq. (72) we can solve for v and again eliminate all 
the currents i. = q. as functionals of K . In fact Eq. (85) is 
unchanged, except for the implicit functional dependence of the 
*k on ! • 
Now suppose that all gaps are shorted, except for k = 1 , 
which is connected to an external circuit with inductance L . 
We also attempt to short the gap to high frequency currents by 
connecting a capacitor C across it, as depicted in Fig. 6. 
This problem can be treated by adding a contribution to the 
Lagrangian corresponding to the two circuits being driven by 
the potential v. . The Lagrangian for the capacitor circuit c 
-36-
is a potential energy term plus an interaction term to represent 
the effect of the potential v, 
(2) + t + 
Lc = -q q/C - q v2 - qv[ , (88) 
while that for the inductor circuit i is a kinetic energy term 
plus an interaction term 
^i - (qj - q >Mqj. - q) - (q[ - qT)v1 - (qx - q)v\ , 
(89) 
where we have built in the charge conservation constraint by 
expressing the charge in the inductor circuit in terms of q, 
and q , the charge in the capacitor circuit. 
When Eqs. (67), (88), and (89) are added, the terms 
involving v, cancel, as they must because there is no excitation 
external to the total system. However, the presence of the 
term q q/C represents a qualitative change in the nature of the 
Lagrangian since q cannot be treated as a generalized coordinate. 
If we assume the time dependence exp(-io)t) and work in terms of 
(2) the i, variables and q , L. will contain terms linear in to . If 
(2) we retain the q. variables, L now will contain linear terms in 
to . Either way the problem is no longer a standard eigenvalue 
2 
problem for u , and will require new solution techniques. 
Finally, we remark that if we apply a true external potential 
v. exp(io)t) , the finite element method can still be used to 
-37-
calculate the open loop response q^Vjy w) . Thus, by using the 
Nyquist technique it should be possible to examine the effect of 
an active feedback circuit on stability and growth rates. 
10. CONCLUSION 
In the foregoing sections we have done several things: 
(i) We have generalized Newcomb's [113 nonlinear Lagrangian 
by the inclusion of a vacuum region. The availability of a non­
linear Lagrangian offers not only the possibility of investi­
gating mode coupling effects C7], but also the possibility of 
making a linear stability code self-correcting with respect to 
errors in the approximation to the equilibrium whose stability 
is to be investigated. 
(ii) We have found a method of expansion for the Lagrangian 
which needs only a linearization to treat linear problems and 
which produces the familiar form of the potential energy in a 
natural manner. 
(iii) We have found variational principles for the inductance 
matrix L.» and scalar potential x which allows Galerkin's method 
to be used in the vacuum region. 
(iv) We have introduced generalized coordinates to describe 
the currents flowing in the plasma and external conductors, 
thus allowing the treatment of external circuits. 
-38-
ACKNOWLEDGMENTS 
It is a pleasure to acknowledge useful conversations with 
Drs. M. S. Chance, R. M. Kulsrud, J. L. Johnson, J. M. Greene, 
and R. C. Grimm. 
This work was supported by United States Department of 
Energy Contract No. EY-76-C-02-3073. 
REFERENCES 
[1] BERNSTEIN, I. B., FRIEMAN, E. A., KRUSKAL, M. D. , and 
KULSRUD, R. M., Proc. Roy. Soc. (London) 244A, 17 (1958). 
GRIMM, R. C, GREENE, J. M. , and JOHNSON, J. I,., in 
Methods in Computational Physics, V. Ij6, ed. J. Killeen 
(Academic Press, New York, 1976), p. 253. 
BERGER, D., Numerical Computations of the Ideal Magneto-
hydrodynamic Stability of Small Aspect Ratio Tokamaka 
(Ph.D. Thesis, Ecole Polytechnique Federal de Lausanne, 
1977). 
STRANG, G. and FIX, G. J., An Analysis of the Finite 
Element Method (Prentice Hall, Englewood cliffs. New 
Jersey, 1973). 
KULSRUD, R. M., Astrophys. J. 152, 1121 (1968). 
DEWAR, R. L., Phys. Fluids 12, 2710 (1970). 
DAGAZIAN, R. Y., Nucl. Fusion 16, 12; (1976). 
LUST, R. and MARTENS ON, E., Z. Naturforsch. 15a, 706 (1960). 
BLANK, A. A., FRIEDRICHS, K. O., and GRAD, H., Theory of 
Maxwell's Equations Without Displacement Current, Notes on 
Magneto-Hydrodynamics V, Report NYO-64&6, Courant Institute 
of Mathematical Sciences, New York University (1957). 
MARDER, B. M., Phys. Fluids 17, 634 (1974). 
[2] 
[3: 
:« 
C5J 
m 
[lOH 
7111 ! 
-40-
Cll] HEWCOMB, w. A., Nucl. Fusion Suppl. Pt. 2, 451 (1962). 
L12] MAXWELL, J. C, A Treatise on Electricity and Magnetism 
(Dover, New York, 1954), 3rd ed., V. 2, p. 223. 
Cl3] HAIN, K., LUST, R., and SCHLUTER, A., Z. Naturforsch. 
12a, 833 (1957). 
-41-
FIGURE CAPTIONS 
Fig. 1. General toroidal configuration: plasma, poloidal 
conductors, and wall. Three sides of the wall may go to 
infinity leaving a conductor on the major axis to give the 
toroidal field. The currents I. and Ampere contours C. are 
also shown. 
Fig. 2. Insulating gaps defined by the surfaces a, = 0 , 
across which e.m.f.'s V. are applied. 
Fig. 3. Close-up of electric field in the vicinity of 
an insulating gap, showing how the tangential component is 
effectively a <5 function. 
Fig. 4. Surfaces J^. and contours r. used for integrating 
Faraday's equat ions. 
Fig. 5. Two conductors in series, showing how Kirchhoff's 
laws give constraints on the circuits. 
Fig. 6. Addition of external circuits to the system. 
•42-
Fig. 1. 782019 
vk 
ak=0 
Va, 
a0 = o 
Va, Y^ =0 " 
Y///// 
Fig. 2. 782021 
-44-
Fig. 3. 782018 
-45-
(q) 
(D) 
Fig. 4. 782020 
ci, = -q 
«Z -- vl 
Pig. 5. 782017 
1^ Ml q, -q 
Fig. 6. 782016 